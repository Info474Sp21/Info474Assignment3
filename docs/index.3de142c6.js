!function(){function e(e){return e&&e.__esModule?e.default:e}function t(e,t,n){Object.defineProperty(e,t,{get:n,enumerable:!0})}function n(e,t){return Object.keys(t).forEach((function(n){"default"!==n&&"__esModule"!==n&&Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[n]}})})),e}var r,i,o,a,s=!1;function u(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function l(){r={},i=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,r=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,r,s=u(e),l=1;l<arguments.length;l++){for(var c in n=Object(arguments[l]))o.call(n,c)&&(s[c]=n[c]);if(i){r=i(n);for(var f=0;f<r.length;f++)a.call(n,r[f])&&(s[r[f]]=n[r[f]])}}return s}}function c(){return s||(s=!0,l()),r}var f,d,h,p,m,g,y,v,b,x,w,_,k,E,S,A,C,D,M,F,N,O,$,T,z,R,P,L,B,I,j,U,q,W,H,V,G,Y,X,Q,J,K,Z,ee,te,ne,re,ie=!1;function oe(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function ae(e,t,n){this.props=e,this.context=t,this.refs=C,this.updater=n||A}function se(){}function ue(e,t,n){this.props=e,this.context=t,this.refs=C,this.updater=n||A}function le(e,t,n){var r,i={},o=null,a=null;if(null!=t)for(r in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(o=""+t.key),t)F.call(t,r)&&!N.hasOwnProperty(r)&&(i[r]=t[r]);var s=arguments.length-2;if(1===s)i.children=n;else if(1<s){for(var u=Array(s),l=0;l<s;l++)u[l]=arguments[l+2];i.children=u}if(e&&e.defaultProps)for(r in s=e.defaultProps)void 0===i[r]&&(i[r]=s[r]);return{$$typeof:h,type:e,key:o,ref:a,props:i,_owner:M.current}}function ce(e){return"object"==typeof e&&null!==e&&e.$$typeof===h}function fe(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function de(e,t,n,r,i){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var a=!1;if(null===e)a=!0;else switch(o){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case h:case p:a=!0}}if(a)return i=i(a=e),e=""===r?"."+fe(a,0):r,Array.isArray(i)?(n="",null!=e&&(n=e.replace(O,"$&/")+"/"),de(i,t,n,"",(function(e){return e}))):null!=i&&(ce(i)&&(i=function(e,t){return{$$typeof:h,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(i,n+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(O,"$&/")+"/")+e)),t.push(i)),1;if(a=0,r=""===r?".":r+":",Array.isArray(e))for(var s=0;s<e.length;s++){var u=r+fe(o=e[s],s);a+=de(o,t,n,u,i)}else if("function"==typeof(u=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=S&&e[S]||e["@@iterator"])?e:null}(e)))for(e=u.call(e),s=0;!(o=e.next()).done;)a+=de(o=o.value,t,n,u=r+fe(o,s++),i);else if("object"===o)throw t=""+e,Error(oe(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t));return a}function he(e,t,n){if(null==e)return e;var r=[],i=0;return de(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function pe(e){if(-1===e._status){var t=e._result;t=t(),e._status=0,e._result=t,t.then((function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)}),(function(t){0===e._status&&(e._status=2,e._result=t)}))}if(1===e._status)return e._result;throw e._result}function me(){var e=$.current;if(null===e)throw Error(oe(321));return e}function ge(){return ie||(ie=!0,f={},d=c(),h=60103,p=60106,m=60107,f.Fragment=m,g=60108,f.StrictMode=g,y=60114,f.Profiler=y,v=60109,b=60110,x=60112,w=60113,f.Suspense=w,_=60115,k=60116,"function"==typeof Symbol&&Symbol.for&&(E=Symbol.for,h=E("react.element"),p=E("react.portal"),m=E("react.fragment"),f.Fragment=m,g=E("react.strict_mode"),f.StrictMode=g,y=E("react.profiler"),f.Profiler=y,v=E("react.provider"),b=E("react.context"),x=E("react.forward_ref"),w=E("react.suspense"),f.Suspense=w,_=E("react.memo"),k=E("react.lazy")),S="function"==typeof Symbol&&Symbol.iterator,A={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C={},ae.prototype.isReactComponent={},ae.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error(oe(85));this.updater.enqueueSetState(this,e,t,"setState")},ae.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},se.prototype=ae.prototype,(D=ue.prototype=new se).constructor=ue,d(D,ae.prototype),D.isPureReactComponent=!0,M={current:null},F=Object.prototype.hasOwnProperty,N={key:!0,ref:!0,__self:!0,__source:!0},O=/\/+/g,T={ReactCurrentDispatcher:$={current:null},ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:M,IsSomeRendererActing:{current:!1},assign:d},z={map:he,forEach:function(e,t,n){he(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return he(e,(function(){t++})),t},toArray:function(e){return he(e,(function(e){return e}))||[]},only:function(e){if(!ce(e))throw Error(oe(143));return e}},f.Children=z,R=ae,f.Component=R,P=ue,f.PureComponent=P,L=T,f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=L,B=function(e,t,n){if(null==e)throw Error(oe(267,e));var r=d({},e.props),i=e.key,o=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,a=M.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var s=e.type.defaultProps;for(u in t)F.call(t,u)&&!N.hasOwnProperty(u)&&(r[u]=void 0===t[u]&&void 0!==s?s[u]:t[u])}var u=arguments.length-2;if(1===u)r.children=n;else if(1<u){s=Array(u);for(var l=0;l<u;l++)s[l]=arguments[l+2];r.children=s}return{$$typeof:h,type:e.type,key:i,ref:o,props:r,_owner:a}},f.cloneElement=B,I=function(e,t){return void 0===t&&(t=null),(e={$$typeof:b,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:v,_context:e},e.Consumer=e},f.createContext=I,j=le,f.createElement=j,U=function(e){var t=le.bind(null,e);return t.type=e,t},f.createFactory=U,q=function(){return{current:null}},f.createRef=q,W=function(e){return{$$typeof:x,render:e}},f.forwardRef=W,H=ce,f.isValidElement=H,V=function(e){return{$$typeof:k,_payload:{_status:-1,_result:e},_init:pe}},f.lazy=V,G=function(e,t){return{$$typeof:_,type:e,compare:void 0===t?null:t}},f.memo=G,Y=function(e,t){return me().useCallback(e,t)},f.useCallback=Y,X=function(e,t){return me().useContext(e,t)},f.useContext=X,Q=function(){},f.useDebugValue=Q,J=function(e,t){return me().useEffect(e,t)},f.useEffect=J,K=function(e,t,n){return me().useImperativeHandle(e,t,n)},f.useImperativeHandle=K,Z=function(e,t){return me().useLayoutEffect(e,t)},f.useLayoutEffect=Z,ee=function(e,t){return me().useMemo(e,t)},f.useMemo=ee,te=function(e,t,n){return me().useReducer(e,t,n)},f.useReducer=te,ne=function(e){return me().useRef(e)},f.useRef=ne,re=function(e){return me().useState(e)},f.useState=re,"17.0.2",f.version="17.0.2"),f}var ye,ve,be=!1;function xe(){return be||(be=!0,ye={},ye=ge(),ve=e(ye)),ye}xe();var we,_e,ke,Ee,Se,Ae,Ce,De,Me,Fe,Ne,Oe,$e,Te,ze,Re,Pe,Le,Be,Ie,je,Ue,qe,We,He,Ve,Ge,Ye,Xe,Qe,Je,Ke,Ze,et,tt,nt,rt,it,ot,at,st,ut,lt,ct=!1;function ft(e,t){var n=e.length;e.push(t);e:for(;;){var r=n-1>>>1,i=e[r];if(!(void 0!==i&&0<pt(i,t)))break e;e[r]=t,e[n]=i,n=r}}function dt(e){return void 0===(e=e[0])?null:e}function ht(e){var t=e[0];if(void 0!==t){var n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length;r<i;){var o=2*(r+1)-1,a=e[o],s=o+1,u=e[s];if(void 0!==a&&0>pt(a,n))void 0!==u&&0>pt(u,a)?(e[r]=u,e[s]=n,r=s):(e[r]=a,e[o]=n,r=o);else{if(!(void 0!==u&&0>pt(u,n)))break e;e[r]=u,e[s]=n,r=s}}}return t}return null}function pt(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}function mt(e){for(var t=dt(Ve);null!==t;){if(null===t.callback)ht(Ve);else{if(!(t.startTime<=e))break;ht(Ve),t.sortIndex=t.expirationTime,ft(He,t)}t=dt(Ve)}}function gt(e){if(Ke=!1,mt(e),!Je)if(null!==dt(He))Je=!0,Se(yt);else{var t=dt(Ve);null!==t&&Ae(gt,t.startTime-e)}}function yt(e,t){Je=!1,Ke&&(Ke=!1,Ce()),Qe=!0;var n=Xe;try{for(mt(t),Ye=dt(He);null!==Ye&&(!(Ye.expirationTime>t)||e&&!_e());){var r=Ye.callback;if("function"==typeof r){Ye.callback=null,Xe=Ye.priorityLevel;var i=r(Ye.expirationTime<=t);t=we(),"function"==typeof i?Ye.callback=i:Ye===dt(He)&&ht(He),mt(t)}else ht(He);Ye=dt(He)}if(null!==Ye)var o=!0;else{var a=dt(Ve);null!==a&&Ae(gt,a.startTime-t),o=!1}return o}finally{Ye=null,Xe=n,Qe=!1}}function vt(){return ct||(ct=!0,Ee={},"object"==typeof performance&&"function"==typeof performance.now?(Me=performance,we=function(){return Me.now()},Ee.unstable_now=we):(Fe=Date,Ne=Fe.now(),we=function(){return Fe.now()-Ne},Ee.unstable_now=we),"undefined"==typeof window||"function"!=typeof MessageChannel?(Oe=null,$e=null,Te=function(){if(null!==Oe)try{var e=we();Oe(!0,e),Oe=null}catch(e){throw setTimeout(Te,0),e}},Se=function(e){null!==Oe?setTimeout(Se,0,e):(Oe=e,setTimeout(Te,0))},Ae=function(e,t){$e=setTimeout(e,t)},Ce=function(){clearTimeout($e)},_e=function(){return!1},Ee.unstable_shouldYield=_e,ke=function(){},De=Ee.unstable_forceFrameRate=ke):(ze=window.setTimeout,Re=window.clearTimeout,"undefined"!=typeof console&&(Pe=window.cancelAnimationFrame,"function"!=typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),"function"!=typeof Pe&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")),Le=!1,Be=null,Ie=-1,je=5,Ue=0,_e=function(){return we()>=Ue},Ee.unstable_shouldYield=_e,De=function(){},ke=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):je=0<e?Math.floor(1e3/e):5},Ee.unstable_forceFrameRate=ke,qe=new MessageChannel,We=qe.port2,qe.port1.onmessage=function(){if(null!==Be){var e=we();Ue=e+je;try{Be(!0,e)?We.postMessage(null):(Le=!1,Be=null)}catch(e){throw We.postMessage(null),e}}else Le=!1},Se=function(e){Be=e,Le||(Le=!0,We.postMessage(null))},Ae=function(e,t){Ie=ze((function(){e(we())}),t)},Ce=function(){Re(Ie),Ie=-1}),He=[],Ve=[],Ge=1,Ye=null,Xe=3,Qe=!1,Je=!1,Ke=!1,Ze=De,5,Ee.unstable_IdlePriority=5,1,Ee.unstable_ImmediatePriority=1,4,Ee.unstable_LowPriority=4,3,Ee.unstable_NormalPriority=3,null,Ee.unstable_Profiling=null,2,Ee.unstable_UserBlockingPriority=2,et=function(e){e.callback=null},Ee.unstable_cancelCallback=et,tt=function(){Je||Qe||(Je=!0,Se(yt))},Ee.unstable_continueExecution=tt,nt=function(){return Xe},Ee.unstable_getCurrentPriorityLevel=nt,rt=function(){return dt(He)},Ee.unstable_getFirstCallbackNode=rt,it=function(e){switch(Xe){case 1:case 2:case 3:var t=3;break;default:t=Xe}var n=Xe;Xe=t;try{return e()}finally{Xe=n}},Ee.unstable_next=it,ot=function(){},Ee.unstable_pauseExecution=ot,at=Ze,Ee.unstable_requestPaint=at,st=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=Xe;Xe=e;try{return t()}finally{Xe=n}},Ee.unstable_runWithPriority=st,ut=function(e,t,n){var r=we();switch(n="object"==typeof n&&null!==n&&"number"==typeof(n=n.delay)&&0<n?r+n:r,e){case 1:var i=-1;break;case 2:i=250;break;case 5:i=1073741823;break;case 4:i=1e4;break;default:i=5e3}return e={id:Ge++,callback:t,priorityLevel:e,startTime:n,expirationTime:i=n+i,sortIndex:-1},n>r?(e.sortIndex=n,ft(Ve,e),null===dt(He)&&e===dt(Ve)&&(Ke?Ce():Ke=!0,Ae(gt,n-r))):(e.sortIndex=i,ft(He,e),Je||Qe||(Je=!0,Se(yt))),e},Ee.unstable_scheduleCallback=ut,lt=function(e){var t=Xe;return function(){var n=Xe;Xe=t;try{return e.apply(this,arguments)}finally{Xe=n}}},Ee.unstable_wrapCallback=lt),Ee}var bt,xt=!1;function wt(){return xt||(xt=!0,bt={},bt=vt()),bt}var _t,kt,Et,St,At,Ct,Dt,Mt,Ft,Nt,Ot,$t,Tt,zt,Rt,Pt,Lt,Bt,It,jt,Ut,qt,Wt,Ht,Vt,Gt,Yt,Xt,Qt,Jt,Kt,Zt,en,tn,nn,rn,on,an,sn,un,ln,cn,fn,dn,hn,pn,mn,gn,yn,vn,bn,xn,wn,_n,kn,En,Sn,An,Cn,Dn,Mn,Fn,Nn,On,$n,Tn,zn,Rn,Pn,Ln,Bn,In,jn,Un,qn,Wn,Hn,Vn,Gn,Yn,Xn,Qn,Jn,Kn,Zn,er,tr,nr,rr,ir,or,ar,sr,ur,lr,cr,fr,dr,hr,pr,mr,gr,yr,vr,br,xr,wr,_r,kr,Er,Sr,Ar,Cr,Dr,Mr,Fr,Nr,Or,$r,Tr,zr,Rr,Pr,Lr,Br,Ir,jr,Ur,qr,Wr,Hr,Vr,Gr,Yr,Xr,Qr,Jr,Kr,Zr,ei,ti,ni,ri,ii,oi,ai,si,ui,li,ci,fi,di,hi,pi,mi,gi,yi,vi,bi,xi,wi,_i,ki,Ei,Si,Ai,Ci,Di,Mi,Fi,Ni,Oi,$i,Ti,zi,Ri,Pi,Li,Bi,Ii,ji,Ui,qi,Wi,Hi,Vi,Gi,Yi,Xi,Qi,Ji,Ki,Zi,eo,to,no,ro,io,oo,ao,so,uo,lo,co,fo,ho,po,mo,go,yo,vo,bo,xo,wo,_o,ko,Eo,So,Ao,Co,Do,Mo,Fo,No,Oo,$o,To,zo,Ro,Po,Lo,Bo,Io,jo,Uo,qo,Wo,Ho,Vo,Go,Yo,Xo,Qo,Jo,Ko,Zo,ea,ta,na,ra,ia,oa,aa,sa,ua,la,ca,fa,da,ha,pa,ma,ga,ya,va,ba,xa,wa,_a,ka,Ea,Sa,Aa,Ca=!1;function Da(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function Ma(e,t){Fa(e,t),Fa(e+"Capture",t)}function Fa(e,t){for(At[e]=t,e=0;e<t.length;e++)St.add(t[e])}function Na(e,t,n,r,i,o,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=a}function Oa(e){return e[1].toUpperCase()}function $a(e,t,n,r){var i=Ot.hasOwnProperty(t)?Ot[t]:null;(null!==i?0===i.type:!r&&(2<t.length&&("o"===t[0]||"O"===t[0])&&("n"===t[1]||"N"===t[1])))||(function(e,t,n,r){if(null==t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!Mt.call(Nt,e)||!Mt.call(Ft,e)&&(Dt.test(e)?Nt[e]=!0:(Ft[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}function Ta(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=Zt&&e[Zt]||e["@@iterator"])?e:null}function za(e){if(void 0===en)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);en=t&&t[1]||""}return"\n"+en+e}function Ra(e,t){if(!e||tn)return"";tn=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(e){var r=e}Reflect.construct(e,[],t)}else{try{t.call()}catch(e){r=e}e.call(t.prototype)}else{try{throw Error()}catch(e){r=e}e()}}catch(e){if(e&&r&&"string"==typeof e.stack){for(var i=e.stack.split("\n"),o=r.stack.split("\n"),a=i.length-1,s=o.length-1;1<=a&&0<=s&&i[a]!==o[s];)s--;for(;1<=a&&0<=s;a--,s--)if(i[a]!==o[s]){if(1!==a||1!==s)do{if(a--,0>--s||i[a]!==o[s])return"\n"+i[a].replace(" at new "," at ")}while(1<=a&&0<=s);break}}}finally{tn=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?za(e):""}function Pa(e){switch(e.tag){case 5:return za(e.type);case 16:return za("Lazy");case 13:return za("Suspense");case 19:return za("SuspenseList");case 0:case 2:case 15:return e=Ra(e.type,!1);case 11:return e=Ra(e.type.render,!1);case 22:return e=Ra(e.type._render,!1);case 1:return e=Ra(e.type,!0);default:return""}}function La(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case Pt:return"Fragment";case Rt:return"Portal";case Bt:return"Profiler";case Lt:return"StrictMode";case qt:return"Suspense";case Wt:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case jt:return(e.displayName||"Context")+".Consumer";case It:return(e._context.displayName||"Context")+".Provider";case Ut:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case Ht:return La(e.type);case Gt:return La(e._render);case Vt:t=e._payload,e=e._init;try{return La(e(t))}catch(e){}}return null}function Ba(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}function Ia(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function ja(e){e._valueTracker||(e._valueTracker=function(e){var t=Ia(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var i=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function Ua(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Ia(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function qa(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Wa(e,t){var n=t.checked;return Et({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Ha(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=Ba(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Va(e,t){null!=(t=t.checked)&&$a(e,"checked",t,!1)}function Ga(e,t){Va(e,t);var n=Ba(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?Xa(e,t.type,n):t.hasOwnProperty("defaultValue")&&Xa(e,t.type,Ba(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Ya(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function Xa(e,t,n){"number"===t&&qa(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}function Qa(e,t){return e=Et({children:void 0},t),(t=function(e){var t="";return kt.Children.forEach(e,(function(e){null!=e&&(t+=e)})),t}(t.children))&&(e.children=t),e}function Ja(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Ba(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function Ka(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(Da(91));return Et({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Za(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(Da(92));if(Array.isArray(n)){if(!(1>=n.length))throw Error(Da(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:Ba(n)}}function es(e,t){var n=Ba(t.value),r=Ba(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ts(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ns(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function rs(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ns(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}function is(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}function os(e,t,n){return null==t||"boolean"==typeof t||""===t?"":n||"number"!=typeof t||0===t||an.hasOwnProperty(e)&&an[e]?(""+t).trim():t+"px"}function as(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=os(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}function ss(e,t){if(t){if(un[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(Da(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(Da(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(Da(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(Da(62))}}function us(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function ls(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}function cs(e){if(e=ju(e)){if("function"!=typeof ln)throw Error(Da(280));var t=e.stateNode;t&&(t=qu(t),ln(e.stateNode,e.type,t))}}function fs(e){cn?fn?fn.push(e):fn=[e]:cn=e}function ds(){if(cn){var e=cn,t=fn;if(fn=cn=null,cs(e),t)for(e=0;e<t.length;e++)cs(t[e])}}function hs(e,t){return e(t)}function ps(e,t,n,r,i){return e(t,n,r,i)}function ms(){}function gs(){null===cn&&null===fn||(ms(),ds())}function ys(e,t){var n=e.stateNode;if(null===n)return null;var r=qu(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(Da(231,t,typeof n));return n}function vs(e,t,n,r,i,o,a,s,u){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(e){this.onError(e)}}function bs(e,t,n,r,i,o,a,s,u){yn=!1,vn=null,vs.apply(wn,arguments)}function xs(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!=(1026&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function ws(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function _s(e){if(xs(e)!==e)throw Error(Da(188))}function ks(e){if(!(e=function(e){var t=e.alternate;if(!t){if(null===(t=xs(e)))throw Error(Da(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return _s(i),e;if(o===r)return _s(i),t;o=o.sibling}throw Error(Da(188))}if(n.return!==r.return)n=i,r=o;else{for(var a=!1,s=i.child;s;){if(s===n){a=!0,n=i,r=o;break}if(s===r){a=!0,r=i,n=o;break}s=s.sibling}if(!a){for(s=o.child;s;){if(s===n){a=!0,n=o,r=i;break}if(s===r){a=!0,r=o,n=i;break}s=s.sibling}if(!a)throw Error(Da(189))}}if(n.alternate!==r)throw Error(Da(190))}if(3!==n.tag)throw Error(Da(188));return n.stateNode.current===n?e:t}(e)))return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}function Es(e,t){for(var n=e.alternate;null!==t;){if(t===e||t===n)return!0;t=t.return}return!1}function Ss(e,t,n,r,i){return{blockedOn:e,domEventName:t,eventSystemFlags:16|n,nativeEvent:i,targetContainers:[r]}}function As(e,t){switch(e){case"focusin":case"focusout":Dn=null;break;case"dragenter":case"dragleave":Mn=null;break;case"mouseover":case"mouseout":Fn=null;break;case"pointerover":case"pointerout":Nn.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":On.delete(t.pointerId)}}function Cs(e,t,n,r,i,o){return null===e||e.nativeEvent!==o?(e=Ss(t,n,r,i,o),null!==t&&(null!==(t=ju(t))&&kn(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Ds(e){var t=Iu(e.target);if(null!==t){var n=xs(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=ws(n)))return e.blockedOn=t,void Sn(e.lanePriority,(function(){wt().unstable_runWithPriority(e.priority,(function(){En(n)}))}))}else if(3===t&&n.stateNode.hydrate)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ms(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Ys(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ju(n))&&kn(t),e.blockedOn=n,!1;t.shift()}return!0}function Fs(e,t,n){Ms(e)&&n.delete(t)}function Ns(){for(An=!1;0<Cn.length;){var e=Cn[0];if(null!==e.blockedOn){null!==(e=ju(e.blockedOn))&&_n(e);break}for(var t=e.targetContainers;0<t.length;){var n=Ys(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n){e.blockedOn=n;break}t.shift()}null===e.blockedOn&&Cn.shift()}null!==Dn&&Ms(Dn)&&(Dn=null),null!==Mn&&Ms(Mn)&&(Mn=null),null!==Fn&&Ms(Fn)&&(Fn=null),Nn.forEach(Fs),On.forEach(Fs)}function Os(e,t){e.blockedOn===t&&(e.blockedOn=null,An||(An=!0,wt().unstable_scheduleCallback(wt().unstable_NormalPriority,Ns)))}function $s(e){function t(t){return Os(t,e)}if(0<Cn.length){Os(Cn[0],e);for(var n=1;n<Cn.length;n++){var r=Cn[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Dn&&Os(Dn,e),null!==Mn&&Os(Mn,e),null!==Fn&&Os(Fn,e),Nn.forEach(t),On.forEach(t),n=0;n<$n.length;n++)(r=$n[n]).blockedOn===e&&(r.blockedOn=null);for(;0<$n.length&&null===(n=$n[0]).blockedOn;)Ds(n),null===n.blockedOn&&$n.shift()}function Ts(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}function zs(e){if(Rn[e])return Rn[e];if(!zn[e])return e;var t,n=zn[e];for(t in n)if(n.hasOwnProperty(t)&&t in Pn)return Rn[e]=n[t];return e}function Rs(e,t){for(var n=0;n<e.length;n+=2){var r=e[n],i=e[n+1];i="on"+(i[0].toUpperCase()+i.slice(1)),qn.set(r,t),Un.set(r,i),Ma(i,[r])}}function Ps(e){if(0!=(1&e))return Hn=15,1;if(0!=(2&e))return Hn=14,2;if(0!=(4&e))return Hn=13,4;var t=24&e;return 0!==t?(Hn=12,t):0!=(32&e)?(Hn=11,32):0!==(t=192&e)?(Hn=10,t):0!=(256&e)?(Hn=9,256):0!==(t=3584&e)?(Hn=8,t):0!=(4096&e)?(Hn=7,4096):0!==(t=4186112&e)?(Hn=6,t):0!==(t=62914560&e)?(Hn=5,t):67108864&e?(Hn=4,67108864):0!=(134217728&e)?(Hn=3,134217728):0!==(t=805306368&e)?(Hn=2,t):0!=(1073741824&e)?(Hn=1,1073741824):(Hn=8,e)}function Ls(e,t){var n=e.pendingLanes;if(0===n)return Hn=0;var r=0,i=0,o=e.expiredLanes,a=e.suspendedLanes,s=e.pingedLanes;if(0!==o)r=o,i=Hn=15;else if(0!==(o=134217727&n)){var u=o&~a;0!==u?(r=Ps(u),i=Hn):0!==(s&=o)&&(r=Ps(s),i=Hn)}else 0!==(o=n&~a)?(r=Ps(o),i=Hn):0!==s&&(r=Ps(s),i=Hn);if(0===r)return 0;if(r=n&((0>(r=31-Vn(r))?0:1<<r)<<1)-1,0!==t&&t!==r&&0==(t&a)){if(Ps(t),i<=Hn)return t;Hn=i}if(0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-Vn(t)),r|=e[n],t&=~i;return r}function Bs(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function Is(e,t){switch(e){case 15:return 1;case 14:return 2;case 12:return 0===(e=js(24&~t))?Is(10,t):e;case 10:return 0===(e=js(192&~t))?Is(8,t):e;case 8:return 0===(e=js(3584&~t))&&(0===(e=js(4186112&~t))&&(e=512)),e;case 2:return 0===(t=js(805306368&~t))&&(t=268435456),t}throw Error(Da(358,e))}function js(e){return e&-e}function Us(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function qs(e,t,n){e.pendingLanes|=t;var r=t-1;e.suspendedLanes&=r,e.pingedLanes&=r,(e=e.eventTimes)[t=31-Vn(t)]=n}function Ws(e){return 0===e?32:31-(Gn(e)/Yn|0)|0}function Hs(e,t,n,r){hn||ms();var i=Gs,o=hn;hn=!0;try{ps(i,e,t,n,r)}finally{(hn=o)||gs()}}function Vs(e,t,n,r){Qn(Xn,Gs.bind(null,e,t,n,r))}function Gs(e,t,n,r){var i;if(Jn)if((i=0==(4&t))&&0<Cn.length&&-1<Tn.indexOf(e))e=Ss(null,e,t,n,r),Cn.push(e);else{var o=Ys(e,t,n,r);if(null===o)i&&As(e,r);else{if(i){if(-1<Tn.indexOf(e))return e=Ss(o,e,t,n,r),void Cn.push(e);if(function(e,t,n,r,i){switch(t){case"focusin":return Dn=Cs(Dn,e,t,n,r,i),!0;case"dragenter":return Mn=Cs(Mn,e,t,n,r,i),!0;case"mouseover":return Fn=Cs(Fn,e,t,n,r,i),!0;case"pointerover":var o=i.pointerId;return Nn.set(o,Cs(Nn.get(o)||null,e,t,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,On.set(o,Cs(On.get(o)||null,e,t,n,r,i)),!0}return!1}(o,e,t,n,r))return;As(e,r)}Mu(e,t,r,null,n)}}}function Ys(e,t,n,r){var i=ls(r);if(null!==(i=Iu(i))){var o=xs(i);if(null===o)i=null;else{var a=o.tag;if(13===a){if(null!==(i=ws(o)))return i;i=null}else if(3===a){if(o.stateNode.hydrate)return 3===o.tag?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null)}}return Mu(e,t,r,i,n),null}function Xs(){if(er)return er;var e,t,n=Zn,r=n.length,i="value"in Kn?Kn.value:Kn.textContent,o=i.length;for(e=0;e<r&&n[e]===i[e];e++);var a=r-e;for(t=1;t<=a&&n[r-t]===i[o-t];t++);return er=i.slice(e,1<t?1-t:void 0)}function Qs(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Js(){return!0}function Ks(){return!1}function Zs(e){function t(t,n,r,i,o){for(var a in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(i):i[a]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?Js:Ks,this.isPropagationStopped=Ks,this}return Et(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Js)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Js)},persist:function(){},isPersistent:Js}),t}function eu(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=_r[e])&&!!t[e]}function tu(){return eu}function nu(e,t){switch(e){case"keyup":return-1!==$r.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ru(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}function iu(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!jr[e.type]:"textarea"===t}function ou(e,t,n,r){fs(r),0<(t=Nu(t,"onChange")).length&&(n=new nr("onChange","change",null,n,r),e.push({event:n,listeners:t}))}function au(e){Eu(e,0)}function su(e){if(Ua(Uu(e)))return e}function uu(e,t){if("change"===e)return t}function lu(){Ur&&(Ur.detachEvent("onpropertychange",cu),qr=Ur=null)}function cu(e){if("value"===e.propertyName&&su(qr)){var t=[];if(ou(t,qr,e,ls(e)),e=au,hn)e(t);else{hn=!0;try{hs(e,t)}finally{hn=!1,gs()}}}}function fu(e,t,n){"focusin"===e?(lu(),qr=n,(Ur=t).attachEvent("onpropertychange",cu)):"focusout"===e&&lu()}function du(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return su(qr)}function hu(e,t){if("click"===e)return su(t)}function pu(e,t){if("input"===e||"change"===e)return su(t)}function mu(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t}function gu(e,t){if(Yr(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++)if(!Xr.call(t,n[r])||!Yr(e[n[r]],t[n[r]]))return!1;return!0}function yu(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function vu(e,t){var n,r=yu(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=yu(r)}}function bu(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?bu(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function xu(){for(var e=window,t=qa();t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(e){n=!1}if(!n)break;t=qa((e=t.contentWindow).document)}return t}function wu(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function _u(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;ei||null==Jr||Jr!==qa(r)||("selectionStart"in(r=Jr)&&wu(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},Zr&&gu(Zr,r)||(Zr=r,0<(r=Nu(Kr,"onSelect")).length&&(t=new nr("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Jr)))}function ku(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,o,a,s,u){if(bs.apply(this,arguments),yn){if(!yn)throw Error(Da(198));var l=vn;yn=!1,vn=null,bn||(bn=!0,xn=l)}}(r,t,void 0,e),e.currentTarget=null}function Eu(e,t){t=0!=(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var a=r.length-1;0<=a;a--){var s=r[a],u=s.instance,l=s.currentTarget;if(s=s.listener,u!==o&&i.isPropagationStopped())break e;ku(i,s,l),o=u}else for(a=0;a<r.length;a++){if(u=(s=r[a]).instance,l=s.currentTarget,s=s.listener,u!==o&&i.isPropagationStopped())break e;ku(i,s,l),o=u}}}if(bn)throw e=xn,bn=!1,xn=null,e}function Su(e,t){var n=Wu(t),r=e+"__bubble";n.has(r)||(Du(t,e,2,!1),n.add(r))}function Au(e){e[oi]||(e[oi]=!0,St.forEach((function(t){ii.has(t)||Cu(t,!1,e,null),Cu(t,!0,e,null)})))}function Cu(e,t,n,r){var i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,o=n;if("selectionchange"===e&&9!==n.nodeType&&(o=n.ownerDocument),null!==r&&!t&&ii.has(e)){if("scroll"!==e)return;i|=2,o=r}var a=Wu(o),s=e+"__"+(t?"capture":"bubble");a.has(s)||(t&&(i|=4),Du(o,e,i,t),a.add(s))}function Du(e,t,n,r){var i=qn.get(t);switch(void 0===i?2:i){case 0:i=Hs;break;case 1:i=Vs;break;default:i=Gs}n=i.bind(null,t,n,e),i=void 0,!mn||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Mu(e,t,n,r,i){var o=r;if(0==(1&t)&&0==(2&t)&&null!==r)e:for(;;){if(null===r)return;var a=r.tag;if(3===a||4===a){var s=r.stateNode.containerInfo;if(s===i||8===s.nodeType&&s.parentNode===i)break;if(4===a)for(a=r.return;null!==a;){var u=a.tag;if((3===u||4===u)&&((u=a.stateNode.containerInfo)===i||8===u.nodeType&&u.parentNode===i))return;a=a.return}for(;null!==s;){if(null===(a=Iu(s)))return;if(5===(u=a.tag)||6===u){r=o=a;continue e}s=s.parentNode}}r=r.return}!function(e,t,n){if(pn)return e(t,n);pn=!0;try{dn(e,t,n)}finally{pn=!1,gs()}}((function(){var r=o,i=ls(n),a=[];e:{var s=Un.get(e);if(void 0!==s){var u=nr,l=e;switch(e){case"keypress":if(0===Qs(n))break e;case"keydown":case"keyup":u=Er;break;case"focusin":l="focus",u=hr;break;case"focusout":l="blur",u=hr;break;case"beforeblur":case"afterblur":u=hr;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":u=lr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":u=fr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":u=Dr;break;case Ln:case Bn:case In:u=mr;break;case jn:u=Fr;break;case"scroll":u=ir;break;case"wheel":u=Or;break;case"copy":case"cut":case"paste":u=yr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":u=Ar}var c=0!=(4&t),f=!c&&"scroll"===e,d=c?null!==s?s+"Capture":null:s;c=[];for(var h,p=r;null!==p;){var m=(h=p).stateNode;if(5===h.tag&&null!==m&&(h=m,null!==d&&(null!=(m=ys(p,d))&&c.push(Fu(p,m,h)))),f)break;p=p.return}0<c.length&&(s=new u(s,l,null,n,i),a.push({event:s,listeners:c}))}}if(0==(7&t)){if(u="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||0!=(16&t)||!(l=n.relatedTarget||n.fromElement)||!Iu(l)&&!l[pi])&&(u||s)&&(s=i.window===i?i:(s=i.ownerDocument)?s.defaultView||s.parentWindow:window,u?(u=r,null!==(l=(l=n.relatedTarget||n.toElement)?Iu(l):null)&&(l!==(f=xs(l))||5!==l.tag&&6!==l.tag)&&(l=null)):(u=null,l=r),u!==l)){if(c=lr,m="onMouseLeave",d="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(c=Ar,m="onPointerLeave",d="onPointerEnter",p="pointer"),f=null==u?s:Uu(u),h=null==l?s:Uu(l),(s=new c(m,p+"leave",u,n,i)).target=f,s.relatedTarget=h,m=null,Iu(i)===r&&((c=new c(d,p+"enter",l,n,i)).target=h,c.relatedTarget=f,m=c),f=m,u&&l)e:{for(d=l,p=0,h=c=u;h;h=Ou(h))p++;for(h=0,m=d;m;m=Ou(m))h++;for(;0<p-h;)c=Ou(c),p--;for(;0<h-p;)d=Ou(d),h--;for(;p--;){if(c===d||null!==d&&c===d.alternate)break e;c=Ou(c),d=Ou(d)}c=null}else c=null;null!==u&&$u(a,s,u,c,!1),null!==l&&null!==f&&$u(a,f,l,c,!0)}if("select"===(u=(s=r?Uu(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===u&&"file"===s.type)var g=uu;else if(iu(s))if(Wr)g=pu;else{g=du;var y=fu}else(u=s.nodeName)&&"input"===u.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(g=hu);switch(g&&(g=g(e,r))?ou(a,g,n,i):(y&&y(e,s,r),"focusout"===e&&(y=s._wrapperState)&&y.controlled&&"number"===s.type&&Xa(s,"number",s.value)),y=r?Uu(r):window,e){case"focusin":(iu(y)||"true"===y.contentEditable)&&(Jr=y,Kr=r,Zr=null);break;case"focusout":Zr=Kr=Jr=null;break;case"mousedown":ei=!0;break;case"contextmenu":case"mouseup":case"dragend":ei=!1,_u(a,n,i);break;case"selectionchange":if(Qr)break;case"keydown":case"keyup":_u(a,n,i)}var v;if(Tr)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Ir?nu(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Pr&&"ko"!==n.locale&&(Ir||"onCompositionStart"!==b?"onCompositionEnd"===b&&Ir&&(v=Xs()):(Zn="value"in(Kn=i)?Kn.value:Kn.textContent,Ir=!0)),0<(y=Nu(r,b)).length&&(b=new br(b,e,null,n,i),a.push({event:b,listeners:y}),v?b.data=v:null!==(v=ru(n))&&(b.data=v))),(v=Rr?function(e,t){switch(e){case"compositionend":return ru(t);case"keypress":return 32!==t.which?null:(Br=!0,Lr);case"textInput":return(e=t.data)===Lr&&Br?null:e;default:return null}}(e,n):function(e,t){if(Ir)return"compositionend"===e||!Tr&&nu(e,t)?(e=Xs(),er=Zn=Kn=null,Ir=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Pr&&"ko"!==t.locale?null:t.data;default:return null}}(e,n))&&(0<(r=Nu(r,"onBeforeInput")).length&&(i=new br("onBeforeInput","beforeinput",null,n,i),a.push({event:i,listeners:r}),i.data=v))}Eu(a,t)}))}function Fu(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Nu(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,o=i.stateNode;5===i.tag&&null!==o&&(i=o,null!=(o=ys(e,n))&&r.unshift(Fu(e,o,i)),null!=(o=ys(e,t))&&r.push(Fu(e,o,i))),e=e.return}return r}function Ou(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function $u(e,t,n,r,i){for(var o=t._reactName,a=[];null!==n&&n!==r;){var s=n,u=s.alternate,l=s.stateNode;if(null!==u&&u===r)break;5===s.tag&&null!==l&&(s=l,i?null!=(u=ys(n,o))&&a.unshift(Fu(n,u,s)):i||null!=(u=ys(n,o))&&a.push(Fu(n,u,s))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}function Tu(){}function zu(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}function Ru(e,t){return"textarea"===e||"option"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}function Pu(e){1===e.nodeType?e.textContent="":9===e.nodeType&&(null!=(e=e.body)&&(e.textContent=""))}function Lu(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break}return e}function Bu(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}function Iu(e){var t=e[di];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pi]||n[di]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=Bu(e);null!==e;){if(n=e[di])return n;e=Bu(e)}return t}n=(e=n).parentNode}return null}function ju(e){return!(e=e[di]||e[pi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function Uu(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(Da(33))}function qu(e){return e[hi]||null}function Wu(e){var t=e[mi];return void 0===t&&(t=e[mi]=new Set),t}function Hu(e){return{current:e}}function Vu(e){0>yi||(e.current=gi[yi],gi[yi]=null,yi--)}function Gu(e,t){yi++,gi[yi]=e.current,e.current=t}function Yu(e,t){var n=e.type.contextTypes;if(!n)return vi;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in n)o[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Xu(e){return null!=(e=e.childContextTypes)}function Qu(){Vu(xi),Vu(bi)}function Ju(e,t,n){if(bi.current!==vi)throw Error(Da(168));Gu(bi,t),Gu(xi,n)}function Ku(e,t,n){var r=e.stateNode;if(e=t.childContextTypes,"function"!=typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in e))throw Error(Da(108,La(t)||"Unknown",i));return Et({},n,r)}function Zu(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||vi,wi=bi.current,Gu(bi,e),Gu(xi,xi.current),!0}function el(e,t,n){var r=e.stateNode;if(!r)throw Error(Da(169));n?(e=Ku(e,t,wi),r.__reactInternalMemoizedMergedChildContext=e,Vu(xi),Vu(bi),Gu(bi,e)):Vu(xi),Gu(xi,n)}function tl(){switch(Fi()){case Ni:return 99;case Oi:return 98;case $i:return 97;case Ti:return 96;case zi:return 95;default:throw Error(Da(332))}}function nl(e){switch(e){case 99:return Ni;case 98:return Oi;case 97:return $i;case 96:return Ti;case 95:return zi;default:throw Error(Da(332))}}function rl(e,t){return e=nl(e),Ei(e,t)}function il(e,t,n){return e=nl(e),Si(e,t,n)}function ol(){if(null!==Bi){var e=Bi;Bi=null,Ai(e)}al()}function al(){if(!Ii&&null!==Li){Ii=!0;var e=0;try{var t=Li;rl(99,(function(){for(;e<t.length;e++){var n=t[e];do{n=n(!0)}while(null!==n)}})),Li=null}catch(t){throw null!==Li&&(Li=Li.slice(e+1)),Si(Ni,ol),t}finally{Ii=!1}}}function sl(e,t){if(e&&e.defaultProps){for(var n in t=Et({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function ul(){Gi=Vi=Hi=null}function ll(e){var t=Wi.current;Vu(Wi),e.type._context._currentValue=t}function cl(e,t){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)===t){if(null===n||(n.childLanes&t)===t)break;n.childLanes|=t}else e.childLanes|=t,null!==n&&(n.childLanes|=t);e=e.return}}function fl(e,t){Hi=e,Gi=Vi=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!=(e.lanes&t)&&(ko=!0),e.firstContext=null)}function dl(e,t){if(Gi!==e&&!1!==t&&0!==t)if("number"==typeof t&&1073741823!==t||(Gi=e,t=1073741823),t={context:e,observedBits:t,next:null},null===Vi){if(null===Hi)throw Error(Da(308));Vi=t,Hi.dependencies={lanes:0,firstContext:t,responders:null}}else Vi=Vi.next=t;return e._currentValue}function hl(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function pl(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ml(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function gl(e,t){if(null!==(e=e.updateQueue)){var n=(e=e.shared).pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}}function yl(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?i=o=a:o=o.next=a,n=n.next}while(null!==n);null===o?i=o=t:o=o.next=t}else i=o=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function vl(e,t,n,r){var i=e.updateQueue;Yi=!1;var o=i.firstBaseUpdate,a=i.lastBaseUpdate,s=i.shared.pending;if(null!==s){i.shared.pending=null;var u=s,l=u.next;u.next=null,null===a?o=l:a.next=l,a=u;var c=e.alternate;if(null!==c){var f=(c=c.updateQueue).lastBaseUpdate;f!==a&&(null===f?c.firstBaseUpdate=l:f.next=l,c.lastBaseUpdate=u)}}if(null!==o){for(f=i.baseState,a=0,c=l=u=null;;){s=o.lane;var d=o.eventTime;if((r&s)===s){null!==c&&(c=c.next={eventTime:d,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var h=e,p=o;switch(s=t,d=n,p.tag){case 1:if("function"==typeof(h=p.payload)){f=h.call(d,f,s);break e}f=h;break e;case 3:h.flags=-4097&h.flags|64;case 0:if(null==(s="function"==typeof(h=p.payload)?h.call(d,f,s):h))break e;f=Et({},f,s);break e;case 2:Yi=!0}}null!==o.callback&&(e.flags|=32,null===(s=i.effects)?i.effects=[o]:s.push(o))}else d={eventTime:d,lane:s,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===c?(l=c=d,u=f):c=c.next=d,a|=s;if(null===(o=o.next)){if(null===(s=i.shared.pending))break;o=s.next,s.next=null,i.lastBaseUpdate=s,i.shared.pending=null}}null===c&&(u=f),i.baseState=u,i.firstBaseUpdate=l,i.lastBaseUpdate=c,qo|=a,e.lanes=a,e.memoizedState=f}}function bl(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!=typeof i)throw Error(Da(191,i));i.call(r)}}}function xl(e,t,n,r){n=null==(n=n(r,t=e.memoizedState))?t:Et({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}function wl(e,t,n,r,i,o,a){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,a):!t.prototype||!t.prototype.isPureReactComponent||(!gu(n,r)||!gu(i,o))}function _l(e,t,n){var r=!1,i=vi,o=t.contextType;return"object"==typeof o&&null!==o?o=dl(o):(i=Xu(t)?wi:bi.current,o=(r=null!=(r=t.contextTypes))?Yu(e,i):vi),t=new t(n,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Qi,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function kl(e,t,n,r){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Qi.enqueueReplaceState(t,t.state,null)}function El(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=Xi,hl(e);var o=t.contextType;"object"==typeof o&&null!==o?i.context=dl(o):(o=Xu(t)?wi:bi.current,i.context=Yu(e,o)),vl(e,n,i,r),i.state=e.memoizedState,"function"==typeof(o=t.getDerivedStateFromProps)&&(xl(e,t,o,n),i.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof i.getSnapshotBeforeUpdate||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||(t=i.state,"function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&Qi.enqueueReplaceState(i,i.state,null),vl(e,n,i,r),i.state=e.memoizedState),"function"==typeof i.componentDidMount&&(e.flags|=4)}function Sl(e,t,n){if(null!==(e=n.ref)&&"function"!=typeof e&&"object"!=typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(Da(309));var r=n.stateNode}if(!r)throw Error(Da(147,e));var i=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===i?t.ref:((t=function(e){var t=r.refs;t===Xi&&(t=r.refs={}),null===e?delete t[i]:t[i]=e})._stringRef=i,t)}if("string"!=typeof e)throw Error(Da(284));if(!n._owner)throw Error(Da(290,e))}return e}function Al(e,t){if("textarea"!==e.type)throw Error(Da(31,"[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t))}function Cl(e){function t(t,n){if(e){var r=t.lastEffect;null!==r?(r.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n,n.nextEffect=null,n.flags=8}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=zf(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags=2,n):r:(t.flags=2,n):n}function a(t){return e&&null===t.alternate&&(t.flags=2),t}function s(e,t,n,r){return null===t||6!==t.tag?((t=Bf(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function u(e,t,n,r){return null!==t&&t.elementType===n.type?((r=i(t,n.props)).ref=Sl(e,t,n),r.return=e,r):((r=Rf(n.type,n.key,n.props,null,e.mode,r)).ref=Sl(e,t,n),r.return=e,r)}function l(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=If(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function c(e,t,n,r,o){return null===t||7!==t.tag?((t=Pf(n,e.mode,r,o)).return=e,t):((t=i(t,n)).return=e,t)}function f(e,t,n){if("string"==typeof t||"number"==typeof t)return(t=Bf(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case zt:return(n=Rf(t.type,t.key,t.props,null,e.mode,n)).ref=Sl(e,null,t),n.return=e,n;case Rt:return(t=If(t,e.mode,n)).return=e,t}if(Ji(t)||Ta(t))return(t=Pf(t,e.mode,n,null)).return=e,t;Al(e,t)}return null}function d(e,t,n,r){var i=null!==t?t.key:null;if("string"==typeof n||"number"==typeof n)return null!==i?null:s(e,t,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case zt:return n.key===i?n.type===Pt?c(e,t,n.props.children,r,i):u(e,t,n,r):null;case Rt:return n.key===i?l(e,t,n,r):null}if(Ji(n)||Ta(n))return null!==i?null:c(e,t,n,r,null);Al(e,n)}return null}function h(e,t,n,r,i){if("string"==typeof r||"number"==typeof r)return s(t,e=e.get(n)||null,""+r,i);if("object"==typeof r&&null!==r){switch(r.$$typeof){case zt:return e=e.get(null===r.key?n:r.key)||null,r.type===Pt?c(t,e,r.props.children,i,r.key):u(t,e,r,i);case Rt:return l(t,e=e.get(null===r.key?n:r.key)||null,r,i)}if(Ji(r)||Ta(r))return c(t,e=e.get(n)||null,r,i,null);Al(t,r)}return null}function p(i,a,s,u){for(var l=null,c=null,p=a,m=a=0,g=null;null!==p&&m<s.length;m++){p.index>m?(g=p,p=null):g=p.sibling;var y=d(i,p,s[m],u);if(null===y){null===p&&(p=g);break}e&&p&&null===y.alternate&&t(i,p),a=o(y,a,m),null===c?l=y:c.sibling=y,c=y,p=g}if(m===s.length)return n(i,p),l;if(null===p){for(;m<s.length;m++)null!==(p=f(i,s[m],u))&&(a=o(p,a,m),null===c?l=p:c.sibling=p,c=p);return l}for(p=r(i,p);m<s.length;m++)null!==(g=h(p,i,m,s[m],u))&&(e&&null!==g.alternate&&p.delete(null===g.key?m:g.key),a=o(g,a,m),null===c?l=g:c.sibling=g,c=g);return e&&p.forEach((function(e){return t(i,e)})),l}function m(i,a,s,u){var l=Ta(s);if("function"!=typeof l)throw Error(Da(150));if(null==(s=l.call(s)))throw Error(Da(151));for(var c=l=null,p=a,m=a=0,g=null,y=s.next();null!==p&&!y.done;m++,y=s.next()){p.index>m?(g=p,p=null):g=p.sibling;var v=d(i,p,y.value,u);if(null===v){null===p&&(p=g);break}e&&p&&null===v.alternate&&t(i,p),a=o(v,a,m),null===c?l=v:c.sibling=v,c=v,p=g}if(y.done)return n(i,p),l;if(null===p){for(;!y.done;m++,y=s.next())null!==(y=f(i,y.value,u))&&(a=o(y,a,m),null===c?l=y:c.sibling=y,c=y);return l}for(p=r(i,p);!y.done;m++,y=s.next())null!==(y=h(p,i,m,y.value,u))&&(e&&null!==y.alternate&&p.delete(null===y.key?m:y.key),a=o(y,a,m),null===c?l=y:c.sibling=y,c=y);return e&&p.forEach((function(e){return t(i,e)})),l}return function(e,r,o,s){var u="object"==typeof o&&null!==o&&o.type===Pt&&null===o.key;u&&(o=o.props.children);var l="object"==typeof o&&null!==o;if(l)switch(o.$$typeof){case zt:e:{for(l=o.key,u=r;null!==u;){if(u.key===l){switch(u.tag){case 7:if(o.type===Pt){n(e,u.sibling),(r=i(u,o.props.children)).return=e,e=r;break e}break;default:if(u.elementType===o.type){n(e,u.sibling),(r=i(u,o.props)).ref=Sl(e,u,o),r.return=e,e=r;break e}}n(e,u);break}t(e,u),u=u.sibling}o.type===Pt?((r=Pf(o.props.children,e.mode,s,o.key)).return=e,e=r):((s=Rf(o.type,o.key,o.props,null,e.mode,s)).ref=Sl(e,r,o),s.return=e,e=s)}return a(e);case Rt:e:{for(u=o.key;null!==r;){if(r.key===u){if(4===r.tag&&r.stateNode.containerInfo===o.containerInfo&&r.stateNode.implementation===o.implementation){n(e,r.sibling),(r=i(r,o.children||[])).return=e,e=r;break e}n(e,r);break}t(e,r),r=r.sibling}(r=If(o,e.mode,s)).return=e,e=r}return a(e)}if("string"==typeof o||"number"==typeof o)return o=""+o,null!==r&&6===r.tag?(n(e,r.sibling),(r=i(r,o)).return=e,e=r):(n(e,r),(r=Bf(o,e.mode,s)).return=e,e=r),a(e);if(Ji(o))return p(e,r,o,s);if(Ta(o))return m(e,r,o,s);if(l&&Al(e,o),void 0===o&&!u)switch(e.tag){case 1:case 22:case 0:case 11:case 15:throw Error(Da(152,La(e.type)||"Component"))}return n(e,r)}}function Dl(e){if(e===eo)throw Error(Da(174));return e}function Ml(e,t){switch(Gu(ro,t),Gu(no,e),Gu(to,eo),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:rs(null,"");break;default:t=rs(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Vu(to),Gu(to,t)}function Fl(){Vu(to),Vu(no),Vu(ro)}function Nl(e){Dl(ro.current);var t=Dl(to.current),n=rs(t,e.type);t!==n&&(Gu(no,e),Gu(to,n))}function Ol(e){no.current===e&&(Vu(to),Vu(no))}function $l(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!=(64&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function Tl(e,t){var n=$f(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=t,n.return=e,n.flags=8,null!==e.lastEffect?(e.lastEffect.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n}function zl(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,!0);case 13:default:return!1}}function Rl(e){if(so){var t=ao;if(t){var n=t;if(!zl(e,t)){if(!(t=Lu(n.nextSibling))||!zl(e,t))return e.flags=-1025&e.flags|2,so=!1,void(oo=e);Tl(oo,n)}oo=e,ao=Lu(t.firstChild)}else e.flags=-1025&e.flags|2,so=!1,oo=e}}function Pl(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;oo=e}function Ll(e){if(e!==oo)return!1;if(!so)return Pl(e),so=!0,!1;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!Ru(t,e.memoizedProps))for(t=ao;t;)Tl(e,t),t=Lu(t.nextSibling);if(Pl(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(Da(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ao=Lu(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ao=null}}else ao=oo?Lu(e.stateNode.nextSibling):null;return!0}function Bl(){ao=oo=null,so=!1}function Il(){for(var e=0;e<uo.length;e++)uo[e]._workInProgressVersionPrimary=null;uo.length=0}function jl(){throw Error(Da(321))}function Ul(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Yr(e[n],t[n]))return!1;return!0}function ql(e,t,n,r,i,o){if(fo=o,ho=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,lo.current=null===e||null===e.memoizedState?bo:xo,e=n(r,i),yo){o=0;do{if(yo=!1,!(25>o))throw Error(Da(301));o+=1,mo=po=null,t.updateQueue=null,lo.current=wo,e=n(r,i)}while(yo)}if(lo.current=vo,t=null!==po&&null!==po.next,fo=0,mo=po=ho=null,go=!1,t)throw Error(Da(300));return e}function Wl(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===mo?ho.memoizedState=mo=e:mo=mo.next=e,mo}function Hl(){if(null===po){var e=ho.alternate;e=null!==e?e.memoizedState:null}else e=po.next;var t=null===mo?ho.memoizedState:mo.next;if(null!==t)mo=t,po=e;else{if(null===e)throw Error(Da(310));e={memoizedState:(po=e).memoizedState,baseState:po.baseState,baseQueue:po.baseQueue,queue:po.queue,next:null},null===mo?ho.memoizedState=mo=e:mo=mo.next=e}return mo}function Vl(e,t){return"function"==typeof t?t(e):t}function Gl(e){var t=Hl(),n=t.queue;if(null===n)throw Error(Da(311));n.lastRenderedReducer=e;var r=po,i=r.baseQueue,o=n.pending;if(null!==o){if(null!==i){var a=i.next;i.next=o.next,o.next=a}r.baseQueue=i=o,n.pending=null}if(null!==i){i=i.next,r=r.baseState;var s=a=o=null,u=i;do{var l=u.lane;if((fo&l)===l)null!==s&&(s=s.next={lane:0,action:u.action,eagerReducer:u.eagerReducer,eagerState:u.eagerState,next:null}),r=u.eagerReducer===e?u.eagerState:e(r,u.action);else{var c={lane:l,action:u.action,eagerReducer:u.eagerReducer,eagerState:u.eagerState,next:null};null===s?(a=s=c,o=r):s=s.next=c,ho.lanes|=l,qo|=l}u=u.next}while(null!==u&&u!==i);null===s?o=r:s.next=a,Yr(r,t.memoizedState)||(ko=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=s,n.lastRenderedState=r}return[t.memoizedState,n.dispatch]}function Yl(e){var t=Hl(),n=t.queue;if(null===n)throw Error(Da(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var a=i=i.next;do{o=e(o,a.action),a=a.next}while(a!==i);Yr(o,t.memoizedState)||(ko=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function Xl(e,t,n){var r=t._getVersion;r=r(t._source);var i=t._workInProgressVersionPrimary;if(null!==i?e=i===r:(e=e.mutableReadLanes,(e=(fo&e)===e)&&(t._workInProgressVersionPrimary=r,uo.push(t))),e)return n(t._source);throw uo.push(t),Error(Da(350))}function Ql(e,t,n,r){var i=zo;if(null===i)throw Error(Da(349));var o=t._getVersion,a=o(t._source),s=lo.current,u=s.useState((function(){return Xl(i,t,n)})),l=u[1],c=u[0];u=mo;var f=e.memoizedState,d=f.refs,h=d.getSnapshot,p=f.source;f=f.subscribe;var m=ho;return e.memoizedState={refs:d,source:t,subscribe:r},s.useEffect((function(){d.getSnapshot=n,d.setSnapshot=l;var e=o(t._source);if(!Yr(a,e)){e=n(t._source),Yr(c,e)||(l(e),e=tf(m),i.mutableReadLanes|=e&i.pendingLanes),e=i.mutableReadLanes,i.entangledLanes|=e;for(var r=i.entanglements,s=e;0<s;){var u=31-Vn(s),f=1<<u;r[u]|=e,s&=~f}}}),[n,t,r]),s.useEffect((function(){return r(t._source,(function(){var e=d.getSnapshot,n=d.setSnapshot;try{n(e(t._source));var r=tf(m);i.mutableReadLanes|=r&i.pendingLanes}catch(e){n((function(){throw e}))}}))}),[t,r]),Yr(h,n)&&Yr(p,t)&&Yr(f,r)||((e={pending:null,dispatch:null,lastRenderedReducer:Vl,lastRenderedState:c}).dispatch=l=hc.bind(null,ho,e),u.queue=e,u.baseQueue=null,c=Xl(i,t,n),u.memoizedState=u.baseState=c),c}function Jl(e,t,n){return Ql(Hl(),e,t,n)}function Kl(e){var t=Wl();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e=(e=t.queue={pending:null,dispatch:null,lastRenderedReducer:Vl,lastRenderedState:e}).dispatch=hc.bind(null,ho,e),[t.memoizedState,e]}function Zl(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=ho.updateQueue)?(t={lastEffect:null},ho.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function ec(e){return e={current:e},Wl().memoizedState=e}function tc(){return Hl().memoizedState}function nc(e,t,n,r){var i=Wl();ho.flags|=e,i.memoizedState=Zl(1|t,n,void 0,void 0===r?null:r)}function rc(e,t,n,r){var i=Hl();r=void 0===r?null:r;var o=void 0;if(null!==po){var a=po.memoizedState;if(o=a.destroy,null!==r&&Ul(r,a.deps))return void Zl(t,n,o,r)}ho.flags|=e,i.memoizedState=Zl(1|t,n,o,r)}function ic(e,t){return nc(516,4,e,t)}function oc(e,t){return rc(516,4,e,t)}function ac(e,t){return rc(4,2,e,t)}function sc(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function uc(e,t,n){return n=null!=n?n.concat([e]):null,rc(4,2,sc.bind(null,t,e),n)}function lc(){}function cc(e,t){var n=Hl();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Ul(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function fc(e,t){var n=Hl();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Ul(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function dc(e,t){var n=tl();rl(98>n?98:n,(function(){e(!0)})),rl(97<n?97:n,(function(){var n=co.transition;co.transition=1;try{e(!1),t()}finally{co.transition=n}}))}function hc(e,t,n){var r=ef(),i=tf(e),o={lane:i,action:n,eagerReducer:null,eagerState:null,next:null},a=t.pending;if(null===a?o.next=o:(o.next=a.next,a.next=o),t.pending=o,a=e.alternate,e===ho||null!==a&&a===ho)yo=go=!0;else{if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var s=t.lastRenderedState,u=a(s,n);if(o.eagerReducer=a,o.eagerState=u,Yr(u,s))return}catch(e){}nf(e,i,r)}}function pc(e,t,n,r){t.child=null===e?Zi(t,null,n,r):Ki(t,e.child,n,r)}function mc(e,t,n,r,i){n=n.render;var o=t.ref;return fl(t,i),r=ql(e,t,n,r,o,i),null===e||ko?(t.flags|=1,pc(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~i,Nc(e,t,i))}function gc(e,t,n,r,i,o){if(null===e){var a=n.type;return"function"!=typeof a||Tf(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Rf(n.type,null,r,t,t.mode,o)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,yc(e,t,a,r,i,o))}return a=e.child,0==(i&o)&&(i=a.memoizedProps,(n=null!==(n=n.compare)?n:gu)(i,r)&&e.ref===t.ref)?Nc(e,t,o):(t.flags|=1,(e=zf(a,r)).ref=t.ref,e.return=t,t.child=e)}function yc(e,t,n,r,i,o){if(null!==e&&gu(e.memoizedProps,r)&&e.ref===t.ref){if(ko=!1,0==(o&i))return t.lanes=e.lanes,Nc(e,t,o);0!=(16384&e.flags)&&(ko=!0)}return xc(e,t,n,r,o)}function vc(e,t,n){var r=t.pendingProps,i=r.children,o=null!==e?e.memoizedState:null;if("hidden"===r.mode||"unstable-defer-without-hiding"===r.mode)if(0==(4&t.mode))t.memoizedState={baseLanes:0},ff(t,n);else{if(0==(1073741824&n))return e=null!==o?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e},ff(t,e),null;t.memoizedState={baseLanes:0},ff(t,null!==o?o.baseLanes:n)}else null!==o?(r=o.baseLanes|n,t.memoizedState=null):r=n,ff(t,r);return pc(e,t,i,n),t.child}function bc(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=128)}function xc(e,t,n,r,i){var o=Xu(n)?wi:bi.current;return o=Yu(t,o),fl(t,i),n=ql(e,t,n,r,o,i),null===e||ko?(t.flags|=1,pc(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~i,Nc(e,t,i))}function wc(e,t,n,r,i){if(Xu(n)){var o=!0;Zu(t)}else o=!1;if(fl(t,i),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),_l(t,n,r),El(t,n,r,i),r=!0;else if(null===e){var a=t.stateNode,s=t.memoizedProps;a.props=s;var u=a.context,l=n.contextType;"object"==typeof l&&null!==l?l=dl(l):l=Yu(t,l=Xu(n)?wi:bi.current);var c=n.getDerivedStateFromProps,f="function"==typeof c||"function"==typeof a.getSnapshotBeforeUpdate;f||"function"!=typeof a.UNSAFE_componentWillReceiveProps&&"function"!=typeof a.componentWillReceiveProps||(s!==r||u!==l)&&kl(t,a,r,l),Yi=!1;var d=t.memoizedState;a.state=d,vl(t,r,a,i),u=t.memoizedState,s!==r||d!==u||xi.current||Yi?("function"==typeof c&&(xl(t,n,c,r),u=t.memoizedState),(s=Yi||wl(t,n,s,r,d,u,l))?(f||"function"!=typeof a.UNSAFE_componentWillMount&&"function"!=typeof a.componentWillMount||("function"==typeof a.componentWillMount&&a.componentWillMount(),"function"==typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"==typeof a.componentDidMount&&(t.flags|=4)):("function"==typeof a.componentDidMount&&(t.flags|=4),t.memoizedProps=r,t.memoizedState=u),a.props=r,a.state=u,a.context=l,r=s):("function"==typeof a.componentDidMount&&(t.flags|=4),r=!1)}else{a=t.stateNode,pl(e,t),s=t.memoizedProps,l=t.type===t.elementType?s:sl(t.type,s),a.props=l,f=t.pendingProps,d=a.context,"object"==typeof(u=n.contextType)&&null!==u?u=dl(u):u=Yu(t,u=Xu(n)?wi:bi.current);var h=n.getDerivedStateFromProps;(c="function"==typeof h||"function"==typeof a.getSnapshotBeforeUpdate)||"function"!=typeof a.UNSAFE_componentWillReceiveProps&&"function"!=typeof a.componentWillReceiveProps||(s!==f||d!==u)&&kl(t,a,r,u),Yi=!1,d=t.memoizedState,a.state=d,vl(t,r,a,i);var p=t.memoizedState;s!==f||d!==p||xi.current||Yi?("function"==typeof h&&(xl(t,n,h,r),p=t.memoizedState),(l=Yi||wl(t,n,l,r,d,p,u))?(c||"function"!=typeof a.UNSAFE_componentWillUpdate&&"function"!=typeof a.componentWillUpdate||("function"==typeof a.componentWillUpdate&&a.componentWillUpdate(r,p,u),"function"==typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,p,u)),"function"==typeof a.componentDidUpdate&&(t.flags|=4),"function"==typeof a.getSnapshotBeforeUpdate&&(t.flags|=256)):("function"!=typeof a.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!=typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=256),t.memoizedProps=r,t.memoizedState=p),a.props=r,a.state=p,a.context=u,r=l):("function"!=typeof a.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!=typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=256),r=!1)}return _c(e,t,n,r,o,i)}function _c(e,t,n,r,i,o){bc(e,t);var a=0!=(64&t.flags);if(!r&&!a)return i&&el(t,n,!1),Nc(e,t,o);r=t.stateNode,_o.current=t;var s=a&&"function"!=typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&a?(t.child=Ki(t,e.child,null,o),t.child=Ki(t,null,s,o)):pc(e,t,s,o),t.memoizedState=r.state,i&&el(t,n,!0),t.child}function kc(e){var t=e.stateNode;t.pendingContext?Ju(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ju(0,t.context,!1),Ml(e,t.containerInfo)}function Ec(e,t,n){var r,i=t.pendingProps,o=io.current,a=!1;return(r=0!=(64&t.flags))||(r=(null===e||null!==e.memoizedState)&&0!=(2&o)),r?(a=!0,t.flags&=-65):null!==e&&null===e.memoizedState||void 0===i.fallback||!0===i.unstable_avoidThisFallback||(o|=1),Gu(io,1&o),null===e?(void 0!==i.fallback&&Rl(t),e=i.children,o=i.fallback,a?(e=Sc(t,e,o,n),t.child.memoizedState={baseLanes:n},t.memoizedState=Eo,e):"number"==typeof i.unstable_expectedLoadTime?(e=Sc(t,e,o,n),t.child.memoizedState={baseLanes:n},t.memoizedState=Eo,t.lanes=33554432,e):((n=Lf({mode:"visible",children:e},t.mode,n,null)).return=t,t.child=n)):(e.memoizedState,a?(i=Cc(e,t,i.children,i.fallback,n),a=t.child,o=e.child.memoizedState,a.memoizedState=null===o?{baseLanes:n}:{baseLanes:o.baseLanes|n},a.childLanes=e.childLanes&~n,t.memoizedState=Eo,i):(n=Ac(e,t,i.children,n),t.memoizedState=null,n))}function Sc(e,t,n,r){var i=e.mode,o=e.child;return t={mode:"hidden",children:t},0==(2&i)&&null!==o?(o.childLanes=0,o.pendingProps=t):o=Lf(t,i,0,null),n=Pf(n,i,r,null),o.return=e,n.return=e,o.sibling=n,e.child=o,n}function Ac(e,t,n,r){var i=e.child;return e=i.sibling,n=zf(i,{mode:"visible",children:n}),0==(2&t.mode)&&(n.lanes=r),n.return=t,n.sibling=null,null!==e&&(e.nextEffect=null,e.flags=8,t.firstEffect=t.lastEffect=e),t.child=n}function Cc(e,t,n,r,i){var o=t.mode,a=e.child;e=a.sibling;var s={mode:"hidden",children:n};return 0==(2&o)&&t.child!==a?((n=t.child).childLanes=0,n.pendingProps=s,null!==(a=n.lastEffect)?(t.firstEffect=n.firstEffect,t.lastEffect=a,a.nextEffect=null):t.firstEffect=t.lastEffect=null):n=zf(a,s),null!==e?r=zf(e,r):(r=Pf(r,o,i,null)).flags|=2,r.return=t,n.return=t,n.sibling=r,t.child=n,r}function Dc(e,t){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),cl(e.return,t)}function Mc(e,t,n,r,i,o){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i,lastEffect:o}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i,a.lastEffect=o)}function Fc(e,t,n){var r=t.pendingProps,i=r.revealOrder,o=r.tail;if(pc(e,t,r.children,n),0!=(2&(r=io.current)))r=1&r|2,t.flags|=64;else{if(null!==e&&0!=(64&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Dc(e,n);else if(19===e.tag)Dc(e,n);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Gu(io,r),0==(2&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===$l(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Mc(t,!1,i,n,o,t.lastEffect);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===$l(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Mc(t,!0,n,null,o,t.lastEffect);break;case"together":Mc(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}return t.child}function Nc(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),qo|=t.lanes,0!=(n&t.childLanes)){if(null!==e&&t.child!==e.child)throw Error(Da(153));if(null!==t.child){for(n=zf(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=zf(e,e.pendingProps)).return=t;n.sibling=null}return t.child}return null}function Oc(e,t){if(!so)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function $c(e,t,n){var r=t.pendingProps;switch(t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return Xu(t.type)&&Qu(),null;case 3:return Fl(),Vu(xi),Vu(bi),Il(),(r=t.stateNode).pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(Ll(t)?t.flags|=4:r.hydrate||(t.flags|=256)),Ao(t),null;case 5:Ol(t);var i=Dl(ro.current);if(n=t.type,null!==e&&null!=t.stateNode)Co(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=128);else{if(!r){if(null===t.stateNode)throw Error(Da(166));return null}if(e=Dl(to.current),Ll(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[di]=t,r[hi]=o,n){case"dialog":Su("cancel",r),Su("close",r);break;case"iframe":case"object":case"embed":Su("load",r);break;case"video":case"audio":for(e=0;e<ri.length;e++)Su(ri[e],r);break;case"source":Su("error",r);break;case"img":case"image":case"link":Su("error",r),Su("load",r);break;case"details":Su("toggle",r);break;case"input":Ha(r,o),Su("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Su("invalid",r);break;case"textarea":Za(r,o),Su("invalid",r)}for(var a in ss(n,o),e=null,o)o.hasOwnProperty(a)&&(i=o[a],"children"===a?"string"==typeof i?r.textContent!==i&&(e=["children",i]):"number"==typeof i&&r.textContent!==""+i&&(e=["children",""+i]):At.hasOwnProperty(a)&&null!=i&&"onScroll"===a&&Su("scroll",r));switch(n){case"input":ja(r),Ya(r,o,!0);break;case"textarea":ja(r),ts(r);break;case"select":case"option":break;default:"function"==typeof o.onClick&&(r.onclick=Tu)}r=e,t.updateQueue=r,null!==r&&(t.flags|=4)}else{switch(a=9===i.nodeType?i:i.ownerDocument,e===nn.html&&(e=ns(n)),e===nn.html?"script"===n?((e=a.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof r.is?e=a.createElement(n,{is:r.is}):(e=a.createElement(n),"select"===n&&(a=e,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):e=a.createElementNS(e,n),e[di]=t,e[hi]=r,So(e,t,!1,!1),t.stateNode=e,a=us(n,r),n){case"dialog":Su("cancel",e),Su("close",e),i=r;break;case"iframe":case"object":case"embed":Su("load",e),i=r;break;case"video":case"audio":for(i=0;i<ri.length;i++)Su(ri[i],e);i=r;break;case"source":Su("error",e),i=r;break;case"img":case"image":case"link":Su("error",e),Su("load",e),i=r;break;case"details":Su("toggle",e),i=r;break;case"input":Ha(e,r),i=Wa(e,r),Su("invalid",e);break;case"option":i=Qa(e,r);break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=Et({},r,{value:void 0}),Su("invalid",e);break;case"textarea":Za(e,r),i=Ka(e,r),Su("invalid",e);break;default:i=r}ss(n,i);var s=i;for(o in s)if(s.hasOwnProperty(o)){var u=s[o];"style"===o?as(e,u):"dangerouslySetInnerHTML"===o?null!=(u=u?u.__html:void 0)&&on(e,u):"children"===o?"string"==typeof u?("textarea"!==n||""!==u)&&is(e,u):"number"==typeof u&&is(e,""+u):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(At.hasOwnProperty(o)?null!=u&&"onScroll"===o&&Su("scroll",e):null!=u&&$a(e,o,u,a))}switch(n){case"input":ja(e),Ya(e,r,!1);break;case"textarea":ja(e),ts(e);break;case"option":null!=r.value&&e.setAttribute("value",""+Ba(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?Ja(e,!!r.multiple,o,!1):null!=r.defaultValue&&Ja(e,!!r.multiple,r.defaultValue,!0);break;default:"function"==typeof i.onClick&&(e.onclick=Tu)}zu(n,r)&&(t.flags|=4)}null!==t.ref&&(t.flags|=128)}return null;case 6:if(e&&null!=t.stateNode)Do(e,t,e.memoizedProps,r);else{if("string"!=typeof r&&null===t.stateNode)throw Error(Da(166));n=Dl(ro.current),Dl(to.current),Ll(t)?(r=t.stateNode,n=t.memoizedProps,r[di]=t,r.nodeValue!==n&&(t.flags|=4)):((r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[di]=t,t.stateNode=r)}return null;case 13:return Vu(io),r=t.memoizedState,0!=(64&t.flags)?(t.lanes=n,t):(r=null!==r,n=!1,null===e?void 0!==t.memoizedProps.fallback&&Ll(t):n=null!==e.memoizedState,r&&!n&&0!=(2&t.mode)&&(null===e&&!0!==t.memoizedProps.unstable_avoidThisFallback||0!=(1&io.current)?0===Io&&(Io=3):(0!==Io&&3!==Io||(Io=4),null===zo||0==(134217727&qo)&&0==(134217727&Wo)||sf(zo,Po))),(r||n)&&(t.flags|=4),null);case 4:return Fl(),Ao(t),null===e&&Au(t.stateNode.containerInfo),null;case 10:return ll(t),null;case 17:return Xu(t.type)&&Qu(),null;case 19:if(Vu(io),null===(r=t.memoizedState))return null;if(o=0!=(64&t.flags),null===(a=r.rendering))if(o)Oc(r,!1);else{if(0!==Io||null!==e&&0!=(64&e.flags))for(e=t.child;null!==e;){if(null!==(a=$l(e))){for(t.flags|=64,Oc(r,!1),null!==(o=a.updateQueue)&&(t.updateQueue=o,t.flags|=4),null===r.lastEffect&&(t.firstEffect=null),t.lastEffect=r.lastEffect,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=2,o.nextEffect=null,o.firstEffect=null,o.lastEffect=null,null===(a=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=a.childLanes,o.lanes=a.lanes,o.child=a.child,o.memoizedProps=a.memoizedProps,o.memoizedState=a.memoizedState,o.updateQueue=a.updateQueue,o.type=a.type,e=a.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Gu(io,1&io.current|2),t.child}e=e.sibling}null!==r.tail&&Ui()>Yo&&(t.flags|=64,o=!0,Oc(r,!1),t.lanes=33554432)}else{if(!o)if(null!==(e=$l(a))){if(t.flags|=64,o=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Oc(r,!0),null===r.tail&&"hidden"===r.tailMode&&!a.alternate&&!so)return null!==(t=t.lastEffect=r.lastEffect)&&(t.nextEffect=null),null}else 2*Ui()-r.renderingStartTime>Yo&&1073741824!==n&&(t.flags|=64,o=!0,Oc(r,!1),t.lanes=33554432);r.isBackwards?(a.sibling=t.child,t.child=a):(null!==(n=r.last)?n.sibling=a:t.child=a,r.last=a)}return null!==r.tail?(n=r.tail,r.rendering=n,r.tail=n.sibling,r.lastEffect=t.lastEffect,r.renderingStartTime=Ui(),n.sibling=null,t=io.current,Gu(io,o?1&t|2:1&t),n):null;case 23:case 24:return df(),null!==e&&null!==e.memoizedState!=(null!==t.memoizedState)&&"unstable-defer-without-hiding"!==r.mode&&(t.flags|=4),null}throw Error(Da(156,t.tag))}function Tc(e){switch(e.tag){case 1:Xu(e.type)&&Qu();var t=e.flags;return 4096&t?(e.flags=-4097&t|64,e):null;case 3:if(Fl(),Vu(xi),Vu(bi),Il(),0!=(64&(t=e.flags)))throw Error(Da(285));return e.flags=-4097&t|64,e;case 5:return Ol(e),null;case 13:return Vu(io),4096&(t=e.flags)?(e.flags=-4097&t|64,e):null;case 19:return Vu(io),null;case 4:return Fl(),null;case 10:return ll(e),null;case 23:case 24:return df(),null;default:return null}}function zc(e,t){try{var n="",r=t;do{n+=Pa(r),r=r.return}while(r);var i=n}catch(e){i="\nError generating stack: "+e.message+"\n"+e.stack}return{value:e,source:t,stack:i}}function Rc(e,t){try{console.error(t.value)}catch(e){setTimeout((function(){throw e}))}}function Pc(e,t,n){(n=ml(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Qo||(Qo=!0,Jo=r),Rc(0,t)},n}function Lc(e,t,n){(n=ml(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"==typeof r){var i=t.value;n.payload=function(){return Rc(0,t),r(i)}}var o=e.stateNode;return null!==o&&"function"==typeof o.componentDidCatch&&(n.callback=function(){"function"!=typeof r&&(null===Ko?Ko=new Set([this]):Ko.add(this),Rc(0,t));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function Bc(e){var t=e.ref;if(null!==t)if("function"==typeof t)try{t(null)}catch(t){Mf(e,t)}else t.current=null}function Ic(e,t){switch(t.tag){case 0:case 11:case 15:case 22:return;case 1:if(256&t.flags&&null!==e){var n=e.memoizedProps,r=e.memoizedState;t=(e=t.stateNode).getSnapshotBeforeUpdate(t.elementType===t.type?n:sl(t.type,n),r),e.__reactInternalSnapshotBeforeUpdate=t}return;case 3:return void(256&t.flags&&Pu(t.stateNode.containerInfo));case 5:case 6:case 4:case 17:return}throw Error(Da(163))}function jc(e,t,n){switch(n.tag){case 0:case 11:case 15:case 22:if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{if(3==(3&e.tag)){var r=e.create;e.destroy=r()}e=e.next}while(e!==t)}if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{var i=e;r=i.next,0!=(4&(i=i.tag))&&0!=(1&i)&&(Af(n,e),Sf(n,e)),e=r}while(e!==t)}return;case 1:return e=n.stateNode,4&n.flags&&(null===t?e.componentDidMount():(r=n.elementType===n.type?t.memoizedProps:sl(n.type,t.memoizedProps),e.componentDidUpdate(r,t.memoizedState,e.__reactInternalSnapshotBeforeUpdate))),void(null!==(t=n.updateQueue)&&bl(n,t,e));case 3:if(null!==(t=n.updateQueue)){if(e=null,null!==n.child)switch(n.child.tag){case 5:e=n.child.stateNode;break;case 1:e=n.child.stateNode}bl(n,t,e)}return;case 5:return e=n.stateNode,void(null===t&&4&n.flags&&zu(n.type,n.memoizedProps)&&e.focus());case 6:case 4:case 12:return;case 13:return void(null===n.memoizedState&&(n=n.alternate,null!==n&&(n=n.memoizedState,null!==n&&(n=n.dehydrated,null!==n&&$s(n)))));case 19:case 17:case 20:case 21:case 23:case 24:return}throw Error(Da(163))}function Uc(e,t){for(var n=e;;){if(5===n.tag){var r=n.stateNode;if(t)"function"==typeof(r=r.style).setProperty?r.setProperty("display","none","important"):r.display="none";else{r=n.stateNode;var i=n.memoizedProps.style;i=null!=i&&i.hasOwnProperty("display")?i.display:null,r.style.display=os("display",i)}}else if(6===n.tag)n.stateNode.nodeValue=t?"":n.memoizedProps;else if((23!==n.tag&&24!==n.tag||null===n.memoizedState||n===e)&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}}function qc(e,t){if(ki&&"function"==typeof ki.onCommitFiberUnmount)try{ki.onCommitFiberUnmount(_i,t)}catch(e){}switch(t.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var n=e=e.next;do{var r=n,i=r.destroy;if(r=r.tag,void 0!==i)if(0!=(4&r))Af(t,n);else{r=t;try{i()}catch(e){Mf(r,e)}}n=n.next}while(n!==e)}break;case 1:if(Bc(t),"function"==typeof(e=t.stateNode).componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(e){Mf(t,e)}break;case 5:Bc(t);break;case 4:Xc(e,t)}}function Wc(e){e.alternate=null,e.child=null,e.dependencies=null,e.firstEffect=null,e.lastEffect=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.return=null,e.updateQueue=null}function Hc(e){return 5===e.tag||3===e.tag||4===e.tag}function Vc(e){e:{for(var t=e.return;null!==t;){if(Hc(t))break e;t=t.return}throw Error(Da(160))}var n=t;switch(t=n.stateNode,n.tag){case 5:var r=!1;break;case 3:case 4:t=t.containerInfo,r=!0;break;default:throw Error(Da(161))}16&n.flags&&(is(t,""),n.flags&=-17);e:t:for(n=e;;){for(;null===n.sibling;){if(null===n.return||Hc(n.return)){n=null;break e}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.flags)continue t;if(null===n.child||4===n.tag)continue t;n.child.return=n,n=n.child}if(!(2&n.flags)){n=n.stateNode;break e}}r?Gc(e,n,t):Yc(e,n,t)}function Gc(e,t,n){var r=e.tag,i=5===r||6===r;if(i)e=i?e.stateNode:e.stateNode.instance,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=Tu));else if(4!==r&&null!==(e=e.child))for(Gc(e,t,n),e=e.sibling;null!==e;)Gc(e,t,n),e=e.sibling}function Yc(e,t,n){var r=e.tag,i=5===r||6===r;if(i)e=i?e.stateNode:e.stateNode.instance,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(Yc(e,t,n),e=e.sibling;null!==e;)Yc(e,t,n),e=e.sibling}function Xc(e,t){for(var n,r,i=t,o=!1;;){if(!o){o=i.return;e:for(;;){if(null===o)throw Error(Da(160));switch(n=o.stateNode,o.tag){case 5:r=!1;break e;case 3:case 4:n=n.containerInfo,r=!0;break e}o=o.return}o=!0}if(5===i.tag||6===i.tag){e:for(var a=e,s=i,u=s;;)if(qc(a,u),null!==u.child&&4!==u.tag)u.child.return=u,u=u.child;else{if(u===s)break e;for(;null===u.sibling;){if(null===u.return||u.return===s)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}r?(a=n,s=i.stateNode,8===a.nodeType?a.parentNode.removeChild(s):a.removeChild(s)):n.removeChild(i.stateNode)}else if(4===i.tag){if(null!==i.child){n=i.stateNode.containerInfo,r=!0,i.child.return=i,i=i.child;continue}}else if(qc(e,i),null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;4===(i=i.return).tag&&(o=!1)}i.sibling.return=i.return,i=i.sibling}}function Qc(e,t){switch(t.tag){case 0:case 11:case 14:case 15:case 22:var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var r=n=n.next;do{3==(3&r.tag)&&(e=r.destroy,r.destroy=void 0,void 0!==e&&e()),r=r.next}while(r!==n)}return;case 1:return;case 5:if(null!=(n=t.stateNode)){r=t.memoizedProps;var i=null!==e?e.memoizedProps:r;e=t.type;var o=t.updateQueue;if(t.updateQueue=null,null!==o){for(n[hi]=r,"input"===e&&"radio"===r.type&&null!=r.name&&Va(n,r),us(e,i),t=us(e,r),i=0;i<o.length;i+=2){var a=o[i],s=o[i+1];"style"===a?as(n,s):"dangerouslySetInnerHTML"===a?on(n,s):"children"===a?is(n,s):$a(n,a,s,t)}switch(e){case"input":Ga(n,r);break;case"textarea":es(n,r);break;case"select":e=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!r.multiple,null!=(o=r.value)?Ja(n,!!r.multiple,o,!1):e!==!!r.multiple&&(null!=r.defaultValue?Ja(n,!!r.multiple,r.defaultValue,!0):Ja(n,!!r.multiple,r.multiple?[]:"",!1))}}}return;case 6:if(null===t.stateNode)throw Error(Da(162));return void(t.stateNode.nodeValue=t.memoizedProps);case 3:return void((n=t.stateNode).hydrate&&(n.hydrate=!1,$s(n.containerInfo)));case 12:return;case 13:return null!==t.memoizedState&&(Go=Ui(),Uc(t.child,!0)),void Jc(t);case 19:return void Jc(t);case 17:return;case 23:case 24:return void Uc(t,null!==t.memoizedState)}throw Error(Da(163))}function Jc(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Fo),t.forEach((function(t){var r=Nf.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function Kc(e,t){return null!==e&&(null===(e=e.memoizedState)||null!==e.dehydrated)&&(null!==(t=t.memoizedState)&&null===t.dehydrated)}function Zc(){Yo=Ui()+500}function ef(){return 0!=(48&To)?Ui():-1!==sa?sa:sa=Ui()}function tf(e){if(0==(2&(e=e.mode)))return 1;if(0==(4&e))return 99===tl()?1:2;if(0===ua&&(ua=Uo),0!==qi.transition){0!==la&&(la=null!==Vo?Vo.pendingLanes:0),e=ua;var t=4186112&~la;return 0===(t&=-t)&&(0===(t=(e=4186112&~e)&-e)&&(t=8192)),t}return e=tl(),0!=(4&To)&&98===e?e=Is(12,ua):e=Is(e=function(e){switch(e){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}(e),ua),e}function nf(e,t,n){if(50<oa)throw oa=0,aa=null,Error(Da(185));if(null===(e=rf(e,t)))return null;qs(e,t,n),e===zo&&(Wo|=t,4===Io&&sf(e,Po));var r=tl();1===t?0!=(8&To)&&0==(48&To)?uf(e):(of(e,n),0===To&&(Zc(),ol())):(0==(4&To)||98!==r&&99!==r||(null===ia?ia=new Set([e]):ia.add(e)),of(e,n)),Vo=e}function rf(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}function of(e,t){for(var n=e.callbackNode,r=e.suspendedLanes,i=e.pingedLanes,o=e.expirationTimes,a=e.pendingLanes;0<a;){var s=31-Vn(a),u=1<<s,l=o[s];if(-1===l){if(0==(u&r)||0!=(u&i)){l=t,Ps(u);var c=Hn;o[s]=10<=c?l+250:6<=c?l+5e3:-1}}else l<=t&&(e.expiredLanes|=u);a&=~u}if(r=Ls(e,e===zo?Po:0),t=Hn,0===r)null!==n&&(n!==Ri&&Ai(n),e.callbackNode=null,e.callbackPriority=0);else{if(null!==n){if(e.callbackPriority===t)return;n!==Ri&&Ai(n)}15===t?(n=uf.bind(null,e),null===Li?(Li=[n],Bi=Si(Ni,al)):Li.push(n),n=Ri):14===t?n=il(99,uf.bind(null,e)):n=il(n=function(e){switch(e){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(Da(358,e))}}(t),af.bind(null,e)),e.callbackPriority=t,e.callbackNode=n}}function af(e){if(sa=-1,la=ua=0,0!=(48&To))throw Error(Da(327));var t=e.callbackNode;if(Ef()&&e.callbackNode!==t)return null;var n=Ls(e,e===zo?Po:0);if(0===n)return null;var r=n,i=To;To|=16;var o=mf();for(zo===e&&Po===r||(Zc(),hf(e,r));;)try{vf();break}catch(t){pf(e,t)}if(ul(),Oo.current=o,To=i,null!==Ro?r=0:(zo=null,Po=0,r=Io),0!=(Uo&Wo))hf(e,0);else if(0!==r){if(2===r&&(To|=64,e.hydrate&&(e.hydrate=!1,Pu(e.containerInfo)),0!==(n=Bs(e))&&(r=gf(e,n))),1===r)throw t=jo,hf(e,0),sf(e,n),of(e,Ui()),t;switch(e.finishedWork=e.current.alternate,e.finishedLanes=n,r){case 0:case 1:throw Error(Da(345));case 2:wf(e);break;case 3:if(sf(e,n),(62914560&n)===n&&10<(r=Go+500-Ui())){if(0!==Ls(e,0))break;if(((i=e.suspendedLanes)&n)!==n){ef(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ui(wf.bind(null,e),r);break}wf(e);break;case 4:if(sf(e,n),(4186112&n)===n)break;for(r=e.eventTimes,i=-1;0<n;){var a=31-Vn(n);o=1<<a,(a=r[a])>i&&(i=a),n&=~o}if(n=i,10<(n=(120>(n=Ui()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*No(n/1960))-n)){e.timeoutHandle=ui(wf.bind(null,e),n);break}wf(e);break;case 5:wf(e);break;default:throw Error(Da(329))}}return of(e,Ui()),e.callbackNode===t?af.bind(null,e):null}function sf(e,t){for(t&=~Ho,t&=~Wo,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Vn(t),r=1<<n;e[n]=-1,t&=~r}}function uf(e){if(0!=(48&To))throw Error(Da(327));if(Ef(),e===zo&&0!=(e.expiredLanes&Po)){var t=Po,n=gf(e,t);0!=(Uo&Wo)&&(n=gf(e,t=Ls(e,t)))}else n=gf(e,t=Ls(e,0));if(0!==e.tag&&2===n&&(To|=64,e.hydrate&&(e.hydrate=!1,Pu(e.containerInfo)),0!==(t=Bs(e))&&(n=gf(e,t))),1===n)throw n=jo,hf(e,0),sf(e,t),of(e,Ui()),n;return e.finishedWork=e.current.alternate,e.finishedLanes=t,wf(e),of(e,Ui()),null}function lf(e,t){var n=To;To|=1;try{return e(t)}finally{0===(To=n)&&(Zc(),ol())}}function cf(e,t){var n=To;To&=-2,To|=8;try{return e(t)}finally{0===(To=n)&&(Zc(),ol())}}function ff(e,t){Gu(Bo,Lo),Lo|=t,Uo|=t}function df(){Lo=Bo.current,Vu(Bo)}function hf(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,li(n)),null!==Ro)for(n=Ro.return;null!==n;){var r=n;switch(r.tag){case 1:null!=(r=r.type.childContextTypes)&&Qu();break;case 3:Fl(),Vu(xi),Vu(bi),Il();break;case 5:Ol(r);break;case 4:Fl();break;case 13:case 19:Vu(io);break;case 10:ll(r);break;case 23:case 24:df()}n=n.return}zo=e,Ro=zf(e.current,null),Po=Lo=Uo=t,Io=0,jo=null,Ho=Wo=qo=0}function pf(e,t){for(;;){var n=Ro;try{if(ul(),lo.current=vo,go){for(var r=ho.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}go=!1}if(fo=0,mo=po=ho=null,yo=!1,$o.current=null,null===n||null===n.return){Io=1,jo=t,Ro=null;break}e:{var o=e,a=n.return,s=n,u=t;if(t=Po,s.flags|=2048,s.firstEffect=s.lastEffect=null,null!==u&&"object"==typeof u&&"function"==typeof u.then){var l=u;if(0==(2&s.mode)){var c=s.alternate;c?(s.updateQueue=c.updateQueue,s.memoizedState=c.memoizedState,s.lanes=c.lanes):(s.updateQueue=null,s.memoizedState=null)}var f=0!=(1&io.current),d=a;do{var h;if(h=13===d.tag){var p=d.memoizedState;if(null!==p)h=null!==p.dehydrated;else{var m=d.memoizedProps;h=void 0!==m.fallback&&(!0!==m.unstable_avoidThisFallback||!f)}}if(h){var g=d.updateQueue;if(null===g){var y=new Set;y.add(l),d.updateQueue=y}else g.add(l);if(0==(2&d.mode)){if(d.flags|=64,s.flags|=16384,s.flags&=-2981,1===s.tag)if(null===s.alternate)s.tag=17;else{var v=ml(-1,1);v.tag=2,gl(s,v)}s.lanes|=1;break e}u=void 0,s=t;var b=o.pingCache;if(null===b?(b=o.pingCache=new Mo,u=new Set,b.set(l,u)):void 0===(u=b.get(l))&&(u=new Set,b.set(l,u)),!u.has(s)){u.add(s);var x=Ff.bind(null,o,l,s);l.then(x,x)}d.flags|=4096,d.lanes=t;break e}d=d.return}while(null!==d);u=Error((La(s.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.")}5!==Io&&(Io=2),u=zc(u,s),d=a;do{switch(d.tag){case 3:o=u,d.flags|=4096,t&=-t,d.lanes|=t,yl(d,Pc(0,o,t));break e;case 1:o=u;var w=d.type,_=d.stateNode;if(0==(64&d.flags)&&("function"==typeof w.getDerivedStateFromError||null!==_&&"function"==typeof _.componentDidCatch&&(null===Ko||!Ko.has(_)))){d.flags|=4096,t&=-t,d.lanes|=t,yl(d,Lc(d,o,t));break e}}d=d.return}while(null!==d)}xf(n)}catch(e){t=e,Ro===n&&null!==n&&(Ro=n=n.return);continue}break}}function mf(){var e=Oo.current;return Oo.current=vo,null===e?vo:e}function gf(e,t){var n=To;To|=16;var r=mf();for(zo===e&&Po===t||hf(e,t);;)try{yf();break}catch(t){pf(e,t)}if(ul(),To=n,Oo.current=r,null!==Ro)throw Error(Da(261));return zo=null,Po=0,Io}function yf(){for(;null!==Ro;)bf(Ro)}function vf(){for(;null!==Ro&&!Ci();)bf(Ro)}function bf(e){var t=da(e.alternate,e,Lo);e.memoizedProps=e.pendingProps,null===t?xf(e):Ro=t,$o.current=null}function xf(e){var t=e;do{var n=t.alternate;if(e=t.return,0==(2048&t.flags)){if(null!==(n=$c(n,t,Lo)))return void(Ro=n);if(24!==(n=t).tag&&23!==n.tag||null===n.memoizedState||0!=(1073741824&Lo)||0==(4&n.mode)){for(var r=0,i=n.child;null!==i;)r|=i.lanes|i.childLanes,i=i.sibling;n.childLanes=r}null!==e&&0==(2048&e.flags)&&(null===e.firstEffect&&(e.firstEffect=t.firstEffect),null!==t.lastEffect&&(null!==e.lastEffect&&(e.lastEffect.nextEffect=t.firstEffect),e.lastEffect=t.lastEffect),1<t.flags&&(null!==e.lastEffect?e.lastEffect.nextEffect=t:e.firstEffect=t,e.lastEffect=t))}else{if(null!==(n=Tc(t)))return n.flags&=2047,void(Ro=n);null!==e&&(e.firstEffect=e.lastEffect=null,e.flags|=2048)}if(null!==(t=t.sibling))return void(Ro=t);Ro=t=e}while(null!==t);0===Io&&(Io=5)}function wf(e){var t=tl();return rl(99,_f.bind(null,e,t)),null}function _f(e,t){do{Ef()}while(null!==ea);if(0!=(48&To))throw Error(Da(327));var n=e.finishedWork;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(Da(177));e.callbackNode=null;var r=n.lanes|n.childLanes,i=r,o=e.pendingLanes&~i;e.pendingLanes=i,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=i,e.mutableReadLanes&=i,e.entangledLanes&=i,i=e.entanglements;for(var a=e.eventTimes,s=e.expirationTimes;0<o;){var u=31-Vn(o),l=1<<u;i[u]=0,a[u]=-1,s[u]=-1,o&=~l}if(null!==ia&&0==(24&r)&&ia.has(e)&&ia.delete(e),e===zo&&(Ro=zo=null,Po=0),1<n.flags?null!==n.lastEffect?(n.lastEffect.nextEffect=n,r=n.firstEffect):r=n:r=n.firstEffect,null!==r){if(i=To,To|=32,$o.current=null,ai=Jn,wu(a=xu())){if("selectionStart"in a)s={start:a.selectionStart,end:a.selectionEnd};else e:if(s=(s=a.ownerDocument)&&s.defaultView||window,(l=s.getSelection&&s.getSelection())&&0!==l.rangeCount){s=l.anchorNode,o=l.anchorOffset,u=l.focusNode,l=l.focusOffset;try{s.nodeType,u.nodeType}catch(e){s=null;break e}var c=0,f=-1,d=-1,h=0,p=0,m=a,g=null;t:for(;;){for(var y;m!==s||0!==o&&3!==m.nodeType||(f=c+o),m!==u||0!==l&&3!==m.nodeType||(d=c+l),3===m.nodeType&&(c+=m.nodeValue.length),null!==(y=m.firstChild);)g=m,m=y;for(;;){if(m===a)break t;if(g===s&&++h===o&&(f=c),g===u&&++p===l&&(d=c),null!==(y=m.nextSibling))break;g=(m=g).parentNode}m=y}s=-1===f||-1===d?null:{start:f,end:d}}else s=null;s=s||{start:0,end:0}}else s=null;si={focusedElem:a,selectionRange:s},Jn=!1,ca=null,fa=!1,Xo=r;do{try{kf()}catch(e){if(null===Xo)throw Error(Da(330));Mf(Xo,e),Xo=Xo.nextEffect}}while(null!==Xo);ca=null,Xo=r;do{try{for(a=e;null!==Xo;){var v=Xo.flags;if(16&v&&is(Xo.stateNode,""),128&v){var b=Xo.alternate;if(null!==b){var x=b.ref;null!==x&&("function"==typeof x?x(null):x.current=null)}}switch(1038&v){case 2:Vc(Xo),Xo.flags&=-3;break;case 6:Vc(Xo),Xo.flags&=-3,Qc(Xo.alternate,Xo);break;case 1024:Xo.flags&=-1025;break;case 1028:Xo.flags&=-1025,Qc(Xo.alternate,Xo);break;case 4:Qc(Xo.alternate,Xo);break;case 8:Xc(a,s=Xo);var w=s.alternate;Wc(s),null!==w&&Wc(w)}Xo=Xo.nextEffect}}catch(e){if(null===Xo)throw Error(Da(330));Mf(Xo,e),Xo=Xo.nextEffect}}while(null!==Xo);if(x=si,b=xu(),v=x.focusedElem,a=x.selectionRange,b!==v&&v&&v.ownerDocument&&bu(v.ownerDocument.documentElement,v)){null!==a&&wu(v)&&(b=a.start,void 0===(x=a.end)&&(x=b),"selectionStart"in v?(v.selectionStart=b,v.selectionEnd=Math.min(x,v.value.length)):(x=(b=v.ownerDocument||document)&&b.defaultView||window).getSelection&&(x=x.getSelection(),s=v.textContent.length,w=Math.min(a.start,s),a=void 0===a.end?w:Math.min(a.end,s),!x.extend&&w>a&&(s=a,a=w,w=s),s=vu(v,w),o=vu(v,a),s&&o&&(1!==x.rangeCount||x.anchorNode!==s.node||x.anchorOffset!==s.offset||x.focusNode!==o.node||x.focusOffset!==o.offset)&&((b=b.createRange()).setStart(s.node,s.offset),x.removeAllRanges(),w>a?(x.addRange(b),x.extend(o.node,o.offset)):(b.setEnd(o.node,o.offset),x.addRange(b))))),b=[];for(x=v;x=x.parentNode;)1===x.nodeType&&b.push({element:x,left:x.scrollLeft,top:x.scrollTop});for("function"==typeof v.focus&&v.focus(),v=0;v<b.length;v++)(x=b[v]).element.scrollLeft=x.left,x.element.scrollTop=x.top}Jn=!!ai,si=ai=null,e.current=n,Xo=r;do{try{for(v=e;null!==Xo;){var _=Xo.flags;if(36&_&&jc(v,Xo.alternate,Xo),128&_){b=void 0;var k=Xo.ref;if(null!==k){var E=Xo.stateNode;switch(Xo.tag){case 5:b=E;break;default:b=E}"function"==typeof k?k(b):k.current=b}}Xo=Xo.nextEffect}}catch(e){if(null===Xo)throw Error(Da(330));Mf(Xo,e),Xo=Xo.nextEffect}}while(null!==Xo);Xo=null,Pi(),To=i}else e.current=n;if(Zo)Zo=!1,ea=e,ta=t;else for(Xo=r;null!==Xo;)t=Xo.nextEffect,Xo.nextEffect=null,8&Xo.flags&&((_=Xo).sibling=null,_.stateNode=null),Xo=t;if(0===(r=e.pendingLanes)&&(Ko=null),1===r?e===aa?oa++:(oa=0,aa=e):oa=0,n=n.stateNode,ki&&"function"==typeof ki.onCommitFiberRoot)try{ki.onCommitFiberRoot(_i,n,void 0,64==(64&n.current.flags))}catch(e){}if(of(e,Ui()),Qo)throw Qo=!1,e=Jo,Jo=null,e;return 0!=(8&To)||ol(),null}function kf(){for(;null!==Xo;){var e=Xo.alternate;fa||null===ca||(0!=(8&Xo.flags)?Es(Xo,ca)&&(fa=!0):13===Xo.tag&&Kc(e,Xo)&&Es(Xo,ca)&&(fa=!0));var t=Xo.flags;0!=(256&t)&&Ic(e,Xo),0==(512&t)||Zo||(Zo=!0,il(97,(function(){return Ef(),null}))),Xo=Xo.nextEffect}}function Ef(){if(90!==ta){var e=97<ta?97:ta;return ta=90,rl(e,Cf)}return!1}function Sf(e,t){na.push(t,e),Zo||(Zo=!0,il(97,(function(){return Ef(),null})))}function Af(e,t){ra.push(t,e),Zo||(Zo=!0,il(97,(function(){return Ef(),null})))}function Cf(){if(null===ea)return!1;var e=ea;if(ea=null,0!=(48&To))throw Error(Da(331));var t=To;To|=32;var n=ra;ra=[];for(var r=0;r<n.length;r+=2){var i=n[r],o=n[r+1],a=i.destroy;if(i.destroy=void 0,"function"==typeof a)try{a()}catch(e){if(null===o)throw Error(Da(330));Mf(o,e)}}for(n=na,na=[],r=0;r<n.length;r+=2){i=n[r],o=n[r+1];try{var s=i.create;i.destroy=s()}catch(e){if(null===o)throw Error(Da(330));Mf(o,e)}}for(s=e.current.firstEffect;null!==s;)e=s.nextEffect,s.nextEffect=null,8&s.flags&&(s.sibling=null,s.stateNode=null),s=e;return To=t,ol(),!0}function Df(e,t,n){gl(e,t=Pc(0,t=zc(n,t),1)),t=ef(),null!==(e=rf(e,1))&&(qs(e,1,t),of(e,t))}function Mf(e,t){if(3===e.tag)Df(e,e,t);else for(var n=e.return;null!==n;){if(3===n.tag){Df(n,e,t);break}if(1===n.tag){var r=n.stateNode;if("function"==typeof n.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===Ko||!Ko.has(r))){var i=Lc(n,e=zc(t,e),1);if(gl(n,i),i=ef(),null!==(n=rf(n,1)))qs(n,1,i),of(n,i);else if("function"==typeof r.componentDidCatch&&(null===Ko||!Ko.has(r)))try{r.componentDidCatch(t,e)}catch(e){}break}}n=n.return}}function Ff(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=ef(),e.pingedLanes|=e.suspendedLanes&n,zo===e&&(Po&n)===n&&(4===Io||3===Io&&(62914560&Po)===Po&&500>Ui()-Go?hf(e,0):Ho|=n),of(e,t)}function Nf(e,t){var n=e.stateNode;null!==n&&n.delete(t),0===(t=0)&&(0==(2&(t=e.mode))?t=1:0==(4&t)?t=99===tl()?1:2:(0===ua&&(ua=Uo),0===(t=js(62914560&~ua))&&(t=4194304))),n=ef(),null!==(e=rf(e,t))&&(qs(e,t,n),of(e,n))}function Of(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function $f(e,t,n,r){return new Of(e,t,n,r)}function Tf(e){return!(!(e=e.prototype)||!e.isReactComponent)}function zf(e,t){var n=e.alternate;return null===n?((n=$f(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Rf(e,t,n,r,i,o){var a=2;if(r=e,"function"==typeof e)Tf(e)&&(a=1);else if("string"==typeof e)a=5;else e:switch(e){case Pt:return Pf(n.children,i,o,t);case Xt:a=8,i|=16;break;case Lt:a=8,i|=1;break;case Bt:return(e=$f(12,n,t,8|i)).elementType=Bt,e.type=Bt,e.lanes=o,e;case qt:return(e=$f(13,n,t,i)).type=qt,e.elementType=qt,e.lanes=o,e;case Wt:return(e=$f(19,n,t,i)).elementType=Wt,e.lanes=o,e;case Qt:return Lf(n,i,o,t);case Jt:return(e=$f(24,n,t,i)).elementType=Jt,e.lanes=o,e;default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case It:a=10;break e;case jt:a=9;break e;case Ut:a=11;break e;case Ht:a=14;break e;case Vt:a=16,r=null;break e;case Gt:a=22;break e}throw Error(Da(130,null==e?e:typeof e,""))}return(t=$f(a,n,t,i)).elementType=e,t.type=r,t.lanes=o,t}function Pf(e,t,n,r){return(e=$f(7,e,r,t)).lanes=n,e}function Lf(e,t,n,r){return(e=$f(23,e,r,t)).elementType=Qt,e.lanes=n,e}function Bf(e,t,n){return(e=$f(6,e,null,t)).lanes=n,e}function If(e,t,n){return(t=$f(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function jf(e,t,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=Us(0),this.expirationTimes=Us(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Us(0),this.mutableSourceEagerHydrationData=null}function Uf(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:Rt,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}function qf(e,t,n,r){var i=t.current,o=ef(),a=tf(i);e:if(n){t:{if(xs(n=n._reactInternals)!==n||1!==n.tag)throw Error(Da(170));var s=n;do{switch(s.tag){case 3:s=s.stateNode.context;break t;case 1:if(Xu(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break t}}s=s.return}while(null!==s);throw Error(Da(171))}if(1===n.tag){var u=n.type;if(Xu(u)){n=Ku(n,u,s);break e}}n=s}else n=vi;return null===t.context?t.context=n:t.pendingContext=n,(t=ml(o,a)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),gl(i,t),nf(i,a,o),a}function Wf(e){if(!(e=e.current).child)return null;switch(e.child.tag){case 5:default:return e.child.stateNode}}function Hf(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Vf(e,t){Hf(e,t),(e=e.alternate)&&Hf(e,t)}function Gf(){return null}function Yf(e,t,n){var r=null!=n&&null!=n.hydrationOptions&&n.hydrationOptions.mutableSources||null;if(n=new jf(e,t,null!=n&&!0===n.hydrate),t=$f(3,null,null,2===t?7:1===t?3:0),n.current=t,t.stateNode=n,hl(t),e[pi]=n.current,Au(8===e.nodeType?e.parentNode:e),r)for(e=0;e<r.length;e++){var i=(t=r[e])._getVersion;i=i(t._source),null==n.mutableSourceEagerHydrationData?n.mutableSourceEagerHydrationData=[t,i]:n.mutableSourceEagerHydrationData.push(t,i)}this._internalRoot=n}function Xf(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Qf(e,t,n,r,i){var o=n._reactRootContainer;if(o){var a=o._internalRoot;if("function"==typeof i){var s=i;i=function(){var e=Wf(a);s.call(e)}}qf(t,a,e,i)}else{if(o=n._reactRootContainer=function(e,t){if(t||(t=!(!(t=e?9===e.nodeType?e.documentElement:e.firstChild:null)||1!==t.nodeType||!t.hasAttribute("data-reactroot"))),!t)for(var n;n=e.lastChild;)e.removeChild(n);return new Yf(e,0,t?{hydrate:!0}:void 0)}(n,r),a=o._internalRoot,"function"==typeof i){var u=i;i=function(){var e=Wf(a);u.call(e)}}cf((function(){qf(t,a,e,i)}))}return Wf(a)}function Jf(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Xf(t))throw Error(Da(200));return Uf(e,t,null,n)}function Kf(){if(_t={},kt=xe(),Et=c(),wt(),!kt)throw Error(Da(227));var e;if(St=new Set,At={},Ct=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),Dt=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Mt=Object.prototype.hasOwnProperty,Ft={},Nt={},Ot={},"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){Ot[e]=new Na(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];Ot[t]=new Na(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){Ot[e]=new Na(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){Ot[e]=new Na(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){Ot[e]=new Na(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){Ot[e]=new Na(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){Ot[e]=new Na(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){Ot[e]=new Na(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){Ot[e]=new Na(e,5,!1,e.toLowerCase(),null,!1,!1)})),$t=/[\-:]([a-z])/g,"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace($t,Oa);Ot[t]=new Na(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace($t,Oa);Ot[t]=new Na(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace($t,Oa);Ot[t]=new Na(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){Ot[e]=new Na(e,1,!1,e.toLowerCase(),null,!1,!1)})),Ot.xlinkHref=new Na("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){Ot[e]=new Na(e,1,!1,e.toLowerCase(),null,!0,!0)})),Tt=kt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,zt=60103,Rt=60106,Pt=60107,Lt=60108,Bt=60114,It=60109,jt=60110,Ut=60112,qt=60113,Wt=60120,Ht=60115,Vt=60116,Gt=60121,Yt=60128,Xt=60129,Qt=60130,Jt=60131,"function"==typeof Symbol&&Symbol.for&&(Kt=Symbol.for,zt=Kt("react.element"),Rt=Kt("react.portal"),Pt=Kt("react.fragment"),Lt=Kt("react.strict_mode"),Bt=Kt("react.profiler"),It=Kt("react.provider"),jt=Kt("react.context"),Ut=Kt("react.forward_ref"),qt=Kt("react.suspense"),Wt=Kt("react.suspense_list"),Ht=Kt("react.memo"),Vt=Kt("react.lazy"),Gt=Kt("react.block"),Kt("react.scope"),Yt=Kt("react.opaque.id"),Xt=Kt("react.debug_trace_mode"),Qt=Kt("react.offscreen"),Jt=Kt("react.legacy_hidden")),Zt="function"==typeof Symbol&&Symbol.iterator,tn=!1,nn={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg"},e=function(e,t){if(e.namespaceURI!==nn.svg||"innerHTML"in e)e.innerHTML=t;else{for((rn=rn||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=rn.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},on="undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction((function(){return e(t,n)}))}:e,an={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},sn=["Webkit","ms","Moz","O"],Object.keys(an).forEach((function(e){sn.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),an[t]=an[e]}))})),un=Et({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}),ln=null,cn=null,fn=null,dn=hs,hn=!1,pn=!1,mn=!1,Ct)try{gn={},Object.defineProperty(gn,"passive",{get:function(){mn=!0}}),window.addEventListener("test",gn,gn),window.removeEventListener("test",gn,gn)}catch(e){mn=!1}yn=!1,vn=null,bn=!1,xn=null,wn={onError:function(e){yn=!0,vn=e}},An=!1,Cn=[],Dn=null,Mn=null,Fn=null,Nn=new Map,On=new Map,$n=[],Tn="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" "),zn={animationend:Ts("Animation","AnimationEnd"),animationiteration:Ts("Animation","AnimationIteration"),animationstart:Ts("Animation","AnimationStart"),transitionend:Ts("Transition","TransitionEnd")},Rn={},Pn={},Ct&&(Pn=document.createElement("div").style,"AnimationEvent"in window||(delete zn.animationend.animation,delete zn.animationiteration.animation,delete zn.animationstart.animation),"TransitionEvent"in window||delete zn.transitionend.transition),Ln=zs("animationend"),Bn=zs("animationiteration"),In=zs("animationstart"),jn=zs("transitionend"),Un=new Map,qn=new Map,Wn=["abort","abort",Ln,"animationEnd",Bn,"animationIteration",In,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",jn,"transitionEnd","waiting","waiting"],(0,wt().unstable_now)(),Hn=8,Vn=Math.clz32?Math.clz32:Ws,Gn=Math.log,Yn=Math.LN2,Xn=wt().unstable_UserBlockingPriority,Qn=wt().unstable_runWithPriority,Jn=!0,Kn=null,Zn=null,er=null,nr=Zs(tr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0}),rr=Et({},tr,{view:0,detail:0}),ir=Zs(rr),ur=Et({},rr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:tu,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==sr&&(sr&&"mousemove"===e.type?(or=e.screenX-sr.screenX,ar=e.screenY-sr.screenY):ar=or=0,sr=e),or)},movementY:function(e){return"movementY"in e?e.movementY:ar}}),lr=Zs(ur),cr=Et({},ur,{dataTransfer:0}),fr=Zs(cr),dr=Et({},rr,{relatedTarget:0}),hr=Zs(dr),pr=Et({},tr,{animationName:0,elapsedTime:0,pseudoElement:0}),mr=Zs(pr),gr=Et({},tr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),yr=Zs(gr),vr=Et({},tr,{data:0}),br=Zs(vr),xr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_r={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"},kr=Et({},rr,{key:function(e){if(e.key){var t=xr[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Qs(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?wr[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:tu,charCode:function(e){return"keypress"===e.type?Qs(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Qs(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Er=Zs(kr),Sr=Et({},ur,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ar=Zs(Sr),Cr=Et({},rr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:tu}),Dr=Zs(Cr),Mr=Et({},tr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Fr=Zs(Mr),Nr=Et({},ur,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Or=Zs(Nr),$r=[9,13,27,32],Tr=Ct&&"CompositionEvent"in window,zr=null,Ct&&"documentMode"in document&&(zr=document.documentMode),Rr=Ct&&"TextEvent"in window&&!zr,Pr=Ct&&(!Tr||zr&&8<zr&&11>=zr),Lr=String.fromCharCode(32),Br=!1,Ir=!1,jr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0},Ur=null,qr=null,Wr=!1,Ct&&(Ct?((Vr="oninput"in document)||((Gr=document.createElement("div")).setAttribute("oninput","return;"),Vr="function"==typeof Gr.oninput),Hr=Vr):Hr=!1,Wr=Hr&&(!document.documentMode||9<document.documentMode)),Yr="function"==typeof Object.is?Object.is:mu,Xr=Object.prototype.hasOwnProperty,Qr=Ct&&"documentMode"in document&&11>=document.documentMode,Jr=null,Kr=null,Zr=null,ei=!1,Rs("cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focusin focus focusout blur input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),Rs("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),Rs(Wn,2);for(ti="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),ni=0;ni<ti.length;ni++)qn.set(ti[ni],0);if(Fa("onMouseEnter",["mouseout","mouseover"]),Fa("onMouseLeave",["mouseout","mouseover"]),Fa("onPointerEnter",["pointerout","pointerover"]),Fa("onPointerLeave",["pointerout","pointerover"]),Ma("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ma("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ma("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ma("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ma("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ma("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" ")),ri="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ii=new Set("cancel close invalid load scroll toggle".split(" ").concat(ri)),oi="_reactListening"+Math.random().toString(36).slice(2),ai=null,si=null,ui="function"==typeof setTimeout?setTimeout:void 0,li="function"==typeof clearTimeout?clearTimeout:void 0,ci=0,fi=Math.random().toString(36).slice(2),di="__reactFiber$"+fi,hi="__reactProps$"+fi,pi="__reactContainer$"+fi,mi="__reactEvents$"+fi,gi=[],yi=-1,bi=Hu(vi={}),xi=Hu(!1),wi=vi,_i=null,ki=null,Ei=wt().unstable_runWithPriority,Si=wt().unstable_scheduleCallback,Ai=wt().unstable_cancelCallback,Ci=wt().unstable_shouldYield,Di=wt().unstable_requestPaint,Mi=wt().unstable_now,Fi=wt().unstable_getCurrentPriorityLevel,Ni=wt().unstable_ImmediatePriority,Oi=wt().unstable_UserBlockingPriority,$i=wt().unstable_NormalPriority,Ti=wt().unstable_LowPriority,zi=wt().unstable_IdlePriority,Ri={},Pi=void 0!==Di?Di:function(){},Li=null,Bi=null,Ii=!1,ji=Mi(),Ui=1e4>ji?Mi:function(){return Mi()-ji},qi=Tt.ReactCurrentBatchConfig,Wi=Hu(null),Hi=null,Vi=null,Gi=null,Yi=!1,Xi=(new kt.Component).refs,Qi={isMounted:function(e){return!!(e=e._reactInternals)&&xs(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ef(),i=tf(e),o=ml(r,i);o.payload=t,null!=n&&(o.callback=n),gl(e,o),nf(e,i,r)},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ef(),i=tf(e),o=ml(r,i);o.tag=1,o.payload=t,null!=n&&(o.callback=n),gl(e,o),nf(e,i,r)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ef(),r=tf(e),i=ml(n,r);i.tag=2,null!=t&&(i.callback=t),gl(e,i),nf(e,r,n)}},Ji=Array.isArray,Ki=Cl(!0),Zi=Cl(!1),to=Hu(eo={}),no=Hu(eo),ro=Hu(eo),io=Hu(0),oo=null,ao=null,so=!1,uo=[],lo=Tt.ReactCurrentDispatcher,co=Tt.ReactCurrentBatchConfig,fo=0,ho=null,po=null,mo=null,go=!1,yo=!1,vo={readContext:dl,useCallback:jl,useContext:jl,useEffect:jl,useImperativeHandle:jl,useLayoutEffect:jl,useMemo:jl,useReducer:jl,useRef:jl,useState:jl,useDebugValue:jl,useDeferredValue:jl,useTransition:jl,useMutableSource:jl,useOpaqueIdentifier:jl,unstable_isNewReconciler:!1},bo={readContext:dl,useCallback:function(e,t){return Wl().memoizedState=[e,void 0===t?null:t],e},useContext:dl,useEffect:ic,useImperativeHandle:function(e,t,n){return n=null!=n?n.concat([e]):null,nc(4,2,sc.bind(null,t,e),n)},useLayoutEffect:function(e,t){return nc(4,2,e,t)},useMemo:function(e,t){var n=Wl();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Wl();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e=(e=r.queue={pending:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t}).dispatch=hc.bind(null,ho,e),[r.memoizedState,e]},useRef:ec,useState:Kl,useDebugValue:lc,useDeferredValue:function(e){var t=Kl(e),n=t[0],r=t[1];return ic((function(){var t=co.transition;co.transition=1;try{r(e)}finally{co.transition=t}}),[e]),n},useTransition:function(){var e=Kl(!1),t=e[0];return ec(e=dc.bind(null,e[1])),[e,t]},useMutableSource:function(e,t,n){var r=Wl();return r.memoizedState={refs:{getSnapshot:t,setSnapshot:null},source:e,subscribe:n},Ql(r,e,t,n)},useOpaqueIdentifier:function(){if(so){var e=!1,t=function(e){return{$$typeof:Yt,toString:e,valueOf:e}}((function(){throw e||(e=!0,n("r:"+(ci++).toString(36))),Error(Da(355))})),n=Kl(t)[1];return 0==(2&ho.mode)&&(ho.flags|=516,Zl(5,(function(){n("r:"+(ci++).toString(36))}),void 0,null)),t}return Kl(t="r:"+(ci++).toString(36)),t},unstable_isNewReconciler:!1},xo={readContext:dl,useCallback:cc,useContext:dl,useEffect:oc,useImperativeHandle:uc,useLayoutEffect:ac,useMemo:fc,useReducer:Gl,useRef:tc,useState:function(){return Gl(Vl)},useDebugValue:lc,useDeferredValue:function(e){var t=Gl(Vl),n=t[0],r=t[1];return oc((function(){var t=co.transition;co.transition=1;try{r(e)}finally{co.transition=t}}),[e]),n},useTransition:function(){var e=Gl(Vl)[0];return[tc().current,e]},useMutableSource:Jl,useOpaqueIdentifier:function(){return Gl(Vl)[0]},unstable_isNewReconciler:!1},wo={readContext:dl,useCallback:cc,useContext:dl,useEffect:oc,useImperativeHandle:uc,useLayoutEffect:ac,useMemo:fc,useReducer:Yl,useRef:tc,useState:function(){return Yl(Vl)},useDebugValue:lc,useDeferredValue:function(e){var t=Yl(Vl),n=t[0],r=t[1];return oc((function(){var t=co.transition;co.transition=1;try{r(e)}finally{co.transition=t}}),[e]),n},useTransition:function(){var e=Yl(Vl)[0];return[tc().current,e]},useMutableSource:Jl,useOpaqueIdentifier:function(){return Yl(Vl)[0]},unstable_isNewReconciler:!1},_o=Tt.ReactCurrentOwner,ko=!1,Eo={dehydrated:null,retryLane:0},So=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ao=function(){},Co=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Dl(to.current);var o,a=null;switch(n){case"input":i=Wa(e,i),r=Wa(e,r),a=[];break;case"option":i=Qa(e,i),r=Qa(e,r),a=[];break;case"select":i=Et({},i,{value:void 0}),r=Et({},r,{value:void 0}),a=[];break;case"textarea":i=Ka(e,i),r=Ka(e,r),a=[];break;default:"function"!=typeof i.onClick&&"function"==typeof r.onClick&&(e.onclick=Tu)}for(l in ss(n,r),n=null,i)if(!r.hasOwnProperty(l)&&i.hasOwnProperty(l)&&null!=i[l])if("style"===l){var s=i[l];for(o in s)s.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else"dangerouslySetInnerHTML"!==l&&"children"!==l&&"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&"autoFocus"!==l&&(At.hasOwnProperty(l)?a||(a=[]):(a=a||[]).push(l,null));for(l in r){var u=r[l];if(s=null!=i?i[l]:void 0,r.hasOwnProperty(l)&&u!==s&&(null!=u||null!=s))if("style"===l)if(s){for(o in s)!s.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&s[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(a||(a=[]),a.push(l,n)),n=u;else"dangerouslySetInnerHTML"===l?(u=u?u.__html:void 0,s=s?s.__html:void 0,null!=u&&s!==u&&(a=a||[]).push(l,u)):"children"===l?"string"!=typeof u&&"number"!=typeof u||(a=a||[]).push(l,""+u):"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&(At.hasOwnProperty(l)?(null!=u&&"onScroll"===l&&Su("scroll",e),a||s===u||(a=[])):"object"==typeof u&&null!==u&&u.$$typeof===Yt?u.toString():(a=a||[]).push(l,u))}n&&(a=a||[]).push("style",n);var l=a;(t.updateQueue=l)&&(t.flags|=4)}},Do=function(e,t,n,r){n!==r&&(t.flags|=4)},Mo="function"==typeof WeakMap?WeakMap:Map,Fo="function"==typeof WeakSet?WeakSet:Set,No=Math.ceil,Oo=Tt.ReactCurrentDispatcher,$o=Tt.ReactCurrentOwner,To=0,zo=null,Ro=null,Po=0,Lo=0,Bo=Hu(0),Io=0,jo=null,Uo=0,qo=0,Wo=0,Ho=0,Vo=null,Go=0,Yo=1/0,Xo=null,Qo=!1,Jo=null,Ko=null,Zo=!1,ea=null,ta=90,na=[],ra=[],ia=null,oa=0,aa=null,sa=-1,ua=0,la=0,ca=null,fa=!1,da=function(e,t,n){var r=t.lanes;if(null!==e)if(e.memoizedProps!==t.pendingProps||xi.current)ko=!0;else{if(0==(n&r)){switch(ko=!1,t.tag){case 3:kc(t),Bl();break;case 5:Nl(t);break;case 1:Xu(t.type)&&Zu(t);break;case 4:Ml(t,t.stateNode.containerInfo);break;case 10:r=t.memoizedProps.value;var i=t.type._context;Gu(Wi,i._currentValue),i._currentValue=r;break;case 13:if(null!==t.memoizedState)return 0!=(n&t.child.childLanes)?Ec(e,t,n):(Gu(io,1&io.current),null!==(t=Nc(e,t,n))?t.sibling:null);Gu(io,1&io.current);break;case 19:if(r=0!=(n&t.childLanes),0!=(64&e.flags)){if(r)return Fc(e,t,n);t.flags|=64}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Gu(io,io.current),r)break;return null;case 23:case 24:return t.lanes=0,vc(e,t,n)}return Nc(e,t,n)}ko=0!=(16384&e.flags)}else ko=!1;switch(t.lanes=0,t.tag){case 2:if(r=t.type,null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,i=Yu(t,bi.current),fl(t,n),i=ql(null,t,r,e,i,n),t.flags|=1,"object"==typeof i&&null!==i&&"function"==typeof i.render&&void 0===i.$$typeof){if(t.tag=1,t.memoizedState=null,t.updateQueue=null,Xu(r)){var o=!0;Zu(t)}else o=!1;t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,hl(t);var a=r.getDerivedStateFromProps;"function"==typeof a&&xl(t,r,a,e),i.updater=Qi,t.stateNode=i,i._reactInternals=t,El(t,r,e,n),t=_c(null,t,r,!0,o,n)}else t.tag=0,pc(null,t,i,n),t=t.child;return t;case 16:i=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,i=(o=i._init)(i._payload),t.type=i,o=t.tag=function(e){if("function"==typeof e)return Tf(e)?1:0;if(null!=e){if((e=e.$$typeof)===Ut)return 11;if(e===Ht)return 14}return 2}(i),e=sl(i,e),o){case 0:t=xc(null,t,i,e,n);break e;case 1:t=wc(null,t,i,e,n);break e;case 11:t=mc(null,t,i,e,n);break e;case 14:t=gc(null,t,i,sl(i.type,e),r,n);break e}throw Error(Da(306,i,""))}return t;case 0:return r=t.type,i=t.pendingProps,xc(e,t,r,i=t.elementType===r?i:sl(r,i),n);case 1:return r=t.type,i=t.pendingProps,wc(e,t,r,i=t.elementType===r?i:sl(r,i),n);case 3:if(kc(t),r=t.updateQueue,null===e||null===r)throw Error(Da(282));if(r=t.pendingProps,i=null!==(i=t.memoizedState)?i.element:null,pl(e,t),vl(t,r,null,n),(r=t.memoizedState.element)===i)Bl(),t=Nc(e,t,n);else{if((o=(i=t.stateNode).hydrate)&&(ao=Lu(t.stateNode.containerInfo.firstChild),oo=t,o=so=!0),o){if(null!=(e=i.mutableSourceEagerHydrationData))for(i=0;i<e.length;i+=2)(o=e[i])._workInProgressVersionPrimary=e[i+1],uo.push(o);for(n=Zi(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|1024,n=n.sibling}else pc(e,t,r,n),Bl();t=t.child}return t;case 5:return Nl(t),null===e&&Rl(t),r=t.type,i=t.pendingProps,o=null!==e?e.memoizedProps:null,a=i.children,Ru(r,i)?a=null:null!==o&&Ru(r,o)&&(t.flags|=16),bc(e,t),pc(e,t,a,n),t.child;case 6:return null===e&&Rl(t),null;case 13:return Ec(e,t,n);case 4:return Ml(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Ki(t,null,r,n):pc(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,mc(e,t,r,i=t.elementType===r?i:sl(r,i),n);case 7:return pc(e,t,t.pendingProps,n),t.child;case 8:case 12:return pc(e,t,t.pendingProps.children,n),t.child;case 10:e:{r=t.type._context,i=t.pendingProps,a=t.memoizedProps,o=i.value;var s=t.type._context;if(Gu(Wi,s._currentValue),s._currentValue=o,null!==a)if(s=a.value,0===(o=Yr(s,o)?0:0|("function"==typeof r._calculateChangedBits?r._calculateChangedBits(s,o):1073741823))){if(a.children===i.children&&!xi.current){t=Nc(e,t,n);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var u=s.dependencies;if(null!==u){a=s.child;for(var l=u.firstContext;null!==l;){if(l.context===r&&0!=(l.observedBits&o)){1===s.tag&&((l=ml(-1,n&-n)).tag=2,gl(s,l)),s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),cl(s.return,n),u.lanes|=n;break}l=l.next}}else a=10===s.tag&&s.type===t.type?null:s.child;if(null!==a)a.return=s;else for(a=s;null!==a;){if(a===t){a=null;break}if(null!==(s=a.sibling)){s.return=a.return,a=s;break}a=a.return}s=a}pc(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=(o=t.pendingProps).children,fl(t,n),r=r(i=dl(i,o.unstable_observedBits)),t.flags|=1,pc(e,t,r,n),t.child;case 14:return o=sl(i=t.type,t.pendingProps),gc(e,t,i,o=sl(i.type,o),r,n);case 15:return yc(e,t,t.type,t.pendingProps,r,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:sl(r,i),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,Xu(r)?(e=!0,Zu(t)):e=!1,fl(t,n),_l(t,r,i),El(t,r,i,n),_c(null,t,r,!0,e,n);case 19:return Fc(e,t,n);case 23:case 24:return vc(e,t,n)}throw Error(Da(156,t.tag))},Yf.prototype.render=function(e){qf(e,this._internalRoot,null,null)},Yf.prototype.unmount=function(){var e=this._internalRoot,t=e.containerInfo;qf(null,e,null,(function(){t[pi]=null}))},_n=function(e){13===e.tag&&(nf(e,4,ef()),Vf(e,4))},kn=function(e){13===e.tag&&(nf(e,67108864,ef()),Vf(e,67108864))},En=function(e){if(13===e.tag){var t=ef(),n=tf(e);nf(e,n,t),Vf(e,n)}},Sn=function(e,t){return t()},ln=function(e,t,n){switch(t){case"input":if(Ga(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=qu(r);if(!i)throw Error(Da(90));Ua(r),Ga(r,i)}}}break;case"textarea":es(e,n);break;case"select":null!=(t=n.value)&&Ja(e,!!n.multiple,t,!1)}},hs=lf,ps=function(e,t,n,r,i){var o=To;To|=4;try{return rl(98,e.bind(null,t,n,r,i))}finally{0===(To=o)&&(Zc(),ol())}},ms=function(){0==(49&To)&&(function(){if(null!==ia){var e=ia;ia=null,e.forEach((function(e){e.expiredLanes|=24&e.pendingLanes,of(e,Ui())}))}ol()}(),Ef())},dn=function(e,t){var n=To;To|=2;try{return e(t)}finally{0===(To=n)&&(Zc(),ol())}},ha={Events:[ju,Uu,qu,fs,ds,Ef,{current:!1}]},ma={bundleType:(pa={findFiberByHostInstance:Iu,bundleType:0,version:"17.0.2",rendererPackageName:"react-dom"}).bundleType,version:pa.version,rendererPackageName:pa.rendererPackageName,rendererConfig:pa.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Tt.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=ks(e))?null:e.stateNode},findFiberByHostInstance:pa.findFiberByHostInstance||Gf,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null},"undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&!(ga=__REACT_DEVTOOLS_GLOBAL_HOOK__).isDisabled&&ga.supportsFiber)try{_i=ga.inject(ma),ki=ga}catch(e){}ya=ha,_t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ya,va=Jf,_t.createPortal=va,ba=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(Da(188));throw Error(Da(268,Object.keys(e)))}return e=null===(e=ks(t))?null:e.stateNode},_t.findDOMNode=ba,xa=function(e,t){var n=To;if(0!=(48&n))return e(t);To|=1;try{if(e)return rl(99,e.bind(null,t))}finally{To=n,ol()}},_t.flushSync=xa,wa=function(e,t,n){if(!Xf(t))throw Error(Da(200));return Qf(null,e,t,!0,n)},_t.hydrate=wa,_a=function(e,t,n){if(!Xf(t))throw Error(Da(200));return Qf(null,e,t,!1,n)},_t.render=_a,ka=function(e){if(!Xf(e))throw Error(Da(40));return!!e._reactRootContainer&&(cf((function(){Qf(null,null,e,!1,(function(){e._reactRootContainer=null,e[pi]=null}))})),!0)},_t.unmountComponentAtNode=ka,Ea=lf,_t.unstable_batchedUpdates=Ea,Sa=function(e,t){return Jf(e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},_t.unstable_createPortal=Sa,Aa=function(e,t,n,r){if(!Xf(n))throw Error(Da(200));if(null==e||void 0===e._reactInternals)throw Error(Da(38));return Qf(e,t,n,!1,r)},_t.unstable_renderSubtreeIntoContainer=Aa,"17.0.2",_t.version="17.0.2"}!function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(e){console.error(e)}}(),Ca||(Ca=!0,Kf());var Zf=e(_t);xe(),xe();var ed={},td={};function nd(e){return new Function("d","return {"+e.map((function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'})).join(",")+"}")}function rd(e){var t=Object.create(null),n=[];return e.forEach((function(e){for(var r in e)r in t||n.push(t[r]=r)})),n}function id(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function od(e){var t,n=e.getUTCHours(),r=e.getUTCMinutes(),i=e.getUTCSeconds(),o=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":((t=e.getUTCFullYear())<0?"-"+id(-t,6):t>9999?"+"+id(t,6):id(t,4))+"-"+id(e.getUTCMonth()+1,2)+"-"+id(e.getUTCDate(),2)+(o?"T"+id(n,2)+":"+id(r,2)+":"+id(i,2)+"."+id(o,3)+"Z":i?"T"+id(n,2)+":"+id(r,2)+":"+id(i,2)+"Z":r||n?"T"+id(n,2)+":"+id(r,2)+"Z":"")}var ad=function(e){var t=new RegExp('["'+e+"\n\r]"),n=e.charCodeAt(0);function r(e,t){var r,i=[],o=e.length,a=0,s=0,u=o<=0,l=!1;function c(){if(u)return td;if(l)return l=!1,ed;var t,r,i=a;if(34===e.charCodeAt(i)){for(;a++<o&&34!==e.charCodeAt(a)||34===e.charCodeAt(++a););return(t=a)>=o?u=!0:10===(r=e.charCodeAt(a++))?l=!0:13===r&&(l=!0,10===e.charCodeAt(a)&&++a),e.slice(i+1,t-1).replace(/""/g,'"')}for(;a<o;){if(10===(r=e.charCodeAt(t=a++)))l=!0;else if(13===r)l=!0,10===e.charCodeAt(a)&&++a;else if(r!==n)continue;return e.slice(i,t)}return u=!0,e.slice(i,o)}for(10===e.charCodeAt(o-1)&&--o,13===e.charCodeAt(o-1)&&--o;(r=c())!==td;){for(var f=[];r!==ed&&r!==td;)f.push(r),r=c();t&&null==(f=t(f,s++))||i.push(f)}return i}function i(t,n){return t.map((function(t){return n.map((function(e){return a(t[e])})).join(e)}))}function o(t){return t.map(a).join(e)}function a(e){return null==e?"":e instanceof Date?od(e):t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:function(e,t){var n,i,o=r(e,(function(e,r){if(n)return n(e,r-1);i=e,n=t?function(e,t){var n=nd(e);return function(r,i){return t(n(r),i,e)}}(e,t):nd(e)}));return o.columns=i||[],o},parseRows:r,format:function(t,n){return null==n&&(n=rd(t)),[n.map(a).join(e)].concat(i(t,n)).join("\n")},formatBody:function(e,t){return null==t&&(t=rd(e)),i(e,t).join("\n")},formatRows:function(e){return e.map(o).join("\n")},formatRow:o,formatValue:a}},sd=ad(","),ud=sd.parse,ld=(sd.parseRows,sd.format,sd.formatBody,sd.formatRows,sd.formatRow,sd.formatValue,ad("\t")),cd=ld.parse;ld.parseRows,ld.format,ld.formatBody,ld.formatRows,ld.formatRow,ld.formatValue;function fd(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.text()}var dd=function(e,t){return fetch(e,t).then(fd)};function hd(e){return function(t,n,r){return 2===arguments.length&&"function"==typeof n&&(r=n,n=void 0),dd(t,n).then((function(t){return e(t,r)}))}}var pd=hd(ud);hd(cd);xe();const md=e=>{const[t,n]=xe().useState([]),[r,i]=xe().useState(!0);return xe().useEffect((()=>{!async function(){const t=await pd(e);n(t),i(!1)}()}),[]),[t,r]};var gd,yd={},vd=(gd=function(e,t){return(gd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}gd(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),bd=Object.prototype.hasOwnProperty;
/*!
  * https://github.com/Starcounter-Jack/JSON-Patch
  * (c) 2017 Joachim Wester
  * MIT license
  */function xd(e,t){return bd.call(e,t)}function wd(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);t=[];for(var r in e)xd(e,r)&&t.push(r);return t}function _d(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function kd(e){for(var t,n=0,r=e.length;n<r;){if(!((t=e.charCodeAt(n))>=48&&t<=57))return!1;n++}return!0}function Ed(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function Sd(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function Ad(e){if(void 0===e)return!0;if(e)if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(Ad(e[t]))return!0}else if("object"==typeof e){var r=wd(e),i=r.length;for(t=0;t<i;t++)if(Ad(e[r[t]]))return!0}return!1}function Cd(e,t){var n=[e];for(var r in t){var i="object"==typeof t[r]?JSON.stringify(t[r],null,2):t[r];void 0!==i&&n.push(r+": "+i)}return n.join("\n")}t(yd,"hasOwnProperty",(function(){return xd})),t(yd,"_objectKeys",(function(){return wd})),t(yd,"_deepClone",(function(){return _d})),t(yd,"isInteger",(function(){return kd})),t(yd,"escapePathComponent",(function(){return Ed})),t(yd,"unescapePathComponent",(function(){return Sd})),t(yd,"hasUndefined",(function(){return Ad}));var Dd=function(e){function t(t,n,r,i,o){var a=this.constructor,s=e.call(this,Cd(t,{name:n,index:r,operation:i,tree:o}))||this;return s.name=n,s.index=r,s.operation=i,s.tree=o,Object.setPrototypeOf(s,a.prototype),s.message=Cd(t,{name:n,index:r,operation:i,tree:o}),s}return vd(t,e),t}(Error);t(yd,"PatchError",(function(){return Dd}));var Md=yd.PatchError,Fd={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var r=e[t];return delete e[t],{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:function(e,t,n){var r=Od(n,this.path);r&&(r=yd._deepClone(r));var i=$d(n,{op:"remove",path:this.from}).removed;return $d(n,{op:"add",path:this.path,value:i}),{newDocument:n,removed:r}},copy:function(e,t,n){var r=Od(n,this.from);return $d(n,{op:"add",path:this.path,value:yd._deepClone(r)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:Rd(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},Nd={add:function(e,t,n){return yd.isInteger(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){return{newDocument:n,removed:e.splice(t,1)[0]}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:Fd.move,copy:Fd.copy,test:Fd.test,_get:Fd._get};function Od(e,t){if(""==t)return e;var n={op:"_get",path:t};return $d(e,n),n.value}function $d(e,t,n,r,i,o){if(void 0===n&&(n=!1),void 0===r&&(r=!0),void 0===i&&(i=!0),void 0===o&&(o=0),n&&("function"==typeof n?n(t,0,e,t.path):zd(t,0)),""===t.path){var a={newDocument:e};if("add"===t.op)return a.newDocument=t.value,a;if("replace"===t.op)return a.newDocument=t.value,a.removed=e,a;if("move"===t.op||"copy"===t.op)return a.newDocument=Od(e,t.from),"move"===t.op&&(a.removed=e),a;if("test"===t.op){if(a.test=Rd(e,t.value),!1===a.test)throw new Md("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return a.newDocument=e,a}if("remove"===t.op)return a.removed=e,a.newDocument=null,a;if("_get"===t.op)return t.value=e,a;if(n)throw new Md("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",o,t,e);return a}r||(e=yd._deepClone(e));var s=(t.path||"").split("/"),u=e,l=1,c=s.length,f=void 0,d=void 0,h=void 0;for(h="function"==typeof n?n:zd;;){if(d=s[l],i&&"__proto__"==d)throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&void 0===f&&(void 0===u[d]?f=s.slice(0,l).join("/"):l==c-1&&(f=t.path),void 0!==f&&h(t,0,e,f)),l++,Array.isArray(u)){if("-"===d)d=u.length;else{if(n&&!yd.isInteger(d))throw new Md("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",o,t,e);yd.isInteger(d)&&(d=~~d)}if(l>=c){if(n&&"add"===t.op&&d>u.length)throw new Md("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",o,t,e);if(!1===(a=Nd[t.op].call(t,u,d,e)).test)throw new Md("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return a}}else if(d&&-1!=d.indexOf("~")&&(d=yd.unescapePathComponent(d)),l>=c){if(!1===(a=Fd[t.op].call(t,u,d,e)).test)throw new Md("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return a}u=u[d]}}function Td(e,t,n,r,i){if(void 0===r&&(r=!0),void 0===i&&(i=!0),n&&!Array.isArray(t))throw new Md("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(e=yd._deepClone(e));for(var o=new Array(t.length),a=0,s=t.length;a<s;a++)o[a]=$d(e,t[a],n,!0,i,a),e=o[a].newDocument;return o.newDocument=e,o}function zd(e,t,n,r){if("object"!=typeof e||null===e||Array.isArray(e))throw new Md("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(!Fd[e.op])throw new Md("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n);if("string"!=typeof e.path)throw new Md("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(0!==e.path.indexOf("/")&&e.path.length>0)throw new Md('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if(("move"===e.op||"copy"===e.op)&&"string"!=typeof e.from)throw new Md("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&void 0===e.value)throw new Md("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&yd.hasUndefined(e.value))throw new Md("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n)if("add"==e.op){var i=e.path.split("/").length,o=r.split("/").length;if(i!==o+1&&i!==o)throw new Md("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==r)throw new Md("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if("move"===e.op||"copy"===e.op){var a=function(e,t,n){try{if(!Array.isArray(e))throw new Md("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)Td(yd._deepClone(t),yd._deepClone(e),n||!0);else{n=n||zd;for(var r=0;r<e.length;r++)n(e[r],r,t,void 0)}}catch(e){if(e instanceof Md)return e;throw e}}([{op:"_get",path:e.from,value:void 0}],n);if(a&&"OPERATION_PATH_UNRESOLVABLE"===a.name)throw new Md("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}function Rd(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var n,r,i,o=Array.isArray(e),a=Array.isArray(t);if(o&&a){if((r=e.length)!=t.length)return!1;for(n=r;0!=n--;)if(!Rd(e[n],t[n]))return!1;return!0}if(o!=a)return!1;var s=Object.keys(e);if((r=s.length)!==Object.keys(t).length)return!1;for(n=r;0!=n--;)if(!t.hasOwnProperty(s[n]))return!1;for(n=r;0!=n--;)if(!Rd(e[i=s[n]],t[i]))return!1;return!0}return e!=e&&t!=t}new WeakMap;Object.assign({},B0,B0,{JsonPatchError:yd.PatchError,deepClone:yd._deepClone,escapePathComponent:yd.escapePathComponent,unescapePathComponent:yd.unescapePathComponent});var Pd,Ld,Bd,Id,jd=/("(?:[^\\"]|\\.)*")|[:,]/g,Ud=e((function(e,t){var n,r,i;return t=t||{},n=JSON.stringify([1],void 0,void 0===t.indent?2:t.indent).slice(2,-3),r=""===n?1/0:void 0===t.maxLength?80:t.maxLength,i=t.replacer,function e(t,o,a){var s,u,l,c,f,d,h,p,m,g,y,v;if(t&&"function"==typeof t.toJSON&&(t=t.toJSON()),void 0===(y=JSON.stringify(t,i)))return y;if(h=r-o.length-a,y.length<=h&&(m=y.replace(jd,(function(e,t){return t||e+" "}))).length<=h)return m;if(null!=i&&(t=JSON.parse(y),i=void 0),"object"==typeof t&&null!==t){if(p=o+n,l=[],u=0,Array.isArray(t))for(g="[",s="]",h=t.length;u<h;u++)l.push(e(t[u],p,u===h-1?0:1)||"null");else for(g="{",s="}",h=(d=Object.keys(t)).length;u<h;u++)c=d[u],f=JSON.stringify(c)+": ",void 0!==(v=e(t[c],p,f.length+(u===h-1?0:1)))&&l.push(f+v);if(l.length>0)return[g,n+l.join(",\n"+p),s].join("\n"+o)}return y}(e,"",0)})),qd={},Wd={};const Hd=Number.MAX_SAFE_INTEGER||9007199254740991;Id={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:Hd,MAX_SAFE_COMPONENT_LENGTH:16};var Vd,Gd,Yd,Xd={};function Qd(){throw new Error("setTimeout has not been defined")}function Jd(){throw new Error("clearTimeout has not been defined")}function Kd(e){if(Gd===setTimeout)return setTimeout(e,0);if((Gd===Qd||!Gd)&&setTimeout)return Gd=setTimeout,setTimeout(e,0);try{return Gd(e,0)}catch(t){try{return Gd.call(null,e,0)}catch(t){return Gd.call(this,e,0)}}}!function(){try{Gd="function"==typeof setTimeout?setTimeout:Qd}catch(e){Gd=Qd}try{Yd="function"==typeof clearTimeout?clearTimeout:Jd}catch(e){Yd=Jd}}();var Zd,eh=[],th=!1,nh=-1;function rh(){th&&Zd&&(th=!1,Zd.length?eh=Zd.concat(eh):nh=-1,eh.length&&ih())}function ih(){if(!th){var e=Kd(rh);th=!0;for(var t=eh.length;t;){for(Zd=eh,eh=[];++nh<t;)Zd&&Zd[nh].run();nh=-1,t=eh.length}Zd=null,th=!1,function(e){if(Yd===clearTimeout)return clearTimeout(e);if((Yd===Jd||!Yd)&&clearTimeout)return Yd=clearTimeout,clearTimeout(e);try{Yd(e)}catch(t){try{return Yd.call(null,e)}catch(t){return Yd.call(this,e)}}}(e)}}function oh(e,t){this.fun=e,this.array=t}function ah(){}Xd.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];eh.push(new oh(e,t)),1!==eh.length||th||Kd(ih)},oh.prototype.run=function(){this.fun.apply(null,this.array)},Xd.title="browser",Xd.browser=!0,Xd.env={},Xd.argv=[],Xd.version="",Xd.versions={},Xd.on=ah,Xd.addListener=ah,Xd.once=ah,Xd.off=ah,Xd.removeListener=ah,Xd.removeAllListeners=ah,Xd.emit=ah,Xd.prependListener=ah,Xd.prependOnceListener=ah,Xd.listeners=function(e){return[]},Xd.binding=function(e){throw new Error("process.binding is not supported")},Xd.cwd=function(){return"/"},Xd.chdir=function(e){throw new Error("process.chdir is not supported")},Xd.umask=function(){return 0};const sh=Vd=()=>{};Wd={};const uh=(Pd=[],Wd.re=Pd),lh=(Ld=[],Wd.src=Ld),ch=(Bd={},Wd.t=Bd);let fh=0;const dh=(e,t,n)=>{const r=fh++;sh(r,t),ch[e]=r,lh[r]=t,uh[r]=new RegExp(t,n?"g":void 0)};dh("NUMERICIDENTIFIER","0|[1-9]\\d*"),dh("NUMERICIDENTIFIERLOOSE","[0-9]+"),dh("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),dh("MAINVERSION",`(${lh[ch.NUMERICIDENTIFIER]})\\.(${lh[ch.NUMERICIDENTIFIER]})\\.(${lh[ch.NUMERICIDENTIFIER]})`),dh("MAINVERSIONLOOSE",`(${lh[ch.NUMERICIDENTIFIERLOOSE]})\\.(${lh[ch.NUMERICIDENTIFIERLOOSE]})\\.(${lh[ch.NUMERICIDENTIFIERLOOSE]})`),dh("PRERELEASEIDENTIFIER",`(?:${lh[ch.NUMERICIDENTIFIER]}|${lh[ch.NONNUMERICIDENTIFIER]})`),dh("PRERELEASEIDENTIFIERLOOSE",`(?:${lh[ch.NUMERICIDENTIFIERLOOSE]}|${lh[ch.NONNUMERICIDENTIFIER]})`),dh("PRERELEASE",`(?:-(${lh[ch.PRERELEASEIDENTIFIER]}(?:\\.${lh[ch.PRERELEASEIDENTIFIER]})*))`),dh("PRERELEASELOOSE",`(?:-?(${lh[ch.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${lh[ch.PRERELEASEIDENTIFIERLOOSE]})*))`),dh("BUILDIDENTIFIER","[0-9A-Za-z-]+"),dh("BUILD",`(?:\\+(${lh[ch.BUILDIDENTIFIER]}(?:\\.${lh[ch.BUILDIDENTIFIER]})*))`),dh("FULLPLAIN",`v?${lh[ch.MAINVERSION]}${lh[ch.PRERELEASE]}?${lh[ch.BUILD]}?`),dh("FULL",`^${lh[ch.FULLPLAIN]}$`),dh("LOOSEPLAIN",`[v=\\s]*${lh[ch.MAINVERSIONLOOSE]}${lh[ch.PRERELEASELOOSE]}?${lh[ch.BUILD]}?`),dh("LOOSE",`^${lh[ch.LOOSEPLAIN]}$`),dh("GTLT","((?:<|>)?=?)"),dh("XRANGEIDENTIFIERLOOSE",`${lh[ch.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),dh("XRANGEIDENTIFIER",`${lh[ch.NUMERICIDENTIFIER]}|x|X|\\*`),dh("XRANGEPLAIN",`[v=\\s]*(${lh[ch.XRANGEIDENTIFIER]})(?:\\.(${lh[ch.XRANGEIDENTIFIER]})(?:\\.(${lh[ch.XRANGEIDENTIFIER]})(?:${lh[ch.PRERELEASE]})?${lh[ch.BUILD]}?)?)?`),dh("XRANGEPLAINLOOSE",`[v=\\s]*(${lh[ch.XRANGEIDENTIFIERLOOSE]})(?:\\.(${lh[ch.XRANGEIDENTIFIERLOOSE]})(?:\\.(${lh[ch.XRANGEIDENTIFIERLOOSE]})(?:${lh[ch.PRERELEASELOOSE]})?${lh[ch.BUILD]}?)?)?`),dh("XRANGE",`^${lh[ch.GTLT]}\\s*${lh[ch.XRANGEPLAIN]}$`),dh("XRANGELOOSE",`^${lh[ch.GTLT]}\\s*${lh[ch.XRANGEPLAINLOOSE]}$`),dh("COERCE",`(^|[^\\d])(\\d{1,${Id.MAX_SAFE_COMPONENT_LENGTH}})(?:\\.(\\d{1,${Id.MAX_SAFE_COMPONENT_LENGTH}}))?(?:\\.(\\d{1,${Id.MAX_SAFE_COMPONENT_LENGTH}}))?(?:$|[^\\d])`),dh("COERCERTL",lh[ch.COERCE],!0),dh("LONETILDE","(?:~>?)"),dh("TILDETRIM",`(\\s*)${lh[ch.LONETILDE]}\\s+`,!0);Wd.tildeTrimReplace="$1~",dh("TILDE",`^${lh[ch.LONETILDE]}${lh[ch.XRANGEPLAIN]}$`),dh("TILDELOOSE",`^${lh[ch.LONETILDE]}${lh[ch.XRANGEPLAINLOOSE]}$`),dh("LONECARET","(?:\\^)"),dh("CARETTRIM",`(\\s*)${lh[ch.LONECARET]}\\s+`,!0);Wd.caretTrimReplace="$1^",dh("CARET",`^${lh[ch.LONECARET]}${lh[ch.XRANGEPLAIN]}$`),dh("CARETLOOSE",`^${lh[ch.LONECARET]}${lh[ch.XRANGEPLAINLOOSE]}$`),dh("COMPARATORLOOSE",`^${lh[ch.GTLT]}\\s*(${lh[ch.LOOSEPLAIN]})$|^$`),dh("COMPARATOR",`^${lh[ch.GTLT]}\\s*(${lh[ch.FULLPLAIN]})$|^$`),dh("COMPARATORTRIM",`(\\s*)${lh[ch.GTLT]}\\s*(${lh[ch.LOOSEPLAIN]}|${lh[ch.XRANGEPLAIN]})`,!0);Wd.comparatorTrimReplace="$1$2$3",dh("HYPHENRANGE",`^\\s*(${lh[ch.XRANGEPLAIN]})\\s+-\\s+(${lh[ch.XRANGEPLAIN]})\\s*$`),dh("HYPHENRANGELOOSE",`^\\s*(${lh[ch.XRANGEPLAINLOOSE]})\\s+-\\s+(${lh[ch.XRANGEPLAINLOOSE]})\\s*$`),dh("STAR","(<|>)?=?\\s*\\*"),dh("GTE0","^\\s*>=\\s*0.0.0\\s*$"),dh("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$");var hh;const ph=Vd;var mh;const gh=["includePrerelease","loose","rtl"],yh=mh=e=>e?"object"!=typeof e?{loose:!0}:gh.filter((t=>e[t])).reduce(((e,t)=>(e[t]=!0,e)),{}):{};var vh;const bh=/^[0-9]+$/,xh=(e,t)=>{const n=bh.test(e),r=bh.test(t);return n&&r&&(e=+e,t=+t),e===t?0:n&&!r?-1:r&&!n?1:e<t?-1:1};vh={compareIdentifiers:xh,rcompareIdentifiers:(e,t)=>xh(t,e)};class wh{constructor(e,t){if(t=yh(t),e instanceof wh){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid Version: ${e}`);if(e.length>Id.MAX_LENGTH)throw new TypeError(`version is longer than ${Id.MAX_LENGTH} characters`);ph("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const n=e.trim().match(t.loose?Wd.re[Wd.t.LOOSE]:Wd.re[Wd.t.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>Id.MAX_SAFE_INTEGER||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Id.MAX_SAFE_INTEGER||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Id.MAX_SAFE_INTEGER||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<Id.MAX_SAFE_INTEGER)return t}return e})):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(ph("SemVer.compare",this.version,this.options,e),!(e instanceof wh)){if("string"==typeof e&&e===this.version)return 0;e=new wh(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof wh||(e=new wh(e,this.options)),vh.compareIdentifiers(this.major,e.major)||vh.compareIdentifiers(this.minor,e.minor)||vh.compareIdentifiers(this.patch,e.patch)}comparePre(e){if(e instanceof wh||(e=new wh(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const n=this.prerelease[t],r=e.prerelease[t];if(ph("prerelease compare",t,n,r),void 0===n&&void 0===r)return 0;if(void 0===r)return 1;if(void 0===n)return-1;if(n!==r)return vh.compareIdentifiers(n,r)}while(++t)}compareBuild(e){e instanceof wh||(e=new wh(e,this.options));let t=0;do{const n=this.build[t],r=e.build[t];if(ph("prerelease compare",t,n,r),void 0===n&&void 0===r)return 0;if(void 0===r)return 1;if(void 0===n)return-1;if(n!==r)return vh.compareIdentifiers(n,r)}while(++t)}inc(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{let e=this.prerelease.length;for(;--e>=0;)"number"==typeof this.prerelease[e]&&(this.prerelease[e]++,e=-2);-1===e&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error(`invalid increment argument: ${e}`)}return this.format(),this.raw=this.version,this}}var _h;const kh=hh=wh,Eh=mh;var Sh;const Ah=_h=(e,t)=>{if(t=Eh(t),e instanceof kh)return e;if("string"!=typeof e)return null;if(e.length>Id.MAX_LENGTH)return null;if(!(t.loose?Wd.re[Wd.t.LOOSE]:Wd.re[Wd.t.FULL]).test(e))return null;try{return new kh(e,t)}catch(e){return null}};Sh=(e,t)=>{const n=Ah(e,t);return n?n.version:null};var Ch;const Dh=_h;Ch=(e,t)=>{const n=Dh(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null};var Mh;const Fh=hh;Mh=(e,t,n,r)=>{"string"==typeof n&&(r=n,n=void 0);try{return new Fh(e,n).inc(t,r).version}catch(e){return null}};var Nh;const Oh=_h;var $h,Th;const zh=hh,Rh=Th=(e,t,n)=>new zh(e,n).compare(new zh(t,n)),Ph=$h=(e,t,n)=>0===Rh(e,t,n);Nh=(e,t)=>{if(Ph(e,t))return null;{const n=Oh(e),r=Oh(t),i=n.prerelease.length||r.prerelease.length,o=i?"pre":"",a=i?"prerelease":"";for(const e in n)if(("major"===e||"minor"===e||"patch"===e)&&n[e]!==r[e])return o+e;return a}};var Lh;const Bh=hh;Lh=(e,t)=>new Bh(e,t).major;var Ih;const jh=hh;Ih=(e,t)=>new jh(e,t).minor;var Uh;const qh=hh;Uh=(e,t)=>new qh(e,t).patch;var Wh;const Hh=_h;Wh=(e,t)=>{const n=Hh(e,t);return n&&n.prerelease.length?n.prerelease:null};var Vh;const Gh=Th;Vh=(e,t,n)=>Gh(t,e,n);var Yh;const Xh=Th;Yh=(e,t)=>Xh(e,t,!0);var Qh;const Jh=hh;var Kh;const Zh=Qh=(e,t,n)=>{const r=new Jh(e,n),i=new Jh(t,n);return r.compare(i)||r.compareBuild(i)};Kh=(e,t)=>e.sort(((e,n)=>Zh(e,n,t)));var ep;const tp=Qh;ep=(e,t)=>e.sort(((e,n)=>tp(n,e,t)));var np;const rp=Th;var ip;const op=Th;var ap;const sp=Th;var up;const lp=Th;var cp;const fp=Th;var dp;const hp=$h,pp=ap=(e,t,n)=>0!==sp(e,t,n),mp=np=(e,t,n)=>rp(e,t,n)>0,gp=up=(e,t,n)=>lp(e,t,n)>=0,yp=ip=(e,t,n)=>op(e,t,n)<0,vp=cp=(e,t,n)=>fp(e,t,n)<=0;dp=(e,t,n,r)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e===n;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e!==n;case"":case"=":case"==":return hp(e,n,r);case"!=":return pp(e,n,r);case">":return mp(e,n,r);case">=":return gp(e,n,r);case"<":return yp(e,n,r);case"<=":return vp(e,n,r);default:throw new TypeError(`Invalid operator: ${t}`)}};var bp;const xp=hh,wp=_h;bp=(e,t)=>{if(e instanceof xp)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let n=null;if((t=t||{}).rtl){let t;for(;(t=Wd.re[Wd.t.COERCERTL].exec(e))&&(!n||n.index+n[0].length!==e.length);)n&&t.index+t[0].length===n.index+n[0].length||(n=t),Wd.re[Wd.t.COERCERTL].lastIndex=t.index+t[1].length+t[2].length;Wd.re[Wd.t.COERCERTL].lastIndex=-1}else n=e.match(Wd.re[Wd.t.COERCE]);return null===n?null:wp(`${n[2]}.${n[3]||"0"}.${n[4]||"0"}`,t)};var _p;const kp=Symbol("SemVer ANY");class Ep{static get ANY(){return kp}constructor(e,t){if(t=Sp(t),e instanceof Ep){if(e.loose===!!t.loose)return e;e=e.value}Cp("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===kp?this.value="":this.value=this.operator+this.semver.version,Cp("comp",this)}parse(e){const t=this.options.loose?Wd.re[Wd.t.COMPARATORLOOSE]:Wd.re[Wd.t.COMPARATOR],n=e.match(t);if(!n)throw new TypeError(`Invalid comparator: ${e}`);this.operator=void 0!==n[1]?n[1]:"","="===this.operator&&(this.operator=""),n[2]?this.semver=new Dp(n[2],this.options.loose):this.semver=kp}toString(){return this.value}test(e){if(Cp("Comparator.test",e,this.options.loose),this.semver===kp||e===kp)return!0;if("string"==typeof e)try{e=new Dp(e,this.options)}catch(e){return!1}return Ap(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof Ep))throw new TypeError("a Comparator is required");if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),""===this.operator)return""===this.value||new km(e.value,t).test(this.value);if(""===e.operator)return""===e.value||new km(this.value,t).test(e.semver);const n=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),r=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),i=this.semver.version===e.semver.version,o=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),a=Ap(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),s=Ap(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return n||r||i&&o||a||s}}_p=Ep;const Sp=mh,Ap=dp,Cp=Vd,Dp=hh;var Mp;class Fp{constructor(e,t){if(t=im(t),e instanceof Fp)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new Fp(e.raw,t);if(e instanceof om)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map((e=>this.parseRange(e.trim()))).filter((e=>e.length)),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${e}`);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter((e=>!um(e[0]))),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&lm(e[0])){this.set=[e];break}}this.format()}format(){return this.range=this.set.map((e=>e.join(" ").trim())).join("||").trim(),this.range}toString(){return this.range}parseRange(e){e=e.trim();const t=`parseRange:${Object.keys(this.options).join(",")}:${e}`,n=rm.get(t);if(n)return n;const r=this.options.loose,i=r?Wd.re[Wd.t.HYPHENRANGELOOSE]:Wd.re[Wd.t.HYPHENRANGE];e=e.replace(i,wm(this.options.includePrerelease)),am("hyphen replace",e),e=e.replace(Wd.re[Wd.t.COMPARATORTRIM],Wd.comparatorTrimReplace),am("comparator trim",e,Wd.re[Wd.t.COMPARATORTRIM]),e=(e=(e=e.replace(Wd.re[Wd.t.TILDETRIM],Wd.tildeTrimReplace)).replace(Wd.re[Wd.t.CARETTRIM],Wd.caretTrimReplace)).split(/\s+/).join(" ");const o=r?Wd.re[Wd.t.COMPARATORLOOSE]:Wd.re[Wd.t.COMPARATOR],a=e.split(" ").map((e=>fm(e,this.options))).join(" ").split(/\s+/).map((e=>xm(e,this.options))).filter(this.options.loose?e=>!!e.match(o):()=>!0).map((e=>new om(e,this.options))),s=(a.length,new Map);for(const e of a){if(um(e))return[e];s.set(e.value,e)}s.size>1&&s.has("")&&s.delete("");const u=[...s.values()];return rm.set(t,u),u}intersects(e,t){if(!(e instanceof Fp))throw new TypeError("a Range is required");return this.set.some((n=>cm(n,t)&&e.set.some((e=>cm(e,t)&&n.every((n=>e.every((e=>n.intersects(e,t)))))))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new sm(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(_m(this.set[t],e,this.options))return!0;return!1}}Mp=Fp;var Np,Op=!1;var $p;function Tp(e){var t=this;if(t instanceof Tp||(t=new Tp),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach((function(e){t.push(e)}));else if(arguments.length>0)for(var n=0,r=arguments.length;n<r;n++)t.push(arguments[n]);return t}function zp(e,t,n){var r=t===e.head?new Lp(n,null,t,e):new Lp(n,t,t.next,e);return null===r.next&&(e.tail=r),null===r.prev&&(e.head=r),e.length++,r}function Rp(e,t){e.tail=new Lp(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function Pp(e,t){e.head=new Lp(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function Lp(e,t,n,r){if(!(this instanceof Lp))return new Lp(e,t,n,r);this.list=r,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}$p=Tp,Tp.Node=Lp,Tp.create=Tp,Tp.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t},Tp.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},Tp.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},Tp.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)Rp(this,arguments[e]);return this.length},Tp.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)Pp(this,arguments[e]);return this.length},Tp.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},Tp.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},Tp.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,r=0;null!==n;r++)e.call(t,n.value,r,this),n=n.next},Tp.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,r=this.length-1;null!==n;r--)e.call(t,n.value,r,this),n=n.prev},Tp.prototype.get=function(e){for(var t=0,n=this.head;null!==n&&t<e;t++)n=n.next;if(t===e&&null!==n)return n.value},Tp.prototype.getReverse=function(e){for(var t=0,n=this.tail;null!==n&&t<e;t++)n=n.prev;if(t===e&&null!==n)return n.value},Tp.prototype.map=function(e,t){t=t||this;for(var n=new Tp,r=this.head;null!==r;)n.push(e.call(t,r.value,this)),r=r.next;return n},Tp.prototype.mapReverse=function(e,t){t=t||this;for(var n=new Tp,r=this.tail;null!==r;)n.push(e.call(t,r.value,this)),r=r.prev;return n},Tp.prototype.reduce=function(e,t){var n,r=this.head;if(arguments.length>1)n=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");r=this.head.next,n=this.head.value}for(var i=0;null!==r;i++)n=e(n,r.value,i),r=r.next;return n},Tp.prototype.reduceReverse=function(e,t){var n,r=this.tail;if(arguments.length>1)n=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");r=this.tail.prev,n=this.tail.value}for(var i=this.length-1;null!==r;i--)n=e(n,r.value,i),r=r.prev;return n},Tp.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;null!==n;t++)e[t]=n.value,n=n.next;return e},Tp.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;null!==n;t++)e[t]=n.value,n=n.prev;return e},Tp.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new Tp;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=0,i=this.head;null!==i&&r<e;r++)i=i.next;for(;null!==i&&r<t;r++,i=i.next)n.push(i.value);return n},Tp.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new Tp;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=this.length,i=this.tail;null!==i&&r>t;r--)i=i.prev;for(;null!==i&&r>e;r--,i=i.prev)n.push(i.value);return n},Tp.prototype.splice=function(e,t,...n){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var r=0,i=this.head;null!==i&&r<e;r++)i=i.next;var o=[];for(r=0;i&&r<t;r++)o.push(i.value),i=this.removeNode(i);null===i&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(r=0;r<n.length;r++)i=zp(this,i,n[r]);return o},Tp.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;null!==n;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=t,this.tail=e,this};try{(Op||(Op=!0,Np={},Np=function(e){e.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}),Np)(Tp)}catch(e){}const Bp=$p,Ip=Symbol("max"),jp=Symbol("length"),Up=Symbol("lengthCalculator"),qp=Symbol("allowStale"),Wp=Symbol("maxAge"),Hp=Symbol("dispose"),Vp=Symbol("noDisposeOnSet"),Gp=Symbol("lruList"),Yp=Symbol("cache"),Xp=Symbol("updateAgeOnGet"),Qp=()=>1;const Jp=(e,t,n)=>{const r=e[Yp].get(t);if(r){const t=r.value;if(Kp(e,t)){if(em(e,r),!e[qp])return}else n&&(e[Xp]&&(r.value.now=Date.now()),e[Gp].unshiftNode(r));return t.value}},Kp=(e,t)=>{if(!t||!t.maxAge&&!e[Wp])return!1;const n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[Wp]&&n>e[Wp]},Zp=e=>{if(e[jp]>e[Ip])for(let t=e[Gp].tail;e[jp]>e[Ip]&&null!==t;){const n=t.prev;em(e,t),t=n}},em=(e,t)=>{if(t){const n=t.value;e[Hp]&&e[Hp](n.key,n.value),e[jp]-=n.length,e[Yp].delete(n.key),e[Gp].removeNode(t)}};class tm{constructor(e,t,n,r,i){this.key=e,this.value=t,this.length=n,this.now=r,this.maxAge=i||0}}const nm=(e,t,n,r)=>{let i=n.value;Kp(e,i)&&(em(e,n),e[qp]||(i=void 0)),i&&t.call(r,i.value,i.key,e)},rm=new class{constructor(e){if("number"==typeof e&&(e={max:e}),e||(e={}),e.max&&("number"!=typeof e.max||e.max<0))throw new TypeError("max must be a non-negative number");this[Ip]=e.max||1/0;const t=e.length||Qp;if(this[Up]="function"!=typeof t?Qp:t,this[qp]=e.stale||!1,e.maxAge&&"number"!=typeof e.maxAge)throw new TypeError("maxAge must be a number");this[Wp]=e.maxAge||0,this[Hp]=e.dispose,this[Vp]=e.noDisposeOnSet||!1,this[Xp]=e.updateAgeOnGet||!1,this.reset()}set max(e){if("number"!=typeof e||e<0)throw new TypeError("max must be a non-negative number");this[Ip]=e||1/0,Zp(this)}get max(){return this[Ip]}set allowStale(e){this[qp]=!!e}get allowStale(){return this[qp]}set maxAge(e){if("number"!=typeof e)throw new TypeError("maxAge must be a non-negative number");this[Wp]=e,Zp(this)}get maxAge(){return this[Wp]}set lengthCalculator(e){"function"!=typeof e&&(e=Qp),e!==this[Up]&&(this[Up]=e,this[jp]=0,this[Gp].forEach((e=>{e.length=this[Up](e.value,e.key),this[jp]+=e.length}))),Zp(this)}get lengthCalculator(){return this[Up]}get length(){return this[jp]}get itemCount(){return this[Gp].length}rforEach(e,t){t=t||this;for(let n=this[Gp].tail;null!==n;){const r=n.prev;nm(this,e,n,t),n=r}}forEach(e,t){t=t||this;for(let n=this[Gp].head;null!==n;){const r=n.next;nm(this,e,n,t),n=r}}keys(){return this[Gp].toArray().map((e=>e.key))}values(){return this[Gp].toArray().map((e=>e.value))}reset(){this[Hp]&&this[Gp]&&this[Gp].length&&this[Gp].forEach((e=>this[Hp](e.key,e.value))),this[Yp]=new Map,this[Gp]=new Bp,this[jp]=0}dump(){return this[Gp].map((e=>!Kp(this,e)&&{k:e.key,v:e.value,e:e.now+(e.maxAge||0)})).toArray().filter((e=>e))}dumpLru(){return this[Gp]}set(e,t,n){if((n=n||this[Wp])&&"number"!=typeof n)throw new TypeError("maxAge must be a number");const r=n?Date.now():0,i=this[Up](t,e);if(this[Yp].has(e)){if(i>this[Ip])return em(this,this[Yp].get(e)),!1;const o=this[Yp].get(e).value;return this[Hp]&&(this[Vp]||this[Hp](e,o.value)),o.now=r,o.maxAge=n,o.value=t,this[jp]+=i-o.length,o.length=i,this.get(e),Zp(this),!0}const o=new tm(e,t,i,r,n);return o.length>this[Ip]?(this[Hp]&&this[Hp](e,t),!1):(this[jp]+=o.length,this[Gp].unshift(o),this[Yp].set(e,this[Gp].head),Zp(this),!0)}has(e){if(!this[Yp].has(e))return!1;const t=this[Yp].get(e).value;return!Kp(this,t)}get(e){return Jp(this,e,!0)}peek(e){return Jp(this,e,!1)}pop(){const e=this[Gp].tail;return e?(em(this,e),e.value):null}del(e){em(this,this[Yp].get(e))}load(e){this.reset();const t=Date.now();for(let n=e.length-1;n>=0;n--){const r=e[n],i=r.e||0;if(0===i)this.set(r.k,r.v);else{const e=i-t;e>0&&this.set(r.k,r.v,e)}}}prune(){this[Yp].forEach(((e,t)=>Jp(this,t,!1)))}}({max:1e3}),im=mh,om=_p,am=Vd,sm=hh,um=e=>"<0.0.0-0"===e.value,lm=e=>""===e.value,cm=(e,t)=>{let n=!0;const r=e.slice();let i=r.pop();for(;n&&r.length;)n=r.every((e=>i.intersects(e,t))),i=r.pop();return n},fm=(e,t)=>(am("comp",e,t),e=mm(e,t),am("caret",e),e=hm(e,t),am("tildes",e),e=ym(e,t),am("xrange",e),e=bm(e,t),am("stars",e),e),dm=e=>!e||"x"===e.toLowerCase()||"*"===e,hm=(e,t)=>e.trim().split(/\s+/).map((e=>pm(e,t))).join(" "),pm=(e,t)=>{const n=t.loose?Wd.re[Wd.t.TILDELOOSE]:Wd.re[Wd.t.TILDE];return e.replace(n,((t,n,r,i,o)=>{let a;return am("tilde",e,t,n,r,i,o),dm(n)?a="":dm(r)?a=`>=${n}.0.0 <${+n+1}.0.0-0`:dm(i)?a=`>=${n}.${r}.0 <${n}.${+r+1}.0-0`:o?(am("replaceTilde pr",o),a=`>=${n}.${r}.${i}-${o} <${n}.${+r+1}.0-0`):a=`>=${n}.${r}.${i} <${n}.${+r+1}.0-0`,am("tilde return",a),a}))},mm=(e,t)=>e.trim().split(/\s+/).map((e=>gm(e,t))).join(" "),gm=(e,t)=>{am("caret",e,t);const n=t.loose?Wd.re[Wd.t.CARETLOOSE]:Wd.re[Wd.t.CARET],r=t.includePrerelease?"-0":"";return e.replace(n,((t,n,i,o,a)=>{let s;return am("caret",e,t,n,i,o,a),dm(n)?s="":dm(i)?s=`>=${n}.0.0${r} <${+n+1}.0.0-0`:dm(o)?s="0"===n?`>=${n}.${i}.0${r} <${n}.${+i+1}.0-0`:`>=${n}.${i}.0${r} <${+n+1}.0.0-0`:a?(am("replaceCaret pr",a),s="0"===n?"0"===i?`>=${n}.${i}.${o}-${a} <${n}.${i}.${+o+1}-0`:`>=${n}.${i}.${o}-${a} <${n}.${+i+1}.0-0`:`>=${n}.${i}.${o}-${a} <${+n+1}.0.0-0`):(am("no pr"),s="0"===n?"0"===i?`>=${n}.${i}.${o}${r} <${n}.${i}.${+o+1}-0`:`>=${n}.${i}.${o}${r} <${n}.${+i+1}.0-0`:`>=${n}.${i}.${o} <${+n+1}.0.0-0`),am("caret return",s),s}))},ym=(e,t)=>(am("replaceXRanges",e,t),e.split(/\s+/).map((e=>vm(e,t))).join(" ")),vm=(e,t)=>{e=e.trim();const n=t.loose?Wd.re[Wd.t.XRANGELOOSE]:Wd.re[Wd.t.XRANGE];return e.replace(n,((n,r,i,o,a,s)=>{am("xRange",e,n,r,i,o,a,s);const u=dm(i),l=u||dm(o),c=l||dm(a),f=c;return"="===r&&f&&(r=""),s=t.includePrerelease?"-0":"",u?n=">"===r||"<"===r?"<0.0.0-0":"*":r&&f?(l&&(o=0),a=0,">"===r?(r=">=",l?(i=+i+1,o=0,a=0):(o=+o+1,a=0)):"<="===r&&(r="<",l?i=+i+1:o=+o+1),"<"===r&&(s="-0"),n=`${r+i}.${o}.${a}${s}`):l?n=`>=${i}.0.0${s} <${+i+1}.0.0-0`:c&&(n=`>=${i}.${o}.0${s} <${i}.${+o+1}.0-0`),am("xRange return",n),n}))},bm=(e,t)=>(am("replaceStars",e,t),e.trim().replace(Wd.re[Wd.t.STAR],"")),xm=(e,t)=>(am("replaceGTE0",e,t),e.trim().replace(Wd.re[t.includePrerelease?Wd.t.GTE0PRE:Wd.t.GTE0],"")),wm=e=>(t,n,r,i,o,a,s,u,l,c,f,d,h)=>`${n=dm(r)?"":dm(i)?`>=${r}.0.0${e?"-0":""}`:dm(o)?`>=${r}.${i}.0${e?"-0":""}`:a?`>=${n}`:`>=${n}${e?"-0":""}`} ${u=dm(l)?"":dm(c)?`<${+l+1}.0.0-0`:dm(f)?`<${l}.${+c+1}.0-0`:d?`<=${l}.${c}.${f}-${d}`:e?`<${l}.${c}.${+f+1}-0`:`<=${u}`}`.trim(),_m=(e,t,n)=>{for(let n=0;n<e.length;n++)if(!e[n].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(let n=0;n<e.length;n++)if(am(e[n].semver),e[n].semver!==om.ANY&&e[n].semver.prerelease.length>0){const r=e[n].semver;if(r.major===t.major&&r.minor===t.minor&&r.patch===t.patch)return!0}return!1}return!0},km=Mp;var Em;const Sm=Mp;Em=(e,t,n)=>{try{t=new Sm(t,n)}catch(e){return!1}return t.test(e)};var Am;const Cm=Mp;Am=(e,t)=>new Cm(e,t).set.map((e=>e.map((e=>e.value)).join(" ").trim().split(" ")));var Dm;const Mm=hh,Fm=Mp;Dm=(e,t,n)=>{let r=null,i=null,o=null;try{o=new Fm(t,n)}catch(e){return null}return e.forEach((e=>{o.test(e)&&(r&&-1!==i.compare(e)||(r=e,i=new Mm(r,n)))})),r};var Nm;const Om=hh,$m=Mp;Nm=(e,t,n)=>{let r=null,i=null,o=null;try{o=new $m(t,n)}catch(e){return null}return e.forEach((e=>{o.test(e)&&(r&&1!==i.compare(e)||(r=e,i=new Om(r,n)))})),r};var Tm;const zm=hh,Rm=Mp,Pm=np;Tm=(e,t)=>{e=new Rm(e,t);let n=new zm("0.0.0");if(e.test(n))return n;if(n=new zm("0.0.0-0"),e.test(n))return n;n=null;for(let t=0;t<e.set.length;++t){const r=e.set[t];let i=null;r.forEach((e=>{const t=new zm(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":i&&!Pm(t,i)||(i=t);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${e.operator}`)}})),!i||n&&!Pm(n,i)||(n=i)}return n&&e.test(n)?n:null};var Lm;const Bm=Mp;Lm=(e,t)=>{try{return new Bm(e,t).range||"*"}catch(e){return null}};var Im;const jm=hh,Um=_p,{ANY:qm}=Um,Wm=Mp,Hm=Em,Vm=np,Gm=ip,Ym=cp,Xm=up;var Qm;const Jm=Im=(e,t,n,r)=>{let i,o,a,s,u;switch(e=new jm(e,r),t=new Wm(t,r),n){case">":i=Vm,o=Ym,a=Gm,s=">",u=">=";break;case"<":i=Gm,o=Xm,a=Vm,s="<",u="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(Hm(e,t,r))return!1;for(let n=0;n<t.set.length;++n){const l=t.set[n];let c=null,f=null;if(l.forEach((e=>{e.semver===qm&&(e=new Um(">=0.0.0")),c=c||e,f=f||e,i(e.semver,c.semver,r)?c=e:a(e.semver,f.semver,r)&&(f=e)})),c.operator===s||c.operator===u)return!1;if((!f.operator||f.operator===s)&&o(e,f.semver))return!1;if(f.operator===u&&a(e,f.semver))return!1}return!0};Qm=(e,t,n)=>Jm(e,t,">",n);var Km;const Zm=Im;Km=(e,t,n)=>Zm(e,t,"<",n);var eg;const tg=Mp;eg=(e,t,n)=>(e=new tg(e,n),t=new tg(t,n),e.intersects(t));var ng;const rg=Em,ig=Th;ng=(e,t,n)=>{const r=[];let i=null,o=null;const a=e.sort(((e,t)=>ig(e,t,n)));for(const e of a){rg(e,t,n)?(o=e,i||(i=e)):(o&&r.push([i,o]),o=null,i=null)}i&&r.push([i,null]);const s=[];for(const[e,t]of r)e===t?s.push(e):t||e!==a[0]?t?e===a[0]?s.push(`<=${t}`):s.push(`${e} - ${t}`):s.push(`>=${e}`):s.push("*");const u=s.join(" || "),l="string"==typeof t.raw?t.raw:String(t);return u.length<l.length?u:t};var og;const ag=Mp,sg=_p,{ANY:ug}=sg,lg=Em,cg=Th,fg=(e,t,n)=>{if(e===t)return!0;if(1===e.length&&e[0].semver===ug){if(1===t.length&&t[0].semver===ug)return!0;e=n.includePrerelease?[new sg(">=0.0.0-0")]:[new sg(">=0.0.0")]}if(1===t.length&&t[0].semver===ug){if(n.includePrerelease)return!0;t=[new sg(">=0.0.0")]}const r=new Set;let i,o,a,s,u,l,c;for(const t of e)">"===t.operator||">="===t.operator?i=dg(i,t,n):"<"===t.operator||"<="===t.operator?o=hg(o,t,n):r.add(t.semver);if(r.size>1)return null;if(i&&o){if(a=cg(i.semver,o.semver,n),a>0)return null;if(0===a&&(">="!==i.operator||"<="!==o.operator))return null}for(const e of r){if(i&&!lg(e,String(i),n))return null;if(o&&!lg(e,String(o),n))return null;for(const r of t)if(!lg(e,String(r),n))return!1;return!0}let f=!(!o||n.includePrerelease||!o.semver.prerelease.length)&&o.semver,d=!(!i||n.includePrerelease||!i.semver.prerelease.length)&&i.semver;f&&1===f.prerelease.length&&"<"===o.operator&&0===f.prerelease[0]&&(f=!1);for(const e of t){if(c=c||">"===e.operator||">="===e.operator,l=l||"<"===e.operator||"<="===e.operator,i)if(d&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===d.major&&e.semver.minor===d.minor&&e.semver.patch===d.patch&&(d=!1),">"===e.operator||">="===e.operator){if(s=dg(i,e,n),s===e&&s!==i)return!1}else if(">="===i.operator&&!lg(i.semver,String(e),n))return!1;if(o)if(f&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===f.major&&e.semver.minor===f.minor&&e.semver.patch===f.patch&&(f=!1),"<"===e.operator||"<="===e.operator){if(u=hg(o,e,n),u===e&&u!==o)return!1}else if("<="===o.operator&&!lg(o.semver,String(e),n))return!1;if(!e.operator&&(o||i)&&0!==a)return!1}return!(i&&l&&!o&&0!==a)&&(!(o&&c&&!i&&0!==a)&&(!d&&!f))},dg=(e,t,n)=>{if(!e)return t;const r=cg(e.semver,t.semver,n);return r>0?e:r<0||">"===t.operator&&">="===e.operator?t:e},hg=(e,t,n)=>{if(!e)return t;const r=cg(e.semver,t.semver,n);return r<0?e:r>0||"<"===t.operator&&"<="===e.operator?t:e};og=(e,t,n={})=>{if(e===t)return!0;e=new ag(e,n),t=new ag(t,n);let r=!1;e:for(const i of e.set){for(const e of t.set){const t=fg(i,e,n);if(r=r||null!==t,t)continue e}if(r)return!1}return!0},qd={re:Wd.re,src:Wd.src,tokens:Wd.t,SEMVER_SPEC_VERSION:Id.SEMVER_SPEC_VERSION,SemVer:hh,compareIdentifiers:vh.compareIdentifiers,rcompareIdentifiers:vh.rcompareIdentifiers,parse:_h,valid:Sh,clean:Ch,inc:Mh,diff:Nh,major:Lh,minor:Ih,patch:Uh,prerelease:Wh,compare:Th,rcompare:Vh,compareLoose:Yh,compareBuild:Qh,sort:Kh,rsort:ep,gt:np,lt:ip,eq:$h,neq:ap,gte:up,lte:cp,cmp:dp,coerce:bp,Comparator:_p,Range:Mp,satisfies:Em,toComparators:Am,maxSatisfying:Dm,minSatisfying:Nm,minVersion:Tm,validRange:Lm,outside:Im,gtr:Qm,ltr:Km,intersects:eg,simplifyRange:ng,subset:og};var pg={},mg={};function gg(e,t,n){return e.fields=t||[],e.fname=n,e}function yg(e){return null==e?null:e.fname}function vg(e){return null==e?null:e.fields}function bg(e){return 1===e.length?xg(e[0]):wg(e)}const xg=e=>function(t){return t[e]},wg=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function _g(e){throw Error(e)}function kg(e){const t=[],n=e.length;let r,i,o,a=null,s=0,u="";function l(){t.push(u+e.substring(r,i)),u="",r=i+1}for(e+="",r=i=0;i<n;++i)if(o=e[i],"\\"===o)u+=e.substring(r,i),u+=e.substring(++i,++i),r=i;else if(o===a)l(),a=null,s=-1;else{if(a)continue;r===s&&'"'===o||r===s&&"'"===o?(r=i+1,a=o):"."!==o||s?"["===o?(i>r&&l(),s=r=i+1):"]"===o&&(s||_g("Access path missing open bracket: "+e),s>0&&l(),s=0,r=i+1):i>r?l():r=i+1}return s&&_g("Access path missing closing bracket: "+e),a&&_g("Access path missing closing quote: "+e),i>r&&(i++,l()),t}function Eg(e,t,n){const r=kg(e);return e=1===r.length?r[0]:e,gg((n&&n.get||bg)(r),[e],t||e)}const Sg=Eg("id"),Ag=gg((e=>e),[],"identity"),Cg=gg((()=>0),[],"zero"),Dg=gg((()=>1),[],"one"),Mg=gg((()=>!0),[],"true"),Fg=gg((()=>!1),[],"false");function Ng(e,t,n){const r=[t].concat([].slice.call(n));console[e].apply(console,r)}function Og(e,t){let n=e||0;return{level:function(e){return arguments.length?(n=+e,this):n},error:function(){return n>=1&&Ng(t||"error","ERROR",arguments),this},warn:function(){return n>=2&&Ng(t||"warn","WARN",arguments),this},info:function(){return n>=3&&Ng(t||"log","INFO",arguments),this},debug:function(){return n>=4&&Ng(t||"log","DEBUG",arguments),this}}}var $g=Array.isArray;function Tg(e){return e===Object(e)}const zg=e=>"__proto__"!==e;function Rg(...e){return e.reduce(((e,t)=>{for(const n in t)if("signals"===n)e.signals=Lg(e.signals,t.signals);else{const r="legend"===n?{layout:1}:"style"===n||null;Pg(e,n,t[n],r)}return e}),{})}function Pg(e,t,n,r){if(!zg(t))return;let i,o;if(Tg(n)&&!$g(n))for(i in o=Tg(e[t])?e[t]:e[t]={},n)r&&(!0===r||r[i])?Pg(o,i,n[i]):zg(i)&&(o[i]=n[i]);else e[t]=n}function Lg(e,t){if(null==e)return t;const n={},r=[];function i(e){n[e.name]||(n[e.name]=1,r.push(e))}return t.forEach(i),e.forEach(i),r}function Bg(e){return e[e.length-1]}function Ig(e){return null==e||""===e?null:+e}const jg=e=>t=>e*Math.exp(t),Ug=e=>t=>Math.log(e*t),qg=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),Wg=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,Hg=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function Vg(e,t,n,r){const i=n(e[0]),o=n(Bg(e)),a=(o-i)*t;return[r(i-a),r(o-a)]}function Gg(e,t){return Vg(e,t,Ig,Ag)}function Yg(e,t){var n=Math.sign(e[0]);return Vg(e,t,Ug(n),jg(n))}function Xg(e,t,n){return Vg(e,t,Hg(n),Hg(1/n))}function Qg(e,t,n){return Vg(e,t,qg(n),Wg(n))}function Jg(e,t,n,r,i){const o=r(e[0]),a=r(Bg(e)),s=null!=t?r(t):(o+a)/2;return[i(s+(o-s)*n),i(s+(a-s)*n)]}function Kg(e,t,n){return Jg(e,t,n,Ig,Ag)}function Zg(e,t,n){const r=Math.sign(e[0]);return Jg(e,t,n,Ug(r),jg(r))}function ey(e,t,n,r){return Jg(e,t,n,Hg(r),Hg(1/r))}function ty(e,t,n,r){return Jg(e,t,n,qg(r),Wg(r))}function ny(e){return 1+~~(new Date(e).getMonth()/3)}function ry(e){return 1+~~(new Date(e).getUTCMonth()/3)}function iy(e){return null!=e?$g(e)?e:[e]:[]}function oy(e,t,n){let r,i=e[0],o=e[1];return o<i&&(r=o,o=i,i=r),r=o-i,r>=n-t?[t,n]:[i=Math.min(Math.max(i,t),n-r),i+r]}function ay(e){return"function"==typeof e}function sy(e,t,n){n=n||{},t=iy(t)||[];const r=[],i=[],o={},a=n.comparator||ly;return iy(e).forEach(((e,a)=>{null!=e&&(r.push("descending"===t[a]?-1:1),i.push(e=ay(e)?e:Eg(e,null,n)),(vg(e)||[]).forEach((e=>o[e]=1)))})),0===i.length?null:gg(a(i,r),Object.keys(o))}const uy=(e,t)=>(e<t||null==e)&&null!=t?-1:(e>t||null==t)&&null!=e?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t==t?-1:t!=t&&e==e?1:0),ly=(e,t)=>1===e.length?cy(e[0],t[0]):fy(e,t,e.length),cy=(e,t)=>function(n,r){return uy(e(n),e(r))*t},fy=(e,t,n)=>(t.push(0),function(r,i){let o,a=0,s=-1;for(;0===a&&++s<n;)o=e[s],a=uy(o(r),o(i));return a*t[s]});function dy(e){return ay(e)?e:()=>e}function hy(e,t){let n;return r=>{n&&clearTimeout(n),n=setTimeout((()=>(t(r),n=null)),e)}}function py(e){for(let t,n,r=1,i=arguments.length;r<i;++r)for(n in t=arguments[r],t)e[n]=t[n];return e}function my(e,t){let n,r,i,o,a=0;if(e&&(n=e.length))if(null==t){for(r=e[a];a<n&&(null==r||r!=r);r=e[++a]);for(i=o=r;a<n;++a)r=e[a],null!=r&&(r<i&&(i=r),r>o&&(o=r))}else{for(r=t(e[a]);a<n&&(null==r||r!=r);r=t(e[++a]));for(i=o=r;a<n;++a)r=t(e[a]),null!=r&&(r<i&&(i=r),r>o&&(o=r))}return[i,o]}function gy(e,t){const n=e.length;let r,i,o,a,s,u=-1;if(null==t){for(;++u<n;)if(i=e[u],null!=i&&i>=i){r=o=i;break}if(u===n)return[-1,-1];for(a=s=u;++u<n;)i=e[u],null!=i&&(r>i&&(r=i,a=u),o<i&&(o=i,s=u))}else{for(;++u<n;)if(i=t(e[u],u,e),null!=i&&i>=i){r=o=i;break}if(u===n)return[-1,-1];for(a=s=u;++u<n;)i=t(e[u],u,e),null!=i&&(r>i&&(r=i,a=u),o<i&&(o=i,s=u))}return[a,s]}const yy=Object.prototype.hasOwnProperty;function vy(e,t){return yy.call(e,t)}const by={};function xy(e){let t,n={};function r(e){return vy(n,e)&&n[e]!==by}const i={size:0,empty:0,object:n,has:r,get:function(e){return r(e)?n[e]:void 0},set:function(e,t){return r(e)||(++i.size,n[e]===by&&--i.empty),n[e]=t,this},delete:function(e){return r(e)&&(--i.size,++i.empty,n[e]=by),this},clear:function(){i.size=i.empty=0,i.object=n={}},test:function(e){return arguments.length?(t=e,i):t},clean:function(){const e={};let r=0;for(const i in n){const o=n[i];o===by||t&&t(o)||(e[i]=o,++r)}i.size=r,i.empty=0,i.object=n=e}};return e&&Object.keys(e).forEach((t=>{i.set(t,e[t])})),i}function wy(e,t,n,r,i,o){if(!n&&0!==n)return o;const a=+n;let s,u=e[0],l=Bg(e);l<u&&(s=u,u=l,l=s),s=Math.abs(t-u);const c=Math.abs(l-t);return s<c&&s<=a?r:c<=a?i:o}function _y(e,t,n){const r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),py(r,n)}function ky(e,t,n,r){let i,o=t[0],a=t[t.length-1];return o>a&&(i=o,o=a,a=i),r=void 0===r||r,((n=void 0===n||n)?o<=e:o<e)&&(r?e<=a:e<a)}function Ey(e){return"boolean"==typeof e}function Sy(e){return"[object Date]"===Object.prototype.toString.call(e)}function Ay(e){return e&&ay(e[Symbol.iterator])}function Cy(e){return"number"==typeof e}function Dy(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function My(e){return"string"==typeof e}function Fy(e,t,n){e&&(e=t?iy(e).map((e=>e.replace(/\\(.)/g,"$1"))):iy(e));const r=e&&e.length,i=n&&n.get||bg,o=e=>i(t?[e]:kg(e));let a;if(r)if(1===r){const t=o(e[0]);a=function(e){return""+t(e)}}else{const t=e.map(o);a=function(e){let n=""+t[0](e),i=0;for(;++i<r;)n+="|"+t[i](e);return n}}else a=function(){return""};return gg(a,e,"key")}function Ny(e,t){const n=e[0],r=Bg(e),i=+t;return i?1===i?r:n+i*(r-n):n}function Oy(e){let t,n,r;e=+e||1e4;const i=()=>{t={},n={},r=0},o=(i,o)=>(++r>e&&(n=t,t={},r=1),t[i]=o);return i(),{clear:i,has:e=>vy(t,e)||vy(n,e),get:e=>vy(t,e)?t[e]:vy(n,e)?o(e,n[e]):void 0,set:(e,n)=>vy(t,e)?t[e]=n:o(e,n)}}function $y(e,t,n,r){const i=t.length,o=n.length;if(!o)return t;if(!i)return n;const a=r||new t.constructor(i+o);let s=0,u=0,l=0;for(;s<i&&u<o;++l)a[l]=e(t[s],n[u])>0?n[u++]:t[s++];for(;s<i;++s,++l)a[l]=t[s];for(;u<o;++u,++l)a[l]=n[u];return a}function Ty(e,t){let n="";for(;--t>=0;)n+=e;return n}function zy(e,t,n,r){const i=n||" ",o=e+"",a=t-o.length;return a<=0?o:"left"===r?Ty(i,a)+o:"center"===r?Ty(i,~~(a/2))+o+Ty(i,Math.ceil(a/2)):o+Ty(i,a)}function Ry(e){return e&&Bg(e)-e[0]||0}function Py(e){return $g(e)?"["+e.map(Py)+"]":Tg(e)||My(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function Ly(e){return null==e||""===e?null:!(!e||"false"===e||"0"===e)&&!!e}const By=e=>Cy(e)||Sy(e)?e:Date.parse(e);function Iy(e,t){return t=t||By,null==e||""===e?null:t(e)}function jy(e){return null==e||""===e?null:e+""}function Uy(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}function qy(e,t,n,r){const i=null!=r?r:"",o=e+"",a=o.length,s=Math.max(0,t-i.length);return a<=t?o:"left"===n?i+o.slice(a-s):"center"===n?o.slice(0,Math.ceil(s/2))+i+o.slice(a-~~(s/2)):o.slice(0,s)+i}function Wy(e,t,n){if(e)if(t){const r=e.length;for(let i=0;i<r;++i){const r=t(e[i]);r&&n(r,i,e)}}else e.forEach(n)}t(mg,"zoomSymlog",(function(){return ty})),t(mg,"zoomPow",(function(){return ey})),t(mg,"zoomLog",(function(){return Zg})),t(mg,"zoomLinear",(function(){return Kg})),t(mg,"zero",(function(){return Cg})),t(mg,"writeConfig",(function(){return Pg})),t(mg,"visitArray",(function(){return Wy})),t(mg,"utcquarter",(function(){return ry})),t(mg,"truthy",(function(){return Mg})),t(mg,"truncate",(function(){return qy})),t(mg,"toString",(function(){return jy})),t(mg,"toSet",(function(){return Uy})),t(mg,"toNumber",(function(){return Ig})),t(mg,"toDate",(function(){return Iy})),t(mg,"toBoolean",(function(){return Ly})),t(mg,"stringValue",(function(){return Py})),t(mg,"splitAccessPath",(function(){return kg})),t(mg,"span",(function(){return Ry})),t(mg,"repeat",(function(){return Ty})),t(mg,"quarter",(function(){return ny})),t(mg,"peek",(function(){return Bg})),t(mg,"panSymlog",(function(){return Qg})),t(mg,"panPow",(function(){return Xg})),t(mg,"panLog",(function(){return Yg})),t(mg,"panLinear",(function(){return Gg})),t(mg,"pad",(function(){return zy})),t(mg,"one",(function(){return Dg})),t(mg,"mergeConfig",(function(){return Rg})),t(mg,"merge",(function(){return $y})),t(mg,"lruCache",(function(){return Oy})),t(mg,"logger",(function(){return Og})),t(mg,"lerp",(function(){return Ny})),t(mg,"key",(function(){return Fy})),t(mg,"isString",(function(){return My})),t(mg,"isRegExp",(function(){return Dy})),t(mg,"isObject",(function(){return Tg})),t(mg,"isNumber",(function(){return Cy})),t(mg,"isIterable",(function(){return Ay})),t(mg,"isFunction",(function(){return ay})),t(mg,"isDate",(function(){return Sy})),t(mg,"isBoolean",(function(){return Ey})),t(mg,"isArray",(function(){return $g})),t(mg,"inrange",(function(){return ky})),t(mg,"inherits",(function(){return _y})),t(mg,"identity",(function(){return Ag})),t(mg,"id",(function(){return Sg})),t(mg,"hasOwnProperty",(function(){return vy})),t(mg,"flush",(function(){return wy})),t(mg,"field",(function(){return Eg})),t(mg,"fastmap",(function(){return xy})),t(mg,"falsy",(function(){return Fg})),t(mg,"extentIndex",(function(){return gy})),t(mg,"extent",(function(){return my})),t(mg,"extend",(function(){return py})),t(mg,"error",(function(){return _g})),t(mg,"debounce",(function(){return hy})),t(mg,"constant",(function(){return dy})),t(mg,"compare",(function(){return sy})),t(mg,"clampRange",(function(){return oy})),t(mg,"ascending",(function(){return uy})),t(mg,"array",(function(){return iy})),t(mg,"accessorName",(function(){return yg})),t(mg,"accessorFields",(function(){return vg})),t(mg,"accessor",(function(){return gg})),t(mg,"Warn",(function(){return 2})),t(mg,"None",(function(){return 0})),t(mg,"Info",(function(){return 3})),t(mg,"Error",(function(){return 1})),t(mg,"Debug",(function(){return 4})),n(pg,mg);var Hy={};const Vy=/^([A-Za-z]+:)?\/\//,Gy=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,Yy=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,Xy="file://";async function Qy(e,t){const n=await this.sanitize(e,t),r=n.href;return n.localFile?this.file(r):this.http(r,t)}async function Jy(e,t){t=py({},this.options,t);const n=this.fileAccess,r={href:null};let i,o,a;const s=Gy.test(e.replace(Yy,""));null!=e&&"string"==typeof e&&s||_g("Sanitize failure, invalid URI: "+Py(e));const u=Vy.test(e);return(a=t.baseURL)&&!u&&(e.startsWith("/")||"/"===a[a.length-1]||(e="/"+e),e=a+e),o=(i=e.startsWith(Xy))||"file"===t.mode||"http"!==t.mode&&!u&&n,i?e=e.slice(Xy.length):e.startsWith("//")&&("file"===t.defaultProtocol?(e=e.slice(2),o=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(r,"localFile",{value:!!o}),r.href=e,t.target&&(r.target=t.target+""),t.rel&&(r.rel=t.rel+""),"image"===t.context&&t.crossOrigin&&(r.crossOrigin=t.crossOrigin+""),r}function Ky(e){return e?t=>new Promise(((n,r)=>{e.readFile(t,((e,t)=>{e?r(e):n(t)}))})):Zy}async function Zy(){_g("No file system access.")}function ev(e){return e?async function(t,n){const r=py({},this.options.http,n),i=n&&n.response,o=await e(t,r);return o.ok?ay(o[i])?o[i]():o.text():_g(o.status+""+o.statusText)}:tv}async function tv(){_g("No HTTP fetch method available.")}const nv=e=>!(Number.isNaN(+e)||e instanceof Date),rv={boolean:Ly,integer:Ig,number:Ig,date:Iy,string:jy,unknown:Ag},iv=[e=>"true"===e||"false"===e||!0===e||!1===e,e=>nv(e)&&Number.isInteger(+e),nv,e=>!Number.isNaN(Date.parse(e))],ov=["boolean","integer","number","date"];function av(e,t){if(!e||!e.length)return"unknown";const n=e.length,r=iv.length,i=iv.map(((e,t)=>t+1));for(let a,s,u=0,l=0;u<n;++u)for(s=t?e[u][t]:e[u],a=0;a<r;++a)if(i[a]&&(null!=(o=s)&&o==o)&&!iv[a](s)&&(i[a]=0,++l,l===iv.length))return"string";var o;return ov[i.reduce(((e,t)=>0===e?t:e),0)-1]}function sv(e,t){return t.reduce(((t,n)=>(t[n]=av(e,n),t)),{})}function uv(e){const t=function(t,n){const r={delimiter:e};return lv(t,n?py(n,r):r)};return t.responseType="text",t}function lv(e,t){return t.header&&(e=t.header.map(Py).join(t.delimiter)+"\n"+e),ad(t.delimiter).parse(e+"")}lv.responseType="text";for(var cv=function(e){var t,n,r=vv(e),i=r[0],o=r[1],a=new pv(function(e,t,n){return 3*(t+n)/4-n}(0,i,o)),s=0,u=o>0?i-4:i;for(n=0;n<u;n+=4)t=hv[e.charCodeAt(n)]<<18|hv[e.charCodeAt(n+1)]<<12|hv[e.charCodeAt(n+2)]<<6|hv[e.charCodeAt(n+3)],a[s++]=t>>16&255,a[s++]=t>>8&255,a[s++]=255&t;2===o&&(t=hv[e.charCodeAt(n)]<<2|hv[e.charCodeAt(n+1)]>>4,a[s++]=255&t);1===o&&(t=hv[e.charCodeAt(n)]<<10|hv[e.charCodeAt(n+1)]<<4|hv[e.charCodeAt(n+2)]>>2,a[s++]=t>>8&255,a[s++]=255&t);return a},fv=function(e){for(var t,n=e.length,r=n%3,i=[],o=16383,a=0,s=n-r;a<s;a+=o)i.push(bv(e,a,a+o>s?s:a+o));1===r?(t=e[n-1],i.push(dv[t>>2]+dv[t<<4&63]+"==")):2===r&&(t=(e[n-2]<<8)+e[n-1],i.push(dv[t>>10]+dv[t>>4&63]+dv[t<<2&63]+"="));return i.join("")},dv=[],hv=[],pv="undefined"!=typeof Uint8Array?Uint8Array:Array,mv="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",gv=0,yv=mv.length;gv<yv;++gv)dv[gv]=mv[gv],hv[mv.charCodeAt(gv)]=gv;function vv(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function bv(e,t,n){for(var r,i,o=[],a=t;a<n;a+=3)r=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),o.push(dv[(i=r)>>18&63]+dv[i>>12&63]+dv[i>>6&63]+dv[63&i]);return o.join("")}hv["-".charCodeAt(0)]=62,hv["_".charCodeAt(0)]=63;var xv=function(e,t,n,r,i){var o,a,s=8*i-r-1,u=(1<<s)-1,l=u>>1,c=-7,f=n?i-1:0,d=n?-1:1,h=e[t+f];for(f+=d,o=h&(1<<-c)-1,h>>=-c,c+=s;c>0;o=256*o+e[t+f],f+=d,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=r;c>0;a=256*a+e[t+f],f+=d,c-=8);if(0===o)o=1-l;else{if(o===u)return a?NaN:1/0*(h?-1:1);a+=Math.pow(2,r),o-=l}return(h?-1:1)*a*Math.pow(2,o-r)},wv=function(e,t,n,r,i,o){var a,s,u,l=8*o-i-1,c=(1<<l)-1,f=c>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:o-1,p=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=c):(a=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-a))<1&&(a--,u*=2),(t+=a+f>=1?d/u:d*Math.pow(2,1-f))*u>=2&&(a++,u/=2),a+f>=c?(s=0,a=c):a+f>=1?(s=(t*u-1)*Math.pow(2,i),a+=f):(s=t*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;e[n+h]=255&s,h+=p,s/=256,i-=8);for(a=a<<i|s,l+=i;l>0;e[n+h]=255&a,h+=p,a/=256,l-=8);e[n+h-p]|=128*m},_v="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null,kv=Av,Ev=2147483647;function Sv(e){if(e>Ev)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,Av.prototype),t}function Av(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return Mv(e)}return Cv(e,t,n)}function Cv(e,t,n){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!Av.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var n=0|$v(e,t),r=Sv(n),i=r.write(e,t);i!==n&&(r=r.slice(0,i));return r}(e,t);if(ArrayBuffer.isView(e))return function(e){if(ob(e,Uint8Array)){var t=new Uint8Array(e);return Nv(t.buffer,t.byteOffset,t.byteLength)}return Fv(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(ob(e,ArrayBuffer)||e&&ob(e.buffer,ArrayBuffer))return Nv(e,t,n);if("undefined"!=typeof SharedArrayBuffer&&(ob(e,SharedArrayBuffer)||e&&ob(e.buffer,SharedArrayBuffer)))return Nv(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return Av.from(r,t,n);var i=function(e){if(Av.isBuffer(e)){var t=0|Ov(e.length),n=Sv(t);return 0===n.length||e.copy(n,0,0,t),n}if(void 0!==e.length)return"number"!=typeof e.length||ab(e.length)?Sv(0):Fv(e);if("Buffer"===e.type&&Array.isArray(e.data))return Fv(e.data)}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return Av.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function Dv(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function Mv(e){return Dv(e),Sv(e<0?0:0|Ov(e))}function Fv(e){for(var t=e.length<0?0:0|Ov(e.length),n=Sv(t),r=0;r<t;r+=1)n[r]=255&e[r];return n}function Nv(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');var r;return r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(r,Av.prototype),r}function Ov(e){if(e>=Ev)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Ev.toString(16)+" bytes");return 0|e}function $v(e,t){if(Av.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||ob(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return nb(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return rb(e).length;default:if(i)return r?-1:nb(e).length;t=(""+t).toLowerCase(),i=!0}}function Tv(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return Yv(this,t,n);case"utf8":case"utf-8":return Wv(this,t,n);case"ascii":return Vv(this,t,n);case"latin1":case"binary":return Gv(this,t,n);case"base64":return qv(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Xv(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function zv(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function Rv(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),ab(n=+n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=Av.from(t,r)),Av.isBuffer(t))return 0===t.length?-1:Pv(e,t,n,r,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):Pv(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function Pv(e,t,n,r,i){var o,a=1,s=e.length,u=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,s/=2,u/=2,n/=2}function l(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var c=-1;for(o=n;o<s;o++)if(l(e,o)===l(t,-1===c?0:o-c)){if(-1===c&&(c=o),o-c+1===u)return c*a}else-1!==c&&(o-=o-c),c=-1}else for(n+u>s&&(n=s-u),o=n;o>=0;o--){for(var f=!0,d=0;d<u;d++)if(l(e,o+d)!==l(t,d)){f=!1;break}if(f)return o}return-1}function Lv(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=t.length;r>o/2&&(r=o/2);for(var a=0;a<r;++a){var s=parseInt(t.substr(2*a,2),16);if(ab(s))return a;e[n+a]=s}return a}function Bv(e,t,n,r){return ib(nb(t,e.length-n),e,n,r)}function Iv(e,t,n,r){return ib(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function jv(e,t,n,r){return ib(rb(t),e,n,r)}function Uv(e,t,n,r){return ib(function(e,t){for(var n,r,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)r=(n=e.charCodeAt(a))>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function qv(e,t,n){return 0===t&&n===e.length?fv(e):fv(e.slice(t,n))}function Wv(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o,a,s,u,l=e[i],c=null,f=l>239?4:l>223?3:l>191?2:1;if(i+f<=n)switch(f){case 1:l<128&&(c=l);break;case 2:128==(192&(o=e[i+1]))&&(u=(31&l)<<6|63&o)>127&&(c=u);break;case 3:o=e[i+1],a=e[i+2],128==(192&o)&&128==(192&a)&&(u=(15&l)<<12|(63&o)<<6|63&a)>2047&&(u<55296||u>57343)&&(c=u);break;case 4:o=e[i+1],a=e[i+2],s=e[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(u=(15&l)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&u<1114112&&(c=u)}null===c?(c=65533,f=1):c>65535&&(c-=65536,r.push(c>>>10&1023|55296),c=56320|1023&c),r.push(c),i+=f}return function(e){var t=e.length;if(t<=Hv)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=Hv));return n}(r)}Av.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),Av.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(Av.prototype,"parent",{enumerable:!0,get:function(){if(Av.isBuffer(this))return this.buffer}}),Object.defineProperty(Av.prototype,"offset",{enumerable:!0,get:function(){if(Av.isBuffer(this))return this.byteOffset}}),Av.poolSize=8192,Av.from=function(e,t,n){return Cv(e,t,n)},Object.setPrototypeOf(Av.prototype,Uint8Array.prototype),Object.setPrototypeOf(Av,Uint8Array),Av.alloc=function(e,t,n){return function(e,t,n){return Dv(e),e<=0?Sv(e):void 0!==t?"string"==typeof n?Sv(e).fill(t,n):Sv(e).fill(t):Sv(e)}(e,t,n)},Av.allocUnsafe=function(e){return Mv(e)},Av.allocUnsafeSlow=function(e){return Mv(e)},Av.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==Av.prototype},Av.compare=function(e,t){if(ob(e,Uint8Array)&&(e=Av.from(e,e.offset,e.byteLength)),ob(t,Uint8Array)&&(t=Av.from(t,t.offset,t.byteLength)),!Av.isBuffer(e)||!Av.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},Av.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Av.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return Av.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=Av.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var o=e[n];if(ob(o,Uint8Array))i+o.length>r.length?Av.from(o).copy(r,i):Uint8Array.prototype.set.call(r,o,i);else{if(!Av.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,i)}i+=o.length}return r},Av.byteLength=$v,Av.prototype._isBuffer=!0,Av.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)zv(this,t,t+1);return this},Av.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)zv(this,t,t+3),zv(this,t+1,t+2);return this},Av.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)zv(this,t,t+7),zv(this,t+1,t+6),zv(this,t+2,t+5),zv(this,t+3,t+4);return this},Av.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?Wv(this,0,e):Tv.apply(this,arguments)},Av.prototype.toLocaleString=Av.prototype.toString,Av.prototype.equals=function(e){if(!Av.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===Av.compare(this,e)},Av.prototype.inspect=function(){var e="";return e=this.toString("hex",0,50).replace(/(.{2})/g,"$1 ").trim(),this.length>50&&(e+=" ... "),"<Buffer "+e+">"},_v&&(Av.prototype[_v]=Av.prototype.inspect),Av.prototype.compare=function(e,t,n,r,i){if(ob(e,Uint8Array)&&(e=Av.from(e,e.offset,e.byteLength)),!Av.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0),s=Math.min(o,a),u=this.slice(r,i),l=e.slice(t,n),c=0;c<s;++c)if(u[c]!==l[c]){o=u[c],a=l[c];break}return o<a?-1:a<o?1:0},Av.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},Av.prototype.indexOf=function(e,t,n){return Rv(this,e,t,n,!0)},Av.prototype.lastIndexOf=function(e,t,n){return Rv(this,e,t,n,!1)},Av.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return Lv(this,e,t,n);case"utf8":case"utf-8":return Bv(this,e,t,n);case"ascii":case"latin1":case"binary":return Iv(this,e,t,n);case"base64":return jv(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Uv(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},Av.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Hv=4096;function Vv(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function Gv(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function Yv(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=t;o<n;++o)i+=sb[e[o]];return i}function Xv(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length-1;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function Qv(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function Jv(e,t,n,r,i,o){if(!Av.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function Kv(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function Zv(e,t,n,r,i){return t=+t,n>>>=0,i||Kv(e,0,n,4),wv(e,t,n,r,23,4),n+4}function eb(e,t,n,r,i){return t=+t,n>>>=0,i||Kv(e,0,n,8),wv(e,t,n,r,52,8),n+8}Av.prototype.slice=function(e,t){var n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var r=this.subarray(e,t);return Object.setPrototypeOf(r,Av.prototype),r},Av.prototype.readUintLE=Av.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||Qv(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},Av.prototype.readUintBE=Av.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||Qv(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},Av.prototype.readUint8=Av.prototype.readUInt8=function(e,t){return e>>>=0,t||Qv(e,1,this.length),this[e]},Av.prototype.readUint16LE=Av.prototype.readUInt16LE=function(e,t){return e>>>=0,t||Qv(e,2,this.length),this[e]|this[e+1]<<8},Av.prototype.readUint16BE=Av.prototype.readUInt16BE=function(e,t){return e>>>=0,t||Qv(e,2,this.length),this[e]<<8|this[e+1]},Av.prototype.readUint32LE=Av.prototype.readUInt32LE=function(e,t){return e>>>=0,t||Qv(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},Av.prototype.readUint32BE=Av.prototype.readUInt32BE=function(e,t){return e>>>=0,t||Qv(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},Av.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||Qv(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},Av.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||Qv(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},Av.prototype.readInt8=function(e,t){return e>>>=0,t||Qv(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},Av.prototype.readInt16LE=function(e,t){e>>>=0,t||Qv(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},Av.prototype.readInt16BE=function(e,t){e>>>=0,t||Qv(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},Av.prototype.readInt32LE=function(e,t){return e>>>=0,t||Qv(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},Av.prototype.readInt32BE=function(e,t){return e>>>=0,t||Qv(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},Av.prototype.readFloatLE=function(e,t){return e>>>=0,t||Qv(e,4,this.length),xv(this,e,!0,23,4)},Av.prototype.readFloatBE=function(e,t){return e>>>=0,t||Qv(e,4,this.length),xv(this,e,!1,23,4)},Av.prototype.readDoubleLE=function(e,t){return e>>>=0,t||Qv(e,8,this.length),xv(this,e,!0,52,8)},Av.prototype.readDoubleBE=function(e,t){return e>>>=0,t||Qv(e,8,this.length),xv(this,e,!1,52,8)},Av.prototype.writeUintLE=Av.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t>>>=0,n>>>=0,r)||Jv(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},Av.prototype.writeUintBE=Av.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t>>>=0,n>>>=0,r)||Jv(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},Av.prototype.writeUint8=Av.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||Jv(this,e,t,1,255,0),this[t]=255&e,t+1},Av.prototype.writeUint16LE=Av.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||Jv(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},Av.prototype.writeUint16BE=Av.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||Jv(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},Av.prototype.writeUint32LE=Av.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||Jv(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},Av.prototype.writeUint32BE=Av.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||Jv(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},Av.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var i=Math.pow(2,8*n-1);Jv(this,e,t,n,i-1,-i)}var o=0,a=1,s=0;for(this[t]=255&e;++o<n&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},Av.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var i=Math.pow(2,8*n-1);Jv(this,e,t,n,i-1,-i)}var o=n-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},Av.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||Jv(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},Av.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||Jv(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},Av.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||Jv(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},Av.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||Jv(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},Av.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||Jv(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},Av.prototype.writeFloatLE=function(e,t,n){return Zv(this,e,t,!0,n)},Av.prototype.writeFloatBE=function(e,t,n){return Zv(this,e,t,!1,n)},Av.prototype.writeDoubleLE=function(e,t,n){return eb(this,e,t,!0,n)},Av.prototype.writeDoubleBE=function(e,t,n){return eb(this,e,t,!1,n)},Av.prototype.copy=function(e,t,n,r){if(!Av.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i=r-n;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,r):Uint8Array.prototype.set.call(e,this.subarray(n,r),t),i},Av.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!Av.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){var i=e.charCodeAt(0);("utf8"===r&&i<128||"latin1"===r)&&(e=i)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(o=t;o<n;++o)this[o]=e;else{var a=Av.isBuffer(e)?e:Av.from(e,r),s=a.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<n-t;++o)this[o+t]=a[o%s]}return this};var tb=/[^+/0-9A-Za-z-_]/g;function nb(e,t){var n;t=t||1/0;for(var r=e.length,i=null,o=[],a=0;a<r;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function rb(e){return cv(function(e){if((e=(e=e.split("=")[0]).trim().replace(tb,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function ib(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function ob(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function ab(e){return e!=e}var sb=function(){for(var e="0123456789abcdef",t=new Array(256),n=0;n<16;++n)for(var r=16*n,i=0;i<16;++i)t[r+i]=e[n]+e[i];return t}(),ub=kv;function lb(e,t){const n=t&&t.property?Eg(t.property):Ag;return!Tg(e)||(r=e,"function"==typeof ub&&ay(ub.isBuffer)&&ub.isBuffer(r))?n(JSON.parse(e)):function(e,t){!$g(e)&&Ay(e)&&(e=[...e]);return t&&t.copy?JSON.parse(JSON.stringify(e)):e}(n(e),t);var r}lb.responseType="json";var cb=function(e){return e},fb=function(e){if(null==e)return cb;var t,n,r=e.scale[0],i=e.scale[1],o=e.translate[0],a=e.translate[1];return function(e,s){s||(t=n=0);var u=2,l=e.length,c=new Array(l);for(c[0]=(t+=e[0])*r+o,c[1]=(n+=e[1])*i+a;u<l;)c[u]=e[u],++u;return c}},db=function(e,t){return"string"==typeof t&&(t=e.objects[t]),"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map((function(t){return hb(e,t)}))}:hb(e,t)};function hb(e,t){var n=t.id,r=t.bbox,i=null==t.properties?{}:t.properties,o=pb(e,t);return null==n&&null==r?{type:"Feature",properties:i,geometry:o}:null==r?{type:"Feature",id:n,properties:i,geometry:o}:{type:"Feature",id:n,bbox:r,properties:i,geometry:o}}function pb(e,t){var n=fb(e.transform),r=e.arcs;function i(e,t){t.length&&t.pop();for(var i=r[e<0?~e:e],o=0,a=i.length;o<a;++o)t.push(n(i[o],o));e<0&&function(e,t){for(var n,r=e.length,i=r-t;i<--r;)n=e[i],e[i++]=e[r],e[r]=n}(t,a)}function o(e){return n(e)}function a(e){for(var t=[],n=0,r=e.length;n<r;++n)i(e[n],t);return t.length<2&&t.push(t[0]),t}function s(e){for(var t=a(e);t.length<4;)t.push(t[0]);return t}function u(e){return e.map(s)}return function e(t){var n,r=t.type;switch(r){case"GeometryCollection":return{type:r,geometries:t.geometries.map(e)};case"Point":n=o(t.coordinates);break;case"MultiPoint":n=t.coordinates.map(o);break;case"LineString":n=a(t.arcs);break;case"MultiLineString":n=t.arcs.map(a);break;case"Polygon":n=u(t.arcs);break;case"MultiPolygon":n=t.arcs.map(u);break;default:return null}return{type:r,coordinates:n}}(t)}var mb=function(e,t){var n={},r={},i={},o=[],a=-1;function s(e,t){for(var r in e){var i=e[r];delete t[i.start],delete i.start,delete i.end,i.forEach((function(e){n[e<0?~e:e]=1})),o.push(i)}}return t.forEach((function(n,r){var i,o=e.arcs[n<0?~n:n];o.length<3&&!o[1][0]&&!o[1][1]&&(i=t[++a],t[a]=n,t[r]=i)})),t.forEach((function(t){var n,o,a=function(t){var n,r=e.arcs[t<0?~t:t],i=r[0];e.transform?(n=[0,0],r.forEach((function(e){n[0]+=e[0],n[1]+=e[1]}))):n=r[r.length-1];return t<0?[n,i]:[i,n]}(t),s=a[0],u=a[1];if(n=i[s])if(delete i[n.end],n.push(t),n.end=u,o=r[u]){delete r[o.start];var l=o===n?n:n.concat(o);r[l.start=n.start]=i[l.end=o.end]=l}else r[n.start]=i[n.end]=n;else if(n=r[u])if(delete r[n.start],n.unshift(t),n.start=s,o=i[s]){delete i[o.end];var c=o===n?n:o.concat(n);r[c.start=o.start]=i[c.end=n.end]=c}else r[n.start]=i[n.end]=n;else r[(n=[t]).start=s]=i[n.end=u]=n})),s(i,r),s(r,i),t.forEach((function(e){n[e<0?~e:e]||o.push([e])})),o},gb=function(e){return pb(e,yb.apply(this,arguments))};function yb(e,t,n){var r,i,o;if(arguments.length>1)r=vb(e,t,n);else for(i=0,r=new Array(o=e.arcs.length);i<o;++i)r[i]=i;return{type:"MultiLineString",arcs:mb(e,r)}}function vb(e,t,n){var r,i=[],o=[];function a(e){var t=e<0?~e:e;(o[t]||(o[t]=[])).push({i:e,g:r})}function s(e){e.forEach(a)}function u(e){e.forEach(s)}return function e(t){switch(r=t,t.type){case"GeometryCollection":t.geometries.forEach(e);break;case"LineString":s(t.arcs);break;case"MultiLineString":case"Polygon":u(t.arcs);break;case"MultiPolygon":!function(e){e.forEach(u)}(t.arcs)}}(t),o.forEach(null==n?function(e){i.push(e[0].i)}:function(e){n(e[0].g,e[e.length-1].g)&&i.push(e[0].i)}),i}const bb={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function xb(e,t){let n,r,i,o;return e=lb(e,t),t&&t.feature?(n=db,i=t.feature):t&&t.mesh?(n=gb,i=t.mesh,o=bb[t.filter]):_g("Missing TopoJSON feature or mesh parameter."),r=(r=e.objects[i])?n(e,r,o):_g("Invalid TopoJSON object: "+i),r&&r.features||[r]}xb.responseType="json";const wb={dsv:lv,csv:uv(","),tsv:uv("\t"),json:lb,topojson:xb};function _b(e,t){return arguments.length>1?(wb[e]=t,this):vy(wb,e)?wb[e]:null}function kb(e){const t=_b(e);return t&&t.responseType||"text"}var Eb=function(e,t){return e<t?-1:e>t?1:e>=t?0:NaN},Sb=function(e){let t=e,n=e;function r(e,t,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){const o=r+i>>>1;n(e[o],t)<0?r=o+1:i=o}return r}return 1===e.length&&(t=(t,n)=>e(t)-n,n=function(e){return(t,n)=>Eb(e(t),n)}(e)),{left:r,center:function(e,n,i,o){null==i&&(i=0),null==o&&(o=e.length);const a=r(e,n,i,o-1);return a>i&&t(e[a-1],n)>-t(e[a],n)?a-1:a},right:function(e,t,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){const o=r+i>>>1;n(e[o],t)>0?i=o:r=o+1}return r}}};var Ab=function(e){return null===e?NaN:+e};const Cb=Sb(Eb),Db=Cb.right,Mb=Cb.left;Sb(Ab).center;class Fb{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const t=this._partials;let n=0;for(let r=0;r<this._n&&r<32;r++){const i=t[r],o=e+i,a=Math.abs(e)<Math.abs(i)?e-(o-i):i-(o-e);a&&(t[n++]=a),e=o}return t[n]=e,this._n=n+1,this}valueOf(){const e=this._partials;let t,n,r,i=this._n,o=0;if(i>0){for(o=e[--i];i>0&&(t=o,n=e[--i],o=t+n,r=n-(o-t),!r););i>0&&(r<0&&e[i-1]<0||r>0&&e[i-1]>0)&&(n=2*r,t=o+n,n==t-o&&(o=t))}return o}}function Nb(e,t){let n;if(void 0===t)for(const t of e)null!=t&&(n<t||void 0===n&&t>=t)&&(n=t);else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}function Ob(e,t){let n;if(void 0===t)for(const t of e)null!=t&&(n>t||void 0===n&&t>=t)&&(n=t);else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}function $b(e,t,n=0,r=e.length-1,i=Eb){for(;r>n;){if(r-n>600){const o=r-n+1,a=t-n+1,s=Math.log(o),u=.5*Math.exp(2*s/3),l=.5*Math.sqrt(s*u*(o-u)/o)*(a-o/2<0?-1:1);$b(e,t,Math.max(n,Math.floor(t-a*u/o+l)),Math.min(r,Math.floor(t+(o-a)*u/o+l)),i)}const o=e[t];let a=n,s=r;for(Tb(e,n,t),i(e[r],o)>0&&Tb(e,n,r);a<s;){for(Tb(e,a,s),++a,--s;i(e[a],o)<0;)++a;for(;i(e[s],o)>0;)--s}0===i(e[n],o)?Tb(e,n,s):(++s,Tb(e,s,r)),s<=t&&(n=s+1),t<=s&&(r=s-1)}return e}function Tb(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function zb(e,t,n){if(r=(e=Float64Array.from(function*(e,t){if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(yield t);else{let n=-1;for(let r of e)null!=(r=t(r,++n,e))&&(r=+r)>=r&&(yield r)}}(e,n))).length){if((t=+t)<=0||r<2)return Ob(e);if(t>=1)return Nb(e);var r,i=(r-1)*t,o=Math.floor(i),a=Nb($b(e,o).subarray(0,o+1));return a+(Ob(e.subarray(o+1))-a)*(i-o)}}function Rb(e,t,n=Ab){if(r=e.length){if((t=+t)<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,o=Math.floor(i),a=+n(e[o],o,e);return a+(+n(e[o+1],o+1,e)-a)*(i-o)}}var Pb=function(e,t){return zb(e,.5,t)};function Lb(e){return Array.from(function*(e){for(const t of e)yield*t}(e))}var Bb=function(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((t-e)/n)),o=new Array(i);++r<i;)o[r]=e+r*n;return o};function Ib(e,t){let n=0;if(void 0===t)for(let t of e)(t=+t)&&(n+=t);else{let r=-1;for(let i of e)(i=+t(i,++r,e))&&(n+=i)}return n}var jb=Math.sqrt(50),Ub=Math.sqrt(10),qb=Math.sqrt(2),Wb=function(e,t,n){var r,i,o,a,s=-1;if(n=+n,(e=+e)===(t=+t)&&n>0)return[e];if((r=t<e)&&(i=e,e=t,t=i),0===(a=Hb(e,t,n))||!isFinite(a))return[];if(a>0){let n=Math.round(e/a),r=Math.round(t/a);for(n*a<e&&++n,r*a>t&&--r,o=new Array(i=r-n+1);++s<i;)o[s]=(n+s)*a}else{a=-a;let n=Math.round(e*a),r=Math.round(t*a);for(n/a<e&&++n,r/a>t&&--r,o=new Array(i=r-n+1);++s<i;)o[s]=(n+s)/a}return r&&o.reverse(),o};function Hb(e,t,n){var r=(t-e)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=jb?10:o>=Ub?5:o>=qb?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=jb?10:o>=Ub?5:o>=qb?2:1)}function Vb(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=jb?i*=10:o>=Ub?i*=5:o>=qb&&(i*=2),t<e?-i:i}function Gb(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}var Yb=function(e){return(e=Gb(Math.abs(e)))?e[1]:NaN},Xb=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Qb(e){if(!(t=Xb.exec(e)))throw new Error("invalid format: "+e);var t;return new Jb({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function Jb(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}Qb.prototype=Jb.prototype,Jb.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var Kb,Zb,ex,tx,nx=function(e,t){var n=Gb(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")},rx={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>nx(100*e,t),r:nx,s:function(e,t){var n=Gb(e,t);if(!n)return e+"";var r=n[0],i=n[1],o=i-(Kb=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+Gb(e,Math.max(0,t+o-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)},ix=function(e){return e},ox=Array.prototype.map,ax=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"],sx=function(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?ix:(t=ox.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var i=e.length,o=[],a=0,s=t[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),o.push(e.substring(i-=s,i+s)),!((u+=s+1)>r));)s=t[a=(a+1)%t.length];return o.reverse().join(n)}),i=void 0===e.currency?"":e.currency[0]+"",o=void 0===e.currency?"":e.currency[1]+"",a=void 0===e.decimal?".":e.decimal+"",s=void 0===e.numerals?ix:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(ox.call(e.numerals,String)),u=void 0===e.percent?"%":e.percent+"",l=void 0===e.minus?"":e.minus+"",c=void 0===e.nan?"NaN":e.nan+"";function f(e){var t=(e=Qb(e)).fill,n=e.align,f=e.sign,d=e.symbol,h=e.zero,p=e.width,m=e.comma,g=e.precision,y=e.trim,v=e.type;"n"===v?(m=!0,v="g"):rx[v]||(void 0===g&&(g=12),y=!0,v="g"),(h||"0"===t&&"="===n)&&(h=!0,t="0",n="=");var b="$"===d?i:"#"===d&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",x="$"===d?o:/[%p]/.test(v)?u:"",w=rx[v],_=/[defgprs%]/.test(v);function k(e){var i,o,u,d=b,k=x;if("c"===v)k=w(e)+k,e="";else{var E=(e=+e)<0||1/e<0;if(e=isNaN(e)?c:w(Math.abs(e),g),y&&(e=function(e){e:for(var t,n=e.length,r=1,i=-1;r<n;++r)switch(e[r]){case".":i=t=r;break;case"0":0===i&&(i=r),t=r;break;default:if(!+e[r])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}(e)),E&&0==+e&&"+"!==f&&(E=!1),d=(E?"("===f?f:l:"-"===f||"("===f?"":f)+d,k=("s"===v?ax[8+Kb/3]:"")+k+(E&&"("===f?")":""),_)for(i=-1,o=e.length;++i<o;)if(48>(u=e.charCodeAt(i))||u>57){k=(46===u?a+e.slice(i+1):e.slice(i))+k,e=e.slice(0,i);break}}m&&!h&&(e=r(e,1/0));var S=d.length+e.length+k.length,A=S<p?new Array(p-S+1).join(t):"";switch(m&&h&&(e=r(A+e,A.length?p-k.length:1/0),A=""),n){case"<":e=d+e+k+A;break;case"=":e=d+A+e+k;break;case"^":e=A.slice(0,S=A.length>>1)+d+e+k+A.slice(S);break;default:e=A+d+e+k}return s(e)}return g=void 0===g?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),k.toString=function(){return e+""},k}return{format:f,formatPrefix:function(e,t){var n=f(((e=Qb(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(Yb(t)/3))),i=Math.pow(10,-r),o=ax[8+r/3];return function(e){return n(i*e)+o}}}};Zb=sx({thousands:",",grouping:[3],currency:["$",""]}),ex=Zb.format,tx=Zb.formatPrefix;var ux=function(e){return Math.max(0,-Yb(Math.abs(e)))},lx=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Yb(t)/3)))-Yb(Math.abs(e)))},cx=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Yb(t)-Yb(e))+1},fx={},dx=new Date,hx=new Date;function px(e,t,n,r){function i(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return i.floor=function(t){return e(t=new Date(+t)),t},i.ceil=function(n){return e(n=new Date(n-1)),t(n,1),e(n),n},i.round=function(e){var t=i(e),n=i.ceil(e);return e-t<n-e?t:n},i.offset=function(e,n){return t(e=new Date(+e),null==n?1:Math.floor(n)),e},i.range=function(n,r,o){var a,s=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r&&o>0))return s;do{s.push(a=new Date(+n)),t(n,o),e(n)}while(a<n&&n<r);return s},i.filter=function(n){return px((function(t){if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)}),(function(e,r){if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););}))},n&&(i.count=function(t,r){return dx.setTime(+t),hx.setTime(+r),e(dx),e(hx),Math.floor(n(dx,hx))},i.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?i.filter(r?function(t){return r(t)%e==0}:function(t){return i.count(0,t)%e==0}):i:null}),i}var mx=px((function(){}),(function(e,t){e.setTime(+e+t)}),(function(e,t){return t-e}));mx.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?px((function(t){t.setTime(Math.floor(t/e)*e)}),(function(t,n){t.setTime(+t+n*e)}),(function(t,n){return(n-t)/e})):mx:null};mx.range;const gx=1e3,yx=6e4,vx=36e5,bx=864e5,xx=6048e5,wx=2592e6,_x=31536e6;var kx=px((function(e){e.setTime(e-e.getMilliseconds())}),(function(e,t){e.setTime(+e+t*gx)}),(function(e,t){return(t-e)/gx}),(function(e){return e.getUTCSeconds()})),Ex=(kx.range,px((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*gx)}),(function(e,t){e.setTime(+e+t*yx)}),(function(e,t){return(t-e)/yx}),(function(e){return e.getMinutes()}))),Sx=(Ex.range,px((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*gx-e.getMinutes()*yx)}),(function(e,t){e.setTime(+e+t*vx)}),(function(e,t){return(t-e)/vx}),(function(e){return e.getHours()}))),Ax=(Sx.range,px((e=>e.setHours(0,0,0,0)),((e,t)=>e.setDate(e.getDate()+t)),((e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*yx)/bx),(e=>e.getDate()-1)));Ax.range;function Cx(e){return px((function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+7*t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*yx)/xx}))}var Dx=Cx(0),Mx=Cx(1),Fx=Cx(2),Nx=Cx(3),Ox=Cx(4),$x=Cx(5),Tx=Cx(6),zx=(Dx.range,Mx.range,Fx.range,Nx.range,Ox.range,$x.range,Tx.range,px((function(e){e.setDate(1),e.setHours(0,0,0,0)}),(function(e,t){e.setMonth(e.getMonth()+t)}),(function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())}),(function(e){return e.getMonth()}))),Rx=(zx.range,px((function(e){e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,t){e.setFullYear(e.getFullYear()+t)}),(function(e,t){return t.getFullYear()-e.getFullYear()}),(function(e){return e.getFullYear()})));Rx.every=function(e){return isFinite(e=Math.floor(e))&&e>0?px((function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,n){t.setFullYear(t.getFullYear()+n*e)})):null};Rx.range;var Px=px((function(e){e.setUTCSeconds(0,0)}),(function(e,t){e.setTime(+e+t*yx)}),(function(e,t){return(t-e)/yx}),(function(e){return e.getUTCMinutes()})),Lx=(Px.range,px((function(e){e.setUTCMinutes(0,0,0)}),(function(e,t){e.setTime(+e+t*vx)}),(function(e,t){return(t-e)/vx}),(function(e){return e.getUTCHours()}))),Bx=(Lx.range,px((function(e){e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t)}),(function(e,t){return(t-e)/bx}),(function(e){return e.getUTCDate()-1})));Bx.range;function Ix(e){return px((function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+7*t)}),(function(e,t){return(t-e)/xx}))}var jx=Ix(0),Ux=Ix(1),qx=Ix(2),Wx=Ix(3),Hx=Ix(4),Vx=Ix(5),Gx=Ix(6),Yx=(jx.range,Ux.range,qx.range,Wx.range,Hx.range,Vx.range,Gx.range,px((function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCMonth(e.getUTCMonth()+t)}),(function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())}),(function(e){return e.getUTCMonth()}))),Xx=(Yx.range,px((function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)}),(function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()}),(function(e){return e.getUTCFullYear()})));Xx.every=function(e){return isFinite(e=Math.floor(e))&&e>0?px((function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})):null};Xx.range;function Qx(e,t,n,r,i,o){const a=[[kx,1,gx],[kx,5,5e3],[kx,15,15e3],[kx,30,3e4],[o,1,yx],[o,5,3e5],[o,15,9e5],[o,30,18e5],[i,1,vx],[i,3,108e5],[i,6,216e5],[i,12,432e5],[r,1,bx],[r,2,1728e5],[n,1,xx],[t,1,wx],[t,3,7776e6],[e,1,_x]];function s(t,n,r){const i=Math.abs(n-t)/r,o=Sb((([,,e])=>e)).right(a,i);if(o===a.length)return e.every(Vb(t/_x,n/_x,r));if(0===o)return mx.every(Math.max(Vb(t,n,r),1));const[s,u]=a[i/a[o-1][2]<a[o][2]/i?o-1:o];return s.every(u)}return[function(e,t,n){const r=t<e;r&&([e,t]=[t,e]);const i=n&&"function"==typeof n.range?n:s(e,t,n),o=i?i.range(e,+t+1):[];return r?o.reverse():o},s]}const[Jx,Kx]=Qx(Xx,Yx,jx,Bx,Lx,Px),[Zx,ew]=Qx(Rx,zx,Dx,Ax,Sx,Ex),tw="year",nw="quarter",rw="month",iw="week",ow="date",aw="day",sw="dayofyear",uw="hours",lw="minutes",cw="seconds",fw="milliseconds",dw=[tw,nw,rw,iw,ow,aw,sw,uw,lw,cw,fw],hw=dw.reduce(((e,t,n)=>(e[t]=1+n,e)),{});function pw(e){const t=iy(e).slice(),n={};t.length||_g("Missing time unit."),t.forEach((e=>{vy(hw,e)?n[e]=1:_g("Invalid time unit: ".concat(e,"."))}));return(n.week||n.day?1:0)+(n.quarter||n.month||n.date?1:0)+(n.dayofyear?1:0)>1&&_g("Incompatible time units: ".concat(e)),t.sort(((e,t)=>hw[e]-hw[t])),t}const mw={[tw]:"%Y ",[nw]:"Q%q ",[rw]:"%b ",[ow]:"%d ",[iw]:"W%U ",[aw]:"%a ",[sw]:"%j ",[uw]:"%H:00",[lw]:"00:%M",[cw]:":%S",[fw]:".%L",["".concat(tw,"-").concat(rw)]:"%Y-%m ",["".concat(tw,"-").concat(rw,"-").concat(ow)]:"%Y-%m-%d ",["".concat(uw,"-").concat(lw)]:"%H:%M"};function gw(e,t){const n=py({},mw,t),r=pw(e),i=r.length;let o,a,s="",u=0;for(u=0;u<i;)for(o=r.length;o>u;--o)if(a=r.slice(u,o).join("-"),null!=n[a]){s+=n[a],u=o;break}return s.trim()}const yw=new Date;function vw(e){return yw.setFullYear(e),yw.setMonth(0),yw.setDate(1),yw.setHours(0,0,0,0),yw}function bw(e){return ww(new Date(e))}function xw(e){return _w(new Date(e))}function ww(e){return Ax.count(vw(e.getFullYear())-1,e)}function _w(e){return Dx.count(vw(e.getFullYear())-1,e)}function kw(e){return vw(e).getDay()}function Ew(e,t,n,r,i,o,a){if(0<=e&&e<100){const s=new Date(-1,t,n,r,i,o,a);return s.setFullYear(e),s}return new Date(e,t,n,r,i,o,a)}function Sw(e){return Cw(new Date(e))}function Aw(e){return Dw(new Date(e))}function Cw(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return Bx.count(t-1,e)}function Dw(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return jx.count(t-1,e)}function Mw(e){return yw.setTime(Date.UTC(e,0,1)),yw.getUTCDay()}function Fw(e,t,n,r,i,o,a){if(0<=e&&e<100){const e=new Date(Date.UTC(-1,t,n,r,i,o,a));return e.setUTCFullYear(n.y),e}return new Date(Date.UTC(e,t,n,r,i,o,a))}function Nw(e,t,n,r,i){const o=t||1,a=Bg(e),s=(e,t,i)=>function(e,t,n,r){const i=n<=1?e:r?(t,i)=>r+n*Math.floor((e(t,i)-r)/n):(t,r)=>n*Math.floor(e(t,r)/n);return t?(e,n)=>t(i(e,n),n):i}(n[i=i||e],r[i],e===a&&o,t),u=new Date,l=Uy(e),c=l.year?s(tw):dy(2012),f=l.month?s(rw):l.quarter?s(nw):Cg,d=l.week&&l.day?s(aw,1,"weekday"):l.week?s(iw,1):l.day?s(aw,1):l.date?s(ow,1):l.dayofyear?s(sw,1):Dg,h=l.hours?s(uw):Cg,p=l.minutes?s(lw):Cg,m=l.seconds?s(cw):Cg,g=l.milliseconds?s(fw):Cg;return function(e){u.setTime(+e);const t=c(u);return i(t,f(u),d(u,t),h(u),p(u),m(u),g(u))}}function Ow(e,t,n){return t+7*e-(n+6)%7}const $w={[tw]:e=>e.getFullYear(),[nw]:e=>Math.floor(e.getMonth()/3),[rw]:e=>e.getMonth(),[ow]:e=>e.getDate(),[uw]:e=>e.getHours(),[lw]:e=>e.getMinutes(),[cw]:e=>e.getSeconds(),[fw]:e=>e.getMilliseconds(),[sw]:e=>ww(e),[iw]:e=>_w(e),weekday:(e,t)=>Ow(_w(e),e.getDay(),kw(t)),[aw]:(e,t)=>Ow(1,e.getDay(),kw(t))},Tw={[nw]:e=>3*e,[iw]:(e,t)=>Ow(e,0,kw(t))};function zw(e,t){return Nw(e,t||1,$w,Tw,Ew)}const Rw={[tw]:e=>e.getUTCFullYear(),[nw]:e=>Math.floor(e.getUTCMonth()/3),[rw]:e=>e.getUTCMonth(),[ow]:e=>e.getUTCDate(),[uw]:e=>e.getUTCHours(),[lw]:e=>e.getUTCMinutes(),[cw]:e=>e.getUTCSeconds(),[fw]:e=>e.getUTCMilliseconds(),[sw]:e=>Cw(e),[iw]:e=>Dw(e),[aw]:(e,t)=>Ow(1,e.getUTCDay(),Mw(t)),weekday:(e,t)=>Ow(Dw(e),e.getUTCDay(),Mw(t))},Pw={[nw]:e=>3*e,[iw]:(e,t)=>Ow(e,0,Mw(t))};function Lw(e,t){return Nw(e,t||1,Rw,Pw,Fw)}const Bw={[tw]:Rx,[nw]:zx.every(3),[rw]:zx,[iw]:Dx,[ow]:Ax,[aw]:Ax,[sw]:Ax,[uw]:Sx,[lw]:Ex,[cw]:kx,[fw]:mx},Iw={[tw]:Xx,[nw]:Yx.every(3),[rw]:Yx,[iw]:jx,[ow]:Bx,[aw]:Bx,[sw]:Bx,[uw]:Lx,[lw]:Px,[cw]:kx,[fw]:mx};function jw(e){return Bw[e]}function Uw(e){return Iw[e]}function qw(e,t,n){return e?e.offset(t,n):void 0}function Ww(e,t,n){return qw(jw(e),t,n)}function Hw(e,t,n){return qw(Uw(e),t,n)}function Vw(e,t,n,r){return e?e.range(t,n,r):void 0}function Gw(e,t,n,r){return Vw(jw(e),t,n,r)}function Yw(e,t,n,r){return Vw(Uw(e),t,n,r)}const Xw=1e3,Qw=6e4,Jw=36e5,Kw=864e5,Zw=2592e6,e_=31536e6,t_=[tw,rw,ow,uw,lw,cw,fw],n_=t_.slice(0,-1),r_=n_.slice(0,-1),i_=r_.slice(0,-1),o_=i_.slice(0,-1),a_=[tw,rw],s_=[tw],u_=[[n_,1,Xw],[n_,5,5e3],[n_,15,15e3],[n_,30,3e4],[r_,1,Qw],[r_,5,3e5],[r_,15,9e5],[r_,30,18e5],[i_,1,Jw],[i_,3,108e5],[i_,6,216e5],[i_,12,432e5],[o_,1,Kw],[[tw,iw],1,6048e5],[a_,1,Zw],[a_,3,7776e6],[s_,1,e_]];function l_(e){const t=e.extent,n=e.maxbins||40,r=Math.abs(Ry(t))/n;let i,o,a=Sb((e=>e[2])).right(u_,r);return a===u_.length?(i=s_,o=Vb(t[0]/e_,t[1]/e_,n)):a?(a=u_[r/u_[a-1][2]<u_[a][2]/r?a-1:a],i=a[0],o=a[1]):(i=t_,o=Math.max(Vb(t[0],t[1],n),1)),{units:i,step:o}}function c_(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function f_(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function d_(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function h_(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,o=e.days,a=e.shortDays,s=e.months,u=e.shortMonths,l=S_(i),c=A_(i),f=S_(o),d=A_(o),h=S_(a),p=A_(a),m=S_(s),g=A_(s),y=S_(u),v=A_(u),b={a:function(e){return a[e.getDay()]},A:function(e){return o[e.getDay()]},b:function(e){return u[e.getMonth()]},B:function(e){return s[e.getMonth()]},c:null,d:G_,e:G_,f:K_,g:lk,G:fk,H:Y_,I:X_,j:Q_,L:J_,m:Z_,M:ek,p:function(e){return i[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:Tk,s:zk,S:tk,u:nk,U:rk,V:ok,w:ak,W:sk,x:null,X:null,y:uk,Y:ck,Z:dk,"%":$k},x={a:function(e){return a[e.getUTCDay()]},A:function(e){return o[e.getUTCDay()]},b:function(e){return u[e.getUTCMonth()]},B:function(e){return s[e.getUTCMonth()]},c:null,d:hk,e:hk,f:vk,g:Mk,G:Nk,H:pk,I:mk,j:gk,L:yk,m:bk,M:xk,p:function(e){return i[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:Tk,s:zk,S:wk,u:_k,U:kk,V:Sk,w:Ak,W:Ck,x:null,X:null,y:Dk,Y:Fk,Z:Ok,"%":$k},w={a:function(e,t,n){var r=h.exec(t.slice(n));return r?(e.w=p.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(e,t,n){var r=f.exec(t.slice(n));return r?(e.w=d.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(e,t,n){var r=y.exec(t.slice(n));return r?(e.m=v.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(e,t,n){var r=m.exec(t.slice(n));return r?(e.m=g.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(e,n,r){return E(e,t,n,r)},d:P_,e:P_,f:q_,g:$_,G:O_,H:B_,I:B_,j:L_,L:U_,m:R_,M:I_,p:function(e,t,n){var r=l.exec(t.slice(n));return r?(e.p=c.get(r[0].toLowerCase()),n+r[0].length):-1},q:z_,Q:H_,s:V_,S:j_,u:D_,U:M_,V:F_,w:C_,W:N_,x:function(e,t,r){return E(e,n,t,r)},X:function(e,t,n){return E(e,r,t,n)},y:$_,Y:O_,Z:T_,"%":W_};function _(e,t){return function(n){var r,i,o,a=[],s=-1,u=0,l=e.length;for(n instanceof Date||(n=new Date(+n));++s<l;)37===e.charCodeAt(s)&&(a.push(e.slice(u,s)),null!=(i=b_[r=e.charAt(++s)])?r=e.charAt(++s):i="e"===r?" ":"0",(o=t[r])&&(r=o(n,i)),a.push(r),u=s+1);return a.push(e.slice(u,s)),a.join("")}}function k(e,t){return function(n){var r,i,o=d_(1900,void 0,1);if(E(o,e,n+="",0)!=n.length)return null;if("Q"in o)return new Date(o.Q);if("s"in o)return new Date(1e3*o.s+("L"in o?o.L:0));if(t&&!("Z"in o)&&(o.Z=0),"p"in o&&(o.H=o.H%12+12*o.p),void 0===o.m&&(o.m="q"in o?o.q:0),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(i=(r=f_(d_(o.y,0,1))).getUTCDay(),r=i>4||0===i?Ux.ceil(r):Ux(r),r=Bx.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(i=(r=c_(d_(o.y,0,1))).getDay(),r=i>4||0===i?Mx.ceil(r):Mx(r),r=Ax.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?f_(d_(o.y,0,1)).getUTCDay():c_(d_(o.y,0,1)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,f_(o)):c_(o)}}function E(e,t,n,r){for(var i,o,a=0,s=t.length,u=n.length;a<s;){if(r>=u)return-1;if(37===(i=t.charCodeAt(a++))){if(i=t.charAt(a++),!(o=w[i in b_?t.charAt(a++):i])||(r=o(e,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return b.x=_(n,b),b.X=_(r,b),b.c=_(t,b),x.x=_(n,x),x.X=_(r,x),x.c=_(t,x),{format:function(e){var t=_(e+="",b);return t.toString=function(){return e},t},parse:function(e){var t=k(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=_(e+="",x);return t.toString=function(){return e},t},utcParse:function(e){var t=k(e+="",!0);return t.toString=function(){return e},t}}}t(fx,"week",(function(){return xw})),t(fx,"utcweek",(function(){return Aw})),t(fx,"utcdayofyear",(function(){return Sw})),t(fx,"utcSequence",(function(){return Yw})),t(fx,"utcOffset",(function(){return Hw})),t(fx,"utcInterval",(function(){return Uw})),t(fx,"utcFloor",(function(){return Lw})),t(fx,"timeUnits",(function(){return pw})),t(fx,"timeUnitSpecifier",(function(){return gw})),t(fx,"timeSequence",(function(){return Gw})),t(fx,"timeOffset",(function(){return Ww})),t(fx,"timeInterval",(function(){return jw})),t(fx,"timeFloor",(function(){return zw})),t(fx,"timeBin",(function(){return l_})),t(fx,"dayofyear",(function(){return bw})),t(fx,"YEAR",(function(){return tw})),t(fx,"WEEK",(function(){return iw})),t(fx,"TIME_UNITS",(function(){return dw})),t(fx,"SECONDS",(function(){return cw})),t(fx,"QUARTER",(function(){return nw})),t(fx,"MONTH",(function(){return rw})),t(fx,"MINUTES",(function(){return lw})),t(fx,"MILLISECONDS",(function(){return fw})),t(fx,"HOURS",(function(){return uw})),t(fx,"DAYOFYEAR",(function(){return sw})),t(fx,"DAY",(function(){return aw})),t(fx,"DATE",(function(){return ow}));var p_,m_,g_,y_,v_,b_={"-":"",_:" ",0:"0"},x_=/^\s*\d+/,w_=/^%/,__=/[\\^$*+?|[\]().{}]/g;function k_(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(t)+i:i)}function E_(e){return e.replace(__,"\\$&")}function S_(e){return new RegExp("^(?:"+e.map(E_).join("|")+")","i")}function A_(e){return new Map(e.map(((e,t)=>[e.toLowerCase(),t])))}function C_(e,t,n){var r=x_.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function D_(e,t,n){var r=x_.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function M_(e,t,n){var r=x_.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function F_(e,t,n){var r=x_.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function N_(e,t,n){var r=x_.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function O_(e,t,n){var r=x_.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function $_(e,t,n){var r=x_.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function T_(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function z_(e,t,n){var r=x_.exec(t.slice(n,n+1));return r?(e.q=3*r[0]-3,n+r[0].length):-1}function R_(e,t,n){var r=x_.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function P_(e,t,n){var r=x_.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function L_(e,t,n){var r=x_.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function B_(e,t,n){var r=x_.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function I_(e,t,n){var r=x_.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function j_(e,t,n){var r=x_.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function U_(e,t,n){var r=x_.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function q_(e,t,n){var r=x_.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function W_(e,t,n){var r=w_.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function H_(e,t,n){var r=x_.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function V_(e,t,n){var r=x_.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function G_(e,t){return k_(e.getDate(),t,2)}function Y_(e,t){return k_(e.getHours(),t,2)}function X_(e,t){return k_(e.getHours()%12||12,t,2)}function Q_(e,t){return k_(1+Ax.count(Rx(e),e),t,3)}function J_(e,t){return k_(e.getMilliseconds(),t,3)}function K_(e,t){return J_(e,t)+"000"}function Z_(e,t){return k_(e.getMonth()+1,t,2)}function ek(e,t){return k_(e.getMinutes(),t,2)}function tk(e,t){return k_(e.getSeconds(),t,2)}function nk(e){var t=e.getDay();return 0===t?7:t}function rk(e,t){return k_(Dx.count(Rx(e)-1,e),t,2)}function ik(e){var t=e.getDay();return t>=4||0===t?Ox(e):Ox.ceil(e)}function ok(e,t){return e=ik(e),k_(Ox.count(Rx(e),e)+(4===Rx(e).getDay()),t,2)}function ak(e){return e.getDay()}function sk(e,t){return k_(Mx.count(Rx(e)-1,e),t,2)}function uk(e,t){return k_(e.getFullYear()%100,t,2)}function lk(e,t){return k_((e=ik(e)).getFullYear()%100,t,2)}function ck(e,t){return k_(e.getFullYear()%1e4,t,4)}function fk(e,t){var n=e.getDay();return k_((e=n>=4||0===n?Ox(e):Ox.ceil(e)).getFullYear()%1e4,t,4)}function dk(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+k_(t/60|0,"0",2)+k_(t%60,"0",2)}function hk(e,t){return k_(e.getUTCDate(),t,2)}function pk(e,t){return k_(e.getUTCHours(),t,2)}function mk(e,t){return k_(e.getUTCHours()%12||12,t,2)}function gk(e,t){return k_(1+Bx.count(Xx(e),e),t,3)}function yk(e,t){return k_(e.getUTCMilliseconds(),t,3)}function vk(e,t){return yk(e,t)+"000"}function bk(e,t){return k_(e.getUTCMonth()+1,t,2)}function xk(e,t){return k_(e.getUTCMinutes(),t,2)}function wk(e,t){return k_(e.getUTCSeconds(),t,2)}function _k(e){var t=e.getUTCDay();return 0===t?7:t}function kk(e,t){return k_(jx.count(Xx(e)-1,e),t,2)}function Ek(e){var t=e.getUTCDay();return t>=4||0===t?Hx(e):Hx.ceil(e)}function Sk(e,t){return e=Ek(e),k_(Hx.count(Xx(e),e)+(4===Xx(e).getUTCDay()),t,2)}function Ak(e){return e.getUTCDay()}function Ck(e,t){return k_(Ux.count(Xx(e)-1,e),t,2)}function Dk(e,t){return k_(e.getUTCFullYear()%100,t,2)}function Mk(e,t){return k_((e=Ek(e)).getUTCFullYear()%100,t,2)}function Fk(e,t){return k_(e.getUTCFullYear()%1e4,t,4)}function Nk(e,t){var n=e.getUTCDay();return k_((e=n>=4||0===n?Hx(e):Hx.ceil(e)).getUTCFullYear()%1e4,t,4)}function Ok(){return"+0000"}function $k(){return"%"}function Tk(e){return+e}function zk(e){return Math.floor(+e/1e3)}function Rk(e){const t={};return n=>t[n]||(t[n]=e(n))}function Pk(e){const t=Rk(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat:function(e){const n=Qb(e||",");if(null==n.precision){switch(n.precision=12,n.type){case"%":n.precision-=2;break;case"e":n.precision-=1}return r=t(n),i=t(".1f")(1)[1],e=>{const t=r(e),n=t.indexOf(i);if(n<0)return t;let o=function(e,t){let n,r=e.lastIndexOf("e");if(r>0)return r;for(r=e.length;--r>t;)if(n=e.charCodeAt(r),n>=48&&n<=57)return r+1}(t,n);const a=o<t.length?t.slice(o):"";for(;--o>n;)if("0"!==t[o]){++o;break}return t.slice(0,o)+a}}return t(n);var r,i},formatSpan:function(e,r,i,o){o=Qb(null==o?",f":o);const a=Vb(e,r,i),s=Math.max(Math.abs(e),Math.abs(r));let u;if(null==o.precision)switch(o.type){case"s":return isNaN(u=lx(a,s))||(o.precision=u),n(o,s);case"":case"e":case"g":case"p":case"r":isNaN(u=cx(a,s))||(o.precision=u-("e"===o.type));break;case"f":case"%":isNaN(u=ux(a))||(o.precision=u-2*("%"===o.type))}return t(o)}}}let Lk,Bk;function Ik(){return Lk=Pk({format:ex,formatPrefix:tx})}function jk(e){return Pk(sx(e))}function Uk(e){return arguments.length?Lk=jk(e):Lk}function qk(e,t,n){Tg(n=n||{})||_g("Invalid time multi-format specifier: ".concat(n));const r=t(cw),i=t(lw),o=t(uw),a=t(ow),s=t(iw),u=t(rw),l=t(nw),c=t(tw),f=e(n.milliseconds||".%L"),d=e(n.seconds||":%S"),h=e(n.minutes||"%I:%M"),p=e(n.hours||"%I %p"),m=e(n.date||n.day||"%a %d"),g=e(n.week||"%b %d"),y=e(n.month||"%B"),v=e(n.quarter||"%B"),b=e(n.year||"%Y");return e=>(r(e)<e?f:i(e)<e?d:o(e)<e?h:a(e)<e?p:u(e)<e?s(e)<e?m:g:c(e)<e?l(e)<e?y:v:b)(e)}function Wk(e){const t=Rk(e.format),n=Rk(e.utcFormat);return{timeFormat:e=>My(e)?t(e):qk(t,jw,e),utcFormat:e=>My(e)?n(e):qk(n,Uw,e),timeParse:Rk(e.parse),utcParse:Rk(e.utcParse)}}function Hk(){return Bk=Wk({format:m_,parse:g_,utcFormat:y_,utcParse:v_})}function Vk(e){return Wk(h_(e))}function Gk(e){return arguments.length?Bk=Vk(e):Bk}!function(e){p_=h_(e),m_=p_.format,g_=p_.parse,y_=p_.utcFormat,v_=p_.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),Ik(),Hk();const Yk=(e,t)=>py({},e,t);function Xk(e,t){const n=e?jk(e):Uk(),r=t?Vk(t):Gk();return Yk(n,r)}function Qk(e,t){const n=arguments.length;return n&&2!==n&&_g("defaultLocale expects either zero or two arguments."),n?Yk(Uk(e),Gk(t)):Yk(Uk(),Gk())}function Jk(){return Ik(),Hk(),Qk()}var Kk=function(e,t,n,r){const i=_b((t=t||{}).type||"json");return i||_g("Unknown data format type: "+t.type),e=i(e,t),t.parse&&function(e,t,n,r){if(!e.length)return;const i=Gk();n=n||i.timeParse,r=r||i.utcParse;let o,a,s,u,l,c,f=e.columns||Object.keys(e[0]);"auto"===t&&(t=sv(e,f));f=Object.keys(t);const d=f.map((e=>{const i=t[e];let o,a;if(i&&(i.startsWith("date:")||i.startsWith("utc:"))){o=i.split(/:(.+)?/,2),a=o[1],("'"===a[0]&&"'"===a[a.length-1]||'"'===a[0]&&'"'===a[a.length-1])&&(a=a.slice(1,-1));return("utc"===o[0]?r:n)(a)}if(!rv[i])throw Error("Illegal format pattern: "+e+":"+i);return rv[i]}));for(s=0,l=e.length,c=f.length;s<l;++s)for(o=e[s],u=0;u<c;++u)a=f[u],o[a]=d[u](o[a])}(e,t.parse,n,r),vy(e,"columns")&&delete e.columns,e};const Zk=function(e,t){return n=>({options:n||{},sanitize:Jy,load:Qy,fileAccess:!!t,file:Ky(t),http:ev(e)})}("undefined"!=typeof fetch&&fetch,null);function eE(e){const t=e||Ag,n=[],r={};return n.add=e=>{const i=t(e);return r[i]||(r[i]=1,n.push(e)),n},n.remove=e=>{const i=t(e);if(r[i]){r[i]=0;const t=n.indexOf(e);t>=0&&n.splice(t,1)}return n},n}async function tE(e,t){try{await t(e)}catch(t){e.error(t)}}t(Hy,"loader",(function(){return Zk})),t(Hy,"read",(function(){return Kk})),t(Hy,"typeParsers",(function(){return rv})),t(Hy,"inferTypes",(function(){return sv})),t(Hy,"inferType",(function(){return av})),t(Hy,"responseType",(function(){return kb})),t(Hy,"formats",(function(){return _b})),t(Hy,"format",(function(){return wb}));const nE=Symbol("vega_id");let rE=1;function iE(e){return!(!e||!oE(e))}function oE(e){return e[nE]}function aE(e,t){return e[nE]=t,e}function sE(e){const t=e===Object(e)?e:{data:e};return oE(t)?t:aE(t,rE++)}function uE(e){return lE(e,sE({}))}function lE(e,t){for(const n in e)t[n]=e[n];return t}function cE(e,t){return aE(t,oE(e))}function fE(e,t){return e?t?(n,r)=>e(n,r)||oE(t(n))-oE(t(r)):(t,n)=>e(t,n)||oE(t)-oE(n):null}function dE(e){return e&&e.constructor===hE}function hE(){const e=[],t=[],n=[],r=[],i=[];let o=null,a=!1;return{constructor:hE,insert:function(t){const n=iy(t),r=n.length;for(let t=0;t<r;++t)e.push(n[t]);return this},remove:function(e){const n=ay(e)?r:t,i=iy(e),o=i.length;for(let e=0;e<o;++e)n.push(i[e]);return this},modify:function(e,t,r){const o={field:t,value:dy(r)};return ay(e)?(o.filter=e,i.push(o)):(o.tuple=e,n.push(o)),this},encode:function(e,t){return ay(e)?i.push({filter:e,field:t}):n.push({tuple:e,field:t}),this},clean:function(e){return o=e,this},reflow:function(){return a=!0,this},pulse:function(s,u){const l={},c={};let f,d,h,p,m,g;for(f=0,d=u.length;f<d;++f)l[oE(u[f])]=1;for(f=0,d=t.length;f<d;++f)m=t[f],l[oE(m)]=-1;for(f=0,d=r.length;f<d;++f)p=r[f],u.forEach((e=>{p(e)&&(l[oE(e)]=-1)}));for(f=0,d=e.length;f<d;++f)m=e[f],g=oE(m),l[g]?l[g]=1:s.add.push(sE(e[f]));for(f=0,d=u.length;f<d;++f)m=u[f],l[oE(m)]<0&&s.rem.push(m);function y(e,t,n){n?e[t]=n(e):s.encode=t,a||(c[oE(e)]=e)}for(f=0,d=n.length;f<d;++f)h=n[f],m=h.tuple,p=h.field,g=l[oE(m)],g>0&&(y(m,p,h.value),s.modifies(p));for(f=0,d=i.length;f<d;++f)h=i[f],p=h.filter,u.forEach((e=>{p(e)&&l[oE(e)]>0&&y(e,h.field,h.value)})),s.modifies(h.field);if(a)s.mod=t.length||r.length?u.filter((e=>l[oE(e)]>0)):u.slice();else for(g in c)s.mod.push(c[g]);return(o||null==o&&(t.length||r.length))&&s.clean(!0),s}}}const pE="_:mod:_";function mE(){Object.defineProperty(this,pE,{writable:!0,value:{}})}mE.prototype={set:function(e,t,n,r){const i=this,o=i[e],a=i["_:mod:_"];return null!=t&&t>=0?(o[t]!==n||r)&&(o[t]=n,a[t+":"+e]=-1,a[e]=-1):(o!==n||r)&&(i[e]=n,a[e]=$g(n)?1+n.length:-1),i},modified:function(e,t){const n=this["_:mod:_"];if(!arguments.length){for(const e in n)if(n[e])return!0;return!1}if($g(e)){for(let t=0;t<e.length;++t)if(n[e[t]])return!0;return!1}return null!=t&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear:function(){return this["_:mod:_"]={},this}};let gE=0;const yE=new mE;function vE(e,t,n,r){this.id=++gE,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,r)}function bE(e){return function(t){const n=this.flags;return 0===arguments.length?!!(n&e):(this.flags=t?n|e:n&~e,this)}}vE.prototype={targets:function(){return this._targets||(this._targets=eE(Sg))},set:function(e){return this.value!==e?(this.value=e,1):0},skip:bE(1),modified:bE(2),parameters:function(e,t,n){t=!1!==t;const r=this._argval=this._argval||new mE,i=this._argops=this._argops||[],o=[];let a,s,u,l;const c=(e,n,a)=>{a instanceof vE?(a!==this&&(t&&a.targets().add(this),o.push(a)),i.push({op:a,name:e,index:n})):r.set(e,n,a)};for(a in e)if(s=e[a],"pulse"===a)iy(s).forEach((e=>{e instanceof vE?e!==this&&(e.targets().add(this),o.push(e)):_g("Pulse parameters must be operator instances.")})),this.source=s;else if($g(s))for(r.set(a,-1,Array(u=s.length)),l=0;l<u;++l)c(a,l,s[l]);else c(a,-1,s);return this.marshall().clear(),n&&(i.initonly=!0),o},marshall:function(e){const t=this._argval||yE,n=this._argops;let r,i,o,a;if(n){const s=n.length;for(i=0;i<s;++i)r=n[i],o=r.op,a=o.modified()&&o.stamp===e,t.set(r.name,r.index,o.value,a);if(n.initonly){for(i=0;i<s;++i)r=n[i],r.op.targets().remove(this);this._argops=null,this._update=null}}return t},detach:function(){const e=this._argops;let t,n,r,i;if(e)for(t=0,n=e.length;t<n;++t)r=e[t],i=r.op,i._targets&&i._targets.remove(this);this.pulse=null,this.source=null},evaluate:function(e){const t=this._update;if(t){const n=this.marshall(e.stamp),r=t.call(this,n,e);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return e.StopPropagation}},run:function(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e}};let xE=0;function wE(e,t,n){this.id=++xE,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function _E(e,t,n){return new wE(e,t,n)}wE.prototype={_filter:Mg,_apply:Ag,targets:function(){return this._targets||(this._targets=eE(Sg))},consume:function(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive:function(e){if(this._filter(e)){const t=this.value=this._apply(e),n=this._targets,r=n?n.length:0;for(let e=0;e<r;++e)n[e].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter:function(e){const t=_E(e);return this.targets().add(t),t},apply:function(e){const t=_E(null,e);return this.targets().add(t),t},merge:function(){const e=_E();this.targets().add(e);for(let t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle:function(e){let t=-1;return this.filter((()=>{const n=Date.now();return n-t>e?(t=n,1):0}))},debounce:function(e){const t=_E();return this.targets().add(_E(null,null,hy(e,(e=>{const n=e.dataflow;t.receive(e),n&&n.run&&n.run()})))),t},between:function(e,t){let n=!1;return e.targets().add(_E(null,null,(()=>n=!0))),t.targets().add(_E(null,null,(()=>n=!1))),this.filter((()=>n))},detach:function(){this._filter=Mg,this._targets=null}};const kE={skip:!0};function EE(e,t,n,r,i,o){const a=py({},o,kE);let s,u;ay(n)||(n=dy(n)),void 0===r?s=t=>e.touch(n(t)):ay(r)?(u=new vE(null,r,i,!1),s=t=>{u.evaluate(t);const r=n(t),i=u.value;dE(i)?e.pulse(r,i,o):e.update(r,i,a)}):s=t=>e.update(n(t),r,a),t.apply(s)}function SE(e,t,n,r,i,o){if(void 0===r)t.targets().add(n);else{const a=o||{},s=new vE(null,function(e,t){return t=ay(t)?t:dy(t),e?function(n,r){const i=t(n,r);return e.skip()||(e.skip(i!==this.value).value=i),i}:t}(n,r),i,!1);s.modified(a.force),s.rank=t.rank,t.targets().add(s),n&&(s.skip(!0),s.value=n.value,s.targets().add(n),e.connect(n,[s]))}}const AE={};function CE(e,t,n){this.dataflow=e,this.stamp=null==t?-1:t,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function DE(e,t){const n=[];return Wy(e,t,(e=>n.push(e))),n}function ME(e,t){const n={};return e.visit(t,(e=>{n[oE(e)]=1})),e=>n[oE(e)]?null:e}function FE(e,t){return e?(n,r)=>e(n,r)&&t(n,r):t}function NE(e,t,n,r){const i=this,o=n.length;let a=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=r||null,this.pulses=n;for(let e=0;e<o;++e){const r=n[e];if(r.stamp===t){if(r.fields){const e=i.fields||(i.fields={});for(const t in r.fields)e[t]=1}r.changed(i.ADD)&&(a|=i.ADD),r.changed(i.REM)&&(a|=i.REM),r.changed(i.MOD)&&(a|=i.MOD)}}this.changes=a}function OE(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}CE.prototype={StopPropagation:AE,ADD:1,REM:2,MOD:4,ADD_REM:3,ADD_MOD:5,ALL:7,REFLOW:8,SOURCE:16,NO_SOURCE:32,NO_FIELDS:64,fork:function(e){return new CE(this.dataflow).init(this,e)},clone:function(){const e=this.fork(7);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(23)},addAll:function(){let e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||(e=new CE(this.dataflow).init(this),e.add=e.source,e.rem=[]),e},init:function(e,t){const n=this;return n.stamp=e.stamp,n.encode=e.encode,!e.fields||64&t||(n.fields=e.fields),1&t?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),2&t?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),4&t?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),32&t?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter:function(e){this.dataflow.runAfter(e)},changed:function(e){const t=e||7;return 1&t&&this.add.length||2&t&&this.rem.length||4&t&&this.mod.length},reflow:function(e){if(e)return this.fork(7).reflow();const t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(4,ME(this,1))),this},clean:function(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies:function(e){const t=this.fields||(this.fields={});return $g(e)?e.forEach((e=>t[e]=!0)):t[e]=!0,this},modified:function(e,t){const n=this.fields;return!(!t&&!this.mod.length||!n)&&(arguments.length?$g(e)?e.some((e=>n[e])):n[e]:!!n)},filter:function(e,t){const n=this;return 1&e&&(n.addF=FE(n.addF,t)),2&e&&(n.remF=FE(n.remF,t)),4&e&&(n.modF=FE(n.modF,t)),16&e&&(n.srcF=FE(n.srcF,t)),n},materialize:function(e){const t=this;return 1&(e=e||7)&&t.addF&&(t.add=DE(t.add,t.addF),t.addF=null),2&e&&t.remF&&(t.rem=DE(t.rem,t.remF),t.remF=null),4&e&&t.modF&&(t.mod=DE(t.mod,t.modF),t.modF=null),16&e&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit:function(e,t){const n=this,r=t;if(16&e)return Wy(n.source,n.srcF,r),n;1&e&&Wy(n.add,n.addF,r),2&e&&Wy(n.rem,n.remF,r),4&e&&Wy(n.mod,n.modF,r);const i=n.source;if(8&e&&i){const e=n.add.length+n.mod.length;e===i.length||Wy(i,e?ME(n,5):n.srcF,r)}return n}},_y(NE,CE,{fork:function(e){const t=new CE(this.dataflow).init(this,e&this.NO_FIELDS);return void 0!==e&&(e&t.ADD&&this.visit(t.ADD,(e=>t.add.push(e))),e&t.REM&&this.visit(t.REM,(e=>t.rem.push(e))),e&t.MOD&&this.visit(t.MOD,(e=>t.mod.push(e)))),t},changed:function(e){return this.changes&e},modified:function(e){const t=this,n=t.fields;return n&&t.changes&t.MOD?$g(e)?e.some((e=>n[e])):n[e]:0},filter:function(){_g("MultiPulse does not support filtering.")},materialize:function(){_g("MultiPulse does not support materialization.")},visit:function(e,t){const n=this,r=n.pulses,i=r.length;let o=0;if(e&n.SOURCE)for(;o<i;++o)r[o].visit(e,t);else for(;o<i;++o)r[o].stamp===n.stamp&&r[o].visit(e,t);return n}});const $E={skip:!1,force:!1};function TE(e){let t=[];return{clear:()=>t=[],size:()=>t.length,peek:()=>t[0],push:n=>(t.push(n),zE(t,0,t.length-1,e)),pop:()=>{const n=t.pop();let r;return t.length?(r=t[0],t[0]=n,function(e,t,n){const r=t,i=e.length,o=e[t];let a,s=1+(t<<1);for(;s<i;)a=s+1,a<i&&n(e[s],e[a])>=0&&(s=a),e[t]=e[s],s=1+((t=s)<<1);e[t]=o,zE(e,r,t,n)}(t,0,e)):r=n,r}}}function zE(e,t,n,r){let i,o;const a=e[n];for(;n>t&&(o=n-1>>1,i=e[o],r(a,i)<0);)e[n]=i,n=o;return e[n]=a}function RE(){this.logger(Og()),this.logLevel(1),this._clock=0,this._rank=0,this._locale=Qk();try{this._loader=Zk()}catch(e){}this._touched=eE(Sg),this._input={},this._pulse=null,this._heap=TE(((e,t)=>e.qrank-t.qrank)),this._postrun=[]}function PE(e){return function(){return this._log[e].apply(this,arguments)}}function LE(e,t){vE.call(this,e,null,t)}RE.prototype={stamp:function(){return this._clock},loader:function(e){return arguments.length?(this._loader=e,this):this._loader},locale:function(e){return arguments.length?(this._locale=e,this):this._locale},logger:function(e){return arguments.length?(this._log=e,this):this._log},error:PE("error"),warn:PE("warn"),info:PE("info"),debug:PE("debug"),logLevel:PE("level"),cleanThreshold:1e4,add:function(e,t,n,r){let i,o=1;return e instanceof vE?i=e:e&&e.prototype instanceof vE?i=new e:ay(e)?i=new vE(null,e):(o=0,i=new vE(e,t)),this.rank(i),o&&(r=n,n=t),n&&this.connect(i,i.parameters(n,r)),this.touch(i),i},connect:function(e,t){const n=e.rank,r=t.length;for(let i=0;i<r;++i)if(n<t[i].rank)return void this.rerank(e)},rank:function(e){e.rank=++this._rank},rerank:function(e){const t=[e];let n,r,i;for(;t.length;)if(this.rank(n=t.pop()),r=n._targets)for(i=r.length;--i>=0;)t.push(n=r[i]),n===e&&_g("Cycle detected in dataflow graph.")},pulse:function(e,t,n){this.touch(e,n||$E);const r=new CE(this,this._clock+(this._pulse?0:1)),i=e.pulse&&e.pulse.source||[];return r.target=e,this._input[e.id]=t.pulse(r,i),this},touch:function(e,t){const n=t||$E;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this},update:function(e,t,n){const r=n||$E;return(e.set(t)||r.force)&&this.touch(e,r),this},changeset:hE,ingest:function(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))},parse:function(e,t){const n=this.locale();return Kk(e,t,n.timeParse,n.utcParse)},preload:async function(e,t,n){const r=this,i=r._pending||function(e){let t;const n=new Promise((e=>t=e));return n.requests=0,n.done=()=>{0==--n.requests&&(e._pending=null,t(e))},e._pending=n}(r);i.requests+=1;const o=await r.request(t,n);return r.pulse(e,r.changeset().remove(Mg).insert(o.data||[])),i.done(),o},request:async function(e,t){const n=this;let r,i=0;try{r=await n.loader().load(e,{context:"dataflow",response:kb(t&&t.type)});try{r=n.parse(r,t)}catch(t){i=-2,n.warn("Data ingestion failed",e,t)}}catch(t){i=-1,n.warn("Loading failed",e,t)}return{data:r,status:i}},events:function(e,t,n,r){const i=this,o=_E(n,r),a=function(e){e.dataflow=i;try{o.receive(e)}catch(e){i.error(e)}finally{i.run()}};let s;s="string"==typeof e&&"undefined"!=typeof document?document.querySelectorAll(e):iy(e);const u=s.length;for(let e=0;e<u;++e)s[e].addEventListener(t,a);return o},on:function(e,t,n,r,i){return(e instanceof vE?SE:EE)(this,e,t,n,r,i),this},evaluate:async function(e,t,n){const r=this,i=[];if(r._pulse)return OE(r);if(r._pending&&await r._pending,t&&await tE(r,t),!r._touched.length)return r.debug("Dataflow invoked, but nothing to do."),r;const o=++r._clock;r._pulse=new CE(r,o,e),r._touched.forEach((e=>r._enqueue(e,!0))),r._touched=eE(Sg);let a,s,u,l=0;try{for(;r._heap.size()>0;)a=r._heap.pop(),a.rank===a.qrank?(s=a.run(r._getPulse(a,e)),s.then?s=await s:s.async&&(i.push(s.async),s=AE),s!==AE&&a._targets&&a._targets.forEach((e=>r._enqueue(e))),++l):r._enqueue(a,!0)}catch(e){r._heap.clear(),u=e}if(r._input={},r._pulse=null,r.debug(`Pulse ${o}: ${l} operators`),u&&(r._postrun=[],r.error(u)),r._postrun.length){const e=r._postrun.sort(((e,t)=>t.priority-e.priority));r._postrun=[];for(let t=0;t<e.length;++t)await tE(r,e[t].callback)}return n&&await tE(r,n),i.length&&Promise.all(i).then((e=>r.runAsync(null,(()=>{e.forEach((e=>{try{e(r)}catch(e){r.error(e)}}))})))),r},run:function(e,t,n){return this._pulse?OE(this):(this.evaluate(e,t,n),this)},runAsync:async function(e,t,n){for(;this._running;)await this._running;const r=()=>this._running=null;return(this._running=this.evaluate(e,t,n)).then(r,r),this._running},runAfter:function(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(e){this.error(e)}},_enqueue:function(e,t){const n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))},_getPulse:function(e,t){const n=e.source,r=this._clock;return n&&$g(n)?new NE(this,r,n.map((e=>e.pulse)),t):this._input[e.id]||function(e,t){if(t&&t.stamp===e.stamp)return t;e=e.fork(),t&&t!==AE&&(e.source=t.source);return e}(this._pulse,n&&n.pulse)}},_y(LE,vE,{run:function(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t.then?t=t.then((e=>this.pulse=e)):t!==e.StopPropagation&&(this.pulse=t),t},evaluate:function(e){const t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform:function(){}});const BE={};function IE(e){const t=jE(e);return t&&t.Definition||null}function jE(e){return e=e&&e.toLowerCase(),vy(BE,e)?BE[e]:null}var UE={},qE={};function*WE(e,t){if(null==t)for(let t of e)null!=t&&""!==t&&(t=+t)>=t&&(yield t);else{let n=-1;for(let r of e)r=t(r,++n,e),null!=r&&""!==r&&(r=+r)>=r&&(yield r)}}function HE(e,t,n){const r=Float64Array.from(WE(e,n));return r.sort(Eb),t.map((e=>Rb(r,e)))}function VE(e,t){return HE(e,[.25,.5,.75],t)}function GE(e,t){const n=e.length,r=function(e,t){const n=function(e,t){let n,r=0,i=0,o=0;if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(n=t-i,i+=n/++r,o+=n*(t-i));else{let a=-1;for(let s of e)null!=(s=t(s,++a,e))&&(s=+s)>=s&&(n=s-i,i+=n/++r,o+=n*(s-i))}if(r>1)return o/(r-1)}(e,t);return n?Math.sqrt(n):n}(e,t),i=VE(e,t),o=(i[2]-i[0])/1.34;return 1.06*(Math.min(r,o)||r||Math.abs(i[0])||1)*Math.pow(n,-.2)}function YE(e){const t=e.maxbins||20,n=e.base||10,r=Math.log(n),i=e.divide||[5,2];let o,a,s,u,l,c,f=e.extent[0],d=e.extent[1];const h=e.span||d-f||Math.abs(f)||1;if(e.step)o=e.step;else if(e.steps){for(u=h/t,l=0,c=e.steps.length;l<c&&e.steps[l]<u;++l);o=e.steps[Math.max(0,l-1)]}else{for(a=Math.ceil(Math.log(t)/r),s=e.minstep||0,o=Math.max(s,Math.pow(n,Math.round(Math.log(h)/r)-a));Math.ceil(h/o)>t;)o*=n;for(l=0,c=i.length;l<c;++l)u=o/i[l],u>=s&&h/u<=t&&(o=u)}u=Math.log(o);const p=u>=0?0:1+~~(-u/r),m=Math.pow(n,-p-1);return(e.nice||void 0===e.nice)&&(u=Math.floor(f/o+m)*o,f=f<u?u-o:u,d=Math.ceil(d/o)*o),{start:f,stop:d===f?f+o:d,step:o}}var XE=Math.random;function QE(e){XE=e}function JE(e,t,n,r){if(!e.length)return[void 0,void 0];const i=Float64Array.from(WE(e,r)),o=i.length,a=t;let s,u,l,c;for(l=0,c=Array(a);l<a;++l){for(s=0,u=0;u<o;++u)s+=i[~~(XE()*o)];c[l]=s/o}return c.sort(Eb),[zb(c,n/2),zb(c,1-n/2)]}function KE(e,t,n,r){r=r||(e=>e);const i=e.length,o=new Float64Array(i);let a,s=0,u=1,l=r(e[0]),c=l,f=l+t;for(;u<i;++u){if(a=r(e[u]),a>=f){for(c=(l+c)/2;s<u;++s)o[s]=c;f=a+t,l=a}c=a}for(c=(l+c)/2;s<u;++s)o[s]=c;return n?function(e,t){const n=e.length;let r,i,o=0,a=1;for(;e[o]===e[a];)++a;for(;a<n;){for(r=a+1;e[a]===e[r];)++r;if(e[a]-e[a-1]<t){for(i=a+(o+r-a-a>>1);i<a;)e[i++]=e[a];for(;i>a;)e[i--]=e[o]}o=a,a=r}return e}(o,t+t/4):o}function ZE(e){return function(){return(e=(1103515245*e+12345)%2147483647)/2147483647}}function eS(e,t){let n,r,i;null==t&&(t=e,e=0);const o={min:function(e){return arguments.length?(n=e||0,i=r-n,o):n},max:function(e){return arguments.length?(r=e||0,i=r-n,o):r},sample:function(){return n+Math.floor(i*XE())},pdf:function(e){return e===Math.floor(e)&&e>=n&&e<r?1/i:0},cdf:function(e){const t=Math.floor(e);return t<n?0:t>=r?1:(t-n+1)/i},icdf:function(e){return e>=0&&e<=1?n-1+Math.floor(e*i):NaN}};return o.min(e).max(t)}const tS=Math.sqrt(2*Math.PI),nS=Math.SQRT2;let rS=NaN;function iS(e,t){e=e||0,t=null==t?1:t;let n,r,i=0,o=0;if(rS==rS)i=rS,rS=NaN;else{do{i=2*XE()-1,o=2*XE()-1,n=i*i+o*o}while(0===n||n>1);r=Math.sqrt(-2*Math.log(n)/n),i*=r,rS=o*r}return e+i*t}function oS(e,t,n){const r=(e-(t||0))/(n=null==n?1:n);return Math.exp(-.5*r*r)/(n*tS)}function aS(e,t,n){const r=(e-(t=t||0))/(n=null==n?1:n),i=Math.abs(r);let o;if(i>37)o=0;else{const e=Math.exp(-i*i/2);let t;i<7.07106781186547?(t=.0352624965998911*i+.700383064443688,t=t*i+6.37396220353165,t=t*i+33.912866078383,t=t*i+112.079291497871,t=t*i+221.213596169931,t=t*i+220.206867912376,o=e*t,t=.0883883476483184*i+1.75566716318264,t=t*i+16.064177579207,t=t*i+86.7807322029461,t=t*i+296.564248779674,t=t*i+637.333633378831,t=t*i+793.826512519948,t=t*i+440.413735824752,o/=t):(t=i+.65,t=i+4/t,t=i+3/t,t=i+2/t,t=i+1/t,o=e/t/2.506628274631)}return r>0?1-o:o}function sS(e,t,n){return e<0||e>1?NaN:(t||0)+(null==n?1:n)*nS*function(e){let t,n=-Math.log((1-e)*(1+e));n<6.25?(n-=3.125,t=-364441206401782e-35,t=t*n-16850591381820166e-35,t=128584807152564e-32+t*n,t=11157877678025181e-33+t*n,t=t*n-1333171662854621e-31,t=20972767875968562e-33+t*n,t=6637638134358324e-30+t*n,t=t*n-4054566272975207e-29,t=t*n-8151934197605472e-29,t=26335093153082323e-28+t*n,t=t*n-12975133253453532e-27,t=t*n-5415412054294628e-26,t=1.0512122733215323e-9+t*n,t=t*n-4.112633980346984e-9,t=t*n-2.9070369957882005e-8,t=4.2347877827932404e-7+t*n,t=t*n-13654692000834679e-22,t=t*n-13882523362786469e-21,t=.00018673420803405714+t*n,t=t*n-.000740702534166267,t=t*n-.006033670871430149,t=.24015818242558962+t*n,t=1.6536545626831027+t*n):n<16?(n=Math.sqrt(n)-3.25,t=2.2137376921775787e-9,t=9.075656193888539e-8+t*n,t=t*n-2.7517406297064545e-7,t=1.8239629214389228e-8+t*n,t=15027403968909828e-22+t*n,t=t*n-4013867526981546e-21,t=29234449089955446e-22+t*n,t=12475304481671779e-21+t*n,t=t*n-47318229009055734e-21,t=6828485145957318e-20+t*n,t=24031110387097894e-21+t*n,t=t*n-.0003550375203628475,t=.0009532893797373805+t*n,t=t*n-.0016882755560235047,t=.002491442096107851+t*n,t=t*n-.003751208507569241,t=.005370914553590064+t*n,t=1.0052589676941592+t*n,t=3.0838856104922208+t*n):Number.isFinite(n)?(n=Math.sqrt(n)-5,t=-27109920616438573e-27,t=t*n-2.555641816996525e-10,t=1.5076572693500548e-9+t*n,t=t*n-3.789465440126737e-9,t=7.61570120807834e-9+t*n,t=t*n-1.496002662714924e-8,t=2.914795345090108e-8+t*n,t=t*n-6.771199775845234e-8,t=2.2900482228026655e-7+t*n,t=t*n-9.9298272942317e-7,t=4526062597223154e-21+t*n,t=t*n-1968177810553167e-20,t=7599527703001776e-20+t*n,t=t*n-.00021503011930044477,t=t*n-.00013871931833623122,t=1.0103004648645344+t*n,t=4.849906401408584+t*n):t=1/0;return t*e}(2*e-1)}function uS(e,t){let n,r;const i={mean:function(e){return arguments.length?(n=e||0,i):n},stdev:function(e){return arguments.length?(r=null==e?1:e,i):r},sample:()=>iS(n,r),pdf:e=>oS(e,n,r),cdf:e=>aS(e,n,r),icdf:e=>sS(e,n,r)};return i.mean(e).stdev(t)}function lS(e,t){const n=uS();let r=0;const i={data:function(n){return arguments.length?(e=n,r=n?n.length:0,i.bandwidth(t)):e},bandwidth:function(n){return arguments.length?(!(t=n)&&e&&(t=GE(e)),i):t},sample:function(){return e[~~(XE()*r)]+t*n.sample()},pdf:function(i){let o=0,a=0;for(;a<r;++a)o+=n.pdf((i-e[a])/t);return o/t/r},cdf:function(i){let o=0,a=0;for(;a<r;++a)o+=n.cdf((i-e[a])/t);return o/r},icdf:function(){throw Error("KDE icdf not supported.")}};return i.data(e)}function cS(e,t){return e=e||0,t=null==t?1:t,Math.exp(e+iS()*t)}function fS(e,t,n){if(e<=0)return 0;t=t||0,n=null==n?1:n;const r=(Math.log(e)-t)/n;return Math.exp(-.5*r*r)/(n*tS*e)}function dS(e,t,n){return aS(Math.log(e),t,n)}function hS(e,t,n){return Math.exp(sS(e,t,n))}function pS(e,t){let n,r;const i={mean:function(e){return arguments.length?(n=e||0,i):n},stdev:function(e){return arguments.length?(r=null==e?1:e,i):r},sample:()=>cS(n,r),pdf:e=>fS(e,n,r),cdf:e=>dS(e,n,r),icdf:e=>hS(e,n,r)};return i.mean(e).stdev(t)}function mS(e,t){let n,r=0;function i(e){const t=[];let n,i=0;for(n=0;n<r;++n)i+=t[n]=null==e[n]?1:+e[n];for(n=0;n<r;++n)t[n]/=i;return t}const o={weights:function(e){return arguments.length?(n=i(t=e||[]),o):t},distributions:function(n){return arguments.length?(n?(r=n.length,e=n):(r=0,e=[]),o.weights(t)):e},sample:function(){const t=XE();let i=e[r-1],o=n[0],a=0;for(;a<r-1;o+=n[++a])if(t<o){i=e[a];break}return i.sample()},pdf:function(t){let i=0,o=0;for(;o<r;++o)i+=n[o]*e[o].pdf(t);return i},cdf:function(t){let i=0,o=0;for(;o<r;++o)i+=n[o]*e[o].cdf(t);return i},icdf:function(){throw Error("Mixture icdf not supported.")}};return o.distributions(e).weights(t)}function gS(e,t){return null==t&&(t=null==e?1:e,e=0),e+(t-e)*XE()}function yS(e,t,n){return null==n&&(n=null==t?1:t,t=0),e>=t&&e<=n?1/(n-t):0}function vS(e,t,n){return null==n&&(n=null==t?1:t,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function bS(e,t,n){return null==n&&(n=null==t?1:t,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function xS(e,t){let n,r;const i={min:function(e){return arguments.length?(n=e||0,i):n},max:function(e){return arguments.length?(r=null==e?1:e,i):r},sample:()=>gS(n,r),pdf:e=>yS(e,n,r),cdf:e=>vS(e,n,r),icdf:e=>bS(e,n,r)};return null==t&&(t=null==e?1:e,e=0),i.min(e).max(t)}function wS(e,t,n,r){const i=r-e*e,o=Math.abs(i)<1e-24?0:(n-e*t)/i;return[t-o*e,o]}function _S(e,t,n,r){e=e.filter((e=>{let r=t(e),i=n(e);return null!=r&&(r=+r)>=r&&null!=i&&(i=+i)>=i})),r&&e.sort(((e,n)=>t(e)-t(n)));const i=e.length,o=new Float64Array(i),a=new Float64Array(i);let s,u,l,c=0,f=0,d=0;for(l of e)o[c]=s=+t(l),a[c]=u=+n(l),++c,f+=(s-f)/c,d+=(u-d)/c;for(c=0;c<i;++c)o[c]-=f,a[c]-=d;return[o,a,f,d]}function kS(e,t,n,r){let i,o,a=-1;for(const s of e)i=t(s),o=n(s),null!=i&&(i=+i)>=i&&null!=o&&(o=+o)>=o&&r(i,o,++a)}function ES(e,t,n,r,i){let o=0,a=0;return kS(e,t,n,((e,t)=>{const n=t-i(e),s=t-r;o+=n*n,a+=s*s})),1-o/a}function SS(e,t,n){let r=0,i=0,o=0,a=0,s=0;kS(e,t,n,((e,t)=>{++s,r+=(e-r)/s,i+=(t-i)/s,o+=(e*t-o)/s,a+=(e*e-a)/s}));const u=wS(r,i,o,a),l=e=>u[0]+u[1]*e;return{coef:u,predict:l,rSquared:ES(e,t,n,i,l)}}function AS(e,t,n){let r=0,i=0,o=0,a=0,s=0;kS(e,t,n,((e,t)=>{++s,e=Math.log(e),r+=(e-r)/s,i+=(t-i)/s,o+=(e*t-o)/s,a+=(e*e-a)/s}));const u=wS(r,i,o,a),l=e=>u[0]+u[1]*Math.log(e);return{coef:u,predict:l,rSquared:ES(e,t,n,i,l)}}function CS(e,t,n){const[r,i,o,a]=_S(e,t,n);let s,u,l,c=0,f=0,d=0,h=0,p=0;kS(e,t,n,((e,t)=>{s=r[p++],u=Math.log(t),l=s*t,c+=(t*u-c)/p,f+=(l-f)/p,d+=(l*u-d)/p,h+=(s*l-h)/p}));const[m,g]=wS(f/a,c/a,d/a,h/a),y=e=>Math.exp(m+g*(e-o));return{coef:[Math.exp(m-g*o),g],predict:y,rSquared:ES(e,t,n,a,y)}}function DS(e,t,n){let r=0,i=0,o=0,a=0,s=0,u=0;kS(e,t,n,((e,t)=>{const n=Math.log(e),l=Math.log(t);++u,r+=(n-r)/u,i+=(l-i)/u,o+=(n*l-o)/u,a+=(n*n-a)/u,s+=(t-s)/u}));const l=wS(r,i,o,a),c=e=>l[0]*Math.pow(e,l[1]);return l[0]=Math.exp(l[0]),{coef:l,predict:c,rSquared:ES(e,t,n,s,c)}}function MS(e,t,n){const[r,i,o,a]=_S(e,t,n),s=r.length;let u,l,c,f,d=0,h=0,p=0,m=0,g=0;for(u=0;u<s;)l=r[u],c=i[u++],f=l*l,d+=(f-d)/u,h+=(f*l-h)/u,p+=(f*f-p)/u,m+=(l*c-m)/u,g+=(f*c-g)/u;const y=p-d*d,v=d*y-h*h,b=(g*d-m*h)/v,x=(m*y-g*h)/v,w=-b*d,_=e=>b*(e-=o)*e+x*e+w+a;return{coef:[w-x*o+b*o*o+a,x-2*b*o,b],predict:_,rSquared:ES(e,t,n,a,_)}}function FS(e,t,n,r){if(1===r)return SS(e,t,n);if(2===r)return MS(e,t,n);const[i,o,a,s]=_S(e,t,n),u=i.length,l=[],c=[],f=r+1;let d,h,p,m,g;for(d=0;d<f;++d){for(p=0,m=0;p<u;++p)m+=Math.pow(i[p],d)*o[p];for(l.push(m),g=new Float64Array(f),h=0;h<f;++h){for(p=0,m=0;p<u;++p)m+=Math.pow(i[p],d+h);g[h]=m}c.push(g)}c.push(l);const y=function(e){const t=e.length-1,n=[];let r,i,o,a,s;for(r=0;r<t;++r){for(a=r,i=r+1;i<t;++i)Math.abs(e[r][i])>Math.abs(e[r][a])&&(a=i);for(o=r;o<t+1;++o)s=e[o][r],e[o][r]=e[o][a],e[o][a]=s;for(i=r+1;i<t;++i)for(o=t;o>=r;o--)e[o][i]-=e[o][r]*e[r][i]/e[r][r]}for(i=t-1;i>=0;--i){for(s=0,o=i+1;o<t;++o)s+=e[o][i]*n[o];n[i]=(e[t][i]-s)/e[i][i]}return n}(c),v=e=>{e-=a;let t=s+y[0]+y[1]*e+y[2]*e*e;for(d=3;d<f;++d)t+=y[d]*Math.pow(e,d);return t};return{coef:NS(f,y,-a,s),predict:v,rSquared:ES(e,t,n,s,v)}}function NS(e,t,n,r){const i=Array(e);let o,a,s,u;for(o=0;o<e;++o)i[o]=0;for(o=e-1;o>=0;--o)for(s=t[o],u=1,i[o]+=s,a=1;a<=o;++a)u*=(o+1-a)/a,i[o-a]+=s*Math.pow(n,a)*u;return i[0]+=r,i}function OS(e,t,n,r){const[i,o,a,s]=_S(e,t,n,!0),u=i.length,l=Math.max(2,~~(r*u)),c=new Float64Array(u),f=new Float64Array(u),d=new Float64Array(u).fill(1);for(let e=-1;++e<=2;){const t=[0,l-1];for(let e=0;e<u;++e){const n=i[e],r=t[0],a=t[1],s=n-i[r]>i[a]-n?r:a;let u=0,l=0,h=0,p=0,m=0;const g=1/Math.abs(i[s]-n||1);for(let e=r;e<=a;++e){const t=i[e],r=o[e],a=$S(Math.abs(n-t)*g)*d[e],s=t*a;u+=a,l+=s,h+=r*a,p+=r*s,m+=t*s}const[y,v]=wS(l/u,h/u,p/u,m/u);c[e]=y+v*n,f[e]=Math.abs(o[e]-c[e]),TS(i,e+1,t)}if(2===e)break;const n=Pb(f);if(Math.abs(n)<1e-12)break;for(let e,t,r=0;r<u;++r)e=f[r]/(6*n),d[r]=e>=1?1e-12:(t=1-e*e)*t}return function(e,t,n,r){const i=e.length,o=[];let a,s=0,u=0,l=[];for(;s<i;++s)a=e[s]+n,l[0]===a?l[1]+=(t[s]-l[1])/++u:(u=0,l[1]+=r,l=[a,t[s]],o.push(l));return l[1]+=r,o}(i,c,a,s)}function $S(e){return(e=1-e*e*e)*e*e}function TS(e,t,n){const r=e[t];let i=n[0],o=n[1]+1;if(!(o>=e.length))for(;t>i&&e[o]-r<=r-e[i];)n[0]=++i,n[1]=o,++o}const zS=.1*Math.PI/180;function RS(e,t,n,r){n=n||25,r=Math.max(n,r||200);const i=t=>[t,e(t)],o=t[0],a=t[1],s=a-o,u=s/r,l=[i(o)],c=[];if(n===r){for(let e=1;e<r;++e)l.push(i(o+e/n*s));return l.push(i(a)),l}c.push(i(a));for(let e=n;--e>0;)c.push(i(o+e/n*s));let f=l[0],d=c[c.length-1];for(;d;){const e=i((f[0]+d[0])/2);e[0]-f[0]>=u&&PS(f,e,d)>zS?c.push(e):(f=d,l.push(d),c.pop()),d=c[c.length-1]}return l}function PS(e,t,n){const r=Math.atan2(n[1]-e[1],n[0]-e[0]),i=Math.atan2(t[1]-e[1],t[0]-e[0]);return Math.abs(r-i)}function LS(e){return e&&e.length?1===e.length?e[0]:(t=e,e=>{const n=t.length;let r=1,i=String(t[0](e));for(;r<n;++r)i+="|"+t[r](e);return i}):function(){return""};var t}function BS(e,t,n){return n||e+(t?"_"+t:"")}t(qE,"setRandom",(function(){return QE})),t(qE,"sampleUniform",(function(){return gS})),t(qE,"sampleNormal",(function(){return iS})),t(qE,"sampleLogNormal",(function(){return cS})),t(qE,"sampleCurve",(function(){return RS})),t(qE,"regressionQuad",(function(){return MS})),t(qE,"regressionPow",(function(){return DS})),t(qE,"regressionPoly",(function(){return FS})),t(qE,"regressionLog",(function(){return AS})),t(qE,"regressionLoess",(function(){return OS})),t(qE,"regressionLinear",(function(){return SS})),t(qE,"regressionExp",(function(){return CS})),t(qE,"randomUniform",(function(){return xS})),t(qE,"randomNormal",(function(){return uS})),t(qE,"randomMixture",(function(){return mS})),t(qE,"randomLogNormal",(function(){return pS})),t(qE,"randomLCG",(function(){return ZE})),t(qE,"randomKDE",(function(){return lS})),t(qE,"randomInteger",(function(){return eS})),t(qE,"random",(function(){return XE})),t(qE,"quartiles",(function(){return VE})),t(qE,"quantiles",(function(){return HE})),t(qE,"quantileUniform",(function(){return bS})),t(qE,"quantileNormal",(function(){return sS})),t(qE,"quantileLogNormal",(function(){return hS})),t(qE,"dotbin",(function(){return KE})),t(qE,"densityUniform",(function(){return yS})),t(qE,"densityNormal",(function(){return oS})),t(qE,"densityLogNormal",(function(){return fS})),t(qE,"cumulativeUniform",(function(){return vS})),t(qE,"cumulativeNormal",(function(){return aS})),t(qE,"cumulativeLogNormal",(function(){return dS})),t(qE,"bootstrapCI",(function(){return JE})),t(qE,"bin",(function(){return YE})),t(qE,"bandwidthNRD",(function(){return GE}));const IS=()=>{},jS={init:IS,add:IS,rem:IS,idx:0},US={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.sum,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||void 0===e.min)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||void 0===e.max)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3}},qS=Object.keys(US);function WS(e,t){return US[e](t)}function HS(e,t){return e.idx-t.idx}function VS(){this.valid=0,this.missing=0,this._ops.forEach((e=>e.init(this)))}function GS(e,t){null!=e&&""!==e?e==e&&(++this.valid,this._ops.forEach((n=>n.add(this,e,t)))):++this.missing}function YS(e,t){null!=e&&""!==e?e==e&&(--this.valid,this._ops.forEach((n=>n.rem(this,e,t)))):--this.missing}function XS(e){return this._out.forEach((t=>e[t.out]=t.value(this))),e}function QS(e,t){const n=t||Ag,r=function(e){const t={};e.forEach((e=>t[e.name]=e));const n=e=>{e.req&&e.req.forEach((e=>{t[e]||n(t[e]=US[e]())}))};return e.forEach(n),Object.values(t).sort(HS)}(e),i=e.slice().sort(HS);function o(e){this._ops=r,this._out=i,this.cell=e,this.init()}return o.prototype.init=VS,o.prototype.add=GS,o.prototype.rem=YS,o.prototype.set=XS,o.prototype.get=n,o.fields=e.map((e=>e.out)),o}function JS(e){this._key=e?Eg(e):oE,this.reset()}qS.forEach((e=>{US[e]=function(e,t){return n=>py({name:e,out:n||e},jS,t)}(e,US[e])}));const KS=JS.prototype;function ZS(e){LE.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}KS.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null},KS.add=function(e){this._add.push(e)},KS.rem=function(e){this._rem.push(e)},KS.values=function(){if(this._get=null,0===this._rem.length)return this._add;const e=this._add,t=this._rem,n=this._key,r=e.length,i=t.length,o=Array(r-i),a={};let s,u,l;for(s=0;s<i;++s)a[n(t[s])]=1;for(s=0,u=0;s<r;++s)a[n(l=e[s])]?a[n(l)]=0:o[u++]=l;return this._rem=[],this._add=o},KS.distinct=function(e){const t=this.values(),n={};let r,i=t.length,o=0;for(;--i>=0;)r=e(t[i])+"",vy(n,r)||(n[r]=1,++o);return o},KS.extent=function(e){if(this._get!==e||!this._ext){const t=this.values(),n=gy(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext},KS.argmin=function(e){return this.extent(e)[0]||{}},KS.argmax=function(e){return this.extent(e)[1]||{}},KS.min=function(e){const t=this.extent(e)[0];return null!=t?e(t):void 0},KS.max=function(e){const t=this.extent(e)[1];return null!=t?e(t):void 0},KS.quartile=function(e){return this._get===e&&this._q||(this._q=VE(this.values(),e),this._get=e),this._q},KS.q1=function(e){return this.quartile(e)[0]},KS.q2=function(e){return this.quartile(e)[1]},KS.q3=function(e){return this.quartile(e)[2]},KS.ci=function(e){return this._get===e&&this._ci||(this._ci=JE(this.values(),1e3,.05,e),this._get=e),this._ci},KS.ci0=function(e){return this.ci(e)[0]},KS.ci1=function(e){return this.ci(e)[1]},ZS.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:qS},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]},_y(ZS,LE,{transform:function(e,t){const n=this,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.modified();return n.stamp=r.stamp,n.value&&(i||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=i?n.init(e):{},t.visit(t.SOURCE,(e=>n.add(e)))):(n.value=n.value||n.init(e),t.visit(t.REM,(e=>n.rem(e))),t.visit(t.ADD,(e=>n.add(e)))),r.modifies(n._outputs),n._drop=!1!==e.drop,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&r.clean(!0).runAfter((()=>this.clean())),n.changes(r)},cross:function(){const e=this,t=e.value,n=e._dnames,r=n.map((()=>({}))),i=n.length;function o(e){let t,o,a,s;for(t in e)for(a=e[t].tuple,o=0;o<i;++o)r[o][s=a[n[o]]]=s}o(e._prev),o(t),function o(a,s,u){const l=n[u],c=r[u++];for(const n in c){const r=a?a+"|"+n:n;s[l]=c[n],u<i?o(r,s,u):t[r]||e.cell(r,s)}}("",{},0)},init:function(e){const t=this._inputs=[],n=this._outputs=[],r={};function i(e){const n=iy(vg(e)),i=n.length;let o,a=0;for(;a<i;++a)r[o=n[a]]||(r[o]=1,t.push(o))}this._dims=iy(e.groupby),this._dnames=this._dims.map((e=>{const t=yg(e);return i(e),n.push(t),t})),this.cellkey=e.key?e.key:LS(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const o=e.fields||[null],a=e.ops||["count"],s=e.as||[],u=o.length,l={};let c,f,d,h,p,m;for(u!==a.length&&_g("Unmatched number of fields and aggregate ops."),m=0;m<u;++m)c=o[m],f=a[m],null==c&&"count"!==f&&_g("Null aggregate field specified."),h=yg(c),p=BS(f,h,s[m]),n.push(p),"count"!==f?(d=l[h],d||(i(c),d=l[h]=[],d.field=c,this._measures.push(d)),"count"!==f&&(this._countOnly=!1),d.push(WS(f,p))):this._counts.push(p);return this._measures=this._measures.map((e=>QS(e,e.field))),{}},cellkey:LS(),cell:function(e,t){let n=this.value[e];return n?0===n.num&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell:function(e,t){const n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){const e=this._measures,t=e.length;n.agg=Array(t);for(let r=0;r<t;++r)n.agg[r]=new e[r](n)}return n.store&&(n.data=new JS),n},newtuple:function(e,t){const n=this._dnames,r=this._dims,i=r.length,o={};for(let t=0;t<i;++t)o[n[t]]=r[t](e);return t?cE(t.tuple,o):sE(o)},clean:function(){const e=this.value;for(const t in e)0===e[t].num&&delete e[t]},add:function(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(e);const r=n.agg;for(let t=0,n=r.length;t<n;++t)r[t].add(r[t].get(e),e)},rem:function(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(e);const r=n.agg;for(let t=0,n=r.length;t<n;++t)r[t].rem(r[t].get(e),e)},celltuple:function(e){const t=e.tuple,n=this._counts;e.store&&e.data.values();for(let r=0,i=n.length;r<i;++r)t[n[r]]=e.num;if(!this._countOnly){const n=e.agg;for(let e=0,r=n.length;e<r;++e)n[e].set(t)}return t},changes:function(e){const t=this._adds,n=this._mods,r=this._prev,i=this._drop,o=e.add,a=e.rem,s=e.mod;let u,l,c,f;if(r)for(l in r)u=r[l],i&&!u.num||a.push(u.tuple);for(c=0,f=this._alen;c<f;++c)o.push(this.celltuple(t[c])),t[c]=null;for(c=0,f=this._mlen;c<f;++c)u=n[c],(0===u.num&&i?a:s).push(this.celltuple(u)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,e}});function eA(e){LE.call(this,null,e)}function tA(e,t,n){const r=e;let i=t||[],o=n||[],a={},s=0;return{add:e=>o.push(e),remove:e=>a[r(e)]=++s,size:()=>i.length,data:(e,t)=>(s&&(i=i.filter((e=>!a[r(e)])),a={},s=0),t&&e&&i.sort(e),o.length&&(i=e?$y(e,i,o.sort(e)):i.concat(o),o=[]),i)}}function nA(e){LE.call(this,[],e)}function rA(e){vE.call(this,null,iA,e)}function iA(e){return this.value&&!e.modified()?this.value:sy(e.fields,e.orders)}function oA(e){LE.call(this,null,e)}function aA(e){LE.call(this,null,e)}eA.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]},_y(eA,LE,{transform:function(e,t){const n=!1!==e.interval,r=this._bins(e),i=r.start,o=r.step,a=e.as||["bin0","bin1"],s=a[0],u=a[1];let l;return l=e.modified()?(t=t.reflow(!0)).SOURCE:t.modified(vg(e.field))?t.ADD_MOD:t.ADD,t.visit(l,n?e=>{const t=r(e);e[s]=t,e[u]=null==t?null:i+o*(1+(t-i)/o)}:e=>e[s]=r(e)),t.modifies(n?a:s)},_bins:function(e){if(this.value&&!e.modified())return this.value;const t=e.field,n=YE(e),r=n.step;let i,o,a=n.start,s=a+Math.ceil((n.stop-a)/r)*r;null!=(i=e.anchor)&&(o=i-(a+r*Math.floor((i-a)/r)),a+=o,s+=o);const u=function(e){let n=Ig(t(e));return null==n?null:n<a?-1/0:n>s?1/0:(n=Math.max(a,Math.min(n,s-r)),a+r*Math.floor(1e-14+(n-a)/r))};return u.start=a,u.stop=n.stop,u.step=r,this.value=gg(u,vg(t),e.name||"bin_"+yg(t))}}),nA.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]},_y(nA,LE,{transform:function(e,t){const n=t.fork(t.ALL),r=tA(oE,this.value,n.materialize(n.ADD).add),i=e.sort,o=t.changed()||i&&(e.modified("sort")||t.modified(i.fields));return n.visit(n.REM,r.remove),this.modified(o),this.value=n.source=r.data(fE(i),o),t.source&&t.source.root&&(this.value.root=t.source.root),n}}),_y(rA,vE),oA.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]},_y(oA,LE,{transform:function(e,t){const n=t=>n=>{for(var r,i=function(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase()}return e.match(n)}(s(n),e.case,o)||[],u=0,l=i.length;u<l;++u)a.test(r=i[u])||t(r)},r=this._parameterCheck(e,t),i=this._counts,o=this._match,a=this._stop,s=e.field,u=e.as||["text","count"],l=n((e=>i[e]=1+(i[e]||0))),c=n((e=>i[e]-=1));return r?t.visit(t.SOURCE,l):(t.visit(t.ADD,l),t.visit(t.REM,c)),this._finish(t,u)},_parameterCheck:function(e,t){let n=!1;return!e.modified("stopwords")&&this._stop||(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),!e.modified("pattern")&&this._match||(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish:function(e,t){const n=this._counts,r=this._tuples||(this._tuples={}),i=t[0],o=t[1],a=e.fork(e.NO_SOURCE|e.NO_FIELDS);let s,u,l;for(s in n)u=r[s],l=n[s]||0,!u&&l?(r[s]=u=sE({}),u[i]=s,u[o]=l,a.add.push(u)):0===l?(u&&a.rem.push(u),n[s]=null,r[s]=null):u[o]!==l&&(u[o]=l,a.mod.push(u));return a.modifies(t)}}),aA.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]},_y(aA,LE,{transform:function(e,t){const n=t.fork(t.NO_SOURCE),r=e.as||["a","b"],i=r[0],o=r[1],a=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");let s=this.value;return a?(s&&(n.rem=s),s=t.materialize(t.SOURCE).source,n.add=this.value=function(e,t,n,r){for(var i,o,a=[],s={},u=e.length,l=0;l<u;++l)for(s[t]=o=e[l],i=0;i<u;++i)s[n]=e[i],r(s)&&(a.push(sE(s)),(s={})[t]=o);return a}(s,i,o,e.filter||Mg)):n.mod=s,n.source=this.value,n.modifies(r)}});const sA={kde:lS,mixture:mS,normal:uS,lognormal:pS,uniform:xS},uA="function";function lA(e,t){const n=e.function;vy(sA,n)||_g("Unknown distribution function: "+n);const r=sA[n]();for(const n in e)"field"===n?r.data((e.from||t()).map(e[n])):"distributions"===n?r[n](e[n].map((e=>lA(e,t)))):typeof r[n]===uA&&r[n](e[n]);return r}function cA(e){LE.call(this,null,e)}const fA=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],dA={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:fA},{name:"weights",type:"number",array:!0}]};function hA(e,t){return e?e.map(((e,n)=>t[n]||yg(e))):null}function pA(e,t,n){const r=[],i=e=>e(u);let o,a,s,u,l,c;if(null==t)r.push(e.map(n));else for(o={},a=0,s=e.length;a<s;++a)u=e[a],l=t.map(i),c=o[l],c||(o[l]=c=[],c.dims=l,r.push(c)),c.push(n(u));return r}cA.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:fA.concat(dA)},{name:"as",type:"string",array:!0,default:["value","density"]}]},_y(cA,LE,{transform:function(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=lA(e.distribution,function(e){return()=>e.materialize(e.SOURCE).source}(t)),i=e.steps||e.minsteps||25,o=e.steps||e.maxsteps||200;let a=e.method||"pdf";"pdf"!==a&&"cdf"!==a&&_g("Invalid density method: "+a),e.extent||r.data||_g("Missing density extent parameter."),a=r[a];const s=e.as||["value","density"],u=RS(a,e.extent||my(r.data()),i,o).map((e=>{const t={};return t[s[0]]=e[0],t[s[1]]=e[1],sE(t)}));this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});function mA(e){LE.call(this,null,e)}mA.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:"bin"}]};function gA(e){vE.call(this,null,yA,e),this.modified(!0)}function yA(e){const t=e.expr;return this.value&&!e.modified("expr")?this.value:gg((n=>t(n,e)),vg(t),yg(t))}function vA(e){LE.call(this,[void 0,void 0],e)}function bA(e,t){vE.call(this,e),this.parent=t,this.count=0}function xA(e){LE.call(this,{},e),this._keys=xy();const t=this._targets=[];t.active=0,t.forEach=e=>{for(let n=0,r=t.active;n<r;++n)e(t[n],n,t)}}function wA(e){vE.call(this,null,_A,e)}function _A(e){return this.value&&!e.modified()?this.value:$g(e.name)?iy(e.name).map((e=>Eg(e))):Eg(e.name,e.as)}function kA(e){LE.call(this,xy(),e)}function EA(e){LE.call(this,[],e)}function SA(e){LE.call(this,[],e)}function AA(e){LE.call(this,null,e)}function CA(e){LE.call(this,[],e)}_y(mA,LE,{transform:function(e,t){if(this.value&&!e.modified()&&!t.changed())return t;const n=t.materialize(t.SOURCE).source,r=pA(t.source,e.groupby,Ag),i=e.smooth||!1,o=e.field,a=e.step||((e,t)=>Ry(my(e,t))/30)(n,o),s=fE(((e,t)=>o(e)-o(t))),u=e.as||"bin",l=r.length;let c,f=1/0,d=-1/0,h=0;for(;h<l;++h){const e=r[h].sort(s);c=-1;for(const t of KE(e,a,i,o))t<f&&(f=t),t>d&&(d=t),e[++c][u]=t}return this.value={start:f,stop:d,step:a},t.reflow(!0).modifies(u)}}),_y(gA,vE),vA.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]},_y(vA,LE,{transform:function(e,t){const n=this.value,r=e.field,i=t.changed()||t.modified(r.fields)||e.modified("field");let o=n[0],a=n[1];if((i||null==o)&&(o=1/0,a=-1/0),t.visit(i?t.SOURCE:t.ADD,(e=>{const t=Ig(r(e));null!=t&&(t<o&&(o=t),t>a&&(a=t))})),!Number.isFinite(o)||!Number.isFinite(a)){let e=yg(r);e&&(e=` for field "${e}"`),t.dataflow.warn(`Infinite extent${e}: [${o}, ${a}]`),o=a=void 0}this.value=[o,a]}}),_y(bA,vE,{connect:function(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add:function(e){this.count+=1,this.value.add.push(e)},rem:function(e){this.count-=1,this.value.rem.push(e)},mod:function(e){this.value.mod.push(e)},init:function(e){this.value.init(e,e.NO_SOURCE)},evaluate:function(){return this.value}}),_y(xA,LE,{activate:function(e){this._targets[this._targets.active++]=e},subflow:function(e,t,n,r){const i=this.value;let o,a,s=vy(i,e)&&i[e];return s?s.value.stamp<n.stamp&&(s.init(n),this.activate(s)):(a=r||(a=this._group[e])&&a.tuple,o=n.dataflow,s=new bA(n.fork(n.NO_SOURCE),this),o.add(s).connect(t(o,e,a)),i[e]=s,this.activate(s)),s},clean:function(){const e=this.value;let t=0;for(const n in e)if(0===e[n].count){const r=e[n].detachSubflow;r&&r(),delete e[n],++t}if(t){const e=this._targets.filter((e=>e&&e.count>0));this.initTargets(e)}},initTargets:function(e){const t=this._targets,n=t.length,r=e?e.length:0;let i=0;for(;i<r;++i)t[i]=e[i];for(;i<n&&null!=t[i];++i)t[i]=null;t.active=r},transform:function(e,t){const n=t.dataflow,r=e.key,i=e.subflow,o=this._keys,a=e.modified("key"),s=e=>this.subflow(e,i,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,(e=>{const t=oE(e),n=o.get(t);void 0!==n&&(o.delete(t),s(n).rem(e))})),t.visit(t.ADD,(e=>{const t=r(e);o.set(oE(e),t),s(t).add(e)})),a||t.modified(r.fields)?t.visit(t.MOD,(e=>{const t=oE(e),n=o.get(t),i=r(e);n===i?s(i).mod(e):(o.set(t,i),s(n).rem(e),s(i).add(e))})):t.changed(t.MOD)&&t.visit(t.MOD,(e=>{s(o.get(oE(e))).mod(e)})),a&&t.visit(t.REFLOW,(e=>{const t=oE(e),n=o.get(t),i=r(e);n!==i&&(o.set(t,i),s(n).rem(e),s(i).add(e))})),t.clean()?n.runAfter((()=>{this.clean(),o.clean()})):o.empty>n.cleanThreshold&&n.runAfter(o.clean),t}}),_y(wA,vE),kA.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]},_y(kA,LE,{transform:function(e,t){const n=t.dataflow,r=this.value,i=t.fork(),o=i.add,a=i.rem,s=i.mod,u=e.expr;let l=!0;function c(t){const n=oE(t),i=u(t,e),c=r.get(n);i&&c?(r.delete(n),o.push(t)):i||c?l&&i&&!c&&s.push(t):(r.set(n,1),a.push(t))}return t.visit(t.REM,(e=>{const t=oE(e);r.has(t)?r.delete(t):a.push(e)})),t.visit(t.ADD,(t=>{u(t,e)?o.push(t):r.set(oE(t),1)})),t.visit(t.MOD,c),e.modified()&&(l=!1,t.visit(t.REFLOW,c)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),i}}),EA.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]},_y(EA,LE,{transform:function(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=hA(r,e.as||[]),o=e.index||null,a=i.length;return n.rem=this.value,t.visit(t.SOURCE,(e=>{const t=r.map((t=>t(e))),s=t.reduce(((e,t)=>Math.max(e,t.length)),0);let u,l,c,f=0;for(;f<s;++f){for(l=uE(e),u=0;u<a;++u)l[i[u]]=null==(c=t[u][f])?null:c;o&&(l[o]=f),n.add.push(l)}})),this.value=n.source=n.add,o&&n.modifies(o),n.modifies(i)}}),SA.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]},_y(SA,LE,{transform:function(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=r.map(yg),o=e.as||["key","value"],a=o[0],s=o[1],u=r.length;return n.rem=this.value,t.visit(t.SOURCE,(e=>{for(let t,o=0;o<u;++o)t=uE(e),t[a]=i[o],t[s]=r[o](e),n.add.push(t)})),this.value=n.source=n.add,n.modifies(o)}}),AA.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]},_y(AA,LE,{transform:function(e,t){const n=e.expr,r=e.as,i=e.modified(),o=e.initonly?t.ADD:i?t.SOURCE:t.modified(n.fields)||t.modified(r)?t.ADD_MOD:t.ADD;return i&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(r),t.visit(o,(t=>t[r]=n(t,e)))}}),_y(CA,LE,{transform:function(e,t){const n=t.fork(t.ALL),r=e.generator;let i,o,a,s=this.value,u=e.size-s.length;if(u>0){for(i=[];--u>=0;)i.push(a=sE(r(e))),s.push(a);n.add=n.add.length?n.materialize(n.ADD).add.concat(i):i}else o=s.slice(0,-u),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(o):o,s=s.slice(-u);return n.source=this.value=s,n}});const DA={value:"value",median:Pb,mean:function(e,t){let n=0,r=0;if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(++n,r+=t);else{let i=-1;for(let o of e)null!=(o=t(o,++i,e))&&(o=+o)>=o&&(++n,r+=o)}if(n)return r/n},min:Ob,max:Nb},MA=[];function FA(e){LE.call(this,[],e)}function NA(e){ZS.call(this,e)}function OA(e){LE.call(this,null,e)}function $A(e){vE.call(this,null,TA,e)}function TA(e){return this.value&&!e.modified()?this.value:Fy(e.fields,e.flat)}function zA(e){LE.call(this,[],e),this._pending=null}function RA(e,t,n){n.forEach(sE);const r=t.fork(t.NO_FIELDS&t.NO_SOURCE);return r.rem=e.value,e.value=r.source=r.add=n,e._pending=null,r.rem.length&&r.clean(!0),r}function PA(e){LE.call(this,{},e)}function LA(e){vE.call(this,null,BA,e)}function BA(e){if(this.value&&!e.modified())return this.value;const t=e.extents,n=t.length;let r,i,o=1/0,a=-1/0;for(r=0;r<n;++r)i=t[r],i[0]<o&&(o=i[0]),i[1]>a&&(a=i[1]);return[o,a]}function IA(e){vE.call(this,null,jA,e)}function jA(e){return this.value&&!e.modified()?this.value:e.values.reduce(((e,t)=>e.concat(t)),[])}function UA(e){LE.call(this,null,e)}function qA(e){ZS.call(this,e)}function WA(e){xA.call(this,e)}function HA(e){LE.call(this,null,e)}function VA(e){LE.call(this,null,e)}function GA(e){LE.call(this,null,e)}FA.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]},_y(FA,LE,{transform:function(e,t){var n,r,i,o,a,s,u,l,c,f,d=t.fork(t.ALL),h=function(e){var t,n=e.method||DA.value;if(null!=DA[n])return n===DA.value?(t=void 0!==e.value?e.value:0,()=>t):DA[n];_g("Unrecognized imputation method: "+n)}(e),p=function(e){const t=e.field;return e=>e?t(e):NaN}(e),m=yg(e.field),g=yg(e.key),y=(e.groupby||[]).map(yg),v=function(e,t,n,r){var i,o,a,s,u,l,c,f,d=e=>e(f),h=[],p=r?r.slice():[],m={},g={};for(p.forEach(((e,t)=>m[e]=t+1)),s=0,c=e.length;s<c;++s)l=n(f=e[s]),u=m[l]||(m[l]=p.push(l)),(a=g[o=(i=t?t.map(d):MA)+""])||(a=g[o]=[],h.push(a),a.values=i),a[u-1]=f;return h.domain=p,h}(t.source,e.groupby,e.key,e.keyvals),b=[],x=this.value,w=v.domain.length;for(a=0,l=v.length;a<l;++a)for(i=(n=v[a]).values,r=NaN,u=0;u<w;++u)if(null==n[u]){for(o=v.domain[u],f={_impute:!0},s=0,c=i.length;s<c;++s)f[y[s]]=i[s];f[g]=o,f[m]=Number.isNaN(r)?r=h(n,p):r,b.push(sE(f))}return b.length&&(d.add=d.materialize(d.ADD).add.concat(b)),x.length&&(d.rem=d.materialize(d.REM).rem.concat(x)),this.value=b,d}}),NA.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:qS},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]},_y(NA,ZS,{transform:function(e,t){const n=this,r=e.modified();let i;return n.value&&(r||t.modified(n._inputs,!0))?(i=n.value=r?n.init(e):{},t.visit(t.SOURCE,(e=>n.add(e)))):(i=n.value=n.value||this.init(e),t.visit(t.REM,(e=>n.rem(e))),t.visit(t.ADD,(e=>n.add(e)))),n.changes(),t.visit(t.SOURCE,(e=>{py(e,i[n.cellkey(e)].tuple)})),t.reflow(r).modifies(this._outputs)},changes:function(){const e=this._adds,t=this._mods;let n,r;for(n=0,r=this._alen;n<r;++n)this.celltuple(e[n]),e[n]=null;for(n=0,r=this._mlen;n<r;++n)this.celltuple(t[n]),t[n]=null;this._alen=this._mlen=0}}),OA.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]},_y(OA,LE,{transform:function(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=pA(r,e.groupby,e.field),o=(e.groupby||[]).map(yg),a=e.bandwidth,s=e.cumulative?"cdf":"pdf",u=e.as||["value","density"],l=[];let c=e.extent,f=e.steps||e.minsteps||25,d=e.steps||e.maxsteps||200;"pdf"!==s&&"cdf"!==s&&_g("Invalid density method: "+s),"shared"===e.resolve&&(c||(c=my(r,e.field)),f=d=e.steps||d),i.forEach((t=>{const n=lS(t,a)[s],r=e.counts?t.length:1;RS(n,c||my(t),f,d).forEach((e=>{const n={};for(let e=0;e<o.length;++e)n[o[e]]=t.dims[e];n[u[0]]=e[0],n[u[1]]=e[1]*r,l.push(sE(n))}))})),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}}),_y($A,vE),_y(zA,LE,{transform:function(e,t){const n=t.dataflow;if(this._pending)return RA(this,t,this._pending);if(function(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}(e))return t.StopPropagation;if(e.values)return RA(this,t,n.parse(e.values,e.format));if(e.async){return{async:n.request(e.url,e.format).then((e=>(this._pending=iy(e.data),e=>e.touch(this))))}}return n.request(e.url,e.format).then((e=>RA(this,t,iy(e.data))))}}),PA.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]},_y(PA,LE,{transform:function(e,t){const n=e.fields,r=e.index,i=e.values,o=null==e.default?null:e.default,a=e.modified(),s=n.length;let u,l,c,f=a?t.SOURCE:t.ADD,d=t,h=e.as;return i?(l=i.length,s>1&&!h&&_g('Multi-field lookup requires explicit "as" parameter.'),h&&h.length!==s*l&&_g('The "as" parameter has too few output field names.'),h=h||i.map(yg),u=function(e){for(var t,a,u=0,c=0;u<s;++u)if(null==(a=r.get(n[u](e))))for(t=0;t<l;++t,++c)e[h[c]]=o;else for(t=0;t<l;++t,++c)e[h[c]]=i[t](a)}):(h||_g("Missing output field names."),u=function(e){for(var t,i=0;i<s;++i)t=r.get(n[i](e)),e[h[i]]=null==t?o:t}),a?d=t.reflow(!0):(c=n.some((e=>t.modified(e.fields))),f|=c?t.MOD:0),t.visit(f,u),d.modifies(h)}}),_y(LA,vE),_y(IA,vE),_y(UA,LE,{transform:function(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}}),qA.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:qS,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]},_y(qA,ZS,{_transform:ZS.prototype.transform,transform:function(e,t){return this._transform(function(e,t){const n=e.field,r=e.value,i=("count"===e.op?"__count__":e.op)||"sum",o=vg(n).concat(vg(r)),a=function(e,t,n){const r={},i=[];return n.visit(n.SOURCE,(t=>{const n=e(t);r[n]||(r[n]=1,i.push(n))})),i.sort(uy),t?i.slice(0,t):i}(n,e.limit||0,t);t.changed()&&e.set("__pivot__",null,null,!0);return{key:e.key,groupby:e.groupby,ops:a.map((()=>i)),fields:a.map((e=>function(e,t,n,r){return gg((r=>t(r)===e?n(r):NaN),r,e+"")}(e,n,r,o))),as:a.map((e=>e+"")),modified:e.modified.bind(e)}}(e,t),t)}}),_y(WA,xA,{transform:function(e,t){const n=e.subflow,r=e.field,i=e=>this.subflow(oE(e),n,t,e);return(e.modified("field")||r&&t.modified(vg(r)))&&_g("PreFacet does not support field modification."),this.initTargets(),r?(t.visit(t.MOD,(e=>{const t=i(e);r(e).forEach((e=>t.mod(e)))})),t.visit(t.ADD,(e=>{const t=i(e);r(e).forEach((e=>t.add(sE(e))))})),t.visit(t.REM,(e=>{const t=i(e);r(e).forEach((e=>t.rem(e)))}))):(t.visit(t.MOD,(e=>i(e).mod(e))),t.visit(t.ADD,(e=>i(e).add(e))),t.visit(t.REM,(e=>i(e).rem(e)))),t.clean()&&t.runAfter((()=>this.clean())),t}}),HA.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]},_y(HA,LE,{transform:function(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=hA(e.fields,e.as||[]),o=r?(e,t)=>function(e,t,n,r){for(let i=0,o=n.length;i<o;++i)t[r[i]]=n[i](e);return t}(e,t,r,i):lE;let a;return this.value?a=this.value:(t=t.addAll(),a=this.value={}),t.visit(t.REM,(e=>{const t=oE(e);n.rem.push(a[t]),a[t]=null})),t.visit(t.ADD,(e=>{const t=o(e,sE({}));a[oE(e)]=t,n.add.push(t)})),t.visit(t.MOD,(e=>{n.mod.push(o(e,a[oE(e)]))})),n}}),_y(VA,LE,{transform:function(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}}),GA.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};function YA(e){LE.call(this,null,e)}function XA(e){LE.call(this,[],e),this.count=0}function QA(e){LE.call(this,null,e)}function JA(e){LE.call(this,null,e),this.modified(!0)}function KA(e){LE.call(this,null,e)}_y(GA,LE,{transform:function(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;const i=pA(t.materialize(t.SOURCE).source,e.groupby,e.field),o=(e.groupby||[]).map(yg),a=[],s=e.step||.01,u=e.probs||Bb(s/2,1-1e-14,s),l=u.length;return i.forEach((e=>{const t=HE(e,u);for(let n=0;n<l;++n){const i={};for(let t=0;t<o.length;++t)i[o[t]]=e.dims[t];i[r[0]]=u[n],i[r[1]]=t[n],a.push(sE(i))}})),this.value&&(n.rem=this.value),this.value=n.add=n.source=a,n}}),_y(YA,LE,{transform:function(e,t){let n,r;return this.value?r=this.value:(n=t=t.addAll(),r=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,(e=>{const t=oE(e);n.rem.push(r[t]),r[t]=null})),t.visit(t.ADD,(e=>{const t=uE(e);r[oE(e)]=t,n.add.push(t)})),t.visit(t.MOD,(e=>{const t=r[oE(e)];for(const r in e)t[r]=e[r],n.modifies(r);n.mod.push(t)}))),n}}),XA.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]},_y(XA,LE,{transform:function(e,t){const n=t.fork(t.NO_SOURCE),r=e.modified("size"),i=e.size,o=this.value.reduce(((e,t)=>(e[oE(t)]=1,e)),{});let a=this.value,s=this.count,u=0;function l(e){let t,r;a.length<i?a.push(e):(r=~~((s+1)*XE()),r<a.length&&r>=u&&(t=a[r],o[oE(t)]&&n.rem.push(t),a[r]=e)),++s}if(t.rem.length&&(t.visit(t.REM,(e=>{const t=oE(e);o[t]&&(o[t]=-1,n.rem.push(e)),--s})),a=a.filter((e=>-1!==o[oE(e)]))),(t.rem.length||r)&&a.length<i&&t.source&&(u=s=a.length,t.visit(t.SOURCE,(e=>{o[oE(e)]||l(e)})),u=-1),r&&a.length>i){const e=a.length-i;for(let t=0;t<e;++t)o[oE(a[t])]=-1,n.rem.push(a[t]);a=a.slice(e)}return t.mod.length&&t.visit(t.MOD,(e=>{o[oE(e)]&&n.mod.push(e)})),t.add.length&&t.visit(t.ADD,l),(t.add.length||u<0)&&(n.add=a.filter((e=>!o[oE(e)]))),this.count=s,this.value=n.source=a,n}}),QA.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]},_y(QA,LE,{transform:function(e,t){if(this.value&&!e.modified())return;const n=t.materialize().fork(t.MOD),r=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=Bb(e.start,e.stop,e.step||1).map((e=>{const t={};return t[r]=e,sE(t)})),n.add=t.add.concat(this.value),n}}),_y(JA,LE,{transform:function(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});const ZA=["unit0","unit1"];function eC(e){LE.call(this,xy(),e)}function tC(e){LE.call(this,null,e)}KA.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:dw,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:ZA}]},_y(KA,LE,{transform:function(e,t){const n=e.field,r=!1!==e.interval,i="utc"===e.timezone,o=this._floor(e,t),a=(i?Uw:jw)(o.unit).offset,s=e.as||ZA,u=s[0],l=s[1],c=o.step;let f=o.start||1/0,d=o.stop||-1/0,h=t.ADD;return(e.modified()||t.modified(vg(n)))&&(h=(t=t.reflow(!0)).SOURCE,f=1/0,d=-1/0),t.visit(h,(e=>{const t=n(e);let i,s;null==t?(e[u]=null,r&&(e[l]=null)):(e[u]=i=s=o(t),r&&(e[l]=s=a(i,c)),i<f&&(f=i),s>d&&(d=s))})),o.start=f,o.stop=d,t.modifies(r?s:u)},_floor:function(e,t){const n="utc"===e.timezone,{units:r,step:i}=e.units?{units:e.units,step:e.step||1}:l_({extent:e.extent||my(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),o=pw(r),a=this.value||{},s=(n?Lw:zw)(o,i);return s.unit=Bg(o),s.units=o,s.step=i,s.start=a.start,s.stop=a.stop,this.value=s}}),_y(eC,LE,{transform:function(e,t){const n=t.dataflow,r=e.field,i=this.value,o=e=>i.set(r(e),e);let a=!0;return e.modified("field")||t.modified(r.fields)?(i.clear(),t.visit(t.SOURCE,o)):t.changed()?(t.visit(t.REM,(e=>i.delete(r(e)))),t.visit(t.ADD,o)):a=!1,this.modified(a),i.empty>n.cleanThreshold&&n.runAfter(i.clean),t.fork()}}),_y(tC,LE,{transform:function(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(fE(e.sort)):t.source).map(e.field))}});const nC={row_number:function(){return{next:e=>e.index+1}},rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?e=n+1:e}}},dense_rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?++e:e}}},percent_rank:function(){const e=nC.rank(),t=e.next;return{init:e.init,next:e=>(t(e)-1)/(e.data.length-1)}},cume_dist:function(){let e;return{init:()=>e=0,next:t=>{const n=t.data,r=t.compare;let i=t.index;if(e<i){for(;i+1<n.length&&!r(n[i],n[i+1]);)++i;e=i}return(1+e)/n.length}}},ntile:function(e,t){(t=+t)>0||_g("ntile num must be greater than zero.");const n=nC.cume_dist(),r=n.next;return{init:n.init,next:e=>Math.ceil(t*r(e))}},lag:function(e,t){return t=+t||1,{next:n=>{const r=n.index-t;return r>=0?e(n.data[r]):null}}},lead:function(e,t){return t=+t||1,{next:n=>{const r=n.index+t,i=n.data;return r<i.length?e(i[r]):null}}},first_value:function(e){return{next:t=>e(t.data[t.i0])}},last_value:function(e){return{next:t=>e(t.data[t.i1-1])}},nth_value:function(e,t){return(t=+t)>0||_g("nth_value nth must be greater than zero."),{next:n=>{const r=n.i0+(t-1);return r<n.i1?e(n.data[r]):null}}},prev_value:function(e){let t;return{init:()=>t=null,next:n=>{const r=e(n.data[n.index]);return null!=r?t=r:t}}},next_value:function(e){let t,n;return{init:()=>(t=null,n=-1),next:r=>{const i=r.data;return r.index<=n?t:(n=function(e,t,n){for(let r=t.length;n<r;++n){if(null!=e(t[n]))return n}return-1}(e,i,r.index))<0?(n=i.length,t=null):t=e(i[n])}}}};const rC=Object.keys(nC);function iC(e){const t=iy(e.ops),n=iy(e.fields),r=iy(e.params),i=iy(e.as),o=this.outputs=[],a=this.windows=[],s={},u={},l=[],c=[];let f=!0;function d(e){iy(vg(e)).forEach((e=>s[e]=1))}d(e.sort),t.forEach(((e,t)=>{const s=n[t],h=yg(s),p=BS(e,h,i[t]);if(d(s),o.push(p),vy(nC,e))a.push(function(e,t,n,r){const i=nC[e](t,n);return{init:i.init||Cg,update:function(e,t){t[r]=i.next(e)}}}(e,n[t],r[t],p));else{if(null==s&&"count"!==e&&_g("Null aggregate field specified."),"count"===e)return void l.push(p);f=!1;let t=u[h];t||(t=u[h]=[],t.field=s,c.push(t)),t.push(WS(e,p))}})),(l.length||c.length)&&(this.cell=function(e,t,n){e=e.map((e=>QS(e,e.field)));const r={num:0,agg:null,store:!1,count:t};if(!n)for(var i=e.length,o=r.agg=Array(i),a=0;a<i;++a)o[a]=new e[a](r);if(r.store)var s=r.data=new JS;return r.add=function(e){if(r.num+=1,!n){s&&s.add(e);for(let t=0;t<i;++t)o[t].add(o[t].get(e),e)}},r.rem=function(e){if(r.num-=1,!n){s&&s.rem(e);for(let t=0;t<i;++t)o[t].rem(o[t].get(e),e)}},r.set=function(e){let i,a;for(s&&s.values(),i=0,a=t.length;i<a;++i)e[t[i]]=r.num;if(!n)for(i=0,a=o.length;i<a;++i)o[i].set(e)},r.init=function(){r.num=0,s&&s.reset();for(let e=0;e<i;++e)o[e].init()},r}(c,l,f)),this.inputs=Object.keys(s)}const oC=iC.prototype;function aC(e){LE.call(this,{},e),this._mlen=0,this._mods=[]}function sC(e,t,n,r){const i=r.sort,o=i&&!r.ignorePeers,a=r.frame||[null,0],s=e.data(n),u=s.length,l=o?Sb(i):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:s,compare:i||dy(-1)};t.init();for(let e=0;e<u;++e)uC(c,a,e,u),o&&lC(c,l),t.update(c,s[e])}function uC(e,t,n,r){e.p0=e.i0,e.p1=e.i1,e.i0=null==t[0]?0:Math.max(0,n-Math.abs(t[0])),e.i1=null==t[1]?r:Math.min(r,n+Math.abs(t[1])+1),e.index=n}function lC(e,t){const n=e.i0,r=e.i1-1,i=e.compare,o=e.data,a=o.length-1;n>0&&!i(o[n],o[n-1])&&(e.i0=t.left(o,o[n])),r<a&&!i(o[r],o[r+1])&&(e.i1=t.right(o,o[r]))}oC.init=function(){this.windows.forEach((e=>e.init())),this.cell&&this.cell.init()},oC.update=function(e,t){const n=this.cell,r=this.windows,i=e.data,o=r&&r.length;let a;if(n){for(a=e.p0;a<e.i0;++a)n.rem(i[a]);for(a=e.p1;a<e.i1;++a)n.add(i[a]);n.set(t)}for(a=0;a<o;++a)r[a].update(e,t)},aC.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:rC.concat(qS)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]},_y(aC,LE,{transform:function(e,t){this.stamp=t.stamp;const n=e.modified(),r=fE(e.sort),i=LS(e.groupby),o=e=>this.group(i(e));let a=this.state;a&&!n||(a=this.state=new iC(e)),n||t.modified(a.inputs)?(this.value={},t.visit(t.SOURCE,(e=>o(e).add(e)))):(t.visit(t.REM,(e=>o(e).remove(e))),t.visit(t.ADD,(e=>o(e).add(e))));for(let t=0,n=this._mlen;t<n;++t)sC(this._mods[t],a,r,e);return this._mlen=0,this._mods=[],t.reflow(n).modifies(a.outputs)},group:function(e){let t=this.value[e];return t||(t=this.value[e]=tA(oE),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}}),t(UE,"window",(function(){return aC})),t(UE,"values",(function(){return tC})),t(UE,"tupleindex",(function(){return eC})),t(UE,"timeunit",(function(){return KA})),t(UE,"subflow",(function(){return bA})),t(UE,"sieve",(function(){return JA})),t(UE,"sequence",(function(){return QA})),t(UE,"sample",(function(){return XA})),t(UE,"relay",(function(){return YA})),t(UE,"quantile",(function(){return GA})),t(UE,"proxy",(function(){return VA})),t(UE,"project",(function(){return HA})),t(UE,"prefacet",(function(){return WA})),t(UE,"pivot",(function(){return qA})),t(UE,"params",(function(){return UA})),t(UE,"multivalues",(function(){return IA})),t(UE,"multiextent",(function(){return LA})),t(UE,"lookup",(function(){return PA})),t(UE,"load",(function(){return zA})),t(UE,"key",(function(){return $A})),t(UE,"kde",(function(){return OA})),t(UE,"joinaggregate",(function(){return NA})),t(UE,"impute",(function(){return FA})),t(UE,"generate",(function(){return CA})),t(UE,"formula",(function(){return AA})),t(UE,"fold",(function(){return SA})),t(UE,"flatten",(function(){return EA})),t(UE,"filter",(function(){return kA})),t(UE,"field",(function(){return wA})),t(UE,"facet",(function(){return xA})),t(UE,"extent",(function(){return vA})),t(UE,"expression",(function(){return gA})),t(UE,"dotbin",(function(){return mA})),t(UE,"density",(function(){return cA})),t(UE,"cross",(function(){return aA})),t(UE,"countpattern",(function(){return oA})),t(UE,"compare",(function(){return rA})),t(UE,"collect",(function(){return nA})),t(UE,"bin",(function(){return eA})),t(UE,"aggregate",(function(){return ZS}));var cC={},fC={};const dC=Math.PI,hC=2*dC,pC=1e-6,mC=hC-pC;function gC(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function yC(){return new gC}gC.prototype=yC.prototype={constructor:gC,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,r){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(e,t,n,r,i,o){this._+="C"+ +e+","+ +t+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+o)},arcTo:function(e,t,n,r,i){e=+e,t=+t,n=+n,r=+r,i=+i;var o=this._x1,a=this._y1,s=n-e,u=r-t,l=o-e,c=a-t,f=l*l+c*c;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(f>pC)if(Math.abs(c*s-u*l)>pC&&i){var d=n-o,h=r-a,p=s*s+u*u,m=d*d+h*h,g=Math.sqrt(p),y=Math.sqrt(f),v=i*Math.tan((dC-Math.acos((p+f-m)/(2*g*y)))/2),b=v/y,x=v/g;Math.abs(b-1)>pC&&(this._+="L"+(e+b*l)+","+(t+b*c)),this._+="A"+i+","+i+",0,0,"+ +(c*d>l*h)+","+(this._x1=e+x*s)+","+(this._y1=t+x*u)}else this._+="L"+(this._x1=e)+","+(this._y1=t);else;},arc:function(e,t,n,r,i,o){e=+e,t=+t,o=!!o;var a=(n=+n)*Math.cos(r),s=n*Math.sin(r),u=e+a,l=t+s,c=1^o,f=o?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+u+","+l:(Math.abs(this._x1-u)>pC||Math.abs(this._y1-l)>pC)&&(this._+="L"+u+","+l),n&&(f<0&&(f=f%hC+hC),f>mC?this._+="A"+n+","+n+",0,1,"+c+","+(e-a)+","+(t-s)+"A"+n+","+n+",0,1,"+c+","+(this._x1=u)+","+(this._y1=l):f>pC&&(this._+="A"+n+","+n+",0,"+ +(f>=dC)+","+c+","+(this._x1=e+n*Math.cos(i))+","+(this._y1=t+n*Math.sin(i))))},rect:function(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var vC=function(e){return function(){return e}},bC=Math.abs,xC=Math.atan2,wC=Math.cos,_C=Math.max,kC=Math.min,EC=Math.sin,SC=Math.sqrt,AC=1e-12,CC=Math.PI,DC=CC/2,MC=2*CC;function FC(e){return e>1?0:e<-1?CC:Math.acos(e)}function NC(e){return e>=1?DC:e<=-1?-DC:Math.asin(e)}function OC(e){return e.innerRadius}function $C(e){return e.outerRadius}function TC(e){return e.startAngle}function zC(e){return e.endAngle}function RC(e){return e&&e.padAngle}function PC(e,t,n,r,i,o,a,s){var u=n-e,l=r-t,c=a-i,f=s-o,d=f*u-c*l;if(!(d*d<AC))return[e+(d=(c*(t-o)-f*(e-i))/d)*u,t+d*l]}function LC(e,t,n,r,i,o,a){var s=e-n,u=t-r,l=(a?o:-o)/SC(s*s+u*u),c=l*u,f=-l*s,d=e+c,h=t+f,p=n+c,m=r+f,g=(d+p)/2,y=(h+m)/2,v=p-d,b=m-h,x=v*v+b*b,w=i-o,_=d*m-p*h,k=(b<0?-1:1)*SC(_C(0,w*w*x-_*_)),E=(_*b-v*k)/x,S=(-_*v-b*k)/x,A=(_*b+v*k)/x,C=(-_*v+b*k)/x,D=E-g,M=S-y,F=A-g,N=C-y;return D*D+M*M>F*F+N*N&&(E=A,S=C),{cx:E,cy:S,x01:-c,y01:-f,x11:E*(i/w-1),y11:S*(i/w-1)}}Array.prototype.slice;var BC=function(e){return"object"==typeof e&&"length"in e?e:Array.from(e)};function IC(e){this._context=e}IC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}};var jC=function(e){return new IC(e)};function UC(e){return e[0]}function qC(e){return e[1]}var WC=function(e,t){var n=vC(!0),r=null,i=jC,o=null;function a(a){var s,u,l,c=(a=BC(a)).length,f=!1;for(null==r&&(o=i(l=yC())),s=0;s<=c;++s)!(s<c&&n(u=a[s],s,a))===f&&((f=!f)?o.lineStart():o.lineEnd()),f&&o.point(+e(u,s,a),+t(u,s,a));if(l)return o=null,l+""||null}return e="function"==typeof e?e:void 0===e?UC:vC(e),t="function"==typeof t?t:void 0===t?qC:vC(t),a.x=function(t){return arguments.length?(e="function"==typeof t?t:vC(+t),a):e},a.y=function(e){return arguments.length?(t="function"==typeof e?e:vC(+e),a):t},a.defined=function(e){return arguments.length?(n="function"==typeof e?e:vC(!!e),a):n},a.curve=function(e){return arguments.length?(i=e,null!=r&&(o=i(r)),a):i},a.context=function(e){return arguments.length?(null==e?r=o=null:o=i(r=e),a):r},a},HC=function(e,t,n){var r=null,i=vC(!0),o=null,a=jC,s=null;function u(u){var l,c,f,d,h,p=(u=BC(u)).length,m=!1,g=new Array(p),y=new Array(p);for(null==o&&(s=a(h=yC())),l=0;l<=p;++l){if(!(l<p&&i(d=u[l],l,u))===m)if(m=!m)c=l,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),f=l-1;f>=c;--f)s.point(g[f],y[f]);s.lineEnd(),s.areaEnd()}m&&(g[l]=+e(d,l,u),y[l]=+t(d,l,u),s.point(r?+r(d,l,u):g[l],n?+n(d,l,u):y[l]))}if(h)return s=null,h+""||null}function l(){return WC().defined(i).curve(a).context(o)}return e="function"==typeof e?e:void 0===e?UC:vC(+e),t="function"==typeof t?t:vC(void 0===t?0:+t),n="function"==typeof n?n:void 0===n?qC:vC(+n),u.x=function(t){return arguments.length?(e="function"==typeof t?t:vC(+t),r=null,u):e},u.x0=function(t){return arguments.length?(e="function"==typeof t?t:vC(+t),u):e},u.x1=function(e){return arguments.length?(r=null==e?null:"function"==typeof e?e:vC(+e),u):r},u.y=function(e){return arguments.length?(t="function"==typeof e?e:vC(+e),n=null,u):t},u.y0=function(e){return arguments.length?(t="function"==typeof e?e:vC(+e),u):t},u.y1=function(e){return arguments.length?(n=null==e?null:"function"==typeof e?e:vC(+e),u):n},u.lineX0=u.lineY0=function(){return l().x(e).y(t)},u.lineY1=function(){return l().x(e).y(n)},u.lineX1=function(){return l().x(r).y(t)},u.defined=function(e){return arguments.length?(i="function"==typeof e?e:vC(!!e),u):i},u.curve=function(e){return arguments.length?(a=e,null!=o&&(s=a(o)),u):a},u.context=function(e){return arguments.length?(null==e?o=s=null:s=a(o=e),u):o},u},VC={draw:function(e,t){var n=Math.sqrt(t/CC);e.moveTo(n,0),e.arc(0,0,n,0,MC)}},GC=(Math.sqrt(1/3),Math.sin(CC/10)/Math.sin(7*CC/10)),YC=(Math.sin(MC/10),Math.cos(MC/10),Math.sqrt(3),Math.sqrt(3),Math.sqrt(12),function(){});function XC(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function QC(e){this._context=e}QC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:XC(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:XC(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function JC(e){this._context=e}JC.prototype={areaStart:YC,areaEnd:YC,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:XC(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function KC(e){this._context=e}KC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:XC(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function ZC(e,t){this._basis=new QC(e),this._beta=t}ZC.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r,i=e[0],o=t[0],a=e[n]-i,s=t[n]-o,u=-1;++u<=n;)r=u/n,this._basis.point(this._beta*e[u]+(1-this._beta)*(i+r*a),this._beta*t[u]+(1-this._beta)*(o+r*s));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var eD=function e(t){function n(e){return 1===t?new QC(e):new ZC(e,t)}return n.beta=function(t){return e(+t)},n}(.85);function tD(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function nD(e,t){this._context=e,this._k=(1-t)/6}nD.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:tD(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:tD(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var rD=function e(t){function n(e){return new nD(e,t)}return n.tension=function(t){return e(+t)},n}(0);function iD(e,t){this._context=e,this._k=(1-t)/6}iD.prototype={areaStart:YC,areaEnd:YC,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:tD(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var oD=function e(t){function n(e){return new iD(e,t)}return n.tension=function(t){return e(+t)},n}(0);function aD(e,t){this._context=e,this._k=(1-t)/6}aD.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:tD(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var sD=function e(t){function n(e){return new aD(e,t)}return n.tension=function(t){return e(+t)},n}(0);function uD(e,t,n){var r=e._x1,i=e._y1,o=e._x2,a=e._y2;if(e._l01_a>AC){var s=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,u=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*s-e._x0*e._l12_2a+e._x2*e._l01_2a)/u,i=(i*s-e._y0*e._l12_2a+e._y2*e._l01_2a)/u}if(e._l23_a>AC){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);o=(o*l+e._x1*e._l23_2a-t*e._l12_2a)/c,a=(a*l+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(r,i,o,a,e._x2,e._y2)}function lD(e,t){this._context=e,this._alpha=t}lD.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:uD(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var cD=function e(t){function n(e){return t?new lD(e,t):new nD(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function fD(e,t){this._context=e,this._alpha=t}fD.prototype={areaStart:YC,areaEnd:YC,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:uD(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var dD=function e(t){function n(e){return t?new fD(e,t):new iD(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function hD(e,t){this._context=e,this._alpha=t}hD.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:uD(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var pD=function e(t){function n(e){return t?new hD(e,t):new aD(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function mD(e){this._context=e}mD.prototype={areaStart:YC,areaEnd:YC,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function gD(e){return e<0?-1:1}function yD(e,t,n){var r=e._x1-e._x0,i=t-e._x1,o=(e._y1-e._y0)/(r||i<0&&-0),a=(n-e._y1)/(i||r<0&&-0),s=(o*i+a*r)/(r+i);return(gD(o)+gD(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(s))||0}function vD(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function bD(e,t,n){var r=e._x0,i=e._y0,o=e._x1,a=e._y1,s=(o-r)/3;e._context.bezierCurveTo(r+s,i+s*t,o-s,a-s*n,o,a)}function xD(e){this._context=e}function wD(e){this._context=new _D(e)}function _D(e){this._context=e}function kD(e){this._context=e}function ED(e){var t,n,r=e.length-1,i=new Array(r),o=new Array(r),a=new Array(r);for(i[0]=0,o[0]=2,a[0]=e[0]+2*e[1],t=1;t<r-1;++t)i[t]=1,o[t]=4,a[t]=4*e[t]+2*e[t+1];for(i[r-1]=2,o[r-1]=7,a[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=i[t]/o[t-1],o[t]-=n,a[t]-=n*a[t-1];for(i[r-1]=a[r-1]/o[r-1],t=r-2;t>=0;--t)i[t]=(a[t]-i[t+1])/o[t];for(o[r-1]=(e[r]+i[r-1])/2,t=0;t<r-1;++t)o[t]=2*e[t+1]-i[t+1];return[i,o]}xD.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:bD(this,this._t0,vD(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,bD(this,vD(this,n=yD(this,e,t)),n);break;default:bD(this,this._t0,n=yD(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(wD.prototype=Object.create(xD.prototype)).point=function(e,t){xD.prototype.point.call(this,t,e)},_D.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,o){this._context.bezierCurveTo(t,e,r,n,o,i)}},kD.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var r=ED(e),i=ED(t),o=0,a=1;a<n;++o,++a)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],e[a],t[a]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function SD(e,t){this._context=e,this._t=t}SD.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}}this._x=e,this._y=t}};function AD(e,t){if("undefined"!=typeof document&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}const CD=()=>"undefined"!=typeof Image?Image:null;var DD={},MD=function(e,t,n){e.prototype=t.prototype=n,n.constructor=e};function FD(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function ND(){}var OD=.7,$D=1.4285714285714286,TD="\\s*([+-]?\\d+)\\s*",zD="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",RD="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",PD=/^#([0-9a-f]{3,8})$/,LD=new RegExp("^rgb\\("+[TD,TD,TD]+"\\)$"),BD=new RegExp("^rgb\\("+[RD,RD,RD]+"\\)$"),ID=new RegExp("^rgba\\("+[TD,TD,TD,zD]+"\\)$"),jD=new RegExp("^rgba\\("+[RD,RD,RD,zD]+"\\)$"),UD=new RegExp("^hsl\\("+[zD,RD,RD]+"\\)$"),qD=new RegExp("^hsla\\("+[zD,RD,RD,zD]+"\\)$"),WD={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function HD(){return this.rgb().formatHex()}function VD(){return this.rgb().formatRgb()}function GD(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=PD.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?YD(t):3===n?new KD(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?XD(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?XD(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=LD.exec(e))?new KD(t[1],t[2],t[3],1):(t=BD.exec(e))?new KD(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=ID.exec(e))?XD(t[1],t[2],t[3],t[4]):(t=jD.exec(e))?XD(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=UD.exec(e))?nM(t[1],t[2]/100,t[3]/100,1):(t=qD.exec(e))?nM(t[1],t[2]/100,t[3]/100,t[4]):WD.hasOwnProperty(e)?YD(WD[e]):"transparent"===e?new KD(NaN,NaN,NaN,0):null}function YD(e){return new KD(e>>16&255,e>>8&255,255&e,1)}function XD(e,t,n,r){return r<=0&&(e=t=n=NaN),new KD(e,t,n,r)}function QD(e){return e instanceof ND||(e=GD(e)),e?new KD((e=e.rgb()).r,e.g,e.b,e.opacity):new KD}function JD(e,t,n,r){return 1===arguments.length?QD(e):new KD(e,t,n,null==r?1:r)}function KD(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function ZD(){return"#"+tM(this.r)+tM(this.g)+tM(this.b)}function eM(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function tM(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function nM(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new oM(e,t,n,r)}function rM(e){if(e instanceof oM)return new oM(e.h,e.s,e.l,e.opacity);if(e instanceof ND||(e=GD(e)),!e)return new oM;if(e instanceof oM)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),a=NaN,s=o-i,u=(o+i)/2;return s?(a=t===o?(n-r)/s+6*(n<r):n===o?(r-t)/s+2:(t-n)/s+4,s/=u<.5?o+i:2-o-i,a*=60):s=u>0&&u<1?0:a,new oM(a,s,u,e.opacity)}function iM(e,t,n,r){return 1===arguments.length?rM(e):new oM(e,t,n,null==r?1:r)}function oM(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function aM(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}MD(ND,GD,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:HD,formatHex:HD,formatHsl:function(){return rM(this).formatHsl()},formatRgb:VD,toString:VD}),MD(KD,JD,FD(ND,{brighter:function(e){return e=null==e?$D:Math.pow($D,e),new KD(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?OD:Math.pow(OD,e),new KD(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ZD,formatHex:ZD,formatRgb:eM,toString:eM})),MD(oM,iM,FD(ND,{brighter:function(e){return e=null==e?$D:Math.pow($D,e),new oM(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?OD:Math.pow(OD,e),new oM(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new KD(aM(e>=240?e-240:e+120,i,r),aM(e,i,r),aM(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));const sM=Math.PI/180,uM=180/Math.PI,lM=.96422,cM=.82521,fM=4/29,dM=6/29,hM=.12841854934601665;function pM(e){if(e instanceof gM)return new gM(e.l,e.a,e.b,e.opacity);if(e instanceof kM)return EM(e);e instanceof KD||(e=QD(e));var t,n,r=xM(e.r),i=xM(e.g),o=xM(e.b),a=yM((.2225045*r+.7168786*i+.0606169*o)/1);return r===i&&i===o?t=n=a:(t=yM((.4360747*r+.3850649*i+.1430804*o)/lM),n=yM((.0139322*r+.0971045*i+.7141733*o)/cM)),new gM(116*a-16,500*(t-a),200*(a-n),e.opacity)}function mM(e,t,n,r){return 1===arguments.length?pM(e):new gM(e,t,n,null==r?1:r)}function gM(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}function yM(e){return e>.008856451679035631?Math.pow(e,1/3):e/hM+fM}function vM(e){return e>dM?e*e*e:hM*(e-fM)}function bM(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function xM(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function wM(e){if(e instanceof kM)return new kM(e.h,e.c,e.l,e.opacity);if(e instanceof gM||(e=pM(e)),0===e.a&&0===e.b)return new kM(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*uM;return new kM(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function _M(e,t,n,r){return 1===arguments.length?wM(e):new kM(e,t,n,null==r?1:r)}function kM(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function EM(e){if(isNaN(e.h))return new gM(e.l,0,0,e.opacity);var t=e.h*sM;return new gM(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}MD(gM,mM,FD(ND,{brighter:function(e){return new gM(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new gM(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return new KD(bM(3.1338561*(t=lM*vM(t))-1.6168667*(e=1*vM(e))-.4906146*(n=cM*vM(n))),bM(-.9787684*t+1.9161415*e+.033454*n),bM(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),MD(kM,_M,FD(ND,{brighter:function(e){return new kM(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker:function(e){return new kM(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb:function(){return EM(this).rgb()}}));var SM=-.14861,AM=1.78277,CM=-.29227,DM=-.90649,MM=1.97294,FM=-1.7884503806,NM=3.5172982438,OM=-.6557636667999999;function $M(e){if(e instanceof zM)return new zM(e.h,e.s,e.l,e.opacity);e instanceof KD||(e=QD(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(OM*r+FM*t-NM*n)/-5.9615122912,o=r-i,a=(MM*(n-i)-CM*o)/DM,s=Math.sqrt(a*a+o*o)/(MM*i*(1-i)),u=s?Math.atan2(a,o)*uM-120:NaN;return new zM(u<0?u+360:u,s,i,e.opacity)}function TM(e,t,n,r){return 1===arguments.length?$M(e):new zM(e,t,n,null==r?1:r)}function zM(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function RM(e,t,n,r,i){var o=e*e,a=o*e;return((1-3*e+3*o-a)*t+(4-6*o+3*a)*n+(1+3*e+3*o-3*a)*r+a*i)/6}MD(zM,TM,FD(ND,{brighter:function(e){return e=null==e?$D:Math.pow($D,e),new zM(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?OD:Math.pow(OD,e),new zM(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*sM,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new KD(255*(t+n*(SM*r+AM*i)),255*(t+n*(CM*r+DM*i)),255*(t+n*(MM*r)),this.opacity)}}));var PM=function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],o=e[r+1],a=r>0?e[r-1]:2*i-o,s=r<t-1?e[r+2]:2*o-i;return RM((n-r/t)*t,a,i,o,s)}},LM=function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],o=e[r%t],a=e[(r+1)%t],s=e[(r+2)%t];return RM((n-r/t)*t,i,o,a,s)}},BM=e=>()=>e;function IM(e,t){return function(n){return e+n*t}}function jM(e,t){var n=t-e;return n?IM(e,n>180||n<-180?n-360*Math.round(n/360):n):BM(isNaN(e)?t:e)}function UM(e){return 1==(e=+e)?qM:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):BM(isNaN(t)?n:t)}}function qM(e,t){var n=t-e;return n?IM(e,n):BM(isNaN(e)?t:e)}var WM=function e(t){var n=UM(t);function r(e,t){var r=n((e=JD(e)).r,(t=JD(t)).r),i=n(e.g,t.g),o=n(e.b,t.b),a=qM(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=o(t),e.opacity=a(t),e+""}}return r.gamma=e,r}(1);function HM(e){return function(t){var n,r,i=t.length,o=new Array(i),a=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=JD(t[n]),o[n]=r.r||0,a[n]=r.g||0,s[n]=r.b||0;return o=e(o),a=e(a),s=e(s),r.opacity=1,function(e){return r.r=o(e),r.g=a(e),r.b=s(e),r+""}}}var VM=HM(PM),GM=HM(LM),YM=function(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,i=t.slice();return function(o){for(n=0;n<r;++n)i[n]=e[n]*(1-o)+t[n]*o;return i}};function XM(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}var QM=function(e,t){return(XM(t)?YM:JM)(e,t)};function JM(e,t){var n,r=t?t.length:0,i=e?Math.min(r,e.length):0,o=new Array(i),a=new Array(r);for(n=0;n<i;++n)o[n]=oF(e[n],t[n]);for(;n<r;++n)a[n]=t[n];return function(e){for(n=0;n<i;++n)a[n]=o[n](e);return a}}var KM=function(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}},ZM=function(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}},eF=function(e,t){var n,r={},i={};for(n in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)n in e?r[n]=oF(e[n],t[n]):i[n]=t[n];return function(e){for(n in r)i[n]=r[n](e);return i}},tF=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,nF=new RegExp(tF.source,"g");var rF,iF=function(e,t){var n,r,i,o=tF.lastIndex=nF.lastIndex=0,a=-1,s=[],u=[];for(e+="",t+="";(n=tF.exec(e))&&(r=nF.exec(t));)(i=r.index)>o&&(i=t.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,u.push({i:a,x:ZM(n,r)})),o=nF.lastIndex;return o<t.length&&(i=t.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?u[0]?function(e){return function(t){return e(t)+""}}(u[0].x):function(e){return function(){return e}}(t):(t=u.length,function(e){for(var n,r=0;r<t;++r)s[(n=u[r]).i]=n.x(e);return s.join("")})},oF=function(e,t){var n,r=typeof t;return null==t||"boolean"===r?BM(t):("number"===r?ZM:"string"===r?(n=GD(t))?(t=n,WM):iF:t instanceof GD?WM:t instanceof Date?KM:XM(t)?YM:Array.isArray(t)?JM:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?eF:ZM)(e,t)},aF=function(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}},sF=function(e,t){var n=jM(+e,+t);return function(e){var t=n(e);return t-360*Math.floor(t/360)}},uF=function(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}},lF=180/Math.PI,cF={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},fF=function(e,t,n,r,i,o){var a,s,u;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(u=e*n+t*r)&&(n-=e*u,r-=t*u),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,u/=s),e*r<t*n&&(e=-e,t=-t,u=-u,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*lF,skewX:Math.atan(u)*lF,scaleX:a,scaleY:s}};function dF(e,t,n,r){function i(e){return e.length?e.pop()+" ":""}return function(o,a){var s=[],u=[];return o=e(o),a=e(a),function(e,r,i,o,a,s){if(e!==i||r!==o){var u=a.push("translate(",null,t,null,n);s.push({i:u-4,x:ZM(e,i)},{i:u-2,x:ZM(r,o)})}else(i||o)&&a.push("translate("+i+t+o+n)}(o.translateX,o.translateY,a.translateX,a.translateY,s,u),function(e,t,n,o){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:ZM(e,t)})):t&&n.push(i(n)+"rotate("+t+r)}(o.rotate,a.rotate,s,u),function(e,t,n,o){e!==t?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:ZM(e,t)}):t&&n.push(i(n)+"skewX("+t+r)}(o.skewX,a.skewX,s,u),function(e,t,n,r,o,a){if(e!==n||t!==r){var s=o.push(i(o)+"scale(",null,",",null,")");a.push({i:s-4,x:ZM(e,n)},{i:s-2,x:ZM(t,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,s,u),o=a=null,function(e){for(var t,n=-1,r=u.length;++n<r;)s[(t=u[n]).i]=t.x(e);return s.join("")}}}var hF=dF((function(e){const t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?cF:fF(t.a,t.b,t.c,t.d,t.e,t.f)}),"px, ","px)","deg)"),pF=dF((function(e){return null==e?cF:(rF||(rF=document.createElementNS("http://www.w3.org/2000/svg","g")),rF.setAttribute("transform",e),(e=rF.transform.baseVal.consolidate())?(e=e.matrix,fF(e.a,e.b,e.c,e.d,e.e,e.f)):cF)}),", ",")",")");function mF(e){return((e=Math.exp(e))+1/e)/2}var gF=function e(t,n,r){function i(e,i){var o,a,s=e[0],u=e[1],l=e[2],c=i[0],f=i[1],d=i[2],h=c-s,p=f-u,m=h*h+p*p;if(m<1e-12)a=Math.log(d/l)/t,o=function(e){return[s+e*h,u+e*p,l*Math.exp(t*e*a)]};else{var g=Math.sqrt(m),y=(d*d-l*l+r*m)/(2*l*n*g),v=(d*d-l*l-r*m)/(2*d*n*g),b=Math.log(Math.sqrt(y*y+1)-y),x=Math.log(Math.sqrt(v*v+1)-v);a=(x-b)/t,o=function(e){var r,i=e*a,o=mF(b),c=l/(n*g)*(o*(r=t*i+b,((r=Math.exp(2*r))-1)/(r+1))-function(e){return((e=Math.exp(e))-1/e)/2}(b));return[s+c*h,u+c*p,l*o/mF(t*i+b)]}}return o.duration=1e3*a*t/Math.SQRT2,o}return i.rho=function(t){var n=Math.max(.001,+t),r=n*n;return e(n,r,r*r)},i}(Math.SQRT2,2,4);function yF(e){return function(t,n){var r=e((t=iM(t)).h,(n=iM(n)).h),i=qM(t.s,n.s),o=qM(t.l,n.l),a=qM(t.opacity,n.opacity);return function(e){return t.h=r(e),t.s=i(e),t.l=o(e),t.opacity=a(e),t+""}}}var vF=yF(jM),bF=yF(qM);function xF(e,t){var n=qM((e=mM(e)).l,(t=mM(t)).l),r=qM(e.a,t.a),i=qM(e.b,t.b),o=qM(e.opacity,t.opacity);return function(t){return e.l=n(t),e.a=r(t),e.b=i(t),e.opacity=o(t),e+""}}function wF(e){return function(t,n){var r=e((t=_M(t)).h,(n=_M(n)).h),i=qM(t.c,n.c),o=qM(t.l,n.l),a=qM(t.opacity,n.opacity);return function(e){return t.h=r(e),t.c=i(e),t.l=o(e),t.opacity=a(e),t+""}}}var _F=wF(jM),kF=wF(qM);function EF(e){return function t(n){function r(t,r){var i=e((t=TM(t)).h,(r=TM(r)).h),o=qM(t.s,r.s),a=qM(t.l,r.l),s=qM(t.opacity,r.opacity);return function(e){return t.h=i(e),t.s=o(e),t.l=a(Math.pow(e,n)),t.opacity=s(e),t+""}}return n=+n,r.gamma=t,r}(1)}var SF=EF(jM),AF=EF(qM);function CF(e,t){void 0===t&&(t=e,e=oF);for(var n=0,r=t.length-1,i=t[0],o=new Array(r<0?0:r);n<r;)o[n]=e(i,i=t[++n]);return function(e){var t=Math.max(0,Math.min(r-1,Math.floor(e*=r)));return o[t](e-t)}}var DF=function(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n};function MF(e){return+e}t(DD,"interpolate",(function(){return oF})),t(DD,"interpolateArray",(function(){return QM})),t(DD,"interpolateBasis",(function(){return PM})),t(DD,"interpolateBasisClosed",(function(){return LM})),t(DD,"interpolateDate",(function(){return KM})),t(DD,"interpolateDiscrete",(function(){return aF})),t(DD,"interpolateHue",(function(){return sF})),t(DD,"interpolateNumber",(function(){return ZM})),t(DD,"interpolateNumberArray",(function(){return YM})),t(DD,"interpolateObject",(function(){return eF})),t(DD,"interpolateRound",(function(){return uF})),t(DD,"interpolateString",(function(){return iF})),t(DD,"interpolateTransformSvg",(function(){return pF})),t(DD,"interpolateTransformCss",(function(){return hF})),t(DD,"interpolateZoom",(function(){return gF})),t(DD,"interpolateRgbBasisClosed",(function(){return GM})),t(DD,"interpolateRgbBasis",(function(){return VM})),t(DD,"interpolateRgb",(function(){return WM})),t(DD,"interpolateHslLong",(function(){return bF})),t(DD,"interpolateHsl",(function(){return vF})),t(DD,"interpolateLab",(function(){return xF})),t(DD,"interpolateHclLong",(function(){return kF})),t(DD,"interpolateHcl",(function(){return _F})),t(DD,"interpolateCubehelixLong",(function(){return AF})),t(DD,"interpolateCubehelix",(function(){return SF})),t(DD,"piecewise",(function(){return CF})),t(DD,"quantize",(function(){return DF}));var FF=[0,1];function NF(e){return e}function OF(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:(n=isNaN(t)?NaN:.5,function(){return n});var n}function $F(e,t,n){var r=e[0],i=e[1],o=t[0],a=t[1];return i<r?(r=OF(i,r),o=n(a,o)):(r=OF(r,i),o=n(o,a)),function(e){return o(r(e))}}function TF(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),o=new Array(r),a=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<r;)i[a]=OF(e[a],e[a+1]),o[a]=n(t[a],t[a+1]);return function(t){var n=Db(e,t,1,r)-1;return o[n](i[n](t))}}function zF(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function RF(){var e,t,n,r,i,o,a=FF,s=FF,u=oF,l=NF;function c(){var e,t,n,u=Math.min(a.length,s.length);return l!==NF&&(e=a[0],t=a[u-1],e>t&&(n=e,e=t,t=n),l=function(n){return Math.max(e,Math.min(t,n))}),r=u>2?TF:$F,i=o=null,f}function f(t){return null==t||isNaN(t=+t)?n:(i||(i=r(a.map(e),s,u)))(e(l(t)))}return f.invert=function(n){return l(t((o||(o=r(s,a.map(e),ZM)))(n)))},f.domain=function(e){return arguments.length?(a=Array.from(e,MF),c()):a.slice()},f.range=function(e){return arguments.length?(s=Array.from(e),c()):s.slice()},f.rangeRound=function(e){return s=Array.from(e),u=uF,c()},f.clamp=function(e){return arguments.length?(l=!!e||NF,c()):l!==NF},f.interpolate=function(e){return arguments.length?(u=e,c()):u},f.unknown=function(e){return arguments.length?(n=e,f):n},function(n,r){return e=n,t=r,c()}}function PF(){return RF()(NF,NF)}function LF(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function BF(e,t){switch(arguments.length){case 0:break;case 1:"function"==typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"==typeof t?this.interpolator(t):this.range(t)}return this}function IF(e,t,n,r){var i,o=Vb(e,t,n);switch((r=Qb(null==r?",f":r)).type){case"s":var a=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(i=lx(o,a))||(r.precision=i),tx(r,a);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=cx(o,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=ux(o))||(r.precision=i-2*("%"===r.type))}return ex(r)}function jF(e){var t=e.domain;return e.ticks=function(e){var n=t();return Wb(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return IF(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var r,i,o=t(),a=0,s=o.length-1,u=o[a],l=o[s],c=10;for(l<u&&(i=u,u=l,l=i,i=a,a=s,s=i);c-- >0;){if((i=Hb(u,l,n))===r)return o[a]=u,o[s]=l,t(o);if(i>0)u=Math.floor(u/i)*i,l=Math.ceil(l/i)*i;else{if(!(i<0))break;u=Math.ceil(u*i)/i,l=Math.floor(l*i)/i}r=i}return e},e}function UF(e,t){var n,r=0,i=(e=e.slice()).length-1,o=e[r],a=e[i];return a<o&&(n=r,r=i,i=n,n=o,o=a,a=n),e[r]=t.floor(o),e[i]=t.ceil(a),e}function qF(e){return Math.log(e)}function WF(e){return Math.exp(e)}function HF(e){return-Math.log(-e)}function VF(e){return-Math.exp(-e)}function GF(e){return isFinite(e)?+("1e"+e):e<0?0:e}function YF(e){return function(t){return-e(-t)}}function XF(e){var t,n,r=e(qF,WF),i=r.domain,o=10;function a(){return t=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}(o),n=function(e){return 10===e?GF:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}(o),i()[0]<0?(t=YF(t),n=YF(n),e(HF,VF)):e(qF,WF),r}return r.base=function(e){return arguments.length?(o=+e,a()):o},r.domain=function(e){return arguments.length?(i(e),a()):i()},r.ticks=function(e){var r,a=i(),s=a[0],u=a[a.length-1];(r=u<s)&&(d=s,s=u,u=d);var l,c,f,d=t(s),h=t(u),p=null==e?10:+e,m=[];if(!(o%1)&&h-d<p){if(d=Math.floor(d),h=Math.ceil(h),s>0){for(;d<=h;++d)for(c=1,l=n(d);c<o;++c)if(!((f=l*c)<s)){if(f>u)break;m.push(f)}}else for(;d<=h;++d)for(c=o-1,l=n(d);c>=1;--c)if(!((f=l*c)<s)){if(f>u)break;m.push(f)}2*m.length<p&&(m=Wb(s,u,p))}else m=Wb(d,h,Math.min(h-d,p)).map(n);return r?m.reverse():m},r.tickFormat=function(e,i){if(null==i&&(i=10===o?".0e":","),"function"!=typeof i&&(i=ex(i)),e===1/0)return i;null==e&&(e=10);var a=Math.max(1,o*e/r.ticks().length);return function(e){var r=e/n(Math.round(t(e)));return r*o<o-.5&&(r*=o),r<=a?i(e):""}},r.nice=function(){return i(UF(i(),{floor:function(e){return n(Math.floor(t(e)))},ceil:function(e){return n(Math.ceil(t(e)))}}))},r}function QF(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function JF(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function KF(e){var t=1,n=e(QF(t),JF(t));return n.constant=function(n){return arguments.length?e(QF(t=+n),JF(t)):t},jF(n)}const ZF=Symbol("implicit");function eN(){var e=new Map,t=[],n=[],r=ZF;function i(i){var o=i+"",a=e.get(o);if(!a){if(r!==ZF)return r;e.set(o,a=t.push(i))}return n[(a-1)%n.length]}return i.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new Map;for(const r of n){const n=r+"";e.has(n)||e.set(n,t.push(r))}return i},i.range=function(e){return arguments.length?(n=Array.from(e),i):n.slice()},i.unknown=function(e){return arguments.length?(r=e,i):r},i.copy=function(){return eN(t,n).unknown(r)},LF.apply(i,arguments),i}function tN(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function nN(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function rN(e){return e<0?-e*e:e*e}function iN(e){var t=e(NF,NF),n=1;function r(){return 1===n?e(NF,NF):.5===n?e(nN,rN):e(tN(n),tN(1/n))}return t.exponent=function(e){return arguments.length?(n=+e,r()):n},jF(t)}function oN(){var e=iN(RF());return e.copy=function(){return zF(e,oN()).exponent(e.exponent())},LF.apply(e,arguments),e}function aN(e){return new Date(e)}function sN(e){return e instanceof Date?+e:+new Date(+e)}function uN(e,t,n,r,i,o,a,s,u,l){var c=PF(),f=c.invert,d=c.domain,h=l(".%L"),p=l(":%S"),m=l("%I:%M"),g=l("%I %p"),y=l("%a %d"),v=l("%b %d"),b=l("%B"),x=l("%Y");function w(e){return(u(e)<e?h:s(e)<e?p:a(e)<e?m:o(e)<e?g:r(e)<e?i(e)<e?y:v:n(e)<e?b:x)(e)}return c.invert=function(e){return new Date(f(e))},c.domain=function(e){return arguments.length?d(Array.from(e,sN)):d().map(aN)},c.ticks=function(t){var n=d();return e(n[0],n[n.length-1],null==t?10:t)},c.tickFormat=function(e,t){return null==t?w:l(t)},c.nice=function(e){var n=d();return e&&"function"==typeof e.range||(e=t(n[0],n[n.length-1],null==e?10:e)),e?d(UF(n,e)):c},c.copy=function(){return zF(c,uN(e,t,n,r,i,o,a,s,u,l))},c}function lN(){var e,t,n,r,i,o=0,a=1,s=NF,u=!1;function l(t){return null==t||isNaN(t=+t)?i:s(0===n?.5:(t=(r(t)-e)*n,u?Math.max(0,Math.min(1,t)):t))}function c(e){return function(t){var n,r;return arguments.length?([n,r]=t,s=e(n,r),l):[s(0),s(1)]}}return l.domain=function(i){return arguments.length?([o,a]=i,e=r(o=+o),t=r(a=+a),n=e===t?0:1/(t-e),l):[o,a]},l.clamp=function(e){return arguments.length?(u=!!e,l):u},l.interpolator=function(e){return arguments.length?(s=e,l):s},l.range=c(oF),l.rangeRound=c(uF),l.unknown=function(e){return arguments.length?(i=e,l):i},function(i){return r=i,e=i(o),t=i(a),n=e===t?0:1/(t-e),l}}function cN(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function fN(){var e=jF(lN()(NF));return e.copy=function(){return cN(e,fN())},BF.apply(e,arguments)}function dN(){var e=iN(lN());return e.copy=function(){return cN(e,dN()).exponent(e.exponent())},BF.apply(e,arguments)}function hN(){var e,t,n,r,i,o,a,s=0,u=.5,l=1,c=1,f=NF,d=!1;function h(e){return isNaN(e=+e)?a:(e=.5+((e=+o(e))-t)*(c*e<c*t?r:i),f(d?Math.max(0,Math.min(1,e)):e))}function p(e){return function(t){var n,r,i;return arguments.length?([n,r,i]=t,f=CF(e,[n,r,i]),h):[f(0),f(.5),f(1)]}}return h.domain=function(a){return arguments.length?([s,u,l]=a,e=o(s=+s),t=o(u=+u),n=o(l=+l),r=e===t?0:.5/(t-e),i=t===n?0:.5/(n-t),c=t<e?-1:1,h):[s,u,l]},h.clamp=function(e){return arguments.length?(d=!!e,h):d},h.interpolator=function(e){return arguments.length?(f=e,h):f},h.range=p(oF),h.rangeRound=p(uF),h.unknown=function(e){return arguments.length?(a=e,h):a},function(a){return o=a,e=a(s),t=a(u),n=a(l),r=e===t?0:.5/(t-e),i=t===n?0:.5/(n-t),c=t<e?-1:1,h}}function pN(){var e=iN(hN());return e.copy=function(){return cN(e,pN()).exponent(e.exponent())},BF.apply(e,arguments)}function mN(e,t,n){const r=e-t+2*n;return e?r>0?r:1:0}const gN="linear",yN="log",vN="pow",bN="sqrt",xN="symlog",wN="time",_N="utc",kN="sequential",EN="diverging",SN="quantile",AN="quantize",CN="threshold",DN="ordinal",MN="point",FN="band",NN="bin-ordinal",ON="continuous",$N="discrete",TN="discretizing",zN="interpolating",RN="temporal";function PN(){const e=eN().unknown(void 0),t=e.domain,n=e.range;let r,i,o=[0,1],a=!1,s=0,u=0,l=.5;function c(){const e=t().length,c=o[1]<o[0],f=o[1-c],d=mN(e,s,u);let h=o[c-0];r=(f-h)/(d||1),a&&(r=Math.floor(r)),h+=(f-h-r*(e-s))*l,i=r*(1-s),a&&(h=Math.round(h),i=Math.round(i));const p=Bb(e).map((e=>h+r*e));return n(c?p.reverse():p)}return delete e.unknown,e.domain=function(e){return arguments.length?(t(e),c()):t()},e.range=function(e){return arguments.length?(o=[+e[0],+e[1]],c()):o.slice()},e.rangeRound=function(e){return o=[+e[0],+e[1]],a=!0,c()},e.bandwidth=function(){return i},e.step=function(){return r},e.round=function(e){return arguments.length?(a=!!e,c()):a},e.padding=function(e){return arguments.length?(u=Math.max(0,Math.min(1,e)),s=u,c()):s},e.paddingInner=function(e){return arguments.length?(s=Math.max(0,Math.min(1,e)),c()):s},e.paddingOuter=function(e){return arguments.length?(u=Math.max(0,Math.min(1,e)),c()):u},e.align=function(e){return arguments.length?(l=Math.max(0,Math.min(1,e)),c()):l},e.invertRange=function(e){if(null==e[0]||null==e[1])return;const r=o[1]<o[0],a=r?n().reverse():n(),s=a.length-1;let u,l,c,f=+e[0],d=+e[1];return f!=f||d!=d||(d<f&&(c=f,f=d,d=c),d<a[0]||f>o[1-r])?void 0:(u=Math.max(0,Db(a,f)-1),l=f===d?u:Db(a,d)-1,f-a[u]>i+1e-10&&++u,r&&(c=u,u=s-l,l=s-c),u>l?void 0:t().slice(u,l+1))},e.invert=function(t){const n=e.invertRange([t,t]);return n?n[0]:n},e.copy=function(){return PN().domain(t()).range(o).round(a).paddingInner(s).paddingOuter(u).align(l)},c()}function LN(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return LN(t())},e}var BN=Array.prototype.map;function IN(e){return BN.call(e,Ig)}const jN=Array.prototype.slice;const UN={};function qN(e,t,n){const r=function(){const n=t();return n.invertRange||(n.invertRange=n.invert?function(e){return function(t){let n,r=t[0],i=t[1];return i<r&&(n=r,r=i,i=n),[e.invert(r),e.invert(i)]}}(n):n.invertExtent?function(e){return function(t){const n=e.range();let r,i,o,a,s=t[0],u=t[1],l=-1;for(u<s&&(i=s,s=u,u=i),o=0,a=n.length;o<a;++o)n[o]>=s&&n[o]<=u&&(l<0&&(l=o),r=o);if(!(l<0))return s=e.invertExtent(n[l]),u=e.invertExtent(n[r]),[void 0===s[0]?s[1]:s[0],void 0===u[1]?u[0]:u[1]]}}(n):void 0),n.type=e,n};return r.metadata=Uy(iy(n)),r}function WN(e,t,n){return arguments.length>1?(UN[e]=qN(e,t,n),this):HN(e)?UN[e]:void 0}function HN(e){return vy(UN,e)}function VN(e,t){const n=UN[e];return n&&n.metadata[t]}function GN(e){return VN(e,ON)}function YN(e){return VN(e,$N)}function XN(e){return VN(e,TN)}function QN(e){return VN(e,yN)}function JN(e){return VN(e,zN)}function KN(e){return VN(e,SN)}WN("identity",(function e(t){var n;function r(e){return null==e||isNaN(e=+e)?n:e}return r.invert=r,r.domain=r.range=function(e){return arguments.length?(t=Array.from(e,MF),r):t.slice()},r.unknown=function(e){return arguments.length?(n=e,r):n},r.copy=function(){return e(t).unknown(n)},t=arguments.length?Array.from(t,MF):[0,1],jF(r)})),WN(gN,(function e(){var t=PF();return t.copy=function(){return zF(t,e())},LF.apply(t,arguments),jF(t)}),ON),WN(yN,(function e(){var t=XF(RF()).domain([1,10]);return t.copy=function(){return zF(t,e()).base(t.base())},LF.apply(t,arguments),t}),[ON,yN]),WN(vN,oN,ON),WN(bN,(function(){return oN.apply(null,arguments).exponent(.5)}),ON),WN(xN,(function e(){var t=KF(RF());return t.copy=function(){return zF(t,e()).constant(t.constant())},LF.apply(t,arguments)}),ON),WN(wN,(function(){return LF.apply(uN(Zx,ew,Rx,zx,Dx,Ax,Sx,Ex,kx,m_).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}),[ON,RN]),WN(_N,(function(){return LF.apply(uN(Jx,Kx,Xx,Yx,jx,Bx,Lx,Px,kx,y_).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}),[ON,RN]),WN(kN,fN,[ON,zN]),WN("".concat(kN,"-").concat(gN),fN,[ON,zN]),WN("".concat(kN,"-").concat(yN),(function e(){var t=XF(lN()).domain([1,10]);return t.copy=function(){return cN(t,e()).base(t.base())},BF.apply(t,arguments)}),[ON,zN,yN]),WN("".concat(kN,"-").concat(vN),dN,[ON,zN]),WN("".concat(kN,"-").concat(bN),(function(){return dN.apply(null,arguments).exponent(.5)}),[ON,zN]),WN("".concat(kN,"-").concat(xN),(function e(){var t=KF(lN());return t.copy=function(){return cN(t,e()).constant(t.constant())},BF.apply(t,arguments)}),[ON,zN]),WN("".concat(EN,"-").concat(gN),(function e(){var t=jF(hN()(NF));return t.copy=function(){return cN(t,e())},BF.apply(t,arguments)}),[ON,zN]),WN("".concat(EN,"-").concat(yN),(function e(){var t=XF(hN()).domain([.1,1,10]);return t.copy=function(){return cN(t,e()).base(t.base())},BF.apply(t,arguments)}),[ON,zN,yN]),WN("".concat(EN,"-").concat(vN),pN,[ON,zN]),WN("".concat(EN,"-").concat(bN),(function(){return pN.apply(null,arguments).exponent(.5)}),[ON,zN]),WN("".concat(EN,"-").concat(xN),(function e(){var t=KF(hN());return t.copy=function(){return cN(t,e()).constant(t.constant())},BF.apply(t,arguments)}),[ON,zN]),WN(SN,(function e(){var t,n=[],r=[],i=[];function o(){var e=0,t=Math.max(1,r.length);for(i=new Array(t-1);++e<t;)i[e-1]=Rb(n,e/t);return a}function a(e){return null==e||isNaN(e=+e)?t:r[Db(i,e)]}return a.invertExtent=function(e){var t=r.indexOf(e);return t<0?[NaN,NaN]:[t>0?i[t-1]:n[0],t<i.length?i[t]:n[n.length-1]]},a.domain=function(e){if(!arguments.length)return n.slice();n=[];for(let t of e)null==t||isNaN(t=+t)||n.push(t);return n.sort(Eb),o()},a.range=function(e){return arguments.length?(r=Array.from(e),o()):r.slice()},a.unknown=function(e){return arguments.length?(t=e,a):t},a.quantiles=function(){return i.slice()},a.copy=function(){return e().domain(n).range(r).unknown(t)},LF.apply(a,arguments)}),[TN,SN]),WN(AN,(function e(){var t,n=0,r=1,i=1,o=[.5],a=[0,1];function s(e){return null!=e&&e<=e?a[Db(o,e,0,i)]:t}function u(){var e=-1;for(o=new Array(i);++e<i;)o[e]=((e+1)*r-(e-i)*n)/(i+1);return s}return s.domain=function(e){return arguments.length?([n,r]=e,n=+n,r=+r,u()):[n,r]},s.range=function(e){return arguments.length?(i=(a=Array.from(e)).length-1,u()):a.slice()},s.invertExtent=function(e){var t=a.indexOf(e);return t<0?[NaN,NaN]:t<1?[n,o[0]]:t>=i?[o[i-1],r]:[o[t-1],o[t]]},s.unknown=function(e){return arguments.length?(t=e,s):s},s.thresholds=function(){return o.slice()},s.copy=function(){return e().domain([n,r]).range(a).unknown(t)},LF.apply(jF(s),arguments)}),TN),WN(CN,(function e(){var t,n=[.5],r=[0,1],i=1;function o(e){return null!=e&&e<=e?r[Db(n,e,0,i)]:t}return o.domain=function(e){return arguments.length?(n=Array.from(e),i=Math.min(n.length,r.length-1),o):n.slice()},o.range=function(e){return arguments.length?(r=Array.from(e),i=Math.min(n.length,r.length-1),o):r.slice()},o.invertExtent=function(e){var t=r.indexOf(e);return[n[t-1],n[t]]},o.unknown=function(e){return arguments.length?(t=e,o):t},o.copy=function(){return e().domain(n).range(r).unknown(t)},LF.apply(o,arguments)}),TN),WN(NN,(function e(){let t=[],n=[];function r(e){return null==e||e!=e?void 0:n[(Db(t,e)-1)%n.length]}return r.domain=function(e){return arguments.length?(t=IN(e),r):t.slice()},r.range=function(e){return arguments.length?(n=jN.call(e),r):n.slice()},r.tickFormat=function(e,n){return IF(t[0],Bg(t),null==e?10:e,n)},r.copy=function(){return e().domain(r.domain()).range(r.range())},r}),[$N,TN]),WN(DN,eN,$N),WN(FN,PN,$N),WN(MN,(function(){return LN(PN().paddingInner(1))}),$N);const ZN=["clamp","base","constant","exponent"];function eO(e,t){const n=t[0],r=Bg(t)-n;return function(t){return e(n+t*r)}}function tO(e,t,n){return CF(iO(t||"rgb",n),e)}function nO(e,t){const n=new Array(t),r=t+1;for(let i=0;i<t;)n[i]=e(++i/r);return n}function rO(e,t,n){const r=n-t;let i,o,a;return r&&Number.isFinite(r)?(i=(o=e.type).indexOf("-"),o=i<0?o:o.slice(i+1),a=WN(o)().domain([t,n]).range([0,1]),ZN.forEach((t=>e[t]?a[t](e[t]()):0)),a):dy(.5)}function iO(e,t){const n=DD[function(e){return"interpolate"+e.toLowerCase().split("-").map((e=>e[0].toUpperCase()+e.slice(1))).join("")}(e)];return null!=t&&n&&n.gamma?n.gamma(t):n}function oO(e){const t=e.length/6|0,n=new Array(t);for(let r=0;r<t;)n[r]="#"+e.slice(6*r,6*++r);return n}function aO(e,t){for(const n in e)uO(n,t(e[n]))}const sO={};function uO(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(sO[e]=t,this):sO[e]}aO({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},oO),aO({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},(e=>tO(oO(e))));const lO="symbol",cO=e=>$g(e)?e.map((e=>String(e))):String(e),fO=(e,t)=>e[1]-t[1],dO=(e,t)=>t[1]-e[1];function hO(e,t,n){let r;return Cy(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),null!=n&&(t=Math.min(t,Math.floor(Ry(e.domain())/n||1)))),Tg(t)&&(r=t.step,t=t.interval),My(t)&&(t=e.type===wN?jw(t):e.type==_N?Uw(t):_g("Only time and utc scales accept interval strings."),r&&(t=t.every(r))),t}function pO(e,t,n){let r=e.range(),i=r[0],o=Bg(r),a=fO;if(i>o&&(r=o,o=i,i=r,a=dO),i=Math.floor(i),o=Math.ceil(o),t=t.map((t=>[t,e(t)])).filter((e=>i<=e[1]&&e[1]<=o)).sort(a).map((e=>e[0])),n>0&&t.length>1){const e=[t[0],Bg(t)];for(;t.length>n&&t.length>=3;)t=t.filter(((e,t)=>!(t%2)));t.length<3&&(t=e)}return t}function mO(e,t){return e.bins?pO(e,e.bins):e.ticks?e.ticks(t):e.domain()}function gO(e,t,n,r,i,o){const a=t.type;let s=cO;if(a===wN||i===wN)s=e.timeFormat(r);else if(a===_N||i===_N)s=e.utcFormat(r);else if(QN(a)){const i=e.formatFloat(r);if(o||t.bins)s=i;else{const e=yO(t,n,!1);s=t=>e(t)?i(t):""}}else if(t.tickFormat){const i=t.domain();s=e.formatSpan(i[0],i[i.length-1],n,r)}else r&&(s=e.format(r));return s}function yO(e,t,n){const r=mO(e,t),i=e.base(),o=Math.log(i),a=Math.max(1,i*t/r.length),s=e=>{let t=e/Math.pow(i,Math.round(Math.log(e)/o));return t*i<i-.5&&(t*=i),t<=a};return n?r.filter(s):s}const vO={[SN]:"quantiles",[AN]:"thresholds",[CN]:"domain"},bO={[SN]:"quantiles",[AN]:"domain"};function xO(e,t){return e.bins?function(e){const t=e.slice(0,-1);return t.max=Bg(e),t}(e.bins):e.type===yN?yO(e,t,!0):vO[e.type]?function(e){const t=[-1/0].concat(e);return t.max=1/0,t}(e[vO[e.type]]()):mO(e,t)}function wO(e,t,n,r,i,o,a){const s=bO[t.type]&&o!==wN&&o!==_N?function(e,t,n){const r=t[bO[t.type]](),i=r.length;let o,a=i>1?r[1]-r[0]:r[0];for(o=1;o<i;++o)a=Math.min(a,r[o]-r[o-1]);return e.formatSpan(0,a,30,n)}(e,t,i):gO(e,t,n,i,o,a);return r===lO&&(e=>vO[e.type]||e.bins)(t)?_O(s):"discrete"===r?EO(s):SO(s)}const _O=e=>(t,n,r)=>{const i=kO(r[n+1],kO(r.max,1/0)),o=AO(t,e),a=AO(i,e);return o&&a?o+"  "+a:a?"< "+a:" "+o},kO=(e,t)=>null!=e?e:t,EO=e=>(t,n)=>n?e(t):null,SO=e=>t=>e(t),AO=(e,t)=>Number.isFinite(e)?t(e):null;function CO(e,t,n,r){const i=r||t.type;return My(n)&&VN(i,RN)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),n||i!==wN?n||i!==_N?wO(e,t,5,null,n,r,!0):e.utcFormat("%A, %d %B %Y, %X UTC"):e.timeFormat("%A, %d %B %Y, %X")}function DO(e,t,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=CO(e,t,n.format,n.formatType);if(XN(t.type)){const e=xO(t).slice(1).map(i),n=e.length;return"".concat(n," boundar").concat(1===n?"y":"ies",": ").concat(e.join(", "))}if(YN(t.type)){const e=t.domain(),n=e.length,o=n>r?e.slice(0,r-2).map(i).join(", ")+", ending with "+e.slice(-1).map(i):e.map(i).join(", ");return"".concat(n," value").concat(1===n?"":"s",": ").concat(o)}{const e=t.domain();return"values from ".concat(i(e[0])," to ").concat(i(Bg(e)))}}let MO=0;const FO="p_";function NO(e){return e&&e.gradient}function OO(e,t,n){const r=e.gradient;let i=e.id,o="radial"===r?FO:"";return i||(i=e.id="gradient_"+MO++,"radial"===r?(e.x1=$O(e.x1,.5),e.y1=$O(e.y1,.5),e.r1=$O(e.r1,0),e.x2=$O(e.x2,.5),e.y2=$O(e.y2,.5),e.r2=$O(e.r2,.5),o=FO):(e.x1=$O(e.x1,0),e.y1=$O(e.y1,0),e.x2=$O(e.x2,1),e.y2=$O(e.y2,0))),t[i]=e,"url("+(n||"")+"#"+o+i+")"}function $O(e,t){return null!=e?e:t}function TO(e,t){var n,r=[];return n={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:r,stop:function(e,t){return r.push({offset:e,color:t}),n}}}const zO={basis:{curve:function(e){return new QC(e)}},"basis-closed":{curve:function(e){return new JC(e)}},"basis-open":{curve:function(e){return new KC(e)}},bundle:{curve:eD,tension:"beta",value:.85},cardinal:{curve:rD,tension:"tension",value:0},"cardinal-open":{curve:sD,tension:"tension",value:0},"cardinal-closed":{curve:oD,tension:"tension",value:0},"catmull-rom":{curve:cD,tension:"alpha",value:.5},"catmull-rom-closed":{curve:dD,tension:"alpha",value:.5},"catmull-rom-open":{curve:pD,tension:"alpha",value:.5},linear:{curve:jC},"linear-closed":{curve:function(e){return new mD(e)}},monotone:{horizontal:function(e){return new wD(e)},vertical:function(e){return new xD(e)}},natural:{curve:function(e){return new kD(e)}},step:{curve:function(e){return new SD(e,.5)}},"step-after":{curve:function(e){return new SD(e,1)}},"step-before":{curve:function(e){return new SD(e,0)}}};function RO(e,t,n){var r=vy(zO,e)&&zO[e],i=null;return r&&(i=r.curve||r[t||"vertical"],r.tension&&null!=n&&(i=i[r.tension](n))),i}const PO={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},LO=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\.\d+)(\.\d)/g,/(\d)([-+])/g,/\s|,|###/];function BO(e){const t=[];let n,r,i,o,a,s,u,l,c,f;const d=e.slice().replace(LO[0],"###$1").split(LO[1]).slice(1);for(u=0,c=d.length;u<c;++u){for(n=d[u],r=n.slice(1).trim().replace(LO[2],"$1###$2").replace(LO[3],"$1###$2").split(LO[4]),a=n.charAt(0),i=[a],l=0,f=r.length;l<f;++l)(o=+r[l])===o&&i.push(o);if(s=PO[a.toLowerCase()],i.length-1>s){const e=i.length;for(l=1,t.push([a].concat(i.slice(l,l+=s))),a="M"===a?"L":"m"===a?"l":a;l<e;l+=s)t.push([a].concat(i.slice(l,l+s)))}else t.push(i)}return t}const IO=Math.PI/180,jO=Math.PI/2,UO=2*Math.PI,qO=Math.sqrt(3)/2;var WO={},HO={},VO=[].join;function GO(e){const t=VO.call(e);if(HO[t])return HO[t];var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7];const c=l*a,f=-u*s,d=u*a,h=l*s,p=Math.cos(i),m=Math.sin(i),g=Math.cos(o),y=Math.sin(o),v=.5*(o-i),b=Math.sin(.5*v),x=8/3*b*b/Math.sin(v),w=n+p-x*m,_=r+m+x*p,k=n+g,E=r+y,S=k+x*y,A=E-x*g;return HO[t]=[c*w+f*_,d*w+h*_,c*S+f*A,d*S+h*A,c*k+f*E,d*k+h*E]}const YO=["l",0,0,0,0,0,0,0];function XO(e,t,n){const r=YO[0]=e[0];if("a"===r||"A"===r)YO[1]=t*e[1],YO[2]=n*e[2],YO[3]=e[3],YO[4]=e[4],YO[5]=e[5],YO[6]=t*e[6],YO[7]=n*e[7];else if("h"===r||"H"===r)YO[1]=t*e[1];else if("v"===r||"V"===r)YO[1]=n*e[1];else for(var i=1,o=e.length;i<o;++i)YO[i]=(i%2==1?t:n)*e[i];return YO}function QO(e,t,n,r,i,o){var a,s,u,l,c,f=null,d=0,h=0,p=0,m=0;null==n&&(n=0),null==r&&(r=0),null==i&&(i=1),null==o&&(o=i),e.beginPath&&e.beginPath();for(var g=0,y=t.length;g<y;++g){switch(a=t[g],1===i&&1===o||(a=XO(a,i,o)),a[0]){case"l":d+=a[1],h+=a[2],e.lineTo(d+n,h+r);break;case"L":d=a[1],h=a[2],e.lineTo(d+n,h+r);break;case"h":d+=a[1],e.lineTo(d+n,h+r);break;case"H":d=a[1],e.lineTo(d+n,h+r);break;case"v":h+=a[1],e.lineTo(d+n,h+r);break;case"V":h=a[1],e.lineTo(d+n,h+r);break;case"m":d+=a[1],h+=a[2],e.moveTo(d+n,h+r);break;case"M":d=a[1],h=a[2],e.moveTo(d+n,h+r);break;case"c":s=d+a[5],u=h+a[6],p=d+a[3],m=h+a[4],e.bezierCurveTo(d+a[1]+n,h+a[2]+r,p+n,m+r,s+n,u+r),d=s,h=u;break;case"C":d=a[5],h=a[6],p=a[3],m=a[4],e.bezierCurveTo(a[1]+n,a[2]+r,p+n,m+r,d+n,h+r);break;case"s":s=d+a[3],u=h+a[4],p=2*d-p,m=2*h-m,e.bezierCurveTo(p+n,m+r,d+a[1]+n,h+a[2]+r,s+n,u+r),p=d+a[1],m=h+a[2],d=s,h=u;break;case"S":s=a[3],u=a[4],p=2*d-p,m=2*h-m,e.bezierCurveTo(p+n,m+r,a[1]+n,a[2]+r,s+n,u+r),d=s,h=u,p=a[1],m=a[2];break;case"q":s=d+a[3],u=h+a[4],p=d+a[1],m=h+a[2],e.quadraticCurveTo(p+n,m+r,s+n,u+r),d=s,h=u;break;case"Q":s=a[3],u=a[4],e.quadraticCurveTo(a[1]+n,a[2]+r,s+n,u+r),d=s,h=u,p=a[1],m=a[2];break;case"t":s=d+a[1],u=h+a[2],null===f[0].match(/[QqTt]/)?(p=d,m=h):"t"===f[0]?(p=2*d-l,m=2*h-c):"q"===f[0]&&(p=2*d-p,m=2*h-m),l=p,c=m,e.quadraticCurveTo(p+n,m+r,s+n,u+r),h=u,p=(d=s)+a[1],m=h+a[2];break;case"T":s=a[1],u=a[2],p=2*d-p,m=2*h-m,e.quadraticCurveTo(p+n,m+r,s+n,u+r),d=s,h=u;break;case"a":JO(e,d+n,h+r,[a[1],a[2],a[3],a[4],a[5],a[6]+d+n,a[7]+h+r]),d+=a[6],h+=a[7];break;case"A":JO(e,d+n,h+r,[a[1],a[2],a[3],a[4],a[5],a[6]+n,a[7]+r]),d=a[6],h=a[7];break;case"z":case"Z":e.closePath()}f=a}}function JO(e,t,n,r){const i=function(e,t,n,r,i,o,a,s,u){const l=VO.call(arguments);if(WO[l])return WO[l];const c=a*IO,f=Math.sin(c),d=Math.cos(c),h=d*(s-e)*.5+f*(u-t)*.5,p=d*(u-t)*.5-f*(s-e)*.5;let m=h*h/((n=Math.abs(n))*n)+p*p/((r=Math.abs(r))*r);m>1&&(m=Math.sqrt(m),n*=m,r*=m);const g=d/n,y=f/n,v=-f/r,b=d/r,x=g*s+y*u,w=v*s+b*u,_=g*e+y*t,k=v*e+b*t;let E=1/((_-x)*(_-x)+(k-w)*(k-w))-.25;E<0&&(E=0);let S=Math.sqrt(E);o==i&&(S=-S);const A=.5*(x+_)-S*(k-w),C=.5*(w+k)+S*(_-x),D=Math.atan2(w-C,x-A);let M=Math.atan2(k-C,_-A)-D;M<0&&1===o?M+=UO:M>0&&0===o&&(M-=UO);const F=Math.ceil(Math.abs(M/(jO+.001))),N=[];for(let e=0;e<F;++e){const t=D+e*M/F,i=D+(e+1)*M/F;N[e]=[A,C,t,i,n,r,f,d]}return WO[l]=N}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n);for(let t=0;t<i.length;++t){const n=GO(i[t]);e.bezierCurveTo(n[0],n[1],n[2],n[3],n[4],n[5])}}const KO=.5773502691896257,ZO={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,UO)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r),e.lineTo(-n,r),e.lineTo(-r,r),e.lineTo(-r,n),e.lineTo(r,n),e.lineTo(r,r),e.lineTo(n,r),e.lineTo(n,-r),e.lineTo(r,-r),e.lineTo(r,-n),e.lineTo(-r,-n),e.lineTo(-r,-r),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,i=n/2.5,o=n/8;e.moveTo(-r,n),e.lineTo(r,n),e.lineTo(r,-o),e.lineTo(i,-o),e.lineTo(0,-n),e.lineTo(-i,-o),e.lineTo(-r,-o),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=qO*n,i=r-n*KO,o=n/4;e.moveTo(0,-r-i),e.lineTo(-o,r-i),e.lineTo(o,r-i),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=qO*n,i=r-n*KO;e.moveTo(0,-r-i),e.lineTo(-n,r-i),e.lineTo(n,r-i),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=qO*n;e.moveTo(0,-r),e.lineTo(-n,r),e.lineTo(n,r),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=qO*n;e.moveTo(0,r),e.lineTo(-n,-r),e.lineTo(n,-r),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=qO*n;e.moveTo(r,0),e.lineTo(-r,-n),e.lineTo(-r,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=qO*n;e.moveTo(-r,0),e.lineTo(r,-n),e.lineTo(r,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function e$(e){return vy(ZO,e)?ZO[e]:function(e){if(!vy(t$,e)){const t=BO(e);t$[e]={draw:function(e,n){QO(e,t,0,0,Math.sqrt(n)/2)}}}return t$[e]}(e)}var t$={};const n$=.448084975506;function r$(e){return e.x}function i$(e){return e.y}function o$(e){return e.width}function a$(e){return e.height}function s$(e){return"function"==typeof e?e:()=>+e}function u$(e,t,n){return Math.max(t,Math.min(e,n))}function l$(){var e=r$,t=i$,n=o$,r=a$,i=s$(0),o=i,a=i,s=i,u=null;function l(l,c,f){var d,h=null!=c?c:+e.call(this,l),p=null!=f?f:+t.call(this,l),m=+n.call(this,l),g=+r.call(this,l),y=Math.min(m,g)/2,v=u$(+i.call(this,l),0,y),b=u$(+o.call(this,l),0,y),x=u$(+a.call(this,l),0,y),w=u$(+s.call(this,l),0,y);if(u||(u=d=yC()),v<=0&&b<=0&&x<=0&&w<=0)u.rect(h,p,m,g);else{var _=h+m,k=p+g;u.moveTo(h+v,p),u.lineTo(_-b,p),u.bezierCurveTo(_-n$*b,p,_,p+n$*b,_,p+b),u.lineTo(_,k-w),u.bezierCurveTo(_,k-n$*w,_-n$*w,k,_-w,k),u.lineTo(h+x,k),u.bezierCurveTo(h+n$*x,k,h,k-n$*x,h,k-x),u.lineTo(h,p+v),u.bezierCurveTo(h,p+n$*v,h+n$*v,p,h+v,p),u.closePath()}if(d)return u=null,d+""||null}return l.x=function(t){return arguments.length?(e=s$(t),l):e},l.y=function(e){return arguments.length?(t=s$(e),l):t},l.width=function(e){return arguments.length?(n=s$(e),l):n},l.height=function(e){return arguments.length?(r=s$(e),l):r},l.cornerRadius=function(e,t,n,r){return arguments.length?(i=s$(e),o=null!=t?s$(t):i,s=null!=n?s$(n):i,a=null!=r?s$(r):o,l):i},l.context=function(e){return arguments.length?(u=null==e?null:e,l):u},l}function c$(){var e,t,n,r,i,o,a,s,u=null;function l(e,t,n){const r=n/2;if(i){var l=a-t,c=e-o;if(l||c){var f=Math.sqrt(l*l+c*c),d=(l/=f)*s,h=(c/=f)*s,p=Math.atan2(c,l);u.moveTo(o-d,a-h),u.lineTo(e-l*r,t-c*r),u.arc(e,t,r,p-Math.PI,p),u.lineTo(o+d,a+h),u.arc(o,a,s,p,p+Math.PI)}else u.arc(e,t,r,0,UO);u.closePath()}else i=1;o=e,a=t,s=r}function c(o){var a,s,c,f=o.length,d=!1;for(null==u&&(u=c=yC()),a=0;a<=f;++a)!(a<f&&r(s=o[a],a,o))===d&&(d=!d)&&(i=0),d&&l(+e(s,a,o),+t(s,a,o),+n(s,a,o));if(c)return u=null,c+""||null}return c.x=function(t){return arguments.length?(e=t,c):e},c.y=function(e){return arguments.length?(t=e,c):t},c.size=function(e){return arguments.length?(n=e,c):n},c.defined=function(e){return arguments.length?(r=e,c):r},c.context=function(e){return arguments.length?(u=null==e?null:e,c):u},c}function f$(e,t){return null!=e?e:t}const d$=e=>e.x||0,h$=e=>e.y||0,p$=e=>!(!1===e.defined),m$=function(){var e=OC,t=$C,n=vC(0),r=null,i=TC,o=zC,a=RC,s=null;function u(){var u,l,c=+e.apply(this,arguments),f=+t.apply(this,arguments),d=i.apply(this,arguments)-DC,h=o.apply(this,arguments)-DC,p=bC(h-d),m=h>d;if(s||(s=u=yC()),f<c&&(l=f,f=c,c=l),f>AC)if(p>MC-AC)s.moveTo(f*wC(d),f*EC(d)),s.arc(0,0,f,d,h,!m),c>AC&&(s.moveTo(c*wC(h),c*EC(h)),s.arc(0,0,c,h,d,m));else{var g,y,v=d,b=h,x=d,w=h,_=p,k=p,E=a.apply(this,arguments)/2,S=E>AC&&(r?+r.apply(this,arguments):SC(c*c+f*f)),A=kC(bC(f-c)/2,+n.apply(this,arguments)),C=A,D=A;if(S>AC){var M=NC(S/c*EC(E)),F=NC(S/f*EC(E));(_-=2*M)>AC?(x+=M*=m?1:-1,w-=M):(_=0,x=w=(d+h)/2),(k-=2*F)>AC?(v+=F*=m?1:-1,b-=F):(k=0,v=b=(d+h)/2)}var N=f*wC(v),O=f*EC(v),$=c*wC(w),T=c*EC(w);if(A>AC){var z,R=f*wC(b),P=f*EC(b),L=c*wC(x),B=c*EC(x);if(p<CC&&(z=PC(N,O,L,B,R,P,$,T))){var I=N-z[0],j=O-z[1],U=R-z[0],q=P-z[1],W=1/EC(FC((I*U+j*q)/(SC(I*I+j*j)*SC(U*U+q*q)))/2),H=SC(z[0]*z[0]+z[1]*z[1]);C=kC(A,(c-H)/(W-1)),D=kC(A,(f-H)/(W+1))}}k>AC?D>AC?(g=LC(L,B,N,O,f,D,m),y=LC(R,P,$,T,f,D,m),s.moveTo(g.cx+g.x01,g.cy+g.y01),D<A?s.arc(g.cx,g.cy,D,xC(g.y01,g.x01),xC(y.y01,y.x01),!m):(s.arc(g.cx,g.cy,D,xC(g.y01,g.x01),xC(g.y11,g.x11),!m),s.arc(0,0,f,xC(g.cy+g.y11,g.cx+g.x11),xC(y.cy+y.y11,y.cx+y.x11),!m),s.arc(y.cx,y.cy,D,xC(y.y11,y.x11),xC(y.y01,y.x01),!m))):(s.moveTo(N,O),s.arc(0,0,f,v,b,!m)):s.moveTo(N,O),c>AC&&_>AC?C>AC?(g=LC($,T,R,P,c,-C,m),y=LC(N,O,L,B,c,-C,m),s.lineTo(g.cx+g.x01,g.cy+g.y01),C<A?s.arc(g.cx,g.cy,C,xC(g.y01,g.x01),xC(y.y01,y.x01),!m):(s.arc(g.cx,g.cy,C,xC(g.y01,g.x01),xC(g.y11,g.x11),!m),s.arc(0,0,c,xC(g.cy+g.y11,g.cx+g.x11),xC(y.cy+y.y11,y.cx+y.x11),m),s.arc(y.cx,y.cy,C,xC(y.y11,y.x11),xC(y.y01,y.x01),!m))):s.arc(0,0,c,w,x,m):s.lineTo($,T)}else s.moveTo(0,0);if(s.closePath(),u)return s=null,u+""||null}return u.centroid=function(){var n=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-CC/2;return[wC(r)*n,EC(r)*n]},u.innerRadius=function(t){return arguments.length?(e="function"==typeof t?t:vC(+t),u):e},u.outerRadius=function(e){return arguments.length?(t="function"==typeof e?e:vC(+e),u):t},u.cornerRadius=function(e){return arguments.length?(n="function"==typeof e?e:vC(+e),u):n},u.padRadius=function(e){return arguments.length?(r=null==e?null:"function"==typeof e?e:vC(+e),u):r},u.startAngle=function(e){return arguments.length?(i="function"==typeof e?e:vC(+e),u):i},u.endAngle=function(e){return arguments.length?(o="function"==typeof e?e:vC(+e),u):o},u.padAngle=function(e){return arguments.length?(a="function"==typeof e?e:vC(+e),u):a},u.context=function(e){return arguments.length?(s=null==e?null:e,u):s},u}().startAngle((e=>e.startAngle||0)).endAngle((e=>e.endAngle||0)).padAngle((e=>e.padAngle||0)).innerRadius((e=>e.innerRadius||0)).outerRadius((e=>e.outerRadius||0)).cornerRadius((e=>e.cornerRadius||0)),g$=HC().x(d$).y1(h$).y0((e=>(e.y||0)+(e.height||0))).defined(p$),y$=HC().y(h$).x1(d$).x0((e=>(e.x||0)+(e.width||0))).defined(p$),v$=WC().x(d$).y(h$).defined(p$),b$=l$().x(d$).y(h$).width((e=>e.width||0)).height((e=>e.height||0)).cornerRadius((e=>f$(e.cornerRadiusTopLeft,e.cornerRadius)||0),(e=>f$(e.cornerRadiusTopRight,e.cornerRadius)||0),(e=>f$(e.cornerRadiusBottomRight,e.cornerRadius)||0),(e=>f$(e.cornerRadiusBottomLeft,e.cornerRadius)||0)),x$=function(e,t){var n=null;function r(){var r;if(n||(n=r=yC()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),r)return n=null,r+""||null}return e="function"==typeof e?e:vC(e||VC),t="function"==typeof t?t:vC(void 0===t?64:+t),r.type=function(t){return arguments.length?(e="function"==typeof t?t:vC(t),r):e},r.size=function(e){return arguments.length?(t="function"==typeof e?e:vC(+e),r):t},r.context=function(e){return arguments.length?(n=null==e?null:e,r):n},r}().type((e=>e$(e.shape||"circle"))).size((e=>f$(e.size,64))),w$=c$().x(d$).y(h$).defined(p$).size((e=>e.size||1));function _$(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function k$(e,t,n,r){return b$.context(e)(t,n,r)}var E$=1;function S$(){E$=1}function A$(e,t,n){var r=t.clip,i=e._defs,o=t.clip_id||(t.clip_id="clip"+E$++),a=i.clipping[o]||(i.clipping[o]={id:o});return ay(r)?a.path=r(null):_$(n)?a.path=k$(null,n,0,0):(a.width=n.width||0,a.height=n.height||0),"url(#"+o+")"}function C$(e){this.clear(),e&&this.union(e)}function D$(e){this.mark=e,this.bounds=this.bounds||new C$}function M$(e){D$.call(this,e),this.items=this.items||[]}function F$(e){this._pending=0,this._loader=e||Zk()}function N$(e){e._pending+=1}function O$(e){e._pending-=1}function $$(e,t,n){if(t.stroke&&0!==t.opacity&&0!==t.strokeOpacity){const r=null!=t.strokeWidth?+t.strokeWidth:1;e.expand(r+(n?function(e,t){return e.strokeJoin&&"miter"!==e.strokeJoin?0:t}(t,r):0))}return e}C$.prototype={clone:function(){return new C$(this)},clear:function(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty:function(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals:function(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set:function(e,t,n,r){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),r<t?(this.y2=t,this.y1=r):(this.y1=t,this.y2=r),this},add:function(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand:function(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round:function(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale:function(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate:function(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate:function(e,t,n){const r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints:function(e,t,n){var{x1:r,y1:i,x2:o,y2:a}=this,s=Math.cos(e),u=Math.sin(e),l=t-t*s+n*u,c=n-t*u-n*s;return[s*r-u*i+l,u*r+s*i+c,s*r-u*a+l,u*r+s*a+c,s*o-u*i+l,u*o+s*i+c,s*o-u*a+l,u*o+s*a+c]},union:function(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect:function(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses:function(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith:function(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects:function(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains:function(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width:function(){return this.x2-this.x1},height:function(){return this.y2-this.y1}},_y(M$,D$),F$.prototype={pending:function(){return this._pending},sanitizeURL:function(e){const t=this;return N$(t),t._loader.sanitize(e,{context:"href"}).then((e=>(O$(t),e))).catch((()=>(O$(t),null)))},loadImage:function(e){const t=this,n=CD();return N$(t),t._loader.sanitize(e,{context:"image"}).then((e=>{const r=e.href;if(!r||!n)throw{url:r};const i=new n,o=vy(e,"crossOrigin")?e.crossOrigin:"anonymous";return null!=o&&(i.crossOrigin=o),i.onload=()=>O$(t),i.onerror=()=>O$(t),i.src=r,i})).catch((e=>(O$(t),{complete:!1,width:0,height:0,src:e&&e.url||""})))},ready:function(){const e=this;return new Promise((t=>{!function n(r){e.pending()?setTimeout((()=>{n(!0)}),10):t(r)}(!1)}))}};const T$=UO-1e-8;let z$,R$,P$,L$,B$,I$,j$,U$;const q$=(e,t)=>z$.add(e,t),W$=(e,t)=>q$(R$=e,P$=t),H$=e=>q$(e,z$.y1),V$=e=>q$(z$.x1,e),G$=(e,t)=>B$*e+j$*t,Y$=(e,t)=>I$*e+U$*t,X$=(e,t)=>q$(G$(e,t),Y$(e,t)),Q$=(e,t)=>W$(G$(e,t),Y$(e,t));function J$(e,t){return z$=e,t?(L$=t*IO,B$=U$=Math.cos(L$),I$=Math.sin(L$),j$=-I$):(B$=U$=1,L$=I$=j$=0),K$}const K$={beginPath:function(){},closePath:function(){},moveTo:Q$,lineTo:Q$,rect:function(e,t,n,r){L$?(X$(e+n,t),X$(e+n,t+r),X$(e,t+r),Q$(e,t)):(q$(e+n,t+r),W$(e,t))},quadraticCurveTo:function(e,t,n,r){const i=G$(e,t),o=Y$(e,t),a=G$(n,r),s=Y$(n,r);Z$(R$,i,a,H$),Z$(P$,o,s,V$),W$(a,s)},bezierCurveTo:function(e,t,n,r,i,o){const a=G$(e,t),s=Y$(e,t),u=G$(n,r),l=Y$(n,r),c=G$(i,o),f=Y$(i,o);eT(R$,a,u,c,H$),eT(P$,s,l,f,V$),W$(c,f)},arc:function(e,t,n,r,i,o){if(r+=L$,i+=L$,R$=n*Math.cos(i)+e,P$=n*Math.sin(i)+t,Math.abs(i-r)>T$)q$(e-n,t-n),q$(e+n,t+n);else{const a=r=>q$(n*Math.cos(r)+e,n*Math.sin(r)+t);let s,u;if(a(r),a(i),i!==r)if((r%=UO)<0&&(r+=UO),(i%=UO)<0&&(i+=UO),i<r&&(o=!o,s=r,r=i,i=s),o)for(i-=UO,s=r-r%jO,u=0;u<4&&s>i;++u,s-=jO)a(s);else for(s=r-r%jO+jO,u=0;u<4&&s<i;++u,s+=jO)a(s)}}};function Z$(e,t,n,r){const i=(e-t)/(e+n-2*t);0<i&&i<1&&r(e+(t-e)*i)}function eT(e,t,n,r,i){const o=r-e+3*t-3*n,a=e+n-2*t,s=e-t;let u,l=0,c=0;Math.abs(o)>1e-14?(u=a*a+s*o,u>=0&&(u=Math.sqrt(u),l=(-a+u)/o,c=(-a-u)/o)):l=.5*s/a,0<l&&l<1&&i(tT(l,e,t,n,r)),0<c&&c<1&&i(tT(c,e,t,n,r))}function tT(e,t,n,r,i){const o=1-e,a=o*o,s=e*e;return a*o*t+3*a*e*n+3*o*s*r+s*e*i}var nT=(nT=AD(1,1))?nT.getContext("2d"):null;const rT=new C$;function iT(e){return function(t,n){if(!nT)return!0;e(nT,t),rT.clear().union(t.bounds).intersect(n).round();const{x1:r,y1:i,x2:o,y2:a}=rT;for(let e=i;e<=a;++e)for(let t=r;t<=o;++t)if(nT.isPointInPath(t,e))return!0;return!1}}function oT(e,t){return t.contains(e.x||0,e.y||0)}function aT(e,t){const n=e.x||0,r=e.y||0,i=e.width||0,o=e.height||0;return t.intersects(rT.set(n,r,n+i,r+o))}function sT(e,t){const n=e.x||0,r=e.y||0;return uT(t,n,r,null!=e.x2?e.x2:n,null!=e.y2?e.y2:r)}function uT(e,t,n,r,i){const{x1:o,y1:a,x2:s,y2:u}=e,l=r-t,c=i-n;let f,d,h,p,m=0,g=1;for(p=0;p<4;++p){if(0===p&&(f=-l,d=-(o-t)),1===p&&(f=l,d=s-t),2===p&&(f=-c,d=-(a-n)),3===p&&(f=c,d=u-n),Math.abs(f)<1e-10&&d<0)return!1;if(h=d/f,f<0){if(h>g)return!1;h>m&&(m=h)}else if(f>0){if(h<m)return!1;h<g&&(g=h)}}return!0}function lT(e,t){e.globalCompositeOperation=t.blend||"source-over"}function cT(e,t){return null==e?t:e}function fT(e,t){const n=t.length;for(let r=0;r<n;++r)e.addColorStop(t[r].offset,t[r].color);return e}function dT(e,t,n){return NO(n)?function(e,t,n){const r=n.width(),i=n.height();let o;if("radial"===t.gradient)o=e.createRadialGradient(n.x1+cT(t.x1,.5)*r,n.y1+cT(t.y1,.5)*i,Math.max(r,i)*cT(t.r1,0),n.x1+cT(t.x2,.5)*r,n.y1+cT(t.y2,.5)*i,Math.max(r,i)*cT(t.r2,.5));else{const a=cT(t.x1,0),s=cT(t.y1,0),u=cT(t.x2,1),l=cT(t.y2,0);if(a!==u&&s!==l&&r!==i){const n=AD(Math.ceil(r),Math.ceil(i)),o=n.getContext("2d");return o.scale(r,i),o.fillStyle=fT(o.createLinearGradient(a,s,u,l),t.stops),o.fillRect(0,0,r,i),e.createPattern(n,"no-repeat")}o=e.createLinearGradient(n.x1+a*r,n.y1+s*i,n.x1+u*r,n.y1+l*i)}return fT(o,t.stops)}(e,n,t.bounds):n}function hT(e,t,n){return(n*=null==t.fillOpacity?1:t.fillOpacity)>0&&(e.globalAlpha=n,e.fillStyle=dT(e,t,t.fill),!0)}var pT=[];function mT(e,t,n){var r=null!=(r=t.strokeWidth)?r:1;return!(r<=0)&&((n*=null==t.strokeOpacity?1:t.strokeOpacity)>0&&(e.globalAlpha=n,e.strokeStyle=dT(e,t,t.stroke),e.lineWidth=r,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||pT),e.lineDashOffset=t.strokeDashOffset||0),!0))}function gT(e,t){return e.zindex-t.zindex||e.index-t.index}function yT(e){if(!e.zdirty)return e.zitems;var t,n,r,i=e.items,o=[];for(n=0,r=i.length;n<r;++n)(t=i[n]).index=n,t.zindex&&o.push(t);return e.zdirty=!1,e.zitems=o.sort(gT)}function vT(e,t){var n,r,i=e.items;if(!i||!i.length)return;const o=yT(e);if(o&&o.length){for(n=0,r=i.length;n<r;++n)i[n].zindex||t(i[n]);i=o}for(n=0,r=i.length;n<r;++n)t(i[n])}function bT(e,t){var n,r,i=e.items;if(!i||!i.length)return null;const o=yT(e);for(o&&o.length&&(i=o),r=i.length;--r>=0;)if(n=t(i[r]))return n;if(i===o)for(r=(i=e.items).length;--r>=0;)if(!i[r].zindex&&(n=t(i[r])))return n;return null}function xT(e){return function(t,n,r){vT(n,(n=>{r&&!r.intersects(n.bounds)||wT(e,t,n,n)}))}}function wT(e,t,n,r){var i=null==n.opacity?1:n.opacity;0!==i&&(e(t,r)||(lT(t,n),n.fill&&hT(t,n,i)&&t.fill(),n.stroke&&mT(t,n,i)&&t.stroke()))}function _T(e){return e=e||Mg,function(t,n,r,i,o,a){return r*=t.pixelRatio,i*=t.pixelRatio,bT(n,(n=>{const s=n.bounds;if((!s||s.contains(o,a))&&s)return e(t,n,r,i,o,a)?n:void 0}))}}function kT(e,t){return function(n,r,i,o){var a,s,u=Array.isArray(r)?r[0]:r,l=null==t?u.fill:t,c=u.stroke&&n.isPointInStroke;return c&&(a=u.strokeWidth,s=u.strokeCap,n.lineWidth=null!=a?a:1,n.lineCap=null!=s?s:"butt"),!e(n,r)&&(l&&n.isPointInPath(i,o)||c&&n.isPointInStroke(i,o))}}function ET(e){return _T(kT(e))}function ST(e,t){return"translate("+e+","+t+")"}function AT(e){return"rotate("+e+")"}function CT(e){return ST(e.x||0,e.y||0)}function DT(e,t,n){function r(e,n){var r=n.x||0,i=n.y||0,o=n.angle||0;e.translate(r,i),o&&e.rotate(o*=IO),e.beginPath(),t(e,n),o&&e.rotate(-o),e.translate(-r,-i)}return{type:e,tag:"path",nested:!1,attr:function(e,n){e("transform",function(e){return ST(e.x||0,e.y||0)+(e.angle?" "+AT(e.angle):"")}(n)),e("d",t(null,n))},bound:function(e,n){return t(J$(e,n.angle),n),$$(e,n).translate(n.x||0,n.y||0)},draw:xT(r),pick:ET(r),isect:n||iT(r)}}var MT=DT("arc",(function(e,t){return m$.context(e)(t)}));function FT(e,t,n){function r(e,n){e.beginPath(),t(e,n)}const i=kT(r);return{type:e,tag:"path",nested:!0,attr:function(e,n){var r=n.mark.items;r.length&&e("d",t(null,r))},bound:function(e,n){var r=n.items;return 0===r.length?e:(t(J$(e),r),$$(e,r[0]))},draw:(o=r,function(e,t,n){!t.items.length||n&&!n.intersects(t.bounds)||wT(o,e,t.items[0],t.items)}),pick:function(e,t,n,r,o,a){var s=t.items,u=t.bounds;return!s||!s.length||u&&!u.contains(o,a)?null:(n*=e.pixelRatio,r*=e.pixelRatio,i(e,s,n,r)?s[0]:null)},isect:oT,tip:n};var o}var NT=FT("area",(function(e,t){const n=t[0],r=n.interpolate||"linear";return("horizontal"===n.orient?y$:g$).curve(RO(r,n.orient,n.tension)).context(e)(t)}),(function(e,t){for(var n,r,i="horizontal"===e[0].orient?t[1]:t[0],o="horizontal"===e[0].orient?"y":"x",a=e.length,s=1/0;--a>=0;)!1!==e[a].defined&&(r=Math.abs(e[a][o]-i))<s&&(s=r,n=e[a]);return n}));function OT(e,t){e.beginPath(),_$(t)?k$(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function $T(e){const t=cT(e.strokeWidth,1);return null!=e.strokeOffset?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function TT(e,t){const n=$T(t);e("d",k$(null,t,n,n))}function zT(e,t,n,r){const i=$T(t);e.beginPath(),k$(e,t,(n||0)+i,(r||0)+i)}const RT=kT(zT),PT=kT(zT,!1),LT=kT(zT,!0);var BT={type:"group",tag:"g",nested:!1,attr:function(e,t){e("transform",CT(t))},bound:function(e,t){if(!t.clip&&t.items){const n=t.items,r=n.length;for(let t=0;t<r;++t)e.union(n[t].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),$$(e,t),e.translate(t.x||0,t.y||0)},draw:function(e,t,n){vT(t,(t=>{const r=t.x||0,i=t.y||0,o=t.strokeForeground,a=null==t.opacity?1:t.opacity;(t.stroke||t.fill)&&a&&(zT(e,t,r,i),lT(e,t),t.fill&&hT(e,t,a)&&e.fill(),t.stroke&&!o&&mT(e,t,a)&&e.stroke()),e.save(),e.translate(r,i),t.clip&&OT(e,t),n&&n.translate(-r,-i),vT(t,(t=>{this.draw(e,t,n)})),n&&n.translate(r,i),e.restore(),o&&t.stroke&&a&&(zT(e,t,r,i),lT(e,t),mT(e,t,a)&&e.stroke())}))},pick:function(e,t,n,r,i,o){if(t.bounds&&!t.bounds.contains(i,o)||!t.items)return null;const a=n*e.pixelRatio,s=r*e.pixelRatio;return bT(t,(u=>{let l,c,f;const d=u.bounds;if(d&&!d.contains(i,o))return;c=u.x||0,f=u.y||0;const h=c+(u.width||0),p=f+(u.height||0),m=u.clip;if(m&&(i<c||i>h||o<f||o>p))return;if(e.save(),e.translate(c,f),c=i-c,f=o-f,m&&_$(u)&&!LT(e,u,a,s))return e.restore(),null;const g=u.strokeForeground,y=!1!==t.interactive;return y&&g&&u.stroke&&PT(e,u,a,s)?(e.restore(),u):(l=bT(u,(e=>function(e,t,n){return(!1!==e.interactive||"group"===e.marktype)&&e.bounds&&e.bounds.contains(t,n)}(e,c,f)?this.pick(e,n,r,c,f):null)),!l&&y&&(u.fill||!g&&u.stroke)&&RT(e,u,a,s)&&(l=u),e.restore(),l||null)}))},isect:aT,content:function(e,t,n){e("clip-path",t.clip?A$(n,t,t):null)},background:function(e,t){e("class","background"),e("aria-hidden",!0),TT(e,t)},foreground:function(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?TT(e,t):e("d","")}},IT={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function jT(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then((t=>{e.image=t,e.image.url=e.url}))),n}function UT(e,t){return null!=e.width?e.width:t&&t.width?!1!==e.aspect&&e.height?e.height*t.width/t.height:t.width:0}function qT(e,t){return null!=e.height?e.height:t&&t.height?!1!==e.aspect&&e.width?e.width*t.height/t.width:t.height:0}function WT(e,t){return"center"===e?t/2:"right"===e?t:0}function HT(e,t){return"middle"===e?t/2:"bottom"===e?t:0}var VT={type:"image",tag:"image",nested:!1,attr:function(e,t,n){const r=jT(t,n),i=UT(t,r),o=qT(t,r),a=(t.x||0)-WT(t.align,i),s=(t.y||0)-HT(t.baseline,o);e("href",!r.src&&r.toDataURL?r.toDataURL():r.src||"",IT["xmlns:xlink"],"xlink:href"),e("transform",ST(a,s)),e("width",i),e("height",o),e("preserveAspectRatio",!1===t.aspect?"none":"xMidYMid")},bound:function(e,t){const n=t.image,r=UT(t,n),i=qT(t,n),o=(t.x||0)-WT(t.align,r),a=(t.y||0)-HT(t.baseline,i);return e.set(o,a,o+r,a+i)},draw:function(e,t,n){vT(t,(t=>{if(n&&!n.intersects(t.bounds))return;const r=jT(t,this);let i=UT(t,r),o=qT(t,r);if(0===i||0===o)return;let a,s,u,l,c=(t.x||0)-WT(t.align,i),f=(t.y||0)-HT(t.baseline,o);!1!==t.aspect&&(s=r.width/r.height,u=t.width/t.height,s==s&&u==u&&s!==u&&(u<s?(l=i/s,f+=(o-l)/2,o=l):(l=o*s,c+=(i-l)/2,i=l))),(r.complete||r.toDataURL)&&(lT(e,t),e.globalAlpha=null!=(a=t.opacity)?a:1,e.imageSmoothingEnabled=!1!==t.smooth,e.drawImage(r,c,f,i,o))}))},pick:_T(),isect:Mg,get:jT,xOffset:WT,yOffset:HT},GT=FT("line",(function(e,t){const n=t[0],r=n.interpolate||"linear";return v$.curve(RO(r,n.orient,n.tension)).context(e)(t)}),(function(e,t){for(var n,r,i=Math.pow(e[0].strokeWidth||1,2),o=e.length;--o>=0;)if(!1!==e[o].defined&&(n=e[o].x-t[0])*n+(r=e[o].y-t[1])*r<i)return e[o];return null}));function YT(e,t){var n=t.path;if(null==n)return!0;var r=t.x||0,i=t.y||0,o=t.scaleX||1,a=t.scaleY||1,s=(t.angle||0)*IO,u=t.pathCache;u&&u.path===n||((t.pathCache=u=BO(n)).path=n),s&&e.rotate&&e.translate?(e.translate(r,i),e.rotate(s),QO(e,u,0,0,o,a),e.rotate(-s),e.translate(-r,-i)):QO(e,u,r,i,o,a)}var XT={type:"path",tag:"path",nested:!1,attr:function(e,t){var n=t.scaleX||1,r=t.scaleY||1;1===n&&1===r||e("vector-effect","non-scaling-stroke"),e("transform",function(e){return ST(e.x||0,e.y||0)+(e.angle?" "+AT(e.angle):"")+(e.scaleX||e.scaleY?" "+(t=e.scaleX||1,n=e.scaleY||1,"scale("+t+","+n+")"):"");var t,n}(t)),e("d",t.path)},bound:function(e,t){return YT(J$(e,t.angle),t)?e.set(0,0,0,0):$$(e,t,!0)},draw:xT(YT),pick:ET(YT),isect:iT(YT)};function QT(e,t){e.beginPath(),k$(e,t)}var JT={type:"rect",tag:"path",nested:!1,attr:function(e,t){e("d",k$(null,t))},bound:function(e,t){var n,r;return $$(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)},draw:xT(QT),pick:ET(QT),isect:aT};function KT(e,t,n){var r,i,o,a;return!(!t.stroke||!mT(e,t,n))&&(r=t.x||0,i=t.y||0,o=null!=t.x2?t.x2:r,a=null!=t.y2?t.y2:i,e.beginPath(),e.moveTo(r,i),e.lineTo(o,a),!0)}var ZT={type:"rule",tag:"line",nested:!1,attr:function(e,t){e("transform",CT(t)),e("x2",null!=t.x2?t.x2-(t.x||0):0),e("y2",null!=t.y2?t.y2-(t.y||0):0)},bound:function(e,t){var n,r;return $$(e.set(n=t.x||0,r=t.y||0,null!=t.x2?t.x2:n,null!=t.y2?t.y2:r),t)},draw:function(e,t,n){vT(t,(t=>{if(!n||n.intersects(t.bounds)){var r=null==t.opacity?1:t.opacity;r&&KT(e,t,r)&&(lT(e,t),e.stroke())}}))},pick:_T((function(e,t,n,r){return!!e.isPointInStroke&&(KT(e,t,1)&&e.isPointInStroke(n,r))})),isect:sT},ez=DT("shape",(function(e,t){return(t.mark.shape||t.shape).context(e)(t)})),tz=DT("symbol",(function(e,t){return x$.context(e)(t)}),oT);const nz=Oy();var rz={height:lz,measureWidth:sz,estimateWidth:oz,width:oz,canvas:iz};function iz(e){rz.width=e&&nT?sz:oz}function oz(e,t){return az(hz(e,t),lz(e))}function az(e,t){return~~(.8*e.length*t)}function sz(e,t){return lz(e)<=0||!(t=hz(e,t))?0:uz(t,mz(e))}function uz(e,t){const n=`(${t}) ${e}`;let r=nz.get(n);return void 0===r&&(nT.font=t,r=nT.measureText(e).width,nz.set(n,r)),r}function lz(e){return null!=e.fontSize?+e.fontSize||0:11}function cz(e){return null!=e.lineHeight?e.lineHeight:lz(e)+2}function fz(e){return t=e.lineBreak&&e.text&&!$g(e.text)?e.text.split(e.lineBreak):e.text,$g(t)?t.length>1?t:t[0]:t;var t}function dz(e){const t=fz(e);return($g(t)?t.length-1:0)*cz(e)}function hz(e,t){const n=null==t?"":(t+"").trim();return e.limit>0&&n.length?function(e,t){var n=+e.limit,r=function(e){if(rz.width===sz){const t=mz(e);return e=>uz(e,t)}{const t=lz(e);return e=>az(e,t)}}(e);if(r(t)<n)return t;var i,o=e.ellipsis||"",a="rtl"===e.dir,s=0,u=t.length;if(n-=r(o),a){for(;s<u;)i=s+u>>>1,r(t.slice(i))>n?s=i+1:u=i;return o+t.slice(s)}for(;s<u;)i=1+(s+u>>>1),r(t.slice(0,i))<n?s=i:u=i-1;return t.slice(0,s)+o}(e,n):n}function pz(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function mz(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+lz(e)+"px "+pz(e,t)}function gz(e){var t=e.baseline,n=lz(e);return Math.round("top"===t?.79*n:"middle"===t?.3*n:"bottom"===t?-.21*n:"line-top"===t?.29*n+.5*cz(e):"line-bottom"===t?.29*n-.5*cz(e):0)}iz(!0);const yz={left:"start",center:"middle",right:"end"},vz=new C$;function bz(e){var t,n=e.x||0,r=e.y||0,i=e.radius||0;return i&&(t=(e.theta||0)-jO,n+=i*Math.cos(t),r+=i*Math.sin(t)),vz.x1=n,vz.y1=r,vz}function xz(e,t,n){var r,i=rz.height(t),o=t.align,a=bz(t),s=a.x1,u=a.y1,l=t.dx||0,c=(t.dy||0)+gz(t)-Math.round(.8*i),f=fz(t);if($g(f)?(i+=cz(t)*(f.length-1),r=f.reduce(((e,n)=>Math.max(e,rz.width(t,n))),0)):r=rz.width(t,f),"center"===o?l-=r/2:"right"===o&&(l-=r),e.set(l+=s,c+=u,l+r,c+i),t.angle&&!n)e.rotate(t.angle*IO,s,u);else if(2===n)return e.rotatedPoints(t.angle*IO,s,u);return e}var wz={arc:MT,area:NT,group:BT,image:VT,line:GT,path:XT,rect:JT,rule:ZT,shape:ez,symbol:tz,text:{type:"text",tag:"text",nested:!1,attr:function(e,t){var n,r=t.dx||0,i=(t.dy||0)+gz(t),o=bz(t),a=o.x1,s=o.y1,u=t.angle||0;e("text-anchor",yz[t.align]||"start"),u?(n=ST(a,s)+" "+AT(u),(r||i)&&(n+=" "+ST(r,i))):n=ST(a+r,s+i),e("transform",n)},bound:xz,draw:function(e,t,n){vT(t,(t=>{var r,i,o,a,s,u,l,c=null==t.opacity?1:t.opacity;if(!(n&&!n.intersects(t.bounds)||0===c||t.fontSize<=0||null==t.text||0===t.text.length)){if(e.font=mz(t),e.textAlign=t.align||"left",i=(r=bz(t)).x1,o=r.y1,t.angle&&(e.save(),e.translate(i,o),e.rotate(t.angle*IO),i=o=0),i+=t.dx||0,o+=(t.dy||0)+gz(t),u=fz(t),lT(e,t),$g(u))for(s=cz(t),a=0;a<u.length;++a)l=hz(t,u[a]),t.fill&&hT(e,t,c)&&e.fillText(l,i,o),t.stroke&&mT(e,t,c)&&e.strokeText(l,i,o),o+=s;else l=hz(t,u),t.fill&&hT(e,t,c)&&e.fillText(l,i,o),t.stroke&&mT(e,t,c)&&e.strokeText(l,i,o);t.angle&&e.restore()}}))},pick:_T((function(e,t,n,r,i,o){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var a=bz(t),s=a.x1,u=a.y1,l=xz(vz,t,1),c=-t.angle*IO,f=Math.cos(c),d=Math.sin(c),h=f*i-d*o+(s-f*s+d*u),p=d*i+f*o+(u-d*s-f*u);return l.contains(h,p)})),isect:function(e,t){const n=xz(vz,e,2);return uT(t,n[0],n[1],n[2],n[3])||uT(t,n[0],n[1],n[4],n[5])||uT(t,n[4],n[5],n[6],n[7])||uT(t,n[2],n[3],n[6],n[7])}},trail:FT("trail",(function(e,t){return w$.context(e)(t)}),(function(e,t){for(var n,r,i=e.length;--i>=0;)if(!1!==e[i].defined&&(n=e[i].x-t[0])*n+(r=e[i].y-t[1])*r<(n=e[i].size||1)*n)return e[i];return null}))};function _z(e,t,n){var r=wz[e.mark.marktype],i=t||r.bound;return r.nested&&(e=e.mark),i(e.bounds||(e.bounds=new C$),e,n)}var kz={mark:null};function Ez(e,t,n){var r,i,o,a,s=wz[e.marktype],u=s.bound,l=e.items,c=l&&l.length;if(s.nested)return c?o=l[0]:(kz.mark=e,o=kz),a=_z(o,u,n),t=t&&t.union(a)||a;if(t=t||e.bounds&&e.bounds.clear()||new C$,c)for(r=0,i=l.length;r<i;++r)t.union(_z(l[r],u,n));return e.bounds=t}const Sz=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function Az(e,t){return JSON.stringify(e,Sz,t)}function Cz(e){return Dz("string"==typeof e?JSON.parse(e):e)}function Dz(e){var t,n,r,i=e.marktype,o=e.items;if(o)for(n=0,r=o.length;n<r;++n)t=i?"mark":"group",o[n][t]=e,o[n].zindex&&(o[n][t].zdirty=!0),"group"===(i||t)&&Dz(o[n]);return i&&Ez(e),e}function Mz(e){arguments.length?this.root=Cz(e):(this.root=Fz({marktype:"group",name:"root",role:"frame"}),this.root.items=[new M$(this.root)])}function Fz(e,t){const n={bounds:new C$,clip:!!e.clip,group:t,interactive:!1!==e.interactive,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return null!=e.aria&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function Nz(e,t,n){return!e&&"undefined"!=typeof document&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function Oz(e,t){t=t.toLowerCase();for(var n=e.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===t)return n[r]}function $z(e,t,n,r){var i,o=e.childNodes[t];return o&&o.tagName.toLowerCase()===n.toLowerCase()||(i=o||null,o=Nz(e.ownerDocument,n,r),e.insertBefore(o,i)),o}function Tz(e,t){for(var n=e.childNodes,r=n.length;r>t;)e.removeChild(n[--r]);return e}function zz(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function Rz(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function Pz(e,t){this._active=null,this._handlers={},this._loader=e||Zk(),this._tooltip=t||Lz}function Lz(e,t,n,r){e.element().setAttribute("title",r||"")}function Bz(e){this._el=null,this._bgcolor=null,this._loader=new F$(e)}Mz.prototype={toJSON:function(e){return Az(this.root,e||0)},mark:function(e,t,n){const r=Fz(e,t=t||this.root.items[0]);return t.items[n]=r,r.zindex&&(r.group.zdirty=!0),r}},Pz.prototype={initialize:function(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element:function(){return this._el},canvas:function(){return this._el&&this._el.firstChild},origin:function(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene:function(e){return arguments.length?(this._scene=e,this):this._scene},on:function(){},off:function(){},_handlerIndex:function(e,t,n){for(let r=e?e.length:0;--r>=0;)if(e[r].type===t&&(!n||e[r].handler===n))return r;return-1},handlers:function(e){const t=this._handlers,n=[];if(e)n.push(...t[this.eventName(e)]);else for(const e in t)n.push(...t[e]);return n},eventName:function(e){const t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref:function(e,t,n){this._loader.sanitize(n,{context:"href"}).then((t=>{const n=new MouseEvent(e.type,e),r=Nz(null,"a");for(const e in t)r.setAttribute(e,t[e]);r.dispatchEvent(n)})).catch((()=>{}))},handleTooltip:function(e,t,n){if(t&&null!=t.tooltip){t=function(e,t,n,r){var i,o,a=e&&e.mark;if(a&&(i=wz[a.marktype]).tip){for((o=Rz(t,n))[0]-=r[0],o[1]-=r[1];e=e.mark.group;)o[0]-=e.x||0,o[1]-=e.y||0;e=i.tip(a.items,o)}return e}(t,e,this.canvas(),this._origin);const r=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,r)}},getItemBoundingClientRect:function(e){const t=this.canvas();if(!t)return;const n=t.getBoundingClientRect(),r=this._origin,i=e.bounds,o=i.width(),a=i.height();let s=i.x1+r[0]+n.left,u=i.y1+r[1]+n.top;for(;e.mark&&(e=e.mark.group);)s+=e.x||0,u+=e.y||0;return{x:s,y:u,width:o,height:a,left:s,top:u,right:s+o,bottom:u+a}}},Bz.prototype={initialize:function(e,t,n,r,i){return this._el=e,this.resize(t,n,r,i)},element:function(){return this._el},canvas:function(){return this._el&&this._el.firstChild},background:function(e){return 0===arguments.length?this._bgcolor:(this._bgcolor=e,this)},resize:function(e,t,n,r){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=r||1,this},dirty:function(){},render:function(e){const t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},_render:function(){},renderAsync:function(e){const t=this.render(e);return this._ready?this._ready.then((()=>t)):Promise.resolve(t)},_load:function(e,t){var n=this,r=n._loader[e](t);if(!n._ready){const e=n._call;n._ready=n._loader.ready().then((t=>{t&&e(),n._ready=null}))}return r},sanitizeURL:function(e){return this._load("sanitizeURL",e)},loadImage:function(e){return this._load("loadImage",e)}};const Iz="dragenter",jz="dragleave",Uz="dragover",qz="mousedown",Wz="mousemove",Hz="mouseout",Vz="mouseover",Gz="click",Yz="mousewheel",Xz="touchstart",Qz="touchmove",Jz="touchend",Kz=Wz,Zz=Hz,eR=Gz;function tR(e,t){Pz.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}function nR(e,t){(e=>e===Xz||e===Qz||e===Jz?[Xz,Qz,Jz]:[e])(t).forEach((t=>function(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?n=>e[t](n):n=>e.fire(t,n)))}(e,t)))}function rR(e,t,n){return function(r){const i=this._active,o=this.pickEvent(r);o===i||(i&&i.exit||this.fire(n,r),this._active=o,this.fire(t,r)),this.fire(e,r)}}function iR(e){return function(t){this.fire(e,t),this._active=null}}_y(tR,Pz,{initialize:function(e,t,n){return this._canvas=e&&Oz(e,"canvas"),[Gz,qz,Wz,Hz,jz].forEach((e=>nR(this,e))),Pz.prototype.initialize.call(this,e,t,n)},canvas:function(){return this._canvas},context:function(){return this._canvas.getContext("2d")},events:["keydown","keypress","keyup",Iz,jz,Uz,qz,"mouseup",Wz,Hz,Vz,Gz,"dblclick","wheel",Yz,Xz,Qz,Jz],DOMMouseScroll:function(e){this.fire(Yz,e)},mousemove:rR(Wz,Vz,Hz),dragover:rR(Uz,Iz,jz),mouseout:iR(Hz),dragleave:iR(jz),mousedown:function(e){this._down=this._active,this.fire(qz,e)},click:function(e){this._down===this._active&&(this.fire(Gz,e),this._down=null)},touchstart:function(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(Xz,e,!0)},touchmove:function(e){this.fire(Qz,e,!0)},touchend:function(e){this.fire(Jz,e,!0),this._touch=null},fire:function(e,t,n){const r=n?this._touch:this._active,i=this._handlers[e];if(t.vegaType=e,e===eR&&r&&r.href?this.handleHref(t,r,r.href):e!==Kz&&e!==Zz||this.handleTooltip(t,r,e!==Zz),i)for(let e=0,n=i.length;e<n;++e)i[e].handler.call(this._obj,t,r)},on:function(e,t){const n=this.eventName(e),r=this._handlers;return this._handlerIndex(r[n],e,t)<0&&(nR(this,e),(r[n]||(r[n]=[])).push({type:e,handler:t})),this},off:function(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&r.splice(i,1),this},pickEvent:function(e){const t=Rz(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick:function(e,t,n,r,i){const o=this.context();return wz[e.marktype].pick.call(this,o,e,t,n,r,i)}});var oR="undefined"!=typeof window&&window.devicePixelRatio||1;function aR(e){Bz.call(this,e),this._options={},this._redraw=!1,this._dirty=new C$,this._tempb=new C$}const sR=Bz.prototype;function uR(e,t){Pz.call(this,e,t);const n=this;n._hrefHandler=lR(n,((e,t)=>{t&&t.href&&n.handleHref(e,t,t.href)})),n._tooltipHandler=lR(n,((e,t)=>{n.handleTooltip(e,t,e.type!==Zz)}))}_y(aR,Bz,{initialize:function(e,t,n,r,i,o){return this._options=o||{},this._canvas=this._options.externalContext?null:AD(1,1,this._options.type),e&&this._canvas&&(Tz(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),sR.initialize.call(this,e,t,n,r,i)},resize:function(e,t,n,r){if(sR.resize.call(this,e,t,n,r),this._canvas)!function(e,t,n,r,i,o){const a="undefined"!=typeof HTMLElement&&e instanceof HTMLElement&&null!=e.parentNode,s=e.getContext("2d"),u=a?oR:i;e.width=t*u,e.height=n*u;for(const e in o)s[e]=o[e];a&&1!==u&&(e.style.width=t+"px",e.style.height=n+"px"),s.pixelRatio=u,s.setTransform(u,0,0,u,u*r[0],u*r[1])}(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const e=this._options.externalContext;e||_g("CanvasRenderer is missing a valid canvas or context"),e.scale(this._scale,this._scale),e.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas:function(){return this._canvas},context:function(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty:function(e){const t=this._tempb.clear().union(e.bounds);let n=e.mark.group;for(;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render:function(e){const t=this.context(),n=this._origin,r=this._width,i=this._height,o=this._dirty,a=(s=n,u=r,l=i,(new C$).set(0,0,u,l).translate(-s[0],-s[1]));var s,u,l;t.save();const c=this._redraw||o.empty()?(this._redraw=!1,a.expand(1)):function(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-n[0]%1,-n[1]%1),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}(t,a.intersect(o),n);return this.clear(-n[0],-n[1],r,i),this.draw(t,e,c),t.restore(),o.clear(),this},draw:function(e,t,n){const r=wz[t.marktype];t.clip&&function(e,t){var n=t.clip;e.save(),ay(n)?(e.beginPath(),n(e),e.clip()):OT(e,t.group)}(e,t),r.draw.call(this,e,t,n),t.clip&&e.restore()},clear:function(e,t,n,r){const i=this._options,o=this.context();"pdf"===i.type||i.externalContext||o.clearRect(e,t,n,r),null!=this._bgcolor&&(o.fillStyle=this._bgcolor,o.fillRect(e,t,n,r))}});const lR=(e,t)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,t.call(e._obj,n,r)};_y(uR,Pz,{initialize:function(e,t,n){let r=this._svg;return r&&(r.removeEventListener(eR,this._hrefHandler),r.removeEventListener(Kz,this._tooltipHandler),r.removeEventListener(Zz,this._tooltipHandler)),this._svg=r=e&&Oz(e,"svg"),r&&(r.addEventListener(eR,this._hrefHandler),r.addEventListener(Kz,this._tooltipHandler),r.addEventListener(Zz,this._tooltipHandler)),Pz.prototype.initialize.call(this,e,t,n)},canvas:function(){return this._svg},on:function(e,t){const n=this.eventName(e),r=this._handlers;if(this._handlerIndex(r[n],e,t)<0){const i={type:e,handler:t,listener:lR(this,t)};(r[n]||(r[n]=[])).push(i),this._svg&&this._svg.addEventListener(n,i.listener)}return this},off:function(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}});const cR="aria-hidden",fR="aria-label",dR="role",hR="aria-roledescription",pR="graphics-object",mR="graphics-symbol",gR=(e,t,n)=>({[dR]:e,[hR]:t,[fR]:n||void 0}),yR=Uy(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),vR={axis:{desc:"axis",caption:function(e){const t=e.datum,n=e.orient,r=t.title?kR(e):null,i=e.context,o=i.scales[t.scale].value,a=i.dataflow.locale(),s=o.type;return("left"===n||"right"===n?"Y":"X")+"-axis"+(r?` titled '${r}'`:"")+` for a ${YN(s)?"discrete":s} scale`+` with ${DO(a,o,e)}`}},legend:{desc:"legend",caption:function(e){const t=e.datum,n=t.title?kR(e):null,r=`${t.type||""} legend`.trim(),i=t.scales,o=Object.keys(i),a=e.context,s=a.scales[i[o[0]]].value,u=a.dataflow.locale();return l=r,(l.length?l[0].toUpperCase()+l.slice(1):l)+(n?` titled '${n}'`:"")+` for ${function(e){return(e=e.map((e=>e+("fill"===e||"stroke"===e?" color":"")))).length<2?e[0]:e.slice(0,-1).join(", ")+" and "+Bg(e)}(o)}`+` with ${DO(u,s,e)}`;var l}},"title-text":{desc:"title",caption:e=>`Title text '${_R(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${_R(e)}'`}},bR={ariaRole:dR,ariaRoleDescription:hR,description:fR};function xR(e,t){const n=!1===t.aria;if(e(cR,n||void 0),n||null==t.description)for(const t in bR)e(bR[t],void 0);else{const n=t.mark.marktype;e(fR,t.description),e(dR,t.ariaRole||("group"===n?pR:mR)),e(hR,t.ariaRoleDescription||`${n} mark`)}}function wR(e){return!1===e.aria?{[cR]:!0}:yR[e.role]?null:vR[e.role]?function(e,t){try{const n=e.items[0],r=t.caption||(()=>"");return gR(t.role||mR,t.desc,n.description||r(n))}catch(e){return null}}(e,vR[e.role]):function(e){const t=e.marktype,n="group"===t||"text"===t||e.items.some((e=>null!=e.description&&!1!==e.aria));return gR(n?pR:mR,`${t} mark container`,e.description)}(e)}function _R(e){return iy(e.text).join(" ")}function kR(e){try{return iy(Bg(e.items).items[0].text).join(" ")}catch(e){return null}}const ER=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");function SR(){let e="",t="",n="";const r=[],i=()=>t=n="",o=(e,n)=>{var r;return null!=n&&(t+=` ${e}="${r=n,ER(r).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;")}"`),a},a={open:function(s,...u){(o=>{t&&(e+=`${t}>${n}`,i()),r.push(o)})(s),t="<"+s;for(const e of u)for(const t in e)o(t,e[t]);return a},close:function(){const o=r.pop();return e+=t?t+(n?`>${n}</${o}>`:"/>"):`</${o}>`,i(),a},attr:o,text:e=>(n+=ER(e),a),toString:()=>e};return a}const AR=e=>CR(SR(),e)+"";function CR(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,r=n.length;for(let t=0;t<r;++t)e.attr(n[t].name,n[t].value)}if(t.hasChildNodes()){const n=t.childNodes,r=n.length;for(let t=0;t<r;t++){const r=n[t];3===r.nodeType?e.text(r.nodeValue):CR(e,r)}}return e.close()}const DR={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},MR={fill:"none","stroke-miterlimit":10},FR="http://www.w3.org/2000/xmlns/",NR=IT.xmlns;function OR(e){Bz.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const $R=Bz.prototype;function TR(e,t){for(;e&&e.dirty!==t;e=e.mark.group){if(e.dirty=t,!e.mark||e.mark.dirty===t)return;e.mark.dirty=t}}function zR(e,t,n){let r,i,o;if("radial"===t.gradient){let r=$z(e,n++,"pattern",NR);qR(r,{id:FO+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),r=$z(r,0,"rect",NR),qR(r,{width:1,height:1,fill:`url(${HR()}#${t.id})`}),qR(e=$z(e,n++,"radialGradient",NR),{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else qR(e=$z(e,n++,"linearGradient",NR),{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(r=0,i=t.stops.length;r<i;++r)o=$z(e,r,"stop",NR),o.setAttribute("offset",t.stops[r].offset),o.setAttribute("stop-color",t.stops[r].color);return Tz(e,r),n}function RR(e,t,n){let r;return(e=$z(e,n,"clipPath",NR)).setAttribute("id",t.id),t.path?(r=$z(e,0,"path",NR),r.setAttribute("d",t.path)):(r=$z(e,0,"rect",NR),qR(r,{x:0,y:0,width:t.width,height:t.height})),Tz(e,1),n+1}function PR(e,t,n,r,i){let o,a=e._svg;if(!a&&(o=t.ownerDocument,a=Nz(o,r,NR),e._svg=a,e.mark&&(a.__data__=e,a.__values__={fill:"default"},"g"===r))){const t=Nz(o,"path",NR);a.appendChild(t),t.__data__=e;const n=Nz(o,"g",NR);a.appendChild(n),n.__data__=e;const r=Nz(o,"path",NR);a.appendChild(r),r.__data__=e,r.__values__={fill:"default"}}return(a.ownerSVGElement!==i||function(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}(a,n))&&t.insertBefore(a,n?n.nextSibling:t.firstChild),a}_y(OR,Bz,{initialize:function(e,t,n,r,i){return this._defs={},this._clearDefs(),e&&(this._svg=$z(e,0,"svg",NR),this._svg.setAttributeNS(FR,"xmlns",NR),this._svg.setAttributeNS(FR,"xmlns:xlink",IT["xmlns:xlink"]),this._svg.setAttribute("version",IT.version),this._svg.setAttribute("class","marks"),Tz(e,1),this._root=$z(this._svg,0,"g",NR),qR(this._root,MR),Tz(this._svg,1)),this.background(this._bgcolor),$R.initialize.call(this,e,t,n,r,i)},background:function(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),$R.background.apply(this,arguments)},resize:function(e,t,n,r){return $R.resize.call(this,e,t,n,r),this._svg&&(qR(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this},canvas:function(){return this._svg},svg:function(){const e=this._svg,t=this._bgcolor;if(!e)return null;let n;t&&(e.removeAttribute("style"),n=$z(e,0,"rect",NR),qR(n,{width:this._width,height:this._height,fill:t}));const r=AR(e);return t&&(e.removeChild(n),this._svg.style.setProperty("background-color",t)),r},_render:function(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),Tz(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty:function(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty:function(e){return this._dirtyAll||!e._svg||e.dirty===this._dirtyID},_dirtyCheck:function(){this._dirtyAll=!0;const e=this._dirty;if(!e.length||!this._dirtyID)return!0;const t=++this._dirtyID;let n,r,i,o,a,s,u;for(a=0,s=e.length;a<s;++a)n=e[a],r=n.mark,r.marktype!==i&&(i=r.marktype,o=wz[i]),r.zdirty&&r.dirty!==t&&(this._dirtyAll=!1,TR(n,t),r.items.forEach((e=>{e.dirty=t}))),r.zdirty||(n.exit?(o.nested&&r.items.length?(u=r.items[0],u._svg&&this._update(o,u._svg,u)):n._svg&&(u=n._svg.parentNode,u&&u.removeChild(n._svg)),n._svg=null):(n=o.nested?r.items[0]:n,n._update!==t&&(n._svg&&n._svg.ownerSVGElement?this._update(o,n._svg,n):(this._dirtyAll=!1,TR(n,t)),n._update=t)));return!this._dirtyAll},mark:function(e,t,n){if(!this.isDirty(t))return t._svg;const r=this._svg,i=wz[t.marktype],o=!1===t.interactive?"none":null,a="g"===i.tag;let s=null,u=0;const l=PR(t,e,n,"g",r);l.setAttribute("class",zz(t));const c=wR(t);for(const e in c)WR(l,e,c[e]);a||WR(l,"pointer-events",o),WR(l,"clip-path",t.clip?A$(this,t,t.group):null);const f=e=>{const t=this.isDirty(e),n=PR(e,l,s,i.tag,r);t&&(this._update(i,n,e),a&&function(e,t,n){t=t.lastChild.previousSibling;let r,i=0;vT(n,(n=>{r=e.mark(t,n,r),++i})),Tz(t,1+i)}(this,n,e)),s=n,++u};return i.nested?t.items.length&&f(t.items[0]):vT(t,f),Tz(l,u),l},_update:function(e,t,n){LR=t,BR=t.__values__,xR(jR,n),e.attr(jR,n,this);const r=IR[e.type];r&&r.call(this,e,t,n),LR&&this.style(LR,n)},style:function(e,t){if(null!=t)for(const n in DR){let r="font"===n?pz(t):t[n];if(r===BR[n])continue;const i=DR[n];null==r?e.removeAttribute(i):(NO(r)&&(r=OO(r,this._defs.gradient,HR())),e.setAttribute(i,r+"")),BR[n]=r}},defs:function(){const e=this._svg,t=this._defs;let n=t.el,r=0;for(const i in t.gradient)n||(t.el=n=$z(e,1,"defs",NR)),r=zR(n,t.gradient[i],r);for(const i in t.clipping)n||(t.el=n=$z(e,1,"defs",NR)),r=RR(n,t.clipping[i],r);n&&(0===r?(e.removeChild(n),t.el=null):Tz(n,r))},_clearDefs:function(){const e=this._defs;e.gradient={},e.clipping={}}});let LR=null,BR=null;const IR={group:function(e,t,n){const r=LR=t.childNodes[2];BR=r.__values__,e.foreground(jR,n,this),BR=t.__values__,LR=t.childNodes[1],e.content(jR,n,this);const i=LR=t.childNodes[0];e.background(jR,n,this);const o=!1===n.mark.interactive?"none":null;if(o!==BR.events&&(WR(r,"pointer-events",o),WR(i,"pointer-events",o),BR.events=o),n.strokeForeground&&n.stroke){const e=n.fill;WR(r,"display",null),this.style(i,n),WR(i,"stroke",null),e&&(n.fill=null),BR=r.__values__,this.style(r,n),e&&(n.fill=e),LR=null}else WR(r,"display","none")},image:function(e,t,n){!1===n.smooth?(UR(t,"image-rendering","optimizeSpeed"),UR(t,"image-rendering","pixelated")):UR(t,"image-rendering",null)},text:function(e,t,n){const r=fz(n);let i,o,a,s;$g(r)?(o=r.map((e=>hz(n,e))),i=o.join("\n"),i!==BR.text&&(Tz(t,0),a=t.ownerDocument,s=cz(n),o.forEach(((e,r)=>{const i=Nz(a,"tspan",NR);i.__data__=n,i.textContent=e,r&&(i.setAttribute("x",0),i.setAttribute("dy",s)),t.appendChild(i)})),BR.text=i)):(o=hz(n,r),o!==BR.text&&(t.textContent=o,BR.text=o)),WR(t,"font-family",pz(n)),WR(t,"font-size",lz(n)+"px"),WR(t,"font-style",n.fontStyle),WR(t,"font-variant",n.fontVariant),WR(t,"font-weight",n.fontWeight)}};function jR(e,t,n){t!==BR[e]&&(n?function(e,t,n,r){null!=n?e.setAttributeNS(r,t,n):e.removeAttributeNS(r,t)}(LR,e,t,n):WR(LR,e,t),BR[e]=t)}function UR(e,t,n){n!==BR[t]&&(null==n?e.style.removeProperty(t):e.style.setProperty(t,n+""),BR[t]=n)}function qR(e,t){for(const n in t)WR(e,n,t[n])}function WR(e,t,n){null!=n?e.setAttribute(t,n):e.removeAttribute(t)}function HR(){let e;return"undefined"==typeof window?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function VR(e){Bz.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}_y(VR,Bz,{svg:function(){return this._text},_render:function(e){const t=SR();t.open("svg",py({},IT,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const n=this._bgcolor;return n&&"transparent"!==n&&"none"!==n&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",MR,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark:function(e,t){const n=wz[t.marktype],r=n.tag,i=[xR,n.attr];e.open("g",{class:zz(t),"clip-path":t.clip?A$(this,t,t.group):null},wR(t),{"pointer-events":"g"!==r&&!1===t.interactive?"none":null});const o=o=>{const a=this.href(o);if(a&&e.open("a",a),e.open(r,this.attr(t,o,i,"g"!==r?r:null)),"text"===r){const t=fz(o);if($g(t)){const n={x:0,dy:cz(o)};for(let r=0;r<t.length;++r)e.open("tspan",r?n:null).text(hz(o,t[r])).close()}else e.text(hz(o,t))}else if("g"===r){const r=o.strokeForeground,i=o.fill,a=o.stroke;r&&a&&(o.stroke=null),e.open("path",this.attr(t,o,n.background,"bgrect")).close(),e.open("g",this.attr(t,o,n.content)),vT(o,(t=>this.mark(e,t))),e.close(),r&&a?(i&&(o.fill=null),o.stroke=a,e.open("path",this.attr(t,o,n.foreground,"bgrect")).close(),i&&(o.fill=i)):e.open("path",this.attr(t,o,n.foreground,"bgfore")).close()}e.close(),a&&e.close()};return n.nested?t.items&&t.items.length&&o(t.items[0]):vT(t,o),e.close()},href:function(e){const t=e.href;let n;if(t){if(n=this._hrefs&&this._hrefs[t])return n;this.sanitizeURL(t).then((e=>{e["xlink:href"]=e.href,e.href=null,(this._hrefs||(this._hrefs={}))[t]=e}))}return null},attr:function(e,t,n,r){const i={},o=(e,t,n,r)=>{i[r||e]=t};return Array.isArray(n)?n.forEach((e=>e(o,t,this))):n(o,t,this),r&&function(e,t,n,r,i){if(null==t)return e;"bgrect"===r&&!1===n.interactive&&(e["pointer-events"]="none");if("bgfore"===r&&(!1===n.interactive&&(e["pointer-events"]="none"),e.display="none",null!==t.fill))return e;"image"===r&&!1===t.smooth&&(e.style="image-rendering: optimizeSpeed; image-rendering: pixelated;");"text"===r&&(e["font-family"]=pz(t),e["font-size"]=lz(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const n in DR){let r=t[n];const o=DR[n];("transparent"!==r||"fill"!==o&&"stroke"!==o)&&null!=r&&(NO(r)&&(r=OO(r,i.gradient,"")),e[o]=r)}}(i,t,e,r,this._defs),i},defs:function(e){const t=this._defs.gradient,n=this._defs.clipping;if(0!==Object.keys(t).length+Object.keys(n).length){e.open("defs");for(const n in t){const r=t[n],i=r.stops;"radial"===r.gradient?(e.open("pattern",{id:FO+n,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+n+")"}).close(),e.close(),e.open("radialGradient",{id:n,fx:r.x1,fy:r.y1,fr:r.r1,cx:r.x2,cy:r.y2,r:r.r2})):e.open("linearGradient",{id:n,x1:r.x1,x2:r.x2,y1:r.y1,y2:r.y2});for(let t=0;t<i.length;++t)e.open("stop",{offset:i[t].offset,"stop-color":i[t].color}).close();e.close()}for(const t in n){const r=n[t];e.open("clipPath",{id:t}),r.path?e.open("path",{d:r.path}).close():e.open("rect",{x:0,y:0,width:r.width,height:r.height}).close(),e.close()}e.close()}}});const GR="canvas",YR="none",XR={Canvas:GR,PNG:"png",SVG:"svg",None:YR},QR={};function JR(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(QR[e]=t,this):QR[e]}function KR(e,t,n){const r=[],i=(new C$).union(t),o=e.marktype;return o?ZR(e,i,n,r):"group"===o?eP(e,i,n,r):_g("Intersect scene must be mark node or group item.")}function ZR(e,t,n,r){if(function(e,t,n){return e.bounds&&t.intersects(e.bounds)&&("group"===e.marktype||!1!==e.interactive&&(!n||n(e)))}(e,t,n)){const i=e.items,o=e.marktype,a=i.length;let s=0;if("group"===o)for(;s<a;++s)eP(i[s],t,n,r);else for(const e=wz[o].isect;s<a;++s){const n=i[s];tP(n,t,e)&&r.push(n)}}return r}function eP(e,t,n,r){n&&n(e.mark)&&tP(e,t,wz.group.isect)&&r.push(e);const i=e.items,o=i&&i.length;if(o){const a=e.x||0,s=e.y||0;t.translate(-a,-s);for(let e=0;e<o;++e)ZR(i[e],t,n,r);t.translate(a,s)}return r}function tP(e,t,n){const r=e.bounds;return t.encloses(r)||t.intersects(r)&&n(e,t)}QR.canvas=QR.png={renderer:aR,headless:aR,handler:tR},QR.svg={renderer:OR,headless:VR,handler:uR},QR.none={};const nP=new C$;function rP(e){const t=e.clip;if(ay(t))t(J$(nP.clear()));else{if(!t)return;nP.set(0,0,e.group.width,e.group.height)}e.bounds.intersect(nP)}function iP(e,t,n){return e===t||("path"===n?oP(e,t):e instanceof Date&&t instanceof Date?+e==+t:Cy(e)&&Cy(t)?Math.abs(e-t)<=1e-9:e&&t&&(Tg(e)||Tg(t))?function(e,t){var n,r,i=Object.keys(e),o=Object.keys(t);if(i.length!==o.length)return!1;for(i.sort(),o.sort(),r=i.length-1;r>=0;r--)if(i[r]!=o[r])return!1;for(r=i.length-1;r>=0;r--)if(!iP(e[n=i[r]],t[n],n))return!1;return typeof e==typeof t}(e,t):e==t)}function oP(e,t){return iP(BO(e),BO(t))}function aP(){S$(),MO=0}t(fC,"textMetrics",(function(){return rz})),t(fC,"serializeXML",(function(){return AR})),t(fC,"sceneZOrder",(function(){return yT})),t(fC,"sceneVisit",(function(){return vT})),t(fC,"sceneToJSON",(function(){return Az})),t(fC,"scenePickVisit",(function(){return bT})),t(fC,"sceneFromJSON",(function(){return Cz})),t(fC,"sceneEqual",(function(){return iP})),t(fC,"resetSVGDefIds",(function(){return aP})),t(fC,"resetSVGClipId",(function(){return S$})),t(fC,"renderModule",(function(){return JR})),t(fC,"point",(function(){return Rz})),t(fC,"pathTrail",(function(){return c$})),t(fC,"pathSymbols",(function(){return e$})),t(fC,"pathRender",(function(){return QO})),t(fC,"pathRectangle",(function(){return l$})),t(fC,"pathParse",(function(){return BO})),t(fC,"pathEqual",(function(){return oP})),t(fC,"pathCurves",(function(){return RO})),t(fC,"multiLineOffset",(function(){return dz})),t(fC,"markup",(function(){return SR})),t(fC,"lineHeight",(function(){return cz})),t(fC,"intersectRule",(function(){return sT})),t(fC,"intersectPoint",(function(){return oT})),t(fC,"intersectPath",(function(){return iT})),t(fC,"intersectBoxLine",(function(){return uT})),t(fC,"intersect",(function(){return KR})),t(fC,"fontSize",(function(){return lz})),t(fC,"fontFamily",(function(){return pz})),t(fC,"font",(function(){return mz})),t(fC,"domFind",(function(){return Oz})),t(fC,"domCreate",(function(){return Nz})),t(fC,"domClear",(function(){return Tz})),t(fC,"domChild",(function(){return $z})),t(fC,"boundStroke",(function(){return $$})),t(fC,"boundMark",(function(){return Ez})),t(fC,"boundItem",(function(){return _z})),t(fC,"boundContext",(function(){return J$})),t(fC,"boundClip",(function(){return rP})),t(fC,"Scenegraph",(function(){return Mz})),t(fC,"SVGStringRenderer",(function(){return VR})),t(fC,"SVGRenderer",(function(){return OR})),t(fC,"SVGHandler",(function(){return uR})),t(fC,"ResourceLoader",(function(){return F$})),t(fC,"Renderer",(function(){return Bz})),t(fC,"RenderType",(function(){return XR})),t(fC,"Marks",(function(){return wz})),t(fC,"Item",(function(){return D$})),t(fC,"Handler",(function(){return Pz})),t(fC,"GroupItem",(function(){return M$})),t(fC,"Gradient",(function(){return TO})),t(fC,"CanvasRenderer",(function(){return aR})),t(fC,"CanvasHandler",(function(){return tR})),t(fC,"Bounds",(function(){return C$}));const sP="top",uP="left",lP="right",cP="bottom",fP="start",dP="middle",hP="end",pP="group",mP="axis",gP="title",yP="frame",vP="scope",bP="legend",xP="row-header",wP="row-footer",_P="row-title",kP="column-header",EP="column-footer",SP="column-title",AP="padding",CP="fit",DP="fit-x",MP="fit-y",FP="none",NP="all",OP="each",$P="flush",TP="column",zP="row";function RP(e){LE.call(this,null,e)}function PP(e,t,n){return t(e.bounds.clear(),e,n)}_y(RP,LE,{transform:function(e,t){const n=t.dataflow,r=e.mark,i=r.marktype,o=wz[i],a=o.bound;let s,u=r.bounds;if(o.nested)r.items.length&&n.dirty(r.items[0]),u=PP(r,a),r.items.forEach((e=>{e.bounds.clear().union(u)}));else if(i===pP||e.modified())switch(t.visit(t.MOD,(e=>n.dirty(e))),u.clear(),r.items.forEach((e=>u.union(PP(e,a)))),r.role){case mP:case bP:case gP:t.reflow()}else s=t.changed(t.REM),t.visit(t.ADD,(e=>{u.union(PP(e,a))})),t.visit(t.MOD,(e=>{s=s||u.alignsWith(e.bounds),n.dirty(e),u.union(PP(e,a))})),s&&(u.clear(),r.items.forEach((e=>u.union(e.bounds))));return rP(r),t.modifies("bounds")}});function LP(e){LE.call(this,0,e)}function BP(e){LE.call(this,null,e)}function IP(e){LE.call(this,null,e)}LP.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]},_y(LP,LE,{transform:function(e,t){const n=(i=t.dataflow)._signals[":vega_identifier:"]||(i._signals[":vega_identifier:"]=i.add(0)),r=e.as;var i;let o=n.value;return t.visit(t.ADD,(e=>e[r]=e[r]||++o)),n.set(this.value=o),t}}),_y(BP,LE,{transform:function(e,t){let n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,function(e){const t=e.groups,n=e.parent;return t&&1===t.size?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}(e),e.index),n.group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);const r=n.marktype===pP?M$:D$;return t.visit(t.ADD,(e=>r.call(e,n))),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});const jP={parity:e=>e.filter(((e,t)=>t%2?e.opacity=0:1)),greedy:(e,t)=>{let n;return e.filter(((e,r)=>r&&UP(n.bounds,e.bounds,t)?e.opacity=0:(n=e,1)))}},UP=(e,t,n)=>n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2),qP=(e,t)=>{for(var n,r=1,i=e.length,o=e[0].bounds;r<i;o=n,++r)if(UP(o,n=e[r].bounds,t))return!0},WP=e=>{const t=e.bounds;return t.width()>1&&t.height()>1},HP=e=>(e.forEach((e=>e.opacity=1)),e),VP=(e,t)=>e.reflow(t.modified()).modifies("opacity");function GP(e){LE.call(this,null,e)}_y(IP,LE,{transform:function(e,t){const n=jP[e.method]||jP.parity,r=e.separation||0;let i,o,a=t.materialize(t.SOURCE).source;if(!a||!a.length)return;if(!e.method)return e.modified("method")&&(HP(a),t=VP(t,e)),t;if(a=a.filter(WP),!a.length)return;if(e.sort&&(a=a.slice().sort(e.sort)),i=HP(a),t=VP(t,e),i.length>=3&&qP(i,r)){do{i=n(i,r)}while(i.length>=3&&qP(i,r));i.length<3&&!Bg(a).opacity&&(i.length>1&&(Bg(i).opacity=0),Bg(a).opacity=1)}var s,u,l,c,f;e.boundScale&&e.boundTolerance>=0&&(s=e.boundScale,u=e.boundOrient,l=+e.boundTolerance,c=s.range(),f=new C$,u===sP||u===cP?f.set(c[0],-1/0,c[1],1/0):f.set(-1/0,c[0],1/0,c[1]),f.expand(l||1),o=e=>f.encloses(e.bounds),a.forEach((e=>{o(e)||(e.opacity=0)})));const d=i[0].mark.bounds.clear();return a.forEach((e=>{e.opacity&&d.union(e.bounds)})),t}}),_y(GP,LE,{transform:function(e,t){const n=t.dataflow;if(t.visit(t.ALL,(e=>n.dirty(e))),t.fields&&t.fields.zindex){const e=t.source&&t.source[0];e&&(e.mark.zdirty=!0)}}});const YP=new C$;function XP(e,t,n){return e[t]===n?0:(e[t]=n,1)}function QP(e){var t=e.items[0].orient;return t===uP||t===lP}function JP(e,t,n,r){var i,o,a=t.items[0],s=a.datum,u=null!=a.translate?a.translate:.5,l=a.orient,c=function(e){let t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}(s),f=a.range,d=a.offset,h=a.position,p=a.minExtent,m=a.maxExtent,g=s.title&&a.items[c[2]].items[0],y=a.titlePadding,v=a.bounds,b=g&&dz(g),x=0,w=0;switch(YP.clear().union(v),v.clear(),(i=c[0])>-1&&v.union(a.items[i].bounds),(i=c[1])>-1&&v.union(a.items[i].bounds),l){case sP:x=h||0,w=-d,o=Math.max(p,Math.min(m,-v.y1)),v.add(0,-o).add(f,0),g&&KP(e,g,o,y,b,0,-1,v);break;case uP:x=-d,w=h||0,o=Math.max(p,Math.min(m,-v.x1)),v.add(-o,0).add(0,f),g&&KP(e,g,o,y,b,1,-1,v);break;case lP:x=n+d,w=h||0,o=Math.max(p,Math.min(m,v.x2)),v.add(0,0).add(o,f),g&&KP(e,g,o,y,b,1,1,v);break;case cP:x=h||0,w=r+d,o=Math.max(p,Math.min(m,v.y2)),v.add(0,0).add(f,o),g&&KP(e,g,o,y,0,0,1,v);break;default:x=a.x,w=a.y}return $$(v.translate(x,w),a),XP(a,"x",x+u)|XP(a,"y",w+u)&&(a.bounds=YP,e.dirty(a),a.bounds=v,e.dirty(a)),a.mark.bounds.clear().union(v)}function KP(e,t,n,r,i,o,a,s){const u=t.bounds;if(t.auto){const s=a*(n+i+r);let l=0,c=0;e.dirty(t),o?l=(t.x||0)-(t.x=s):c=(t.y||0)-(t.y=s),t.mark.bounds.clear().union(u.translate(-l,-c)),e.dirty(t)}s.union(u)}const ZP=(e,t)=>Math.floor(Math.min(e,t)),eL=(e,t)=>Math.ceil(Math.max(e,t));function tL(e){return(new C$).set(0,0,e.width||0,e.height||0)}function nL(e){const t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function rL(e,t,n){const r=Tg(e)?e[t]:e;return null!=r?r:void 0!==n?n:0}function iL(e){return e<0?Math.ceil(-e):0}function oL(e,t,n){var r,i,o,a,s,u,l,c,f,d,h,p=!n.nodirty,m=n.bounds===$P?tL:nL,g=YP.set(0,0,0,0),y=rL(n.align,TP),v=rL(n.align,zP),b=rL(n.padding,TP),x=rL(n.padding,zP),w=n.columns||t.length,_=w<=0?1:Math.ceil(t.length/w),k=t.length,E=Array(k),S=Array(w),A=0,C=Array(k),D=Array(_),M=0,F=Array(k),N=Array(k),O=Array(k);for(i=0;i<w;++i)S[i]=0;for(i=0;i<_;++i)D[i]=0;for(i=0;i<k;++i)u=t[i],s=O[i]=m(u),u.x=u.x||0,F[i]=0,u.y=u.y||0,N[i]=0,o=i%w,a=~~(i/w),A=Math.max(A,l=Math.ceil(s.x2)),M=Math.max(M,c=Math.ceil(s.y2)),S[o]=Math.max(S[o],l),D[a]=Math.max(D[a],c),E[i]=b+iL(s.x1),C[i]=x+iL(s.y1),p&&e.dirty(t[i]);for(i=0;i<k;++i)i%w==0&&(E[i]=0),i<w&&(C[i]=0);if(y===OP)for(o=1;o<w;++o){for(h=0,i=o;i<k;i+=w)h<E[i]&&(h=E[i]);for(i=o;i<k;i+=w)E[i]=h+S[o-1]}else if(y===NP){for(h=0,i=0;i<k;++i)i%w&&h<E[i]&&(h=E[i]);for(i=0;i<k;++i)i%w&&(E[i]=h+A)}else for(y=!1,o=1;o<w;++o)for(i=o;i<k;i+=w)E[i]+=S[o-1];if(v===OP)for(a=1;a<_;++a){for(h=0,r=(i=a*w)+w;i<r;++i)h<C[i]&&(h=C[i]);for(i=a*w;i<r;++i)C[i]=h+D[a-1]}else if(v===NP){for(h=0,i=w;i<k;++i)h<C[i]&&(h=C[i]);for(i=w;i<k;++i)C[i]=h+M}else for(v=!1,a=1;a<_;++a)for(r=(i=a*w)+w;i<r;++i)C[i]+=D[a-1];for(f=0,i=0;i<k;++i)f=E[i]+(i%w?f:0),F[i]+=f-t[i].x;for(o=0;o<w;++o)for(d=0,i=o;i<k;i+=w)d+=C[i],N[i]+=d-t[i].y;if(y&&rL(n.center,TP)&&_>1)for(i=0;i<k;++i)(f=(s=y===NP?A:S[i%w])-O[i].x2-t[i].x-F[i])>0&&(F[i]+=f/2);if(v&&rL(n.center,zP)&&1!==w)for(i=0;i<k;++i)(d=(s=v===NP?M:D[~~(i/w)])-O[i].y2-t[i].y-N[i])>0&&(N[i]+=d/2);for(i=0;i<k;++i)g.union(O[i].translate(F[i],N[i]));switch(f=rL(n.anchor,"x"),d=rL(n.anchor,"y"),rL(n.anchor,TP)){case hP:f-=g.width();break;case dP:f-=g.width()/2}switch(rL(n.anchor,zP)){case hP:d-=g.height();break;case dP:d-=g.height()/2}for(f=Math.round(f),d=Math.round(d),g.clear(),i=0;i<k;++i)t[i].mark.bounds.clear();for(i=0;i<k;++i)(u=t[i]).x+=F[i]+=f,u.y+=N[i]+=d,g.union(u.mark.bounds.union(u.bounds.translate(F[i],N[i]))),p&&e.dirty(u);return g}function aL(e,t,n){var r,i,o,a,s,u,l,c=function(e){var t,n,r=e.items,i=r.length,o=0;const a={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;o<i;++o)if(n=(t=r[o]).items,t.marktype===pP)switch(t.role){case mP:case bP:case gP:break;case xP:a.rowheaders.push(...n);break;case wP:a.rowfooters.push(...n);break;case kP:a.colheaders.push(...n);break;case EP:a.colfooters.push(...n);break;case _P:a.rowtitle=n[0];break;case SP:a.coltitle=n[0];break;default:a.marks.push(...n)}return a}(t),f=c.marks,d=n.bounds===$P?sL:uL,h=n.offset,p=n.columns||f.length,m=p<=0?1:Math.ceil(f.length/p),g=m*p;const y=oL(e,f,n);y.empty()&&y.set(0,0,0,0),c.rowheaders&&(u=rL(n.headerBand,zP,null),r=lL(e,c.rowheaders,f,p,m,-rL(h,"rowHeader"),ZP,0,d,"x1",0,p,1,u)),c.colheaders&&(u=rL(n.headerBand,TP,null),i=lL(e,c.colheaders,f,p,p,-rL(h,"columnHeader"),ZP,1,d,"y1",0,1,p,u)),c.rowfooters&&(u=rL(n.footerBand,zP,null),o=lL(e,c.rowfooters,f,p,m,rL(h,"rowFooter"),eL,0,d,"x2",p-1,p,1,u)),c.colfooters&&(u=rL(n.footerBand,TP,null),a=lL(e,c.colfooters,f,p,p,rL(h,"columnFooter"),eL,1,d,"y2",g-p,1,p,u)),c.rowtitle&&(s=rL(n.titleAnchor,zP),l=rL(h,"rowTitle"),l=s===hP?o+l:r-l,u=rL(n.titleBand,zP,.5),cL(e,c.rowtitle,l,0,y,u)),c.coltitle&&(s=rL(n.titleAnchor,TP),l=rL(h,"columnTitle"),l=s===hP?a+l:i-l,u=rL(n.titleBand,TP,.5),cL(e,c.coltitle,l,1,y,u))}function sL(e,t){return"x1"===t?e.x||0:"y1"===t?e.y||0:"x2"===t?(e.x||0)+(e.width||0):"y2"===t?(e.y||0)+(e.height||0):void 0}function uL(e,t){return e.bounds[t]}function lL(e,t,n,r,i,o,a,s,u,l,c,f,d,h){var p,m,g,y,v,b,x,w,_,k=n.length,E=0,S=0;if(!k)return E;for(p=c;p<k;p+=f)n[p]&&(E=a(E,u(n[p],l)));if(!t.length)return E;for(t.length>i&&(e.warn("Grid headers exceed limit: "+i),t=t.slice(0,i)),E+=o,m=0,y=t.length;m<y;++m)e.dirty(t[m]),t[m].mark.bounds.clear();for(p=c,m=0,y=t.length;m<y;++m,p+=f){for(v=(b=t[m]).mark.bounds,g=p;g>=0&&null==(x=n[g]);g-=d);s?(w=null==h?x.x:Math.round(x.bounds.x1+h*x.bounds.width()),_=E):(w=E,_=null==h?x.y:Math.round(x.bounds.y1+h*x.bounds.height())),v.union(b.bounds.translate(w-(b.x||0),_-(b.y||0))),b.x=w,b.y=_,e.dirty(b),S=a(S,v[l])}return S}function cL(e,t,n,r,i,o){if(t){e.dirty(t);var a=n,s=n;r?a=Math.round(i.x1+o*i.width()):s=Math.round(i.y1+o*i.height()),t.bounds.translate(a-(t.x||0),s-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=a,t.y=s,e.dirty(t)}}function fL(e,t,n,r,i,o,a){const s=function(e,t){const n=e[t]||{};return(t,r)=>null!=n[t]?n[t]:null!=e[t]?e[t]:r}(n,t),u=function(e,t){let n=-1/0;return e.forEach((e=>{null!=e.offset&&(n=Math.max(n,e.offset))})),n>-1/0?n:t}(e,s("offset",0)),l=s("anchor",fP),c=l===hP?1:l===dP?.5:0,f={align:OP,bounds:s("bounds",$P),columns:"vertical"===s("direction")?1:e.length,padding:s("margin",8),center:s("center"),nodirty:!0};switch(t){case uP:f.anchor={x:Math.floor(r.x1)-u,column:hP,y:c*(a||r.height()+2*r.y1),row:l};break;case lP:f.anchor={x:Math.ceil(r.x2)+u,y:c*(a||r.height()+2*r.y1),row:l};break;case sP:f.anchor={y:Math.floor(i.y1)-u,row:hP,x:c*(o||i.width()+2*i.x1),column:l};break;case cP:f.anchor={y:Math.ceil(i.y2)+u,x:c*(o||i.width()+2*i.x1),column:l};break;case"top-left":f.anchor={x:u,y:u};break;case"top-right":f.anchor={x:o-u,y:u,column:hP};break;case"bottom-left":f.anchor={x:u,y:a-u,row:hP};break;case"bottom-right":f.anchor={x:o-u,y:a-u,column:hP,row:hP}}return f}function dL(e,t){var n,r,i=t.items[0],o=i.datum,a=i.orient,s=i.bounds,u=i.x,l=i.y;return i._bounds?i._bounds.clear().union(s):i._bounds=s.clone(),s.clear(),function(e,t,n){var r=t.padding,i=r-n.x,o=r-n.y;if(t.datum.title){var a=t.items[1].items[0],s=a.anchor,u=t.titlePadding||0,l=r-a.x,c=r-a.y;switch(a.orient){case uP:i+=Math.ceil(a.bounds.width())+u;break;case lP:case cP:break;default:o+=a.bounds.height()+u}switch((i||o)&&pL(e,n,i,o),a.orient){case uP:c+=hL(t,n,a,s,1,1);break;case lP:l+=hL(t,n,a,hP,0,0)+u,c+=hL(t,n,a,s,1,1);break;case cP:l+=hL(t,n,a,s,0,0),c+=hL(t,n,a,hP,-1,0,1)+u;break;default:l+=hL(t,n,a,s,0,0)}(l||c)&&pL(e,a,l,c),(l=Math.round(a.bounds.x1-r))<0&&(pL(e,n,-l,0),pL(e,a,-l,0))}else(i||o)&&pL(e,n,i,o)}(e,i,i.items[0].items[0]),s=function(e,t){return e.items.forEach((e=>t.union(e.bounds))),t.x1=e.padding,t.y1=e.padding,t}(i,s),n=2*i.padding,r=2*i.padding,s.empty()||(n=Math.ceil(s.width()+n),r=Math.ceil(s.height()+r)),"symbol"===o.type&&function(e){const t=e.reduce(((e,t)=>(e[t.column]=Math.max(t.bounds.x2-t.x,e[t.column]||0),e)),{});e.forEach((e=>{e.width=t[e.column],e.height=e.bounds.y2-e.y}))}(i.items[0].items[0].items[0].items),a!==FP&&(i.x=u=0,i.y=l=0),i.width=n,i.height=r,$$(s.set(u,l,u+n,l+r),i),i.mark.bounds.clear().union(s),i}function hL(e,t,n,r,i,o,a){const s="symbol"!==e.datum.type,u=n.datum.vgrad,l=(!s||!o&&u||a?t:t.items[0]).bounds[i?"y2":"x2"]-e.padding,c=u&&o?l:0,f=u&&o?0:l,d=i<=0?0:dz(n);return Math.round(r===fP?c:r===hP?f-d:.5*(l-d))}function pL(e,t,n,r){t.x+=n,t.y+=r,t.bounds.translate(n,r),t.mark.bounds.translate(n,r),e.dirty(t)}function mL(e){LE.call(this,null,e)}_y(mL,LE,{transform:function(e,t){const n=t.dataflow;return e.mark.items.forEach((t=>{e.layout&&aL(n,t,e.layout),function(e,t,n){var r,i,o,a,s,u=t.items,l=Math.max(0,t.width||0),c=Math.max(0,t.height||0),f=(new C$).set(0,0,l,c),d=f.clone(),h=f.clone(),p=[];for(a=0,s=u.length;a<s;++a)switch((i=u[a]).role){case mP:(QP(i)?d:h).union(JP(e,i,l,c));break;case gP:r=i;break;case bP:p.push(dL(e,i));break;case yP:case vP:case xP:case wP:case _P:case kP:case EP:case SP:d.union(i.bounds),h.union(i.bounds);break;default:f.union(i.bounds)}if(p.length){const t={};p.forEach((e=>{(o=e.orient||lP)!==FP&&(t[o]||(t[o]=[])).push(e)}));for(const r in t){const i=t[r];oL(e,i,fL(i,r,n.legends,d,h,l,c))}p.forEach((t=>{const r=t.bounds;if(r.equals(t._bounds)||(t.bounds=t._bounds,e.dirty(t),t.bounds=r,e.dirty(t)),n.autosize&&n.autosize.type===CP)switch(t.orient){case uP:case lP:f.add(r.x1,0).add(r.x2,0);break;case sP:case cP:f.add(0,r.y1).add(0,r.y2)}else f.union(r)}))}f.union(d).union(h),r&&f.union(function(e,t,n,r,i){var o,a=t.items[0],s=a.frame,u=a.orient,l=a.anchor,c=a.offset,f=a.padding,d=a.items[0].items[0],h=a.items[1]&&a.items[1].items[0],p=u===uP||u===lP?r:n,m=0,g=0,y=0,v=0,b=0;if(s!==pP?u===uP?(m=i.y2,p=i.y1):u===lP?(m=i.y1,p=i.y2):(m=i.x1,p=i.x2):u===uP&&(m=r,p=0),o=l===fP?m:l===hP?p:(m+p)/2,h&&h.text){switch(u){case sP:case cP:b=d.bounds.height()+f;break;case uP:v=d.bounds.width()+f;break;case lP:v=-d.bounds.width()-f}YP.clear().union(h.bounds),YP.translate(v-(h.x||0),b-(h.y||0)),XP(h,"x",v)|XP(h,"y",b)&&(e.dirty(h),h.bounds.clear().union(YP),h.mark.bounds.clear().union(YP),e.dirty(h)),YP.clear().union(h.bounds)}else YP.clear();switch(YP.union(d.bounds),u){case sP:g=o,y=i.y1-YP.height()-c;break;case uP:g=i.x1-YP.width()-c,y=o;break;case lP:g=i.x2+YP.width()+c,y=o;break;case cP:g=o,y=i.y2+c;break;default:g=a.x,y=a.y}return XP(a,"x",g)|XP(a,"y",y)&&(YP.translate(g,y),e.dirty(a),a.bounds.clear().union(YP),t.bounds.clear().union(YP),e.dirty(a)),a.bounds}(e,r,l,c,f));t.clip&&f.set(0,0,t.width||0,t.height||0);!function(e,t,n,r){const i=r.autosize||{},o=i.type;if(e._autosize<1||!o)return;let a=e._width,s=e._height,u=Math.max(0,t.width||0),l=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,t.height||0),f=Math.max(0,Math.ceil(-n.y1));const d=Math.max(0,Math.ceil(n.x2-u)),h=Math.max(0,Math.ceil(n.y2-c));if(i.contains===AP){const t=e.padding();a-=t.left+t.right,s-=t.top+t.bottom}o===FP?(l=0,f=0,u=a,c=s):o===CP?(u=Math.max(0,a-l-d),c=Math.max(0,s-f-h)):o===DP?(u=Math.max(0,a-l-d),s=c+f+h):o===MP?(a=u+l+d,c=Math.max(0,s-f-h)):"pad"===o&&(a=u+l+d,s=c+f+h);e._resizeView(a,s,u,c,[l,f],i.resize)}(e,t,f,n)}(n,t,e)})),(r=e.mark.group)&&"legend-entry"!==r.mark.role?t.reflow():t;var r}}),t(cC,"viewlayout",(function(){return mL})),t(cC,"render",(function(){return GP})),t(cC,"overlap",(function(){return IP})),t(cC,"mark",(function(){return BP})),t(cC,"identifier",(function(){return LP})),t(cC,"bound",(function(){return RP}));var gL={};function yL(e){LE.call(this,null,e)}function vL(e){LE.call(this,null,e)}function bL(){return sE({})}function xL(e){LE.call(this,null,e)}function wL(e){LE.call(this,[],e)}_y(yL,LE,{transform:function(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,o=e.scale,a=hO(o,null==e.count?e.values?e.values.length:10:e.count,e.minstep),s=e.format||gO(n,o,a,e.formatSpecifier,e.formatType,!!e.values),u=e.values?pO(o,e.values,a):mO(o,a);return i&&(r.rem=i),i=u.map(((e,t)=>sE({index:t/(u.length-1||1),value:e,label:s(e)}))),e.extra&&i.length&&i.push(sE({index:-1,extra:{value:i[0].value},label:""})),r.source=i,r.add=i,this.value=i,r}}),_y(vL,LE,{transform:function(e,t){var n=t.dataflow,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.item||bL,o=e.key||oE,a=this.value;return $g(r.encode)&&(r.encode=null),a&&(e.modified("key")||t.modified(o))&&_g("DataJoin does not support modified key function or fields."),a||(t=t.addAll(),this.value=a=function(e){const t=xy().test((e=>e.exit));return t.lookup=n=>t.get(e(n)),t}(o)),t.visit(t.ADD,(e=>{const t=o(e);let n=a.get(t);n?n.exit?(a.empty--,r.add.push(n)):r.mod.push(n):(n=i(e),a.set(t,n),r.add.push(n)),n.datum=e,n.exit=!1})),t.visit(t.MOD,(e=>{const t=o(e),n=a.get(t);n&&(n.datum=e,r.mod.push(n))})),t.visit(t.REM,(e=>{const t=o(e),n=a.get(t);e!==n.datum||n.exit||(r.rem.push(n),n.exit=!0,++a.empty)})),t.changed(t.ADD_MOD)&&r.modifies("datum"),(t.clean()||e.clean&&a.empty>n.cleanThreshold)&&n.runAfter(a.clean),r}}),_y(xL,LE,{transform:function(e,t){var n=t.fork(t.ADD_REM),r=e.mod||!1,i=e.encoders,o=t.encode;if($g(o)){if(!n.changed()&&!o.every((e=>i[e])))return t.StopPropagation;o=o[0],n.encode=null}var a="enter"===o,s=i.update||Fg,u=i.enter||Fg,l=i.exit||Fg,c=(o&&!a?i[o]:s)||Fg;if(t.changed(t.ADD)&&(t.visit(t.ADD,(t=>{u(t,e),s(t,e)})),n.modifies(u.output),n.modifies(s.output),c!==Fg&&c!==s&&(t.visit(t.ADD,(t=>{c(t,e)})),n.modifies(c.output))),t.changed(t.REM)&&l!==Fg&&(t.visit(t.REM,(t=>{l(t,e)})),n.modifies(l.output)),a||c!==Fg){const i=t.MOD|(e.modified()?t.REFLOW:0);a?(t.visit(i,(t=>{const i=u(t,e)||r;(c(t,e)||i)&&n.mod.push(t)})),n.mod.length&&n.modifies(u.output)):t.visit(i,(t=>{(c(t,e)||r)&&n.mod.push(t)})),n.mod.length&&n.modifies(c.output)}return n.changed()?n:t.StopPropagation}}),_y(wL,LE,{transform:function(e,t){if(null!=this.value&&!e.modified())return t.StopPropagation;var n,r,i,o,a,s=t.dataflow.locale(),u=t.fork(t.NO_SOURCE|t.NO_FIELDS),l=this.value,c=e.type||lO,f=e.scale,d=+e.limit,h=hO(f,null==e.count?5:e.count,e.minstep),p=!!e.values||c===lO,m=e.format||wO(s,f,h,c,e.formatSpecifier,e.formatType,p),g=e.values||xO(f,h);return l&&(u.rem=l),c===lO?(d&&g.length>d?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),l=g.slice(0,d-1),a=!0):l=g,ay(i=e.size)?(e.values||0!==f(l[0])||(l=l.slice(1)),o=l.reduce(((t,n)=>Math.max(t,i(n,e))),0)):i=dy(o=i||8),l=l.map(((t,n)=>sE({index:n,label:m(t,n,l),value:t,offset:o,size:i(t,e)}))),a&&(a=g[l.length],l.push(sE({index:l.length,label:"".concat(g.length-l.length," entries"),value:a,offset:o,size:i(a,e)})))):"gradient"===c?(n=f.domain(),r=rO(f,n[0],Bg(n)),g.length<3&&!e.values&&n[0]!==Bg(n)&&(g=[n[0],Bg(n)]),l=g.map(((e,t)=>sE({index:t,label:m(e,t,g),value:e,perc:r(e)})))):(i=g.length-1,r=function(e){const t=e.domain(),n=t.length-1;let r=+t[0],i=+Bg(t),o=i-r;if(e.type===CN){const e=n?o/n:.1;r-=e,i+=e,o=i-r}return e=>(e-r)/o}(f),l=g.map(((e,t)=>sE({index:t,label:m(e,t,g),value:e,perc:t?r(e):0,perc2:t===i?1:r(g[t+1])})))),u.source=l,u.add=l,this.value=l,u}});const _L=e=>e.source.x,kL=e=>e.source.y,EL=e=>e.target.x,SL=e=>e.target.y;function AL(e){LE.call(this,{},e)}AL.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]},_y(AL,LE,{transform:function(e,t){var n=e.sourceX||_L,r=e.sourceY||kL,i=e.targetX||EL,o=e.targetY||SL,a=e.as||"path",s=e.orient||"vertical",u=e.shape||"line",l=FL.get(u+"-"+s)||FL.get(u);return l||_g("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,(e=>{e[a]=l(n(e),r(e),i(e),o(e))})),t.reflow(e.modified()).modifies(a)}});const CL=(e,t,n,r)=>"M"+e+","+t+"L"+n+","+r,DL=(e,t,n,r)=>{var i=n-e,o=r-t,a=Math.sqrt(i*i+o*o)/2;return"M"+e+","+t+"A"+a+","+a+" "+180*Math.atan2(o,i)/Math.PI+" 0 1 "+n+","+r},ML=(e,t,n,r)=>{const i=n-e,o=r-t,a=.2*(i+o),s=.2*(o-i);return"M"+e+","+t+"C"+(e+a)+","+(t+s)+" "+(n+s)+","+(r-a)+" "+n+","+r},FL=xy({line:CL,"line-radial":(e,t,n,r)=>CL(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),arc:DL,"arc-radial":(e,t,n,r)=>DL(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),curve:ML,"curve-radial":(e,t,n,r)=>ML(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),"orthogonal-horizontal":(e,t,n,r)=>"M"+e+","+t+"V"+r+"H"+n,"orthogonal-vertical":(e,t,n,r)=>"M"+e+","+t+"H"+n+"V"+r,"orthogonal-radial":(e,t,n,r)=>{const i=Math.cos(e),o=Math.sin(e),a=Math.cos(n),s=Math.sin(n);return"M"+t*i+","+t*o+"A"+t+","+t+" 0 0,"+((Math.abs(n-e)>Math.PI?n<=e:n>e)?1:0)+" "+t*a+","+t*s+"L"+r*a+","+r*s},"diagonal-horizontal":(e,t,n,r)=>{const i=(e+n)/2;return"M"+e+","+t+"C"+i+","+t+" "+i+","+r+" "+n+","+r},"diagonal-vertical":(e,t,n,r)=>{const i=(t+r)/2;return"M"+e+","+t+"C"+e+","+i+" "+n+","+i+" "+n+","+r},"diagonal-radial":(e,t,n,r)=>{const i=Math.cos(e),o=Math.sin(e),a=Math.cos(n),s=Math.sin(n),u=(t+r)/2;return"M"+t*i+","+t*o+"C"+u*i+","+u*o+" "+u*a+","+u*s+" "+r*a+","+r*s}});function NL(e){LE.call(this,null,e)}NL.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]},_y(NL,LE,{transform:function(e,t){var n,r,i,o=e.as||["startAngle","endAngle"],a=o[0],s=o[1],u=e.field||Dg,l=e.startAngle||0,c=null!=e.endAngle?e.endAngle:2*Math.PI,f=t.source,d=f.map(u),h=d.length,p=l,m=(c-l)/Ib(d),g=Bb(h);for(e.sort&&g.sort(((e,t)=>d[e]-d[t])),n=0;n<h;++n)i=d[g[n]],(r=f[g[n]])[a]=p,r[s]=p+=i*m;return this.value=d,t.reflow(e.modified()).modifies(o)}});function OL(e){return GN(e)&&e!==kN}const $L=Uy(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function TL(e){LE.call(this,null,e),this.modified(!0)}function zL(e,t,n){QN(e)&&(Math.abs(t.reduce(((e,t)=>e+(t<0?-1:t>0?1:0)),0))!==t.length&&n.warn("Log scale domain includes zero: "+Py(t)));return t}function RL(e,t,n){return ay(e)&&(t||n)?eO(e,PL(t||[0,1],n)):e}function PL(e,t){return t?e.slice().reverse():e}function LL(e){LE.call(this,null,e)}_y(TL,LE,{transform:function(e,t){var n=t.dataflow,r=this.value,i=function(e){var t,n=e.type,r="";if(n===kN)return"sequential-linear";(function(e){const t=e.type;return GN(t)&&t!==wN&&t!==_N&&(e.scheme||e.range&&e.range.length&&e.range.every(My))})(e)&&(r=2===(t=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(null!=e.domainMid):0)?"sequential-":3===t?"diverging-":"");return(r+n||gN).toLowerCase()}(e);for(i in r&&i===r.type||(this.value=r=WN(i)()),e)if(!$L[i]){if("padding"===i&&OL(r.type))continue;ay(r[i])?r[i](e[i]):n.warn("Unsupported scale property: "+i)}return function(e,t,n){var r=e.type,i=t.round||!1,o=t.range;if(null!=t.rangeStep)o=function(e,t,n){e!==FN&&e!==MN&&_g("Only band and point scales support rangeStep.");var r=(null!=t.paddingOuter?t.paddingOuter:t.padding)||0,i=e===MN?1:(null!=t.paddingInner?t.paddingInner:t.padding)||0;return[0,t.rangeStep*mN(n,i,r)]}(r,t,n);else if(t.scheme&&(o=function(e,t,n){var r,i=t.schemeExtent;$g(t.scheme)?r=tO(t.scheme,t.interpolate,t.interpolateGamma):(r=uO(t.scheme.toLowerCase()))||_g("Unrecognized scheme name: ".concat(t.scheme));return n=e===CN?n+1:e===NN?n-1:e===SN||e===AN?+t.schemeCount||5:n,JN(e)?RL(r,i,t.reverse):ay(r)?nO(RL(r,i),n):e===DN?r:r.slice(0,n)}(r,t,n),ay(o))){if(e.interpolator)return e.interpolator(o);_g("Scale type ".concat(r," does not support interpolating color schemes."))}if(o&&JN(r))return e.interpolator(tO(PL(o,t.reverse),t.interpolate,t.interpolateGamma));o&&t.interpolate&&e.interpolate?e.interpolate(iO(t.interpolate,t.interpolateGamma)):ay(e.round)?e.round(i):ay(e.rangeRound)&&e.interpolate(i?uF:oF);o&&e.range(PL(o,t.reverse))}(r,e,function(e,t,n){let r=t.bins;if(r&&!$g(r)){const t=e.domain(),n=t[0],i=Bg(t),o=r.step;let a=null==r.start?n:r.start,s=null==r.stop?i:r.stop;o||_g("Scale bins parameter missing step property."),a<n&&(a=o*Math.ceil(n/o)),s>i&&(s=o*Math.floor(i/o)),r=Bb(a,s+o/2,o)}r?e.bins=r:e.bins&&delete e.bins;e.type===NN&&(r?t.domain||t.domainRaw||(e.domain(r),n=r.length):e.bins=e.domain());return n}(r,e,function(e,t,n){const r=function(e,t,n){return t?(e.domain(zL(e.type,t,n)),t.length):-1}(e,t.domainRaw,n);if(r>-1)return r;var i,o,a=t.domain,s=e.type,u=t.zero||void 0===t.zero&&function(e){const t=e.type;return!e.bins&&(t===gN||t===vN||t===bN)}(e);if(!a)return 0;OL(s)&&t.padding&&a[0]!==Bg(a)&&(a=function(e,t,n,r,i,o){var a=Math.abs(Bg(n)-n[0]),s=a/(a-2*r),u=e===yN?Zg(t,null,s):e===bN?ey(t,null,s,.5):e===vN?ey(t,null,s,i||1):e===xN?ty(t,null,s,o||1):Kg(t,null,s);return(t=t.slice())[0]=u[0],t[t.length-1]=u[1],t}(s,a,t.range,t.padding,t.exponent,t.constant));if((u||null!=t.domainMin||null!=t.domainMax||null!=t.domainMid)&&(i=(a=a.slice()).length-1||1,u&&(a[0]>0&&(a[0]=0),a[i]<0&&(a[i]=0)),null!=t.domainMin&&(a[0]=t.domainMin),null!=t.domainMax&&(a[i]=t.domainMax),null!=t.domainMid)){const e=(o=t.domainMid)>a[i]?i+1:o<a[0]?0:i;e!==i&&n.warn("Scale domainMid exceeds domain min or max.",o),a.splice(e,0,o)}e.domain(zL(s,a,n)),s===DN&&e.unknown(t.domainImplicit?ZF:void 0);t.nice&&e.nice&&e.nice(!0!==t.nice&&hO(e,t.nice)||null);return a.length}(r,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}}),_y(LL,LE,{transform:function(e,t){const n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(fE(e.sort)),this.modified(n),t}});const BL="zero",IL="center",jL="normalize",UL=["y0","y1"];function qL(e){LE.call(this,null,e)}function WL(e,t,n,r,i){for(var o,a=(t-e.sum)/2,s=e.length,u=0;u<s;++u)(o=e[u])[r]=a,o[i]=a+=Math.abs(n(o))}function HL(e,t,n,r,i){for(var o,a=1/e.sum,s=0,u=e.length,l=0,c=0;l<u;++l)(o=e[l])[r]=s,o[i]=s=a*(c+=Math.abs(n(o)))}function VL(e,t,n,r,i){for(var o,a,s=0,u=0,l=e.length,c=0;c<l;++c)(o=+n(a=e[c]))<0?(a[r]=u,a[i]=u+=o):(a[r]=s,a[i]=s+=o)}qL.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:BL,values:[BL,IL,jL]},{name:"as",type:"string",array:!0,length:2,default:UL}]},_y(qL,LE,{transform:function(e,t){var n,r,i,o,a=e.as||UL,s=a[0],u=a[1],l=fE(e.sort),c=e.field||Dg,f=e.offset===IL?WL:e.offset===jL?HL:VL;for(n=function(e,t,n,r){var i,o,a,s,u,l,c,f,d,h=[],p=e=>e(u);if(null==t)h.push(e.slice());else for(i={},o=0,a=e.length;o<a;++o)u=e[o],(c=i[l=t.map(p)])||(i[l]=c=[],h.push(c)),c.push(u);for(l=0,d=0,s=h.length;l<s;++l){for(o=0,f=0,a=(c=h[l]).length;o<a;++o)f+=Math.abs(r(c[o]));c.sum=f,f>d&&(d=f),n&&c.sort(n)}return h.max=d,h}(t.source,e.groupby,l,c),r=0,i=n.length,o=n.max;r<i;++r)f(n[r],o,c,s,u);return t.reflow(e.modified()).modifies(a)}}),t(gL,"stack",(function(){return qL})),t(gL,"sortitems",(function(){return LL})),t(gL,"scale",(function(){return TL})),t(gL,"pie",(function(){return NL})),t(gL,"linkpath",(function(){return AL})),t(gL,"legendentries",(function(){return wL})),t(gL,"encode",(function(){return xL})),t(gL,"datajoin",(function(){return vL})),t(gL,"axisticks",(function(){return yL}));var GL={},YL=1e-6,XL=1e-12,QL=Math.PI,JL=QL/2,KL=QL/4,ZL=2*QL,eB=180/QL,tB=QL/180,nB=Math.abs,rB=Math.atan,iB=Math.atan2,oB=Math.cos,aB=Math.ceil,sB=Math.exp,uB=(Math.floor,Math.hypot),lB=Math.log,cB=Math.pow,fB=Math.sin,dB=Math.sign||function(e){return e>0?1:e<0?-1:0},hB=Math.sqrt,pB=Math.tan;function mB(e){return e>1?0:e<-1?QL:Math.acos(e)}function gB(e){return e>1?JL:e<-1?-JL:Math.asin(e)}function yB(){}function vB(e,t){e&&xB.hasOwnProperty(e.type)&&xB[e.type](e,t)}var bB={Feature:function(e,t){vB(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)vB(n[r].geometry,t)}},xB={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){wB(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)wB(n[r],t,0)},Polygon:function(e,t){_B(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)_B(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)vB(n[r],t)}};function wB(e,t,n){var r,i=-1,o=e.length-n;for(t.lineStart();++i<o;)r=e[i],t.point(r[0],r[1],r[2]);t.lineEnd()}function _B(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)wB(e[n],t,1);t.polygonEnd()}var kB,EB,SB,AB,CB,DB=function(e,t){e&&bB.hasOwnProperty(e.type)?bB[e.type](e,t):vB(e,t)},MB=new Fb,FB=new Fb,NB={point:yB,lineStart:yB,lineEnd:yB,polygonStart:function(){MB=new Fb,NB.lineStart=OB,NB.lineEnd=$B},polygonEnd:function(){var e=+MB;FB.add(e<0?ZL+e:e),this.lineStart=this.lineEnd=this.point=yB},sphere:function(){FB.add(ZL)}};function OB(){NB.point=TB}function $B(){zB(kB,EB)}function TB(e,t){NB.point=zB,kB=e,EB=t,SB=e*=tB,AB=oB(t=(t*=tB)/2+KL),CB=fB(t)}function zB(e,t){var n=(e*=tB)-SB,r=n>=0?1:-1,i=r*n,o=oB(t=(t*=tB)/2+KL),a=fB(t),s=CB*a,u=AB*o+s*oB(i),l=s*r*fB(i);MB.add(iB(l,u)),SB=e,AB=o,CB=a}var RB,PB,LB,BB,IB,jB,UB,qB,WB,HB,VB;function GB(e){return[iB(e[1],e[0]),gB(e[2])]}function YB(e){var t=e[0],n=e[1],r=oB(n);return[r*oB(t),r*fB(t),fB(n)]}function XB(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function QB(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function JB(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function KB(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function ZB(e){var t=hB(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var eI={point:tI,lineStart:rI,lineEnd:iI,polygonStart:function(){eI.point=oI,eI.lineStart=aI,eI.lineEnd=sI,WB=new Fb,NB.polygonStart()},polygonEnd:function(){NB.polygonEnd(),eI.point=tI,eI.lineStart=rI,eI.lineEnd=iI,MB<0?(RB=-(LB=180),PB=-(BB=90)):WB>YL?BB=90:WB<-1e-6&&(PB=-90),VB[0]=RB,VB[1]=LB},sphere:function(){RB=-(LB=180),PB=-(BB=90)}};function tI(e,t){HB.push(VB=[RB=e,LB=e]),t<PB&&(PB=t),t>BB&&(BB=t)}function nI(e,t){var n=YB([e*tB,t*tB]);if(qB){var r=QB(qB,n),i=QB([r[1],-r[0],0],r);ZB(i),i=GB(i);var o,a=e-IB,s=a>0?1:-1,u=i[0]*eB*s,l=nB(a)>180;l^(s*IB<u&&u<s*e)?(o=i[1]*eB)>BB&&(BB=o):l^(s*IB<(u=(u+360)%360-180)&&u<s*e)?(o=-i[1]*eB)<PB&&(PB=o):(t<PB&&(PB=t),t>BB&&(BB=t)),l?e<IB?uI(RB,e)>uI(RB,LB)&&(LB=e):uI(e,LB)>uI(RB,LB)&&(RB=e):LB>=RB?(e<RB&&(RB=e),e>LB&&(LB=e)):e>IB?uI(RB,e)>uI(RB,LB)&&(LB=e):uI(e,LB)>uI(RB,LB)&&(RB=e)}else HB.push(VB=[RB=e,LB=e]);t<PB&&(PB=t),t>BB&&(BB=t),qB=n,IB=e}function rI(){eI.point=nI}function iI(){VB[0]=RB,VB[1]=LB,eI.point=tI,qB=null}function oI(e,t){if(qB){var n=e-IB;WB.add(nB(n)>180?n+(n>0?360:-360):n)}else jB=e,UB=t;NB.point(e,t),nI(e,t)}function aI(){NB.lineStart()}function sI(){oI(jB,UB),NB.lineEnd(),nB(WB)>YL&&(RB=-(LB=180)),VB[0]=RB,VB[1]=LB,qB=null}function uI(e,t){return(t-=e)<0?t+360:t}function lI(e,t){return e[0]-t[0]}function cI(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}var fI,dI,hI,pI,mI,gI,yI,vI,bI,xI,wI,_I,kI,EI,SI,AI,CI={sphere:yB,point:DI,lineStart:FI,lineEnd:$I,polygonStart:function(){CI.lineStart=TI,CI.lineEnd=zI},polygonEnd:function(){CI.lineStart=FI,CI.lineEnd=$I}};function DI(e,t){e*=tB;var n=oB(t*=tB);MI(n*oB(e),n*fB(e),fB(t))}function MI(e,t,n){++fI,hI+=(e-hI)/fI,pI+=(t-pI)/fI,mI+=(n-mI)/fI}function FI(){CI.point=NI}function NI(e,t){e*=tB;var n=oB(t*=tB);EI=n*oB(e),SI=n*fB(e),AI=fB(t),CI.point=OI,MI(EI,SI,AI)}function OI(e,t){e*=tB;var n=oB(t*=tB),r=n*oB(e),i=n*fB(e),o=fB(t),a=iB(hB((a=SI*o-AI*i)*a+(a=AI*r-EI*o)*a+(a=EI*i-SI*r)*a),EI*r+SI*i+AI*o);dI+=a,gI+=a*(EI+(EI=r)),yI+=a*(SI+(SI=i)),vI+=a*(AI+(AI=o)),MI(EI,SI,AI)}function $I(){CI.point=DI}function TI(){CI.point=RI}function zI(){PI(_I,kI),CI.point=DI}function RI(e,t){_I=e,kI=t,e*=tB,t*=tB,CI.point=PI;var n=oB(t);EI=n*oB(e),SI=n*fB(e),AI=fB(t),MI(EI,SI,AI)}function PI(e,t){e*=tB;var n=oB(t*=tB),r=n*oB(e),i=n*fB(e),o=fB(t),a=SI*o-AI*i,s=AI*r-EI*o,u=EI*i-SI*r,l=uB(a,s,u),c=gB(l),f=l&&-c/l;bI.add(f*a),xI.add(f*s),wI.add(f*u),dI+=c,gI+=c*(EI+(EI=r)),yI+=c*(SI+(SI=i)),vI+=c*(AI+(AI=o)),MI(EI,SI,AI)}function LI(e,t,n){var r=Bb(e,t-YL,n).concat(t);return function(e){return r.map((function(t){return[e,t]}))}}function BI(e,t,n){var r=Bb(e,t-YL,n).concat(t);return function(e){return r.map((function(t){return[t,e]}))}}var II,jI,UI,qI,WI=e=>e,HI=new Fb,VI=new Fb,GI={point:yB,lineStart:yB,lineEnd:yB,polygonStart:function(){GI.lineStart=YI,GI.lineEnd=JI},polygonEnd:function(){GI.lineStart=GI.lineEnd=GI.point=yB,HI.add(nB(VI)),VI=new Fb},result:function(){var e=HI/2;return HI=new Fb,e}};function YI(){GI.point=XI}function XI(e,t){GI.point=QI,II=UI=e,jI=qI=t}function QI(e,t){VI.add(qI*e-UI*t),UI=e,qI=t}function JI(){QI(II,jI)}var KI=1/0,ZI=KI,ej=-KI,tj=ej,nj={point:function(e,t){e<KI&&(KI=e);e>ej&&(ej=e);t<ZI&&(ZI=t);t>tj&&(tj=t)},lineStart:yB,lineEnd:yB,polygonStart:yB,polygonEnd:yB,result:function(){var e=[[KI,ZI],[ej,tj]];return ej=tj=-(ZI=KI=1/0),e}};var rj,ij,oj,aj,sj=0,uj=0,lj=0,cj=0,fj=0,dj=0,hj=0,pj=0,mj=0,gj={point:yj,lineStart:vj,lineEnd:wj,polygonStart:function(){gj.lineStart=_j,gj.lineEnd=kj},polygonEnd:function(){gj.point=yj,gj.lineStart=vj,gj.lineEnd=wj},result:function(){var e=mj?[hj/mj,pj/mj]:dj?[cj/dj,fj/dj]:lj?[sj/lj,uj/lj]:[NaN,NaN];return sj=uj=lj=cj=fj=dj=hj=pj=mj=0,e}};function yj(e,t){sj+=e,uj+=t,++lj}function vj(){gj.point=bj}function bj(e,t){gj.point=xj,yj(oj=e,aj=t)}function xj(e,t){var n=e-oj,r=t-aj,i=hB(n*n+r*r);cj+=i*(oj+e)/2,fj+=i*(aj+t)/2,dj+=i,yj(oj=e,aj=t)}function wj(){gj.point=yj}function _j(){gj.point=Ej}function kj(){Sj(rj,ij)}function Ej(e,t){gj.point=Sj,yj(rj=oj=e,ij=aj=t)}function Sj(e,t){var n=e-oj,r=t-aj,i=hB(n*n+r*r);cj+=i*(oj+e)/2,fj+=i*(aj+t)/2,dj+=i,hj+=(i=aj*e-oj*t)*(oj+e),pj+=i*(aj+t),mj+=3*i,yj(oj=e,aj=t)}function Aj(e){this._context=e}Aj.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._context.moveTo(e,t),this._point=1;break;case 1:this._context.lineTo(e,t);break;default:this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,ZL)}},result:yB};var Cj,Dj,Mj,Fj,Nj,Oj=new Fb,$j={point:yB,lineStart:function(){$j.point=Tj},lineEnd:function(){Cj&&zj(Dj,Mj),$j.point=yB},polygonStart:function(){Cj=!0},polygonEnd:function(){Cj=null},result:function(){var e=+Oj;return Oj=new Fb,e}};function Tj(e,t){$j.point=zj,Dj=Fj=e,Mj=Nj=t}function zj(e,t){Fj-=e,Nj-=t,Oj.add(hB(Fj*Fj+Nj*Nj)),Fj=e,Nj=t}function Rj(){this._string=[]}function Pj(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}Rj.prototype={_radius:4.5,_circle:Pj(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._string.push("M",e,",",t),this._point=1;break;case 1:this._string.push("L",e,",",t);break;default:null==this._circle&&(this._circle=Pj(this._radius)),this._string.push("M",e,",",t,this._circle)}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}return null}};var Lj=function(e,t){var n,r,i=4.5;function o(e){return e&&("function"==typeof i&&r.pointRadius(+i.apply(this,arguments)),DB(e,n(r))),r.result()}return o.area=function(e){return DB(e,n(GI)),GI.result()},o.measure=function(e){return DB(e,n($j)),$j.result()},o.bounds=function(e){return DB(e,n(nj)),nj.result()},o.centroid=function(e){return DB(e,n(gj)),gj.result()},o.projection=function(t){return arguments.length?(n=null==t?(e=null,WI):(e=t).stream,o):e},o.context=function(e){return arguments.length?(r=null==e?(t=null,new Rj):new Aj(t=e),"function"!=typeof i&&r.pointRadius(i),o):t},o.pointRadius=function(e){return arguments.length?(i="function"==typeof e?e:(r.pointRadius(+e),+e),o):i},o.projection(e).context(t)},Bj=function(){var e,t=[];return{point:function(t,n,r){e.push([t,n,r])},lineStart:function(){t.push(e=[])},lineEnd:yB,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var n=t;return t=[],e=null,n}}},Ij=function(e,t){return nB(e[0]-t[0])<YL&&nB(e[1]-t[1])<YL};function jj(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}var Uj=function(e,t,n,r,i){var o,a,s=[],u=[];if(e.forEach((function(e){if(!((t=e.length-1)<=0)){var t,n,r=e[0],a=e[t];if(Ij(r,a)){if(!r[2]&&!a[2]){for(i.lineStart(),o=0;o<t;++o)i.point((r=e[o])[0],r[1]);return void i.lineEnd()}a[0]+=2e-6}s.push(n=new jj(r,e,null,!0)),u.push(n.o=new jj(r,null,n,!1)),s.push(n=new jj(a,e,null,!1)),u.push(n.o=new jj(a,null,n,!0))}})),s.length){for(u.sort(t),qj(s),qj(u),o=0,a=u.length;o<a;++o)u[o].e=n=!n;for(var l,c,f=s[0];;){for(var d=f,h=!0;d.v;)if((d=d.n)===f)return;l=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(o=0,a=l.length;o<a;++o)i.point((c=l[o])[0],c[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(h)for(l=d.p.z,o=l.length-1;o>=0;--o)i.point((c=l[o])[0],c[1]);else r(d.x,d.p.x,-1,i);d=d.p}l=(d=d.o).z,h=!h}while(!d.v);i.lineEnd()}}};function qj(e){if(t=e.length){for(var t,n,r=0,i=e[0];++r<t;)i.n=n=e[r],n.p=i,i=n;i.n=n=e[0],n.p=i}}function Wj(e){return nB(e[0])<=QL?e[0]:dB(e[0])*((nB(e[0])+QL)%ZL-QL)}var Hj=function(e,t,n,r){return function(i){var o,a,s,u=t(i),l=Bj(),c=t(l),f=!1,d={point:h,lineStart:m,lineEnd:g,polygonStart:function(){d.point=y,d.lineStart=v,d.lineEnd=b,a=[],o=[]},polygonEnd:function(){d.point=h,d.lineStart=m,d.lineEnd=g,a=Lb(a);var e=function(e,t){var n=Wj(t),r=t[1],i=fB(r),o=[fB(n),-oB(n),0],a=0,s=0,u=new Fb;1===i?r=JL+YL:-1===i&&(r=-JL-YL);for(var l=0,c=e.length;l<c;++l)if(d=(f=e[l]).length)for(var f,d,h=f[d-1],p=Wj(h),m=h[1]/2+KL,g=fB(m),y=oB(m),v=0;v<d;++v,p=x,g=_,y=k,h=b){var b=f[v],x=Wj(b),w=b[1]/2+KL,_=fB(w),k=oB(w),E=x-p,S=E>=0?1:-1,A=S*E,C=A>QL,D=g*_;if(u.add(iB(D*S*fB(A),y*k+D*oB(A))),a+=C?E+S*ZL:E,C^p>=n^x>=n){var M=QB(YB(h),YB(b));ZB(M);var F=QB(o,M);ZB(F);var N=(C^E>=0?-1:1)*gB(F[2]);(r>N||r===N&&(M[0]||M[1]))&&(s+=C^E>=0?1:-1)}}return(a<-1e-6||a<YL&&u<-1e-12)^1&s}(o,r);a.length?(f||(i.polygonStart(),f=!0),Uj(a,Gj,e,n,i)):e&&(f||(i.polygonStart(),f=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),f&&(i.polygonEnd(),f=!1),a=o=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function h(t,n){e(t,n)&&i.point(t,n)}function p(e,t){u.point(e,t)}function m(){d.point=p,u.lineStart()}function g(){d.point=h,u.lineEnd()}function y(e,t){s.push([e,t]),c.point(e,t)}function v(){c.lineStart(),s=[]}function b(){y(s[0][0],s[0][1]),c.lineEnd();var e,t,n,r,u=c.clean(),d=l.result(),h=d.length;if(s.pop(),o.push(s),s=null,h)if(1&u){if((t=(n=d[0]).length-1)>0){for(f||(i.polygonStart(),f=!0),i.lineStart(),e=0;e<t;++e)i.point((r=n[e])[0],r[1]);i.lineEnd()}}else h>1&&2&u&&d.push(d.pop().concat(d.shift())),a.push(d.filter(Vj))}return d}};function Vj(e){return e.length>1}function Gj(e,t){return((e=e.x)[0]<0?e[1]-JL-YL:JL-e[1])-((t=t.x)[0]<0?t[1]-JL-YL:JL-t[1])}var Yj=Hj((function(){return!0}),(function(e){var t,n=NaN,r=NaN,i=NaN;return{lineStart:function(){e.lineStart(),t=1},point:function(o,a){var s=o>0?QL:-QL,u=nB(o-n);nB(u-QL)<YL?(e.point(n,r=(r+a)/2>0?JL:-JL),e.point(i,r),e.lineEnd(),e.lineStart(),e.point(s,r),e.point(o,r),t=0):i!==s&&u>=QL&&(nB(n-i)<YL&&(n-=i*YL),nB(o-s)<YL&&(o-=s*YL),r=function(e,t,n,r){var i,o,a=fB(e-n);return nB(a)>YL?rB((fB(t)*(o=oB(r))*fB(n)-fB(r)*(i=oB(t))*fB(e))/(i*o*a)):(t+r)/2}(n,r,o,a),e.point(i,r),e.lineEnd(),e.lineStart(),e.point(s,r),t=0),e.point(n=o,r=a),i=s},lineEnd:function(){e.lineEnd(),n=r=NaN},clean:function(){return 2-t}}}),(function(e,t,n,r){var i;if(null==e)i=n*JL,r.point(-QL,i),r.point(0,i),r.point(QL,i),r.point(QL,0),r.point(QL,-i),r.point(0,-i),r.point(-QL,-i),r.point(-QL,0),r.point(-QL,i);else if(nB(e[0]-t[0])>YL){var o=e[0]<t[0]?QL:-QL;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(t[0],t[1])}),[-QL,-JL]);var Xj=function(e,t){function n(n,r){return n=e(n,r),t(n[0],n[1])}return e.invert&&t.invert&&(n.invert=function(n,r){return(n=t.invert(n,r))&&e.invert(n[0],n[1])}),n};function Qj(e,t){return[nB(e)>QL?e+Math.round(-e/ZL)*ZL:e,t]}function Jj(e,t,n){return(e%=ZL)?t||n?Xj(Zj(e),eU(t,n)):Zj(e):t||n?eU(t,n):Qj}function Kj(e){return function(t,n){return[(t+=e)>QL?t-ZL:t<-QL?t+ZL:t,n]}}function Zj(e){var t=Kj(e);return t.invert=Kj(-e),t}function eU(e,t){var n=oB(e),r=fB(e),i=oB(t),o=fB(t);function a(e,t){var a=oB(t),s=oB(e)*a,u=fB(e)*a,l=fB(t),c=l*n+s*r;return[iB(u*i-c*o,s*n-l*r),gB(c*i+u*o)]}return a.invert=function(e,t){var a=oB(t),s=oB(e)*a,u=fB(e)*a,l=fB(t),c=l*i-u*o;return[iB(u*i+l*o,s*n+c*r),gB(c*n-s*r)]},a}Qj.invert=Qj;function tU(e,t){(t=YB(t))[0]-=e,ZB(t);var n=mB(-t[1]);return((-t[2]<0?-n:n)+ZL-YL)%ZL}var nU=function(e){var t=oB(e),n=6*tB,r=t>0,i=nB(t)>YL;function o(e,n){return oB(e)*oB(n)>t}function a(e,n,r){var i=[1,0,0],o=QB(YB(e),YB(n)),a=XB(o,o),s=o[0],u=a-s*s;if(!u)return!r&&e;var l=t*a/u,c=-t*s/u,f=QB(i,o),d=KB(i,l);JB(d,KB(o,c));var h=f,p=XB(d,h),m=XB(h,h),g=p*p-m*(XB(d,d)-1);if(!(g<0)){var y=hB(g),v=KB(h,(-p-y)/m);if(JB(v,d),v=GB(v),!r)return v;var b,x=e[0],w=n[0],_=e[1],k=n[1];w<x&&(b=x,x=w,w=b);var E=w-x,S=nB(E-QL)<YL;if(!S&&k<_&&(b=_,_=k,k=b),S||E<YL?S?_+k>0^v[1]<(nB(v[0]-x)<YL?_:k):_<=v[1]&&v[1]<=k:E>QL^(x<=v[0]&&v[0]<=w)){var A=KB(h,(-p+y)/m);return JB(A,d),[v,GB(A)]}}}function s(t,n){var i=r?e:QL-e,o=0;return t<-i?o|=1:t>i&&(o|=2),n<-i?o|=4:n>i&&(o|=8),o}return Hj(o,(function(e){var t,n,u,l,c;return{lineStart:function(){l=u=!1,c=1},point:function(f,d){var h,p=[f,d],m=o(f,d),g=r?m?0:s(f,d):m?s(f+(f<0?QL:-QL),d):0;if(!t&&(l=u=m)&&e.lineStart(),m!==u&&(!(h=a(t,p))||Ij(t,h)||Ij(p,h))&&(p[2]=1),m!==u)c=0,m?(e.lineStart(),h=a(p,t),e.point(h[0],h[1])):(h=a(t,p),e.point(h[0],h[1],2),e.lineEnd()),t=h;else if(i&&t&&r^m){var y;g&n||!(y=a(p,t,!0))||(c=0,r?(e.lineStart(),e.point(y[0][0],y[0][1]),e.point(y[1][0],y[1][1]),e.lineEnd()):(e.point(y[1][0],y[1][1]),e.lineEnd(),e.lineStart(),e.point(y[0][0],y[0][1],3)))}!m||t&&Ij(t,p)||e.point(p[0],p[1]),t=p,u=m,n=g},lineEnd:function(){u&&e.lineEnd(),t=null},clean:function(){return c|(l&&u)<<1}}}),(function(t,r,i,o){!function(e,t,n,r,i,o){if(n){var a=oB(t),s=fB(t),u=r*n;null==i?(i=t+r*ZL,o=t-u/2):(i=tU(a,i),o=tU(a,o),(r>0?i<o:i>o)&&(i+=r*ZL));for(var l,c=i;r>0?c>o:c<o;c-=u)l=GB([a,-s*oB(c),-s*fB(c)]),e.point(l[0],l[1])}}(o,e,n,i,t,r)}),r?[0,-e]:[-QL,e-QL])},rU=1e9,iU=-1e9;function oU(e,t,n,r){function i(i,o){return e<=i&&i<=n&&t<=o&&o<=r}function o(i,o,s,l){var c=0,f=0;if(null==i||(c=a(i,s))!==(f=a(o,s))||u(i,o)<0^s>0)do{l.point(0===c||3===c?e:n,c>1?r:t)}while((c=(c+s+4)%4)!==f);else l.point(o[0],o[1])}function a(r,i){return nB(r[0]-e)<YL?i>0?0:3:nB(r[0]-n)<YL?i>0?2:1:nB(r[1]-t)<YL?i>0?1:0:i>0?3:2}function s(e,t){return u(e.x,t.x)}function u(e,t){var n=a(e,1),r=a(t,1);return n!==r?n-r:0===n?t[1]-e[1]:1===n?e[0]-t[0]:2===n?e[1]-t[1]:t[0]-e[0]}return function(a){var u,l,c,f,d,h,p,m,g,y,v,b=a,x=Bj(),w={point:_,lineStart:function(){w.point=k,l&&l.push(c=[]);y=!0,g=!1,p=m=NaN},lineEnd:function(){u&&(k(f,d),h&&g&&x.rejoin(),u.push(x.result()));w.point=_,g&&b.lineEnd()},polygonStart:function(){b=x,u=[],l=[],v=!0},polygonEnd:function(){var t=function(){for(var t=0,n=0,i=l.length;n<i;++n)for(var o,a,s=l[n],u=1,c=s.length,f=s[0],d=f[0],h=f[1];u<c;++u)o=d,a=h,d=(f=s[u])[0],h=f[1],a<=r?h>r&&(d-o)*(r-a)>(h-a)*(e-o)&&++t:h<=r&&(d-o)*(r-a)<(h-a)*(e-o)&&--t;return t}(),n=v&&t,i=(u=Lb(u)).length;(n||i)&&(a.polygonStart(),n&&(a.lineStart(),o(null,null,1,a),a.lineEnd()),i&&Uj(u,s,t,o,a),a.polygonEnd());b=a,u=l=c=null}};function _(e,t){i(e,t)&&b.point(e,t)}function k(o,a){var s=i(o,a);if(l&&c.push([o,a]),y)f=o,d=a,h=s,y=!1,s&&(b.lineStart(),b.point(o,a));else if(s&&g)b.point(o,a);else{var u=[p=Math.max(iU,Math.min(rU,p)),m=Math.max(iU,Math.min(rU,m))],x=[o=Math.max(iU,Math.min(rU,o)),a=Math.max(iU,Math.min(rU,a))];!function(e,t,n,r,i,o){var a,s=e[0],u=e[1],l=0,c=1,f=t[0]-s,d=t[1]-u;if(a=n-s,f||!(a>0)){if(a/=f,f<0){if(a<l)return;a<c&&(c=a)}else if(f>0){if(a>c)return;a>l&&(l=a)}if(a=i-s,f||!(a<0)){if(a/=f,f<0){if(a>c)return;a>l&&(l=a)}else if(f>0){if(a<l)return;a<c&&(c=a)}if(a=r-u,d||!(a>0)){if(a/=d,d<0){if(a<l)return;a<c&&(c=a)}else if(d>0){if(a>c)return;a>l&&(l=a)}if(a=o-u,d||!(a<0)){if(a/=d,d<0){if(a>c)return;a>l&&(l=a)}else if(d>0){if(a<l)return;a<c&&(c=a)}return l>0&&(e[0]=s+l*f,e[1]=u+l*d),c<1&&(t[0]=s+c*f,t[1]=u+c*d),!0}}}}}(u,x,e,t,n,r)?s&&(b.lineStart(),b.point(o,a),v=!1):(g||(b.lineStart(),b.point(u[0],u[1])),b.point(x[0],x[1]),s||b.lineEnd(),v=!1)}p=o,m=a,g=s}return w}}function aU(e){return function(t){var n=new sU;for(var r in e)n[r]=e[r];return n.stream=t,n}}function sU(){}function uU(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),null!=r&&e.clipExtent(null),DB(n,e.stream(nj)),t(nj.result()),null!=r&&e.clipExtent(r),e}function lU(e,t,n){return uU(e,(function(n){var r=t[1][0]-t[0][0],i=t[1][1]-t[0][1],o=Math.min(r/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),a=+t[0][0]+(r-o*(n[1][0]+n[0][0]))/2,s=+t[0][1]+(i-o*(n[1][1]+n[0][1]))/2;e.scale(150*o).translate([a,s])}),n)}function cU(e,t,n){return lU(e,[[0,0],t],n)}function fU(e,t,n){return uU(e,(function(n){var r=+t,i=r/(n[1][0]-n[0][0]),o=(r-i*(n[1][0]+n[0][0]))/2,a=-i*n[0][1];e.scale(150*i).translate([o,a])}),n)}function dU(e,t,n){return uU(e,(function(n){var r=+t,i=r/(n[1][1]-n[0][1]),o=-i*n[0][0],a=(r-i*(n[1][1]+n[0][1]))/2;e.scale(150*i).translate([o,a])}),n)}sU.prototype={constructor:sU,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var hU=oB(30*tB),pU=function(e,t){return+t?function(e,t){function n(r,i,o,a,s,u,l,c,f,d,h,p,m,g){var y=l-r,v=c-i,b=y*y+v*v;if(b>4*t&&m--){var x=a+d,w=s+h,_=u+p,k=hB(x*x+w*w+_*_),E=gB(_/=k),S=nB(nB(_)-1)<YL||nB(o-f)<YL?(o+f)/2:iB(w,x),A=e(S,E),C=A[0],D=A[1],M=C-r,F=D-i,N=v*M-y*F;(N*N/b>t||nB((y*M+v*F)/b-.5)>.3||a*d+s*h+u*p<hU)&&(n(r,i,o,a,s,u,C,D,S,x/=k,w/=k,_,m,g),g.point(C,D),n(C,D,S,x,w,_,l,c,f,d,h,p,m,g))}}return function(t){var r,i,o,a,s,u,l,c,f,d,h,p,m={point:g,lineStart:y,lineEnd:b,polygonStart:function(){t.polygonStart(),m.lineStart=x},polygonEnd:function(){t.polygonEnd(),m.lineStart=y}};function g(n,r){n=e(n,r),t.point(n[0],n[1])}function y(){c=NaN,m.point=v,t.lineStart()}function v(r,i){var o=YB([r,i]),a=e(r,i);n(c,f,l,d,h,p,c=a[0],f=a[1],l=r,d=o[0],h=o[1],p=o[2],16,t),t.point(c,f)}function b(){m.point=g,t.lineEnd()}function x(){y(),m.point=w,m.lineEnd=_}function w(e,t){v(r=e,t),i=c,o=f,a=d,s=h,u=p,m.point=v}function _(){n(c,f,l,d,h,p,i,o,r,a,s,u,16,t),m.lineEnd=b,b()}return m}}(e,t):function(e){return aU({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}(e)};var mU=aU({point:function(e,t){this.stream.point(e*tB,t*tB)}});function gU(e,t,n,r,i,o){if(!o)return function(e,t,n,r,i){function o(o,a){return[t+e*(o*=r),n-e*(a*=i)]}return o.invert=function(o,a){return[(o-t)/e*r,(n-a)/e*i]},o}(e,t,n,r,i);var a=oB(o),s=fB(o),u=a*e,l=s*e,c=a/e,f=s/e,d=(s*n-a*t)/e,h=(s*t+a*n)/e;function p(e,o){return[u*(e*=r)-l*(o*=i)+t,n-l*e-u*o]}return p.invert=function(e,t){return[r*(c*e-f*t+d),i*(h-f*e-c*t)]},p}function yU(e){return vU((function(){return e}))()}function vU(e){var t,n,r,i,o,a,s,u,l,c,f=150,d=480,h=250,p=0,m=0,g=0,y=0,v=0,b=0,x=1,w=1,_=null,k=Yj,E=null,S=WI,A=.5;function C(e){return u(e[0]*tB,e[1]*tB)}function D(e){return(e=u.invert(e[0],e[1]))&&[e[0]*eB,e[1]*eB]}function M(){var e=gU(f,0,0,x,w,b).apply(null,t(p,m)),r=gU(f,d-e[0],h-e[1],x,w,b);return n=Jj(g,y,v),s=Xj(t,r),u=Xj(n,s),a=pU(s,A),F()}function F(){return l=c=null,C}return C.stream=function(e){return l&&c===e?l:l=mU(function(e){return aU({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}(n)(k(a(S(c=e)))))},C.preclip=function(e){return arguments.length?(k=e,_=void 0,F()):k},C.postclip=function(e){return arguments.length?(S=e,E=r=i=o=null,F()):S},C.clipAngle=function(e){return arguments.length?(k=+e?nU(_=e*tB):(_=null,Yj),F()):_*eB},C.clipExtent=function(e){return arguments.length?(S=null==e?(E=r=i=o=null,WI):oU(E=+e[0][0],r=+e[0][1],i=+e[1][0],o=+e[1][1]),F()):null==E?null:[[E,r],[i,o]]},C.scale=function(e){return arguments.length?(f=+e,M()):f},C.translate=function(e){return arguments.length?(d=+e[0],h=+e[1],M()):[d,h]},C.center=function(e){return arguments.length?(p=e[0]%360*tB,m=e[1]%360*tB,M()):[p*eB,m*eB]},C.rotate=function(e){return arguments.length?(g=e[0]%360*tB,y=e[1]%360*tB,v=e.length>2?e[2]%360*tB:0,M()):[g*eB,y*eB,v*eB]},C.angle=function(e){return arguments.length?(b=e%360*tB,M()):b*eB},C.reflectX=function(e){return arguments.length?(x=e?-1:1,M()):x<0},C.reflectY=function(e){return arguments.length?(w=e?-1:1,M()):w<0},C.precision=function(e){return arguments.length?(a=pU(s,A=e*e),F()):hB(A)},C.fitExtent=function(e,t){return lU(C,e,t)},C.fitSize=function(e,t){return cU(C,e,t)},C.fitWidth=function(e,t){return fU(C,e,t)},C.fitHeight=function(e,t){return dU(C,e,t)},function(){return t=e.apply(this,arguments),C.invert=t.invert&&D,M()}}function bU(e){var t=0,n=QL/3,r=vU(e),i=r(t,n);return i.parallels=function(e){return arguments.length?r(t=e[0]*tB,n=e[1]*tB):[t*eB,n*eB]},i}function xU(e,t){var n=fB(e),r=(n+fB(t))/2;if(nB(r)<YL)return function(e){var t=oB(e);function n(e,n){return[e*t,fB(n)/t]}return n.invert=function(e,n){return[e/t,gB(n*t)]},n}(e);var i=1+n*(2*r-n),o=hB(i)/r;function a(e,t){var n=hB(i-2*r*fB(t))/r;return[n*fB(e*=r),o-n*oB(e)]}return a.invert=function(e,t){var n=o-t,a=iB(e,nB(n))*dB(n);return n*r<0&&(a-=QL*dB(e)*dB(n)),[a/r,gB((i-(e*e+n*n)*r*r)/(2*r))]},a}var wU=function(){return bU(xU).scale(155.424).center([0,33.6442])},_U=function(){return wU().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])};function kU(e){return function(t,n){var r=oB(t),i=oB(n),o=e(r*i);return o===1/0?[2,0]:[o*i*fB(t),o*fB(n)]}}function EU(e){return function(t,n){var r=hB(t*t+n*n),i=e(r),o=fB(i),a=oB(i);return[iB(t*o,r*a),gB(r&&n*o/r)]}}var SU=kU((function(e){return hB(2/(1+e))}));SU.invert=EU((function(e){return 2*gB(e/2)}));var AU=kU((function(e){return(e=mB(e))&&e/fB(e)}));AU.invert=EU((function(e){return e}));function CU(e,t){return[e,lB(pB((JL+t)/2))]}CU.invert=function(e,t){return[e,2*rB(sB(t))-JL]};function DU(e){var t,n,r,i=yU(e),o=i.center,a=i.scale,s=i.translate,u=i.clipExtent,l=null;function c(){var o=QL*a(),s=i(function(e){function t(t){return(t=e(t[0]*tB,t[1]*tB))[0]*=eB,t[1]*=eB,t}return e=Jj(e[0]*tB,e[1]*tB,e.length>2?e[2]*tB:0),t.invert=function(t){return(t=e.invert(t[0]*tB,t[1]*tB))[0]*=eB,t[1]*=eB,t},t}(i.rotate()).invert([0,0]));return u(null==l?[[s[0]-o,s[1]-o],[s[0]+o,s[1]+o]]:e===CU?[[Math.max(s[0]-o,l),t],[Math.min(s[0]+o,n),r]]:[[l,Math.max(s[1]-o,t)],[n,Math.min(s[1]+o,r)]])}return i.scale=function(e){return arguments.length?(a(e),c()):a()},i.translate=function(e){return arguments.length?(s(e),c()):s()},i.center=function(e){return arguments.length?(o(e),c()):o()},i.clipExtent=function(e){return arguments.length?(null==e?l=t=n=r=null:(l=+e[0][0],t=+e[0][1],n=+e[1][0],r=+e[1][1]),c()):null==l?null:[[l,t],[n,r]]},c()}function MU(e){return pB((JL+e)/2)}function FU(e,t){var n=oB(e),r=e===t?fB(e):lB(n/oB(t))/lB(MU(t)/MU(e)),i=n*cB(MU(e),r)/r;if(!r)return CU;function o(e,t){i>0?t<-JL+YL&&(t=-JL+YL):t>JL-YL&&(t=JL-YL);var n=i/cB(MU(t),r);return[n*fB(r*e),i-n*oB(r*e)]}return o.invert=function(e,t){var n=i-t,o=dB(r)*hB(e*e+n*n),a=iB(e,nB(n))*dB(n);return n*r<0&&(a-=QL*dB(e)*dB(n)),[a/r,2*rB(cB(i/o,1/r))-JL]},o}function NU(e,t){return[e,t]}NU.invert=NU;function OU(e,t){var n=oB(e),r=e===t?fB(e):(n-oB(t))/(t-e),i=n/r+e;if(nB(r)<YL)return NU;function o(e,t){var n=i-t,o=r*e;return[n*fB(o),i-n*oB(o)]}return o.invert=function(e,t){var n=i-t,o=iB(e,nB(n))*dB(n);return n*r<0&&(o-=QL*dB(e)*dB(n)),[o/r,i-dB(r)*hB(e*e+n*n)]},o}var $U=1.340264,TU=-.081106,zU=893e-6,RU=.003796,PU=hB(3)/2;function LU(e,t){var n=gB(PU*fB(t)),r=n*n,i=r*r*r;return[e*oB(n)/(PU*($U+-.24331799999999998*r+i*(.0062510000000000005+.034164*r))),n*($U+TU*r+i*(zU+RU*r))]}LU.invert=function(e,t){for(var n,r=t,i=r*r,o=i*i*i,a=0;a<12&&(o=(i=(r-=n=(r*($U+TU*i+o*(zU+RU*i))-t)/($U+-.24331799999999998*i+o*(.0062510000000000005+.034164*i)))*r)*i*i,!(nB(n)<XL));++a);return[PU*e*($U+-.24331799999999998*i+o*(.0062510000000000005+.034164*i))/oB(r),gB(fB(r)/PU)]};function BU(e,t){var n=oB(t),r=oB(e)*n;return[n*fB(e)/r,fB(t)/r]}BU.invert=EU(rB);function IU(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),t*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}IU.invert=function(e,t){var n,r=t,i=25;do{var o=r*r,a=o*o;r-=n=(r*(1.007226+o*(.015085+a*(.028874*o-.044475-.005916*a)))-t)/(1.007226+o*(.045255+a*(.259866*o-.311325-.005916*11*a)))}while(nB(n)>YL&&--i>0);return[e/(.8707+(o=r*r)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),r]};function jU(e,t){return[oB(t)*fB(e),fB(t)]}jU.invert=EU(gB);function UU(e,t){var n=oB(t),r=1+oB(e)*n;return[n*fB(e)/r,fB(t)/r]}UU.invert=EU((function(e){return 2*rB(e)}));function qU(e,t){return[lB(pB((JL+t)/2)),-e]}qU.invert=function(e,t){return[-t,2*rB(sB(e))-JL]};var WU=Math.abs,HU=(Math.atan,Math.atan2,Math.ceil,Math.cos),VU=(Math.exp,Math.floor,Math.log,Math.max,Math.min,Math.pow,Math.round,Math.sign,Math.sin),GU=(Math.tan,Math.PI),YU=GU/2,XU=(Math.SQRT1_2,JU(2));JU(GU);function QU(e){return e>1?YU:e<-1?-YU:Math.asin(e)}function JU(e){return e>0?Math.sqrt(e):0}function KU(e,t){var n,r=e*VU(t),i=30;do{t-=n=(t+VU(t)-r)/(1+HU(t))}while(WU(n)>1e-6&&--i>0);return t/2}var ZU=function(e,t,n){function r(r,i){return[e*r*HU(i=KU(n,i)),t*VU(i)]}return r.invert=function(r,i){return i=QU(i/t),[r/(e*HU(i)),QU((2*i+VU(2*i))/n)]},r}(XU/YU,XU,GU);const eq=Lj(),tq=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function nq(e,t){return function n(){const r=t();return r.type=e,r.path=Lj().projection(r),r.copy=r.copy||function(){const e=n();return tq.forEach((t=>{r[t]&&e[t](r[t]())})),e.path.pointRadius(r.path.pointRadius()),e},r}}function rq(e,t){if(!e||"string"!=typeof e)throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(oq[e]=nq(e,t),this):oq[e]||null}function iq(e){return e&&e.path||eq}const oq={albers:_U,albersusa:function(){var e,t,n,r,i,o,a=_U(),s=wU().rotate([154,0]).center([-2,58.5]).parallels([55,65]),u=wU().rotate([157,0]).center([-3,19.9]).parallels([8,18]),l={point:function(e,t){o=[e,t]}};function c(e){var t=e[0],a=e[1];return o=null,n.point(t,a),o||(r.point(t,a),o)||(i.point(t,a),o)}function f(){return e=t=null,c}return c.invert=function(e){var t=a.scale(),n=a.translate(),r=(e[0]-n[0])/t,i=(e[1]-n[1])/t;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?s:i>=.166&&i<.234&&r>=-.214&&r<-.115?u:a).invert(e)},c.stream=function(n){return e&&t===n?e:(r=[a.stream(t=n),s.stream(n),u.stream(n)],i=r.length,e={point:function(e,t){for(var n=-1;++n<i;)r[n].point(e,t)},sphere:function(){for(var e=-1;++e<i;)r[e].sphere()},lineStart:function(){for(var e=-1;++e<i;)r[e].lineStart()},lineEnd:function(){for(var e=-1;++e<i;)r[e].lineEnd()},polygonStart:function(){for(var e=-1;++e<i;)r[e].polygonStart()},polygonEnd:function(){for(var e=-1;++e<i;)r[e].polygonEnd()}});var r,i},c.precision=function(e){return arguments.length?(a.precision(e),s.precision(e),u.precision(e),f()):a.precision()},c.scale=function(e){return arguments.length?(a.scale(e),s.scale(.35*e),u.scale(e),c.translate(a.translate())):a.scale()},c.translate=function(e){if(!arguments.length)return a.translate();var t=a.scale(),o=+e[0],c=+e[1];return n=a.translate(e).clipExtent([[o-.455*t,c-.238*t],[o+.455*t,c+.238*t]]).stream(l),r=s.translate([o-.307*t,c+.201*t]).clipExtent([[o-.425*t+YL,c+.12*t+YL],[o-.214*t-YL,c+.234*t-YL]]).stream(l),i=u.translate([o-.205*t,c+.212*t]).clipExtent([[o-.214*t+YL,c+.166*t+YL],[o-.115*t-YL,c+.234*t-YL]]).stream(l),f()},c.fitExtent=function(e,t){return lU(c,e,t)},c.fitSize=function(e,t){return cU(c,e,t)},c.fitWidth=function(e,t){return fU(c,e,t)},c.fitHeight=function(e,t){return dU(c,e,t)},c.scale(1070)},azimuthalequalarea:function(){return yU(SU).scale(124.75).clipAngle(179.999)},azimuthalequidistant:function(){return yU(AU).scale(79.4188).clipAngle(179.999)},conicconformal:function(){return bU(FU).scale(109.5).parallels([30,30])},conicequalarea:wU,conicequidistant:function(){return bU(OU).scale(131.154).center([0,13.9389])},equalEarth:function(){return yU(LU).scale(177.158)},equirectangular:function(){return yU(NU).scale(152.63)},gnomonic:function(){return yU(BU).scale(144.049).clipAngle(60)},identity:function(){var e,t,n,r,i,o,a,s=1,u=0,l=0,c=1,f=1,d=0,h=null,p=1,m=1,g=aU({point:function(e,t){var n=b([e,t]);this.stream.point(n[0],n[1])}}),y=WI;function v(){return p=s*c,m=s*f,o=a=null,b}function b(n){var r=n[0]*p,i=n[1]*m;if(d){var o=i*e-r*t;r=r*e+i*t,i=o}return[r+u,i+l]}return b.invert=function(n){var r=n[0]-u,i=n[1]-l;if(d){var o=i*e+r*t;r=r*e-i*t,i=o}return[r/p,i/m]},b.stream=function(e){return o&&a===e?o:o=g(y(a=e))},b.postclip=function(e){return arguments.length?(y=e,h=n=r=i=null,v()):y},b.clipExtent=function(e){return arguments.length?(y=null==e?(h=n=r=i=null,WI):oU(h=+e[0][0],n=+e[0][1],r=+e[1][0],i=+e[1][1]),v()):null==h?null:[[h,n],[r,i]]},b.scale=function(e){return arguments.length?(s=+e,v()):s},b.translate=function(e){return arguments.length?(u=+e[0],l=+e[1],v()):[u,l]},b.angle=function(n){return arguments.length?(t=fB(d=n%360*tB),e=oB(d),v()):d*eB},b.reflectX=function(e){return arguments.length?(c=e?-1:1,v()):c<0},b.reflectY=function(e){return arguments.length?(f=e?-1:1,v()):f<0},b.fitExtent=function(e,t){return lU(b,e,t)},b.fitSize=function(e,t){return cU(b,e,t)},b.fitWidth=function(e,t){return fU(b,e,t)},b.fitHeight=function(e,t){return dU(b,e,t)},b},mercator:function(){return DU(CU).scale(961/ZL)},mollweide:function(){return yU(ZU).scale(169.529)},naturalEarth1:function(){return yU(IU).scale(175.295)},orthographic:function(){return yU(jU).scale(249.5).clipAngle(90.000001)},stereographic:function(){return yU(UU).scale(250).clipAngle(142)},transversemercator:function(){var e=DU(qU),t=e.center,n=e.rotate;return e.center=function(e){return arguments.length?t([-e[1],e[0]]):[(e=t())[1],-e[0]]},e.rotate=function(e){return arguments.length?n([e[0],e[1],e.length>2?e[2]+90:90]):[(e=n())[0],e[1],e[2]-90]},n([0,0,90]).scale(159.155)}};for(const e in oq)rq(e,oq[e]);function aq(){}const sq=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function uq(){var e=1,t=1,n=a;function r(e,t){return t.map((t=>i(e,t)))}function i(r,i){var a=[],s=[];return function(n,r,i){var a,s,u,l,c,f,d=new Array,h=new Array;a=s=-1,l=n[0]>=r,sq[l<<1].forEach(p);for(;++a<e-1;)u=l,l=n[a+1]>=r,sq[u|l<<1].forEach(p);sq[l<<0].forEach(p);for(;++s<t-1;){for(a=-1,l=n[s*e+e]>=r,c=n[s*e]>=r,sq[l<<1|c<<2].forEach(p);++a<e-1;)u=l,l=n[s*e+e+a+1]>=r,f=c,c=n[s*e+a+1]>=r,sq[u|l<<1|c<<2|f<<3].forEach(p);sq[l|c<<3].forEach(p)}a=-1,c=n[s*e]>=r,sq[c<<2].forEach(p);for(;++a<e-1;)f=c,c=n[s*e+a+1]>=r,sq[c<<2|f<<3].forEach(p);function p(e){var t,n,r=[e[0][0]+a,e[0][1]+s],u=[e[1][0]+a,e[1][1]+s],l=o(r),c=o(u);(t=h[l])?(n=d[c])?(delete h[t.end],delete d[n.start],t===n?(t.ring.push(u),i(t.ring)):d[t.start]=h[n.end]={start:t.start,end:n.end,ring:t.ring.concat(n.ring)}):(delete h[t.end],t.ring.push(u),h[t.end=c]=t):(t=d[c])?(n=h[l])?(delete d[t.start],delete h[n.end],t===n?(t.ring.push(u),i(t.ring)):d[n.start]=h[t.end]={start:n.start,end:t.end,ring:n.ring.concat(t.ring)}):(delete d[t.start],t.ring.unshift(r),d[t.start=l]=t):d[l]=h[c]={start:l,end:c,ring:[r,u]}}sq[c<<3].forEach(p)}(r,i,(e=>{n(e,r,i),function(e){var t=0,n=e.length,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];for(;++t<n;)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r}(e)>0?a.push([e]):s.push(e)})),s.forEach((e=>{for(var t,n=0,r=a.length;n<r;++n)if(-1!==lq((t=a[n])[0],e))return void t.push(e)})),{type:"MultiPolygon",value:i,coordinates:a}}function o(t){return 2*t[0]+t[1]*(e+1)*4}function a(n,r,i){n.forEach((n=>{var o,a=n[0],s=n[1],u=0|a,l=0|s,c=r[l*e+u];a>0&&a<e&&u===a&&(o=r[l*e+u-1],n[0]=a+(i-o)/(c-o)-.5),s>0&&s<t&&l===s&&(o=r[(l-1)*e+u],n[1]=s+(i-o)/(c-o)-.5)}))}return r.contour=i,r.size=function(n){if(!arguments.length)return[e,t];var i=Math.floor(n[0]),o=Math.floor(n[1]);return i>=0&&o>=0||_g("invalid size"),e=i,t=o,r},r.smooth=function(e){return arguments.length?(n=e?a:aq,r):n===a},r}function lq(e,t){for(var n,r=-1,i=t.length;++r<i;)if(n=cq(e,t[r]))return n;return 0}function cq(e,t){for(var n=t[0],r=t[1],i=-1,o=0,a=e.length,s=a-1;o<a;s=o++){var u=e[o],l=u[0],c=u[1],f=e[s],d=f[0],h=f[1];if(fq(u,f,t))return 0;c>r!=h>r&&n<(d-l)*(r-c)/(h-c)+l&&(i=-i)}return i}function fq(e,t,n){var r,i,o,a;return function(e,t,n){return(t[0]-e[0])*(n[1]-e[1])==(n[0]-e[0])*(t[1]-e[1])}(e,t,n)&&(i=e[r=+(e[0]===t[0])],o=n[r],a=t[r],i<=o&&o<=a||a<=o&&o<=i)}function dq(e,t,n){return function(r){var i=my(r),o=n?Math.min(i[0],0):i[0],a=i[1],s=a-o,u=t?Vb(o,a,e):s/(e+1);return Bb(o+u,a,u)}}function hq(e){LE.call(this,null,e)}function pq(e,t,n,r,i){const o=e.x1||0,a=e.y1||0,s=t*n<0;function u(e){e.forEach(l)}function l(e){s&&e.reverse(),e.forEach(c)}function c(e){e[0]=(e[0]-o)*t+r,e[1]=(e[1]-a)*n+i}return function(e){return e.coordinates.forEach(u),e}}function mq(e,t,n){const r=e>=0?e:GE(t,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function gq(e){return ay(e)?e:dy(+e)}function yq(){var e=e=>e[0],t=e=>e[1],n=Dg,r=[-1,-1],i=960,o=500,a=2;function s(s,u){const l=mq(r[0],s,e)>>a,c=mq(r[1],s,t)>>a,f=l?l+2:0,d=c?c+2:0,h=2*f+(i>>a),p=2*d+(o>>a),m=new Float32Array(h*p),g=new Float32Array(h*p);let y=m;s.forEach((r=>{const i=f+(+e(r)>>a),o=d+(+t(r)>>a);i>=0&&i<h&&o>=0&&o<p&&(m[i+o*h]+=+n(r))})),l>0&&c>0?(vq(h,p,m,g,l),bq(h,p,g,m,c),vq(h,p,m,g,l),bq(h,p,g,m,c),vq(h,p,m,g,l),bq(h,p,g,m,c)):l>0?(vq(h,p,m,g,l),vq(h,p,g,m,l),vq(h,p,m,g,l),y=g):c>0&&(bq(h,p,m,g,c),bq(h,p,g,m,c),bq(h,p,m,g,c),y=g);const v=u?Math.pow(2,-2*a):1/Ib(y);for(let e=0,t=h*p;e<t;++e)y[e]*=v;return{values:y,scale:1<<a,width:h,height:p,x1:f,y1:d,x2:f+(i>>a),y2:d+(o>>a)}}return s.x=function(t){return arguments.length?(e=gq(t),s):e},s.y=function(e){return arguments.length?(t=gq(e),s):t},s.weight=function(e){return arguments.length?(n=gq(e),s):n},s.size=function(e){if(!arguments.length)return[i,o];var t=+e[0],n=+e[1];return t>=0&&n>=0||_g("invalid size"),i=t,o=n,s},s.cellSize=function(e){return arguments.length?((e=+e)>=1||_g("invalid cell size"),a=Math.floor(Math.log(e)/Math.LN2),s):1<<a},s.bandwidth=function(e){return arguments.length?(1===(e=iy(e)).length&&(e=[+e[0],+e[0]]),2!==e.length&&_g("invalid bandwidth"),r=e,s):r},s}function vq(e,t,n,r,i){const o=1+(i<<1);for(let a=0;a<t;++a)for(let t=0,s=0;t<e+i;++t)t<e&&(s+=n[t+a*e]),t>=i&&(t>=o&&(s-=n[t-o+a*e]),r[t-i+a*e]=s/Math.min(t+1,e-1+o-t,o))}function bq(e,t,n,r,i){const o=1+(i<<1);for(let a=0;a<e;++a)for(let s=0,u=0;s<t+i;++s)s<t&&(u+=n[a+s*e]),s>=i&&(s>=o&&(u-=n[a+(s-o)*e]),r[a+(s-i)*e]=u/Math.min(s+1,t-1+o-s,o))}function xq(e){LE.call(this,null,e)}hq.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]},_y(hq,LE,{transform:function(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=e.field||Ag,o=uq().smooth(!1!==e.smooth),a=e.thresholds||function(e,t,n){const r=dq(n.levels||10,n.nice,!1!==n.zero);return"shared"!==n.resolve?r:r(e.map((e=>Nb(t(e).values))))}(r,i,e),s=null===e.as?null:e.as||"contour",u=[];return r.forEach((t=>{const n=i(t),r=o.size([n.width,n.height])(n.values,$g(a)?a:a(n.values));!function(e,t,n,r){let i=r.scale||t.scale,o=r.translate||t.translate;ay(i)&&(i=i(n,r));ay(o)&&(o=o(n,r));if((1===i||null==i)&&!o)return;const a=(Cy(i)?i:i[0])||1,s=(Cy(i)?i:i[1])||1,u=o&&o[0]||0,l=o&&o[1]||0;e.forEach(pq(t,a,s,u,l))}(r,n,t,e),r.forEach((e=>{u.push(lE(t,sE(null!=s?{[s]:e}:e)))}))})),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}}),xq.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const wq=["x","y","weight","size","cellSize","bandwidth"];function _q(e,t){return wq.forEach((n=>null!=t[n]?e[n](t[n]):0)),e}function kq(e){LE.call(this,null,e)}_y(xq,LE,{transform:function(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=function(e,t){var n,r,i,o,a,s,u=[],l=e=>e(o);if(null==t)u.push(e);else for(n={},r=0,i=e.length;r<i;++r)o=e[r],(s=n[a=t.map(l)])||(n[a]=s=[],s.dims=a,u.push(s)),s.push(o);return u}(t.materialize(t.SOURCE).source,e.groupby),o=(e.groupby||[]).map(yg),a=_q(yq(),e),s=e.as||"grid";return n=i.map((t=>sE(function(e,t){for(let n=0;n<o.length;++n)e[o[n]]=t[n];return e}({[s]:a(t,e.counts)},t.dims)))),this.value&&(r.rem=this.value),this.value=r.source=r.add=n,r}}),kq.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]},_y(kq,LE,{transform:function(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n,r,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),o=uq().smooth(!1!==e.smooth),a=e.values,s=e.thresholds||dq(e.count||10,e.nice,!!a),u=e.size;return a||(a=t.materialize(t.SOURCE).source,r=pq(n=_q(yq(),e)(a,!0),n.scale||1,n.scale||1,0,0),u=[n.width,n.height],a=n.values),s=$g(s)?s:s(a),a=o.size(u)(a,s),r&&a.forEach(r),this.value&&(i.rem=this.value),this.value=i.source=i.add=(a||[]).map(sE),i}});const Eq="Feature",Sq="FeatureCollection";function Aq(e){LE.call(this,null,e)}function Cq(e){LE.call(this,null,e)}function Dq(e){LE.call(this,null,e)}function Mq(e){LE.call(this,null,e)}function Fq(e){LE.call(this,[],e),this.generator=function(){var e,t,n,r,i,o,a,s,u,l,c,f,d=10,h=d,p=90,m=360,g=2.5;function y(){return{type:"MultiLineString",coordinates:v()}}function v(){return Bb(aB(r/p)*p,n,p).map(c).concat(Bb(aB(s/m)*m,a,m).map(f)).concat(Bb(aB(t/d)*d,e,d).filter((function(e){return nB(e%p)>YL})).map(u)).concat(Bb(aB(o/h)*h,i,h).filter((function(e){return nB(e%m)>YL})).map(l))}return y.lines=function(){return v().map((function(e){return{type:"LineString",coordinates:e}}))},y.outline=function(){return{type:"Polygon",coordinates:[c(r).concat(f(a).slice(1),c(n).reverse().slice(1),f(s).reverse().slice(1))]}},y.extent=function(e){return arguments.length?y.extentMajor(e).extentMinor(e):y.extentMinor()},y.extentMajor=function(e){return arguments.length?(r=+e[0][0],n=+e[1][0],s=+e[0][1],a=+e[1][1],r>n&&(e=r,r=n,n=e),s>a&&(e=s,s=a,a=e),y.precision(g)):[[r,s],[n,a]]},y.extentMinor=function(n){return arguments.length?(t=+n[0][0],e=+n[1][0],o=+n[0][1],i=+n[1][1],t>e&&(n=t,t=e,e=n),o>i&&(n=o,o=i,i=n),y.precision(g)):[[t,o],[e,i]]},y.step=function(e){return arguments.length?y.stepMajor(e).stepMinor(e):y.stepMinor()},y.stepMajor=function(e){return arguments.length?(p=+e[0],m=+e[1],y):[p,m]},y.stepMinor=function(e){return arguments.length?(d=+e[0],h=+e[1],y):[d,h]},y.precision=function(d){return arguments.length?(g=+d,u=LI(o,i,90),l=BI(t,e,g),c=LI(s,a,90),f=BI(r,n,g),y):g},y.extentMajor([[-180,-89.999999],[180,89.999999]]).extentMinor([[-180,-80.000001],[180,80.000001]])}()}function Nq(e){LE.call(this,null,e)}function Oq(e){if(!ay(e))return!1;const t=Uy(vg(e));return t.$x||t.$y||t.$value||t.$max}function $q(e){LE.call(this,null,e),this.modified(!0)}function Tq(e,t,n){ay(e[t])&&e[t](n)}Aq.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]},_y(Aq,LE,{transform:function(e,t){var n,r=this._features,i=this._points,o=e.fields,a=o&&o[0],s=o&&o[1],u=e.geojson||!o&&Ag,l=t.ADD;n=e.modified()||t.changed(t.REM)||t.modified(vg(u))||a&&t.modified(vg(a))||s&&t.modified(vg(s)),this.value&&!n||(l=t.SOURCE,this._features=r=[],this._points=i=[]),u&&t.visit(l,(e=>r.push(u(e)))),a&&s&&(t.visit(l,(e=>{var t=a(e),n=s(e);null!=t&&null!=n&&(t=+t)===t&&(n=+n)===n&&i.push([t,n])})),r=r.concat({type:Eq,geometry:{type:"MultiPoint",coordinates:i}})),this.value={type:Sq,features:r}}}),Cq.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]},_y(Cq,LE,{transform:function(e,t){var n=t.fork(t.ALL),r=this.value,i=e.field||Ag,o=e.as||"path",a=n.SOURCE;!r||e.modified()?(this.value=r=iq(e.projection),n.materialize().reflow()):a=i===Ag||t.modified(i.fields)?n.ADD_MOD:n.ADD;const s=function(e,t){const n=e.pointRadius();e.context(null),null!=t&&e.pointRadius(t);return n}(r,e.pointRadius);return n.visit(a,(e=>e[o]=r(i(e)))),r.pointRadius(s),n.modifies(o)}}),Dq.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]},_y(Dq,LE,{transform:function(e,t){var n,r=e.projection,i=e.fields[0],o=e.fields[1],a=e.as||["x","y"],s=a[0],u=a[1];function l(e){const t=r([i(e),o(e)]);t?(e[s]=t[0],e[u]=t[1]):(e[s]=void 0,e[u]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,l):(n=t.modified(i.fields)||t.modified(o.fields),t.visit(n?t.ADD_MOD:t.ADD,l)),t.modifies(a)}}),Mq.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]},_y(Mq,LE,{transform:function(e,t){var n=t.fork(t.ALL),r=this.value,i=e.as||"shape",o=n.ADD;return r&&!e.modified()||(this.value=r=function(e,t,n){const r=null==n?n=>e(t(n)):r=>{var i=e.pointRadius(),o=e.pointRadius(n)(t(r));return e.pointRadius(i),o};return r.context=t=>(e.context(t),r),r}(iq(e.projection),e.field||Eg("datum"),e.pointRadius),n.materialize().reflow(),o=n.SOURCE),n.visit(o,(e=>e[i]=r)),n.modifies(i)}}),Fq.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]},_y(Fq,LE,{transform:function(e,t){var n,r=this.value,i=this.generator;if(!r.length||e.modified())for(const t in e)ay(i[t])&&i[t](e[t]);return n=i(),r.length?t.mod.push(cE(r[0],n)):t.add.push(sE(n)),r[0]=n,t}}),Nq.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]},_y(Nq,LE,{transform:function(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,r="shared"===e.resolve,i=e.field||Ag,o=function(e,t){let n;ay(e)?(n=n=>e(n,t),n.dep=Oq(e)):e?n=dy(e):(n=e=>e.$value/e.$max||0,n.dep=!0);return n}(e.opacity,e),a=function(e,t){let n;ay(e)?(n=n=>JD(e(n,t)),n.dep=Oq(e)):n=dy(JD(e||"#888"));return n}(e.color,e),s=e.as||"image",u={$x:0,$y:0,$value:0,$max:r?Nb(n.map((e=>Nb(i(e).values)))):0};return n.forEach((e=>{const t=i(e),n=py({},e,u);r||(n.$max=Nb(t.values||[])),e[s]=function(e,t,n,r){const i=e.width,o=e.height,a=e.x1||0,s=e.y1||0,u=e.x2||i,l=e.y2||o,c=e.values,f=c?e=>c[e]:Cg,d=AD(u-a,l-s),h=d.getContext("2d"),p=h.getImageData(0,0,u-a,l-s),m=p.data;for(let e=s,o=0;e<l;++e){t.$y=e-s;for(let s=a,l=e*i;s<u;++s,o+=4){t.$x=s-a,t.$value=f(s+l);const e=n(t);m[o+0]=e.r,m[o+1]=e.g,m[o+2]=e.b,m[o+3]=~~(255*r(t))}}return h.putImageData(p,0,0),d}(t,n,a.dep?a:dy(a(n)),o.dep?o:dy(o(n)))})),t.reflow(!0).modifies(s)}}),_y($q,LE,{transform:function(e,t){let n=this.value;return!n||e.modified("type")?(this.value=n=function(e){const t=rq((e||"mercator").toLowerCase());t||_g("Unrecognized projection type: "+e);return t()}(e.type),tq.forEach((t=>{null!=e[t]&&Tq(n,t,e[t])}))):tq.forEach((t=>{e.modified(t)&&Tq(n,t,e[t])})),null!=e.pointRadius&&n.path.pointRadius(e.pointRadius),e.fit&&function(e,t){const n=function(e){return 1===(e=iy(e)).length?e[0]:{type:Sq,features:e.reduce(((e,t)=>e.concat(function(e){return e.type===Sq?e.features:iy(e).filter((e=>null!=e)).map((e=>e.type===Eq?e:{type:Eq,geometry:e}))}(t))),[])}}(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}}),t(GL,"projection",(function(){return $q})),t(GL,"kde2d",(function(){return xq})),t(GL,"isocontour",(function(){return hq})),t(GL,"heatmap",(function(){return Nq})),t(GL,"graticule",(function(){return Fq})),t(GL,"geoshape",(function(){return Mq})),t(GL,"geopoint",(function(){return Dq})),t(GL,"geopath",(function(){return Cq})),t(GL,"geojson",(function(){return Aq})),t(GL,"contour",(function(){return kq}));var zq={};function Rq(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,o,a,s,u,l,c,f,d,h=e._root,p={data:r},m=e._x0,g=e._y0,y=e._x1,v=e._y1;if(!h)return e._root=p,e;for(;h.length;)if((l=t>=(o=(m+y)/2))?m=o:y=o,(c=n>=(a=(g+v)/2))?g=a:v=a,i=h,!(h=h[f=c<<1|l]))return i[f]=p,e;if(s=+e._x.call(null,h.data),u=+e._y.call(null,h.data),t===s&&n===u)return p.next=h,i?i[f]=p:e._root=p,e;do{i=i?i[f]=new Array(4):e._root=new Array(4),(l=t>=(o=(m+y)/2))?m=o:y=o,(c=n>=(a=(g+v)/2))?g=a:v=a}while((f=c<<1|l)==(d=(u>=a)<<1|s>=o));return i[d]=h,i[f]=p,e}var Pq=function(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i};function Lq(e){return e[0]}function Bq(e){return e[1]}function Iq(e,t,n){var r=new jq(null==t?Lq:t,null==n?Bq:n,NaN,NaN,NaN,NaN);return null==e?r:r.addAll(e)}function jq(e,t,n,r,i,o){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function Uq(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var qq=Iq.prototype=jq.prototype;qq.copy=function(){var e,t,n=new jq(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=Uq(r),n;for(e=[{source:r,target:n._root=new Array(4)}];r=e.pop();)for(var i=0;i<4;++i)(t=r.source[i])&&(t.length?e.push({source:t,target:r.target[i]=new Array(4)}):r.target[i]=Uq(t));return n},qq.add=function(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return Rq(this.cover(t,n),t,n,e)},qq.addAll=function(e){var t,n,r,i,o=e.length,a=new Array(o),s=new Array(o),u=1/0,l=1/0,c=-1/0,f=-1/0;for(n=0;n<o;++n)isNaN(r=+this._x.call(null,t=e[n]))||isNaN(i=+this._y.call(null,t))||(a[n]=r,s[n]=i,r<u&&(u=r),r>c&&(c=r),i<l&&(l=i),i>f&&(f=i));if(u>c||l>f)return this;for(this.cover(u,l).cover(c,f),n=0;n<o;++n)Rq(this,a[n],s[n],e[n]);return this},qq.cover=function(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,o=(r=Math.floor(t))+1;else{for(var a,s,u=i-n||1,l=this._root;n>e||e>=i||r>t||t>=o;)switch(s=(t<r)<<1|e<n,(a=new Array(4))[s]=l,l=a,u*=2,s){case 0:i=n+u,o=r+u;break;case 1:n=i-u,o=r+u;break;case 2:i=n+u,r=o-u;break;case 3:n=i-u,r=o-u}this._root&&this._root.length&&(this._root=l)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this},qq.data=function(){var e=[];return this.visit((function(t){if(!t.length)do{e.push(t.data)}while(t=t.next)})),e},qq.extent=function(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},qq.find=function(e,t,n){var r,i,o,a,s,u,l,c=this._x0,f=this._y0,d=this._x1,h=this._y1,p=[],m=this._root;for(m&&p.push(new Pq(m,c,f,d,h)),null==n?n=1/0:(c=e-n,f=t-n,d=e+n,h=t+n,n*=n);u=p.pop();)if(!(!(m=u.node)||(i=u.x0)>d||(o=u.y0)>h||(a=u.x1)<c||(s=u.y1)<f))if(m.length){var g=(i+a)/2,y=(o+s)/2;p.push(new Pq(m[3],g,y,a,s),new Pq(m[2],i,y,g,s),new Pq(m[1],g,o,a,y),new Pq(m[0],i,o,g,y)),(l=(t>=y)<<1|e>=g)&&(u=p[p.length-1],p[p.length-1]=p[p.length-1-l],p[p.length-1-l]=u)}else{var v=e-+this._x.call(null,m.data),b=t-+this._y.call(null,m.data),x=v*v+b*b;if(x<n){var w=Math.sqrt(n=x);c=e-w,f=t-w,d=e+w,h=t+w,r=m.data}}return r},qq.remove=function(e){if(isNaN(o=+this._x.call(null,e))||isNaN(a=+this._y.call(null,e)))return this;var t,n,r,i,o,a,s,u,l,c,f,d,h=this._root,p=this._x0,m=this._y0,g=this._x1,y=this._y1;if(!h)return this;if(h.length)for(;;){if((l=o>=(s=(p+g)/2))?p=s:g=s,(c=a>=(u=(m+y)/2))?m=u:y=u,t=h,!(h=h[f=c<<1|l]))return this;if(!h.length)break;(t[f+1&3]||t[f+2&3]||t[f+3&3])&&(n=t,d=f)}for(;h.data!==e;)if(r=h,!(h=h.next))return this;return(i=h.next)&&delete h.next,r?(i?r.next=i:delete r.next,this):t?(i?t[f]=i:delete t[f],(h=t[0]||t[1]||t[2]||t[3])&&h===(t[3]||t[2]||t[1]||t[0])&&!h.length&&(n?n[d]=h:this._root=h),this):(this._root=i,this)},qq.removeAll=function(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this},qq.root=function(){return this._root},qq.size=function(){var e=0;return this.visit((function(t){if(!t.length)do{++e}while(t=t.next)})),e},qq.visit=function(e){var t,n,r,i,o,a,s=[],u=this._root;for(u&&s.push(new Pq(u,this._x0,this._y0,this._x1,this._y1));t=s.pop();)if(!e(u=t.node,r=t.x0,i=t.y0,o=t.x1,a=t.y1)&&u.length){var l=(r+o)/2,c=(i+a)/2;(n=u[3])&&s.push(new Pq(n,l,c,o,a)),(n=u[2])&&s.push(new Pq(n,r,c,l,a)),(n=u[1])&&s.push(new Pq(n,l,i,o,c)),(n=u[0])&&s.push(new Pq(n,r,i,l,c))}return this},qq.visitAfter=function(e){var t,n=[],r=[];for(this._root&&n.push(new Pq(this._root,this._x0,this._y0,this._x1,this._y1));t=n.pop();){var i=t.node;if(i.length){var o,a=t.x0,s=t.y0,u=t.x1,l=t.y1,c=(a+u)/2,f=(s+l)/2;(o=i[0])&&n.push(new Pq(o,a,s,c,f)),(o=i[1])&&n.push(new Pq(o,c,s,u,f)),(o=i[2])&&n.push(new Pq(o,a,f,c,l)),(o=i[3])&&n.push(new Pq(o,c,f,u,l))}r.push(t)}for(;t=r.pop();)e(t.node,t.x0,t.y0,t.x1,t.y1);return this},qq.x=function(e){return arguments.length?(this._x=e,this):this._x},qq.y=function(e){return arguments.length?(this._y=e,this):this._y};var Wq=function(e){return function(){return e}},Hq=function(e){return 1e-6*(e()-.5)};function Vq(e){return e.x+e.vx}function Gq(e){return e.y+e.vy}function Yq(e){return e.index}function Xq(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}var Qq={value:()=>{}};function Jq(){for(var e,t=0,n=arguments.length,r={};t<n;++t){if(!(e=arguments[t]+"")||e in r||/[\s.]/.test(e))throw new Error("illegal type: "+e);r[e]=[]}return new Kq(r)}function Kq(e){this._=e}function Zq(e,t){return e.trim().split(/^|\s+/).map((function(e){var n="",r=e.indexOf(".");if(r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}}))}function eW(e,t){for(var n,r=0,i=e.length;r<i;++r)if((n=e[r]).name===t)return n.value}function tW(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=Qq,e=e.slice(0,r).concat(e.slice(r+1));break}return null!=n&&e.push({name:t,value:n}),e}Kq.prototype=Jq.prototype={constructor:Kq,on:function(e,t){var n,r=this._,i=Zq(e+"",r),o=-1,a=i.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++o<a;)if(n=(e=i[o]).type)r[n]=tW(r[n],e.name,t);else if(null==t)for(n in r)r[n]=tW(r[n],e.name,null);return this}for(;++o<a;)if((n=(e=i[o]).type)&&(n=eW(r[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Kq(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=0,n=(r=this._[e]).length;o<n;++o)r[o].value.apply(t,i)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,o=r.length;i<o;++i)r[i].value.apply(t,n)}};var nW,rW,iW=0,oW=0,aW=0,sW=0,uW=0,lW=0,cW="object"==typeof performance&&performance.now?performance:Date,fW="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function dW(){return uW||(fW(hW),uW=cW.now()+lW)}function hW(){uW=0}function pW(){this._call=this._time=this._next=null}function mW(e,t,n){var r=new pW;return r.restart(e,t,n),r}function gW(){uW=(sW=cW.now())+lW,iW=oW=0;try{!function(){dW(),++iW;for(var e,t=nW;t;)(e=uW-t._time)>=0&&t._call.call(null,e),t=t._next;--iW}()}finally{iW=0,function(){var e,t,n=nW,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:nW=t);rW=e,vW(r)}(),uW=0}}function yW(){var e=cW.now(),t=e-sW;t>1e3&&(lW-=t,sW=e)}function vW(e){iW||(oW&&(oW=clearTimeout(oW)),e-uW>24?(e<1/0&&(oW=setTimeout(gW,e-cW.now()-lW)),aW&&(aW=clearInterval(aW))):(aW||(sW=cW.now(),aW=setInterval(yW,1e3)),iW=1,fW(gW)))}pW.prototype=mW.prototype={constructor:pW,restart:function(e,t,n){if("function"!=typeof e)throw new TypeError("callback is not a function");n=(null==n?dW():+n)+(null==t?0:+t),this._next||rW===this||(rW?rW._next=this:nW=this,rW=this),this._call=e,this._time=n,vW()},stop:function(){this._call&&(this._call=null,this._time=1/0,vW())}};const bW=4294967296;function xW(e){return e.x}function wW(e){return e.y}var _W=Math.PI*(3-Math.sqrt(5)),kW=function(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),o=0,a=.6,s=new Map,u=mW(f),l=Jq("tick","end"),c=function(){let e=1;return()=>(e=(1664525*e+1013904223)%bW)/bW}();function f(){d(),l.call("tick",t),n<r&&(u.stop(),l.call("end",t))}function d(r){var u,l,c=e.length;void 0===r&&(r=1);for(var f=0;f<r;++f)for(n+=(o-n)*i,s.forEach((function(e){e(n)})),u=0;u<c;++u)null==(l=e[u]).fx?l.x+=l.vx*=a:(l.x=l.fx,l.vx=0),null==l.fy?l.y+=l.vy*=a:(l.y=l.fy,l.vy=0);return t}function h(){for(var t,n=0,r=e.length;n<r;++n){if((t=e[n]).index=n,null!=t.fx&&(t.x=t.fx),null!=t.fy&&(t.y=t.fy),isNaN(t.x)||isNaN(t.y)){var i=10*Math.sqrt(.5+n),o=n*_W;t.x=i*Math.cos(o),t.y=i*Math.sin(o)}(isNaN(t.vx)||isNaN(t.vy))&&(t.vx=t.vy=0)}}function p(t){return t.initialize&&t.initialize(e,c),t}return null==e&&(e=[]),h(),t={tick:d,restart:function(){return u.restart(f),t},stop:function(){return u.stop(),t},nodes:function(n){return arguments.length?(e=n,h(),s.forEach(p),t):e},alpha:function(e){return arguments.length?(n=+e,t):n},alphaMin:function(e){return arguments.length?(r=+e,t):r},alphaDecay:function(e){return arguments.length?(i=+e,t):+i},alphaTarget:function(e){return arguments.length?(o=+e,t):o},velocityDecay:function(e){return arguments.length?(a=1-e,t):1-a},randomSource:function(e){return arguments.length?(c=e,s.forEach(p),t):c},force:function(e,n){return arguments.length>1?(null==n?s.delete(e):s.set(e,p(n)),t):s.get(e)},find:function(t,n,r){var i,o,a,s,u,l=0,c=e.length;for(null==r?r=1/0:r*=r,l=0;l<c;++l)(a=(i=t-(s=e[l]).x)*i+(o=n-s.y)*o)<r&&(u=s,r=a);return u},on:function(e,n){return arguments.length>1?(l.on(e,n),t):l.on(e)}}};const EW={center:function(e,t){var n,r=1;function i(){var i,o,a=n.length,s=0,u=0;for(i=0;i<a;++i)s+=(o=n[i]).x,u+=o.y;for(s=(s/a-e)*r,u=(u/a-t)*r,i=0;i<a;++i)(o=n[i]).x-=s,o.y-=u}return null==e&&(e=0),null==t&&(t=0),i.initialize=function(e){n=e},i.x=function(t){return arguments.length?(e=+t,i):e},i.y=function(e){return arguments.length?(t=+e,i):t},i.strength=function(e){return arguments.length?(r=+e,i):r},i},collide:function(e){var t,n,r,i=1,o=1;function a(){for(var e,a,u,l,c,f,d,h=t.length,p=0;p<o;++p)for(a=Iq(t,Vq,Gq).visitAfter(s),e=0;e<h;++e)u=t[e],f=n[u.index],d=f*f,l=u.x+u.vx,c=u.y+u.vy,a.visit(m);function m(e,t,n,o,a){var s=e.data,h=e.r,p=f+h;if(!s)return t>l+p||o<l-p||n>c+p||a<c-p;if(s.index>u.index){var m=l-s.x-s.vx,g=c-s.y-s.vy,y=m*m+g*g;y<p*p&&(0===m&&(y+=(m=Hq(r))*m),0===g&&(y+=(g=Hq(r))*g),y=(p-(y=Math.sqrt(y)))/y*i,u.vx+=(m*=y)*(p=(h*=h)/(d+h)),u.vy+=(g*=y)*p,s.vx-=m*(p=1-p),s.vy-=g*p)}}}function s(e){if(e.data)return e.r=n[e.data.index];for(var t=e.r=0;t<4;++t)e[t]&&e[t].r>e.r&&(e.r=e[t].r)}function u(){if(t){var r,i,o=t.length;for(n=new Array(o),r=0;r<o;++r)i=t[r],n[i.index]=+e(i,r,t)}}return"function"!=typeof e&&(e=Wq(null==e?1:+e)),a.initialize=function(e,n){t=e,r=n,u()},a.iterations=function(e){return arguments.length?(o=+e,a):o},a.strength=function(e){return arguments.length?(i=+e,a):i},a.radius=function(t){return arguments.length?(e="function"==typeof t?t:Wq(+t),u(),a):e},a},nbody:function(){var e,t,n,r,i,o=Wq(-30),a=1,s=1/0,u=.81;function l(n){var i,o=e.length,a=Iq(e,xW,wW).visitAfter(f);for(r=n,i=0;i<o;++i)t=e[i],a.visit(d)}function c(){if(e){var t,n,r=e.length;for(i=new Array(r),t=0;t<r;++t)n=e[t],i[n.index]=+o(n,t,e)}}function f(e){var t,n,r,o,a,s=0,u=0;if(e.length){for(r=o=a=0;a<4;++a)(t=e[a])&&(n=Math.abs(t.value))&&(s+=t.value,u+=n,r+=n*t.x,o+=n*t.y);e.x=r/u,e.y=o/u}else{(t=e).x=t.data.x,t.y=t.data.y;do{s+=i[t.data.index]}while(t=t.next)}e.value=s}function d(e,o,l,c){if(!e.value)return!0;var f=e.x-t.x,d=e.y-t.y,h=c-o,p=f*f+d*d;if(h*h/u<p)return p<s&&(0===f&&(p+=(f=Hq(n))*f),0===d&&(p+=(d=Hq(n))*d),p<a&&(p=Math.sqrt(a*p)),t.vx+=f*e.value*r/p,t.vy+=d*e.value*r/p),!0;if(!(e.length||p>=s)){(e.data!==t||e.next)&&(0===f&&(p+=(f=Hq(n))*f),0===d&&(p+=(d=Hq(n))*d),p<a&&(p=Math.sqrt(a*p)));do{e.data!==t&&(h=i[e.data.index]*r/p,t.vx+=f*h,t.vy+=d*h)}while(e=e.next)}}return l.initialize=function(t,r){e=t,n=r,c()},l.strength=function(e){return arguments.length?(o="function"==typeof e?e:Wq(+e),c(),l):o},l.distanceMin=function(e){return arguments.length?(a=e*e,l):Math.sqrt(a)},l.distanceMax=function(e){return arguments.length?(s=e*e,l):Math.sqrt(s)},l.theta=function(e){return arguments.length?(u=e*e,l):Math.sqrt(u)},l},link:function(e){var t,n,r,i,o,a,s=Yq,u=function(e){return 1/Math.min(i[e.source.index],i[e.target.index])},l=Wq(30),c=1;function f(r){for(var i=0,s=e.length;i<c;++i)for(var u,l,f,d,h,p,m,g=0;g<s;++g)l=(u=e[g]).source,d=(f=u.target).x+f.vx-l.x-l.vx||Hq(a),h=f.y+f.vy-l.y-l.vy||Hq(a),d*=p=((p=Math.sqrt(d*d+h*h))-n[g])/p*r*t[g],h*=p,f.vx-=d*(m=o[g]),f.vy-=h*m,l.vx+=d*(m=1-m),l.vy+=h*m}function d(){if(r){var a,u,l=r.length,c=e.length,f=new Map(r.map(((e,t)=>[s(e,t,r),e])));for(a=0,i=new Array(l);a<c;++a)(u=e[a]).index=a,"object"!=typeof u.source&&(u.source=Xq(f,u.source)),"object"!=typeof u.target&&(u.target=Xq(f,u.target)),i[u.source.index]=(i[u.source.index]||0)+1,i[u.target.index]=(i[u.target.index]||0)+1;for(a=0,o=new Array(c);a<c;++a)u=e[a],o[a]=i[u.source.index]/(i[u.source.index]+i[u.target.index]);t=new Array(c),h(),n=new Array(c),p()}}function h(){if(r)for(var n=0,i=e.length;n<i;++n)t[n]=+u(e[n],n,e)}function p(){if(r)for(var t=0,i=e.length;t<i;++t)n[t]=+l(e[t],t,e)}return null==e&&(e=[]),f.initialize=function(e,t){r=e,a=t,d()},f.links=function(t){return arguments.length?(e=t,d(),f):e},f.id=function(e){return arguments.length?(s=e,f):s},f.iterations=function(e){return arguments.length?(c=+e,f):c},f.strength=function(e){return arguments.length?(u="function"==typeof e?e:Wq(+e),h(),f):u},f.distance=function(e){return arguments.length?(l="function"==typeof e?e:Wq(+e),p(),f):l},f},x:function(e){var t,n,r,i=Wq(.1);function o(e){for(var i,o=0,a=t.length;o<a;++o)(i=t[o]).vx+=(r[o]-i.x)*n[o]*e}function a(){if(t){var o,a=t.length;for(n=new Array(a),r=new Array(a),o=0;o<a;++o)n[o]=isNaN(r[o]=+e(t[o],o,t))?0:+i(t[o],o,t)}}return"function"!=typeof e&&(e=Wq(null==e?0:+e)),o.initialize=function(e){t=e,a()},o.strength=function(e){return arguments.length?(i="function"==typeof e?e:Wq(+e),a(),o):i},o.x=function(t){return arguments.length?(e="function"==typeof t?t:Wq(+t),a(),o):e},o},y:function(e){var t,n,r,i=Wq(.1);function o(e){for(var i,o=0,a=t.length;o<a;++o)(i=t[o]).vy+=(r[o]-i.y)*n[o]*e}function a(){if(t){var o,a=t.length;for(n=new Array(a),r=new Array(a),o=0;o<a;++o)n[o]=isNaN(r[o]=+e(t[o],o,t))?0:+i(t[o],o,t)}}return"function"!=typeof e&&(e=Wq(null==e?0:+e)),o.initialize=function(e){t=e,a()},o.strength=function(e){return arguments.length?(i="function"==typeof e?e:Wq(+e),a(),o):i},o.y=function(t){return arguments.length?(e="function"==typeof t?t:Wq(+t),a(),o):e},o}},SW="forces",AW=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],CW=["static","iterations"],DW=["x","y","vx","vy"];function MW(e){LE.call(this,null,e)}function FW(e,t,n,r){var i,o,a,s,u=iy(t.forces);for(i=0,o=AW.length;i<o;++i)(a=AW[i])!==SW&&t.modified(a)&&e[a](t[a]);for(i=0,o=u.length;i<o;++i)s=SW+i,(a=n||t.modified(SW,i)?OW(u[i]):r&&NW(u[i],r)?e.force(s):null)&&e.force(s,a);for(o=e.numForces||0;i<o;++i)e.force(SW+i,null);return e.numForces=u.length,e}function NW(e,t){var n,r;for(n in e)if(ay(r=e[n])&&t.modified(vg(r)))return 1;return 0}function OW(e){var t,n;for(n in vy(EW,e.force)||_g("Unrecognized force: "+e.force),t=EW[e.force](),e)ay(t[n])&&$W(t[n],e[n],e);return t}function $W(e,t,n){e(ay(t)?e=>t(e,n):t)}MW.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:DW}]},_y(MW,LE,{transform:function(e,t){var n,r,i=this.value,o=t.changed(t.ADD_REM),a=e.modified(AW),s=e.iterations||300;if(i?(o&&(t.modifies("index"),i.nodes(t.source)),(a||t.changed(t.MOD))&&FW(i,e,0,t)):(this.value=i=function(e,t){const n=kW(e),r=n.stop,i=n.restart;let o=!1;return n.stopped=()=>o,n.restart=()=>(o=!1,i()),n.stop=()=>(o=!0,r()),FW(n,t,!0).on("end",(()=>o=!0))}(t.source,e),i.on("tick",(n=t.dataflow,r=this,()=>n.touch(r).run())),e.static||(o=!0,i.tick()),t.modifies("index")),a||o||e.modified(CW)||t.changed()&&e.restart)if(i.alpha(Math.max(i.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(i.alphaMin(),1/s)),e.static)for(i.stop();--s>=0;)i.tick();else if(i.stopped()&&i.restart(),!o)return t.StopPropagation;return this.finish(e,t)},finish:function(e,t){const n=t.dataflow;for(let e,t=this._argops,s=0,u=t.length;s<u;++s)if(e=t[s],e.name===SW&&"link"===e.op._argval.force)for(var r,i=e.op._argops,o=0,a=i.length;o<a;++o)if("links"===i[o].name&&(r=i[o].op.source)){n.pulse(r,n.changeset().reflow());break}return t.reflow(e.modified()).modifies(DW)}}),t(zq,"force",(function(){return MW}));var TW={};function zW(e,t){return e.parent===t.parent?1:2}function RW(e,t){return e+t.x}function PW(e,t){return Math.max(e,t.y)}function LW(e){var t=0,n=e.children,r=n&&n.length;if(r)for(;--r>=0;)t+=n[r].value;else t=1;e.value=t}function BW(e,t){e instanceof Map?(e=[void 0,e],void 0===t&&(t=jW)):void 0===t&&(t=IW);for(var n,r,i,o,a,s=new WW(e),u=[s];n=u.pop();)if((i=t(n.data))&&(a=(i=Array.from(i)).length))for(n.children=i,o=a-1;o>=0;--o)u.push(r=i[o]=new WW(i[o])),r.parent=n,r.depth=n.depth+1;return s.eachBefore(qW)}function IW(e){return e.children}function jW(e){return Array.isArray(e)?e[1]:null}function UW(e){void 0!==e.data.value&&(e.value=e.data.value),e.data=e.data.data}function qW(e){var t=0;do{e.height=t}while((e=e.parent)&&e.height<++t)}function WW(e){this.data=e,this.depth=this.height=0,this.parent=null}WW.prototype=BW.prototype={constructor:WW,count:function(){return this.eachAfter(LW)},each:function(e,t){let n=-1;for(const r of this)e.call(t,r,++n,this);return this},eachAfter:function(e,t){for(var n,r,i,o=this,a=[o],s=[],u=-1;o=a.pop();)if(s.push(o),n=o.children)for(r=0,i=n.length;r<i;++r)a.push(n[r]);for(;o=s.pop();)e.call(t,o,++u,this);return this},eachBefore:function(e,t){for(var n,r,i=this,o=[i],a=-1;i=o.pop();)if(e.call(t,i,++a,this),n=i.children)for(r=n.length-1;r>=0;--r)o.push(n[r]);return this},find:function(e,t){let n=-1;for(const r of this)if(e.call(t,r,++n,this))return r},sum:function(e){return this.eachAfter((function(t){for(var n=+e(t.data)||0,r=t.children,i=r&&r.length;--i>=0;)n+=r[i].value;t.value=n}))},sort:function(e){return this.eachBefore((function(t){t.children&&t.children.sort(e)}))},path:function(e){for(var t=this,n=function(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),i=null;e=n.pop(),t=r.pop();for(;e===t;)i=e,e=n.pop(),t=r.pop();return i}(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var i=r.length;e!==n;)r.splice(i,0,e),e=e.parent;return r},ancestors:function(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t},descendants:function(){return Array.from(this)},leaves:function(){var e=[];return this.eachBefore((function(t){t.children||e.push(t)})),e},links:function(){var e=this,t=[];return e.each((function(n){n!==e&&t.push({source:n.parent,target:n})})),t},copy:function(){return BW(this).eachBefore(UW)},[Symbol.iterator]:function*(){var e,t,n,r,i=this,o=[i];do{for(e=o.reverse(),o=[];i=e.pop();)if(yield i,t=i.children)for(n=0,r=t.length;n<r;++n)o.push(t[n])}while(o.length)}};var HW=function(e){for(var t,n,r=0,i=(e=function(e){for(var t,n,r=e.length;r;)n=Math.random()*r--|0,t=e[r],e[r]=e[n],e[n]=t;return e}(Array.from(e))).length,o=[];r<i;)t=e[r],n&&YW(n,t)?++r:(n=QW(o=VW(o,t)),r=0);return n};function VW(e,t){var n,r;if(XW(t,e))return[t];for(n=0;n<e.length;++n)if(GW(t,e[n])&&XW(JW(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(r=n+1;r<e.length;++r)if(GW(JW(e[n],e[r]),t)&&GW(JW(e[n],t),e[r])&&GW(JW(e[r],t),e[n])&&XW(KW(e[n],e[r],t),e))return[e[n],e[r],t];throw new Error}function GW(e,t){var n=e.r-t.r,r=t.x-e.x,i=t.y-e.y;return n<0||n*n<r*r+i*i}function YW(e,t){var n=e.r-t.r+1e-9*Math.max(e.r,t.r,1),r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function XW(e,t){for(var n=0;n<t.length;++n)if(!YW(e,t[n]))return!1;return!0}function QW(e){switch(e.length){case 1:return{x:(t=e[0]).x,y:t.y,r:t.r};case 2:return JW(e[0],e[1]);case 3:return KW(e[0],e[1],e[2])}var t}function JW(e,t){var n=e.x,r=e.y,i=e.r,o=t.x,a=t.y,s=t.r,u=o-n,l=a-r,c=s-i,f=Math.sqrt(u*u+l*l);return{x:(n+o+u/f*c)/2,y:(r+a+l/f*c)/2,r:(f+i+s)/2}}function KW(e,t,n){var r=e.x,i=e.y,o=e.r,a=t.x,s=t.y,u=t.r,l=n.x,c=n.y,f=n.r,d=r-a,h=r-l,p=i-s,m=i-c,g=u-o,y=f-o,v=r*r+i*i-o*o,b=v-a*a-s*s+u*u,x=v-l*l-c*c+f*f,w=h*p-d*m,_=(p*x-m*b)/(2*w)-r,k=(m*g-p*y)/w,E=(h*b-d*x)/(2*w)-i,S=(d*y-h*g)/w,A=k*k+S*S-1,C=2*(o+_*k+E*S),D=_*_+E*E-o*o,M=-(A?(C+Math.sqrt(C*C-4*A*D))/(2*A):D/C);return{x:r+_+k*M,y:i+E+S*M,r:M}}function ZW(e,t,n){var r,i,o,a,s=e.x-t.x,u=e.y-t.y,l=s*s+u*u;l?(i=t.r+n.r,i*=i,a=e.r+n.r,i>(a*=a)?(r=(l+a-i)/(2*l),o=Math.sqrt(Math.max(0,a/l-r*r)),n.x=e.x-r*s-o*u,n.y=e.y-r*u+o*s):(r=(l+i-a)/(2*l),o=Math.sqrt(Math.max(0,i/l-r*r)),n.x=t.x+r*s-o*u,n.y=t.y+r*u+o*s)):(n.x=t.x+n.r,n.y=t.y)}function eH(e,t){var n=e.r+t.r-1e-6,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function tH(e){var t=e._,n=e.next._,r=t.r+n.r,i=(t.x*n.r+n.x*t.r)/r,o=(t.y*n.r+n.y*t.r)/r;return i*i+o*o}function nH(e){this._=e,this.next=null,this.previous=null}function rH(e){if(!(o=(t=e,e="object"==typeof t&&"length"in t?t:Array.from(t)).length))return 0;var t,n,r,i,o,a,s,u,l,c,f,d;if((n=e[0]).x=0,n.y=0,!(o>1))return n.r;if(r=e[1],n.x=-r.r,r.x=n.r,r.y=0,!(o>2))return n.r+r.r;ZW(r,n,i=e[2]),n=new nH(n),r=new nH(r),i=new nH(i),n.next=i.previous=r,r.next=n.previous=i,i.next=r.previous=n;e:for(u=3;u<o;++u){ZW(n._,r._,i=e[u]),i=new nH(i),l=r.next,c=n.previous,f=r._.r,d=n._.r;do{if(f<=d){if(eH(l._,i._)){r=l,n.next=r,r.previous=n,--u;continue e}f+=l._.r,l=l.next}else{if(eH(c._,i._)){(n=c).next=r,r.previous=n,--u;continue e}d+=c._.r,c=c.previous}}while(l!==c.next);for(i.previous=n,i.next=r,n.next=r.previous=r=i,a=tH(n);(i=i.next)!==r;)(s=tH(i))<a&&(n=i,a=s);r=n.next}for(n=[r._],i=r;(i=i.next)!==r;)n.push(i._);for(i=HW(n),u=0;u<o;++u)(n=e[u]).x-=i.x,n.y-=i.y;return i.r}function iH(e){return null==e?null:oH(e)}function oH(e){if("function"!=typeof e)throw new Error;return e}function aH(){return 0}var sH=function(e){return function(){return e}};function uH(e){return Math.sqrt(e.value)}function lH(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function cH(e,t){return function(n){if(r=n.children){var r,i,o,a=r.length,s=e(n)*t||0;if(s)for(i=0;i<a;++i)r[i].r+=s;if(o=rH(r),s)for(i=0;i<a;++i)r[i].r-=s;n.r=o+s}}}function fH(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}var dH=function(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)},hH=function(e,t,n,r,i){for(var o,a=e.children,s=-1,u=a.length,l=e.value&&(r-t)/e.value;++s<u;)(o=a[s]).y0=n,o.y1=i,o.x0=t,o.x1=t+=o.value*l},pH={depth:-1},mH={};function gH(e){return e.id}function yH(e){return e.parentId}var vH=function(){var e=gH,t=yH;function n(n){var r,i,o,a,s,u,l,c=Array.from(n),f=c.length,d=new Map;for(i=0;i<f;++i)r=c[i],s=c[i]=new WW(r),null!=(u=e(r,i,n))&&(u+="")&&(l=s.id=u,d.set(l,d.has(l)?mH:s)),null!=(u=t(r,i,n))&&(u+="")&&(s.parent=u);for(i=0;i<f;++i)if(u=(s=c[i]).parent){if(!(a=d.get(u)))throw new Error("missing: "+u);if(a===mH)throw new Error("ambiguous: "+u);a.children?a.children.push(s):a.children=[s],s.parent=a}else{if(o)throw new Error("multiple roots");o=s}if(!o)throw new Error("no root");if(o.parent=pH,o.eachBefore((function(e){e.depth=e.parent.depth+1,--f})).eachBefore(qW),o.parent=null,f>0)throw new Error("cycle");return o}return n.id=function(t){return arguments.length?(e=oH(t),n):e},n.parentId=function(e){return arguments.length?(t=oH(e),n):t},n};function bH(e,t){return e.parent===t.parent?1:2}function xH(e){var t=e.children;return t?t[0]:e.t}function wH(e){var t=e.children;return t?t[t.length-1]:e.t}function _H(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function kH(e,t,n){return e.a.parent===t.parent?e.a:n}function EH(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}EH.prototype=Object.create(WW.prototype);var SH=function(e,t,n,r,i){for(var o,a=e.children,s=-1,u=a.length,l=e.value&&(i-n)/e.value;++s<u;)(o=a[s]).x0=t,o.x1=r,o.y0=n,o.y1=n+=o.value*l},AH=(1+Math.sqrt(5))/2;function CH(e,t,n,r,i,o){for(var a,s,u,l,c,f,d,h,p,m,g,y=[],v=t.children,b=0,x=0,w=v.length,_=t.value;b<w;){u=i-n,l=o-r;do{c=v[x++].value}while(!c&&x<w);for(f=d=c,g=c*c*(m=Math.max(l/u,u/l)/(_*e)),p=Math.max(d/g,g/f);x<w;++x){if(c+=s=v[x].value,s<f&&(f=s),s>d&&(d=s),g=c*c*m,(h=Math.max(d/g,g/f))>p){c-=s;break}p=h}y.push(a={value:c,dice:u<l,children:v.slice(b,x)}),a.dice?hH(a,n,r,i,_?r+=l*c/_:o):SH(a,n,r,_?n+=u*c/_:i,o),_-=c,b=x}return y}var DH=function e(t){function n(e,n,r,i,o){CH(t,e,n,r,i,o)}return n.ratio=function(t){return e((t=+t)>1?t:1)},n}(AH),MH=function e(t){function n(e,n,r,i,o){if((a=e._squarify)&&a.ratio===t)for(var a,s,u,l,c,f=-1,d=a.length,h=e.value;++f<d;){for(u=(s=a[f]).children,l=s.value=0,c=u.length;l<c;++l)s.value+=u[l].value;s.dice?hH(s,n,r,i,h?r+=(o-r)*s.value/h:o):SH(s,n,r,h?n+=(i-n)*s.value/h:i,o),h-=s.value}else e._squarify=a=CH(t,e,n,r,i,o),a.ratio=t}return n.ratio=function(t){return e((t=+t)>1?t:1)},n}(AH);function FH(e,t,n){const r={};return e.each((e=>{const i=e.data;n(i)&&(r[t(i)]=e)})),e.lookup=r,e}function NH(e){LE.call(this,null,e)}NH.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const OH=e=>e.values;function $H(){const e=[],t={entries:e=>r(n(e,0),0),key:n=>(e.push(n),t)};function n(t,r){if(r>=e.length)return t;const i=t.length,o=e[r++],a={},s={};let u,l,c,f=-1;for(;++f<i;)u=o(l=t[f])+"",(c=a[u])?c.push(l):a[u]=[l];for(u in a)s[u]=n(a[u],r);return s}function r(t,n){if(++n>e.length)return t;const i=[];for(const e in t)i.push({key:e,values:r(t[e],n)});return i}return t}function TH(e){LE.call(this,null,e)}_y(NH,LE,{transform:function(e,t){t.source||_g("Nest transform requires an upstream data source.");var n=e.generate,r=e.modified(),i=t.clone(),o=this.value;return(!o||r||t.changed())&&(o&&o.each((e=>{e.children&&iE(e.data)&&i.rem.push(e.data)})),this.value=o=BW({values:iy(e.keys).reduce(((e,t)=>(e.key(t),e)),$H()).entries(i.source)},OH),n&&o.each((e=>{e.children&&(e=sE(e.data),i.add.push(e),i.source.push(e))})),FH(o,oE,oE)),i.source.root=o,i}});const zH=(e,t)=>e.parent===t.parent?1:2;_y(TH,LE,{transform:function(e,t){t.source&&t.source.root||_g(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(e.method),r=this.fields,i=t.source.root,o=e.as||r;e.field?i.sum(e.field):i.count(),e.sort&&i.sort(fE(e.sort,(e=>e.data))),function(e,t,n){for(let r,i=0,o=t.length;i<o;++i)r=t[i],r in n&&e[r](n[r])}(n,this.params,e),n.separation&&n.separation(!1!==e.separation?zH:Dg);try{this.value=n(i)}catch(e){_g(e)}return i.each((e=>function(e,t,n){const r=e.data,i=t.length-1;for(let o=0;o<i;++o)r[n[o]]=e[t[o]];r[n[i]]=e.children?e.children.length:0}(e,r,o))),t.reflow(e.modified()).modifies(o).modifies("leaf")}});const RH=["x","y","r","depth","children"];function PH(e){TH.call(this,e)}PH.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:RH.length,default:RH}]},_y(PH,TH,{layout:function(){var e=null,t=1,n=1,r=aH;function i(i){return i.x=t/2,i.y=n/2,e?i.eachBefore(lH(e)).eachAfter(cH(r,.5)).eachBefore(fH(1)):i.eachBefore(lH(uH)).eachAfter(cH(aH,1)).eachAfter(cH(r,i.r/Math.min(t,n))).eachBefore(fH(Math.min(t,n)/(2*i.r))),i}return i.radius=function(t){return arguments.length?(e=iH(t),i):e},i.size=function(e){return arguments.length?(t=+e[0],n=+e[1],i):[t,n]},i.padding=function(e){return arguments.length?(r="function"==typeof e?e:sH(+e),i):r},i},params:["radius","size","padding"],fields:RH});const LH=["x0","y0","x1","y1","depth","children"];function BH(e){TH.call(this,e)}function IH(e){LE.call(this,null,e)}BH.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:LH.length,default:LH}]},_y(BH,TH,{layout:function(){var e=1,t=1,n=0,r=!1;function i(i){var o=i.height+1;return i.x0=i.y0=n,i.x1=e,i.y1=t/o,i.eachBefore(function(e,t){return function(r){r.children&&hH(r,r.x0,e*(r.depth+1)/t,r.x1,e*(r.depth+2)/t);var i=r.x0,o=r.y0,a=r.x1-n,s=r.y1-n;a<i&&(i=a=(i+a)/2),s<o&&(o=s=(o+s)/2),r.x0=i,r.y0=o,r.x1=a,r.y1=s}}(t,o)),r&&i.eachBefore(dH),i}return i.round=function(e){return arguments.length?(r=!!e,i):r},i.size=function(n){return arguments.length?(e=+n[0],t=+n[1],i):[e,t]},i.padding=function(e){return arguments.length?(n=+e,i):n},i},params:["size","round","padding"],fields:LH}),IH.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]},_y(IH,LE,{transform:function(e,t){t.source||_g("Stratify transform requires an upstream data source.");let n=this.value;const r=e.modified(),i=t.fork(t.ALL).materialize(t.SOURCE),o=!n||r||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return i.source=i.source.slice(),o&&(n=i.source.length?FH(vH().id(e.key).parentId(e.parentKey)(i.source),e.key,Mg):FH(vH()([{}]),e.key,e.key)),i.source.root=this.value=n,i}});const jH={tidy:function(){var e=bH,t=1,n=1,r=null;function i(i){var u=function(e){for(var t,n,r,i,o,a=new EH(e,0),s=[a];t=s.pop();)if(r=t._.children)for(t.children=new Array(o=r.length),i=o-1;i>=0;--i)s.push(n=t.children[i]=new EH(r[i],i)),n.parent=t;return(a.parent=new EH(null,0)).children=[a],a}(i);if(u.eachAfter(o),u.parent.m=-u.z,u.eachBefore(a),r)i.eachBefore(s);else{var l=i,c=i,f=i;i.eachBefore((function(e){e.x<l.x&&(l=e),e.x>c.x&&(c=e),e.depth>f.depth&&(f=e)}));var d=l===c?1:e(l,c)/2,h=d-l.x,p=t/(c.x+d+h),m=n/(f.depth||1);i.eachBefore((function(e){e.x=(e.x+h)*p,e.y=e.depth*m}))}return i}function o(t){var n=t.children,r=t.parent.children,i=t.i?r[t.i-1]:null;if(n){!function(e){for(var t,n=0,r=0,i=e.children,o=i.length;--o>=0;)(t=i[o]).z+=n,t.m+=n,n+=t.s+(r+=t.c)}(t);var o=(n[0].z+n[n.length-1].z)/2;i?(t.z=i.z+e(t._,i._),t.m=t.z-o):t.z=o}else i&&(t.z=i.z+e(t._,i._));t.parent.A=function(t,n,r){if(n){for(var i,o=t,a=t,s=n,u=o.parent.children[0],l=o.m,c=a.m,f=s.m,d=u.m;s=wH(s),o=xH(o),s&&o;)u=xH(u),(a=wH(a)).a=t,(i=s.z+f-o.z-l+e(s._,o._))>0&&(_H(kH(s,t,r),t,i),l+=i,c+=i),f+=s.m,l+=o.m,d+=u.m,c+=a.m;s&&!wH(a)&&(a.t=s,a.m+=f-c),o&&!xH(u)&&(u.t=o,u.m+=l-d,r=t)}return r}(t,i,t.parent.A||r[0])}function a(e){e._.x=e.z+e.parent.m,e.m+=e.parent.m}function s(e){e.x*=t,e.y=e.depth*n}return i.separation=function(t){return arguments.length?(e=t,i):e},i.size=function(e){return arguments.length?(r=!1,t=+e[0],n=+e[1],i):r?null:[t,n]},i.nodeSize=function(e){return arguments.length?(r=!0,t=+e[0],n=+e[1],i):r?[t,n]:null},i},cluster:function(){var e=zW,t=1,n=1,r=!1;function i(i){var o,a=0;i.eachAfter((function(t){var n=t.children;n?(t.x=function(e){return e.reduce(RW,0)/e.length}(n),t.y=function(e){return 1+e.reduce(PW,0)}(n)):(t.x=o?a+=e(t,o):0,t.y=0,o=t)}));var s=function(e){for(var t;t=e.children;)e=t[0];return e}(i),u=function(e){for(var t;t=e.children;)e=t[t.length-1];return e}(i),l=s.x-e(s,u)/2,c=u.x+e(u,s)/2;return i.eachAfter(r?function(e){e.x=(e.x-i.x)*t,e.y=(i.y-e.y)*n}:function(e){e.x=(e.x-l)/(c-l)*t,e.y=(1-(i.y?e.y/i.y:1))*n})}return i.separation=function(t){return arguments.length?(e=t,i):e},i.size=function(e){return arguments.length?(r=!1,t=+e[0],n=+e[1],i):r?null:[t,n]},i.nodeSize=function(e){return arguments.length?(r=!0,t=+e[0],n=+e[1],i):r?[t,n]:null},i}},UH=["x","y","depth","children"];function qH(e){TH.call(this,e)}function WH(e){LE.call(this,[],e)}qH.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:UH.length,default:UH}]},_y(qH,TH,{layout:function(e){const t=e||"tidy";if(vy(jH,t))return jH[t]();_g("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:UH}),WH.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]},_y(WH,LE,{transform:function(e,t){const n=this.value,r=t.source&&t.source.root,i=t.fork(t.NO_SOURCE),o={};return r||_g("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(i.rem=n,t.visit(t.SOURCE,(e=>o[oE(e)]=1)),r.each((e=>{const t=e.data,n=e.parent&&e.parent.data;n&&o[oE(t)]&&o[oE(n)]&&i.add.push(sE({source:n,target:t}))})),this.value=i.add):t.changed(t.MOD)&&(t.visit(t.MOD,(e=>o[oE(e)]=1)),n.forEach((e=>{(o[oE(e.source)]||o[oE(e.target)])&&i.mod.push(e)}))),i}});const HH={binary:function(e,t,n,r,i){var o,a,s=e.children,u=s.length,l=new Array(u+1);for(l[0]=a=o=0;o<u;++o)l[o+1]=a+=s[o].value;!function e(t,n,r,i,o,a,u){if(t>=n-1){var c=s[t];return c.x0=i,c.y0=o,c.x1=a,void(c.y1=u)}var f=l[t],d=r/2+f,h=t+1,p=n-1;for(;h<p;){var m=h+p>>>1;l[m]<d?h=m+1:p=m}d-l[h-1]<l[h]-d&&t+1<h&&--h;var g=l[h]-f,y=r-g;if(a-i>u-o){var v=r?(i*y+a*g)/r:a;e(t,h,g,i,o,v,u),e(h,n,y,v,o,a,u)}else{var b=r?(o*y+u*g)/r:u;e(t,h,g,i,o,a,b),e(h,n,y,i,b,a,u)}}(0,u,e.value,t,n,r,i)},dice:hH,slice:SH,slicedice:function(e,t,n,r,i){(1&e.depth?SH:hH)(e,t,n,r,i)},squarify:DH,resquarify:MH},VH=["x0","y0","x1","y1","depth","children"];function GH(e){TH.call(this,e)}GH.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:VH.length,default:VH}]},_y(GH,TH,{layout:function(){const e=function(){var e=DH,t=!1,n=1,r=1,i=[0],o=aH,a=aH,s=aH,u=aH,l=aH;function c(e){return e.x0=e.y0=0,e.x1=n,e.y1=r,e.eachBefore(f),i=[0],t&&e.eachBefore(dH),e}function f(t){var n=i[t.depth],r=t.x0+n,c=t.y0+n,f=t.x1-n,d=t.y1-n;f<r&&(r=f=(r+f)/2),d<c&&(c=d=(c+d)/2),t.x0=r,t.y0=c,t.x1=f,t.y1=d,t.children&&(n=i[t.depth+1]=o(t)/2,r+=l(t)-n,c+=a(t)-n,(f-=s(t)-n)<r&&(r=f=(r+f)/2),(d-=u(t)-n)<c&&(c=d=(c+d)/2),e(t,r,c,f,d))}return c.round=function(e){return arguments.length?(t=!!e,c):t},c.size=function(e){return arguments.length?(n=+e[0],r=+e[1],c):[n,r]},c.tile=function(t){return arguments.length?(e=oH(t),c):e},c.padding=function(e){return arguments.length?c.paddingInner(e).paddingOuter(e):c.paddingInner()},c.paddingInner=function(e){return arguments.length?(o="function"==typeof e?e:sH(+e),c):o},c.paddingOuter=function(e){return arguments.length?c.paddingTop(e).paddingRight(e).paddingBottom(e).paddingLeft(e):c.paddingTop()},c.paddingTop=function(e){return arguments.length?(a="function"==typeof e?e:sH(+e),c):a},c.paddingRight=function(e){return arguments.length?(s="function"==typeof e?e:sH(+e),c):s},c.paddingBottom=function(e){return arguments.length?(u="function"==typeof e?e:sH(+e),c):u},c.paddingLeft=function(e){return arguments.length?(l="function"==typeof e?e:sH(+e),c):l},c}();return e.ratio=t=>{const n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=t=>{vy(HH,t)?e.tile(HH[t]):_g("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:VH}),t(TW,"treemap",(function(){return GH})),t(TW,"treelinks",(function(){return WH})),t(TW,"tree",(function(){return qH})),t(TW,"stratify",(function(){return IH})),t(TW,"partition",(function(){return BH})),t(TW,"pack",(function(){return PH})),t(TW,"nest",(function(){return NH}));var YH={};function XH(e,t,n,r){const i=e.width,o=e.height,a=n||r,s=AD(i,o).getContext("2d");t.forEach((e=>QH(s,e,a)));const u=new Uint32Array(s.getImageData(0,0,i,o).data.buffer),l=e.bitmap(),c=a&&e.bitmap();let f,d,h,p,m;for(d=0;d<o;++d)for(f=0;f<i;++f)m=4278190080&u[d*i+f],m&&(h=e(f),p=e(d),r||l.set(h,p),a&&268435456^m&&c.set(h,p));return[l,c]}function QH(e,t,n){if(!t.length)return;const r=t[0].mark.marktype;"group"===r?t.forEach((t=>{t.items.forEach((t=>QH(e,t.items,n)))})):wz[r].draw(e,{items:n?t.map(JH):t})}function JH(e){const t=lE(e,{});return t.stroke&&(t.strokeOpacity=1),t.fill&&(t.fillOpacity=.0625,t.stroke="#000",t.strokeOpacity=1,t.strokeWidth=2),t}const KH=31,ZH=new Uint32Array(33),eV=new Uint32Array(33);eV[0]=0,ZH[0]=~eV[0];for(let e=1;e<=32;++e)eV[e]=eV[e-1]<<1|1,ZH[e]=~eV[e];function tV(e,t,n){const r=Math.max(1,Math.sqrt(e*t/1e6)),i=~~((e+2*n+r)/r),o=~~((t+2*n+r)/r),a=e=>~~((e+n)/r);return a.invert=e=>e*r-n,a.bitmap=()=>function(e,t){const n=new Uint32Array(~~((e*t+32)/32));function r(e,t){n[e]|=t}function i(e,t){n[e]&=t}return{array:n,get:(t,r)=>{const i=r*e+t;return n[i>>>5]&1<<(i&KH)},set:(t,n)=>{const i=n*e+t;r(i>>>5,1<<(i&KH))},clear:(t,n)=>{const r=n*e+t;i(r>>>5,~(1<<(r&KH)))},getRange:(t,r,i,o)=>{let a,s,u,l,c=o;for(;c>=r;--c)if(a=c*e+t,s=c*e+i,u=a>>>5,l=s>>>5,u===l){if(n[u]&ZH[a&KH]&eV[1+(s&KH)])return!0}else{if(n[u]&ZH[a&KH])return!0;if(n[l]&eV[1+(s&KH)])return!0;for(let e=u+1;e<l;++e)if(n[e])return!0}return!1},setRange:(t,n,i,o)=>{let a,s,u,l,c;for(;n<=o;++n)if(a=n*e+t,s=n*e+i,u=a>>>5,l=s>>>5,u===l)r(u,ZH[a&KH]&eV[1+(s&KH)]);else for(r(u,ZH[a&KH]),r(l,eV[1+(s&KH)]),c=u+1;c<l;++c)r(c,4294967295)},clearRange:(t,n,r,o)=>{let a,s,u,l,c;for(;n<=o;++n)if(a=n*e+t,s=n*e+r,u=a>>>5,l=s>>>5,u===l)i(u,eV[a&KH]|ZH[1+(s&KH)]);else for(i(u,eV[a&KH]),i(l,ZH[1+(s&KH)]),c=u+1;c<l;++c)i(c,0)},outOfBounds:(n,r,i,o)=>n<0||r<0||o>=t||i>=e}}(i,o),a.ratio=r,a.padding=n,a.width=e,a.height=t,a}function nV(e,t,n,r,i,o){let a=n/2;return e-a<0||e+a>i||t-(a=r/2)<0||t+a>o}function rV(e,t,n,r,i,o,a,s){const u=i*o/(2*r),l=e(t-u),c=e(t+u),f=e(n-(o/=2)),d=e(n+o);return a.outOfBounds(l,f,c,d)||a.getRange(l,f,c,d)||s&&s.getRange(l,f,c,d)}const iV=[-1,-1,1,1],oV=[-1,1,-1,1];const aV=["right","center","left"],sV=["bottom","middle","top"];function uV(e,t,n,r,i,o,a,s,u,l,c,f){return!(i.outOfBounds(e,n,t,r)||(f&&o?o.getRange(e,n,t,r)||!function(e,t,n,r,i){return i[0]<=e&&n<=i[2]&&i[3]<=t&&r<=i[5]}(a,u,s,l,c):i.getRange(e,n,t,r)))}const lV={"top-left":0,top:1,"top-right":2,left:4,middle:5,right:6,"bottom-left":8,bottom:9,"bottom-right":10},cV={naive:function(e,t,n,r){const i=e.width,o=e.height;return function(e){const t=e.datum.datum.items[r].items,n=t.length,a=e.datum.fontSize,s=rz.width(e.datum,e.datum.text);let u,l,c,f,d,h,p,m=0;for(let r=0;r<n;++r)u=t[r].x,c=t[r].y,l=void 0===t[r].x2?u:t[r].x2,f=void 0===t[r].y2?c:t[r].y2,d=(u+l)/2,h=(c+f)/2,p=Math.abs(l-u+f-c),p>=m&&(m=p,e.x=d,e.y=h);return d=s/2,h=a/2,u=e.x-d,l=e.x+d,c=e.y-h,f=e.y+h,e.align="center",u<0&&l<=i?e.align="left":0<=u&&i<l&&(e.align="right"),e.baseline="middle",c<0&&f<=o?e.baseline="top":0<=c&&o<f&&(e.baseline="bottom"),!0}},"reduced-search":function(e,t,n,r){const i=e.width,o=e.height,a=t[0],s=t[1];function u(t,n,r,u,l){const c=e.invert(t),f=e.invert(n);let d,h=r,p=o;if(!nV(c,f,u,l,i,o)&&!rV(e,c,f,l,u,h,a,s)&&!rV(e,c,f,l,u,l,a,null)){for(;p-h>=1;)d=(h+p)/2,rV(e,c,f,l,u,d,a,s)?p=d:h=d;if(h>r)return[c,f,h,!0]}}return function(t){const s=t.datum.datum.items[r].items,l=s.length,c=t.datum.fontSize,f=rz.width(t.datum,t.datum.text);let d,h,p,m,g,y,v,b,x,w,_,k,E,S,A,C,D,M=n?c:0,F=!1,N=!1,O=0;for(let r=0;r<l;++r){for(d=s[r].x,p=s[r].y,h=void 0===s[r].x2?d:s[r].x2,m=void 0===s[r].y2?p:s[r].y2,d>h&&(D=d,d=h,h=D),p>m&&(D=p,p=m,m=D),x=e(d),_=e(h),w=~~((x+_)/2),k=e(p),S=e(m),E=~~((k+S)/2),v=w;v>=x;--v)for(b=E;b>=k;--b)C=u(v,b,M,f,c),C&&([t.x,t.y,M,F]=C);for(v=w;v<=_;++v)for(b=E;b<=S;++b)C=u(v,b,M,f,c),C&&([t.x,t.y,M,F]=C);F||n||(A=Math.abs(h-d+m-p),g=(d+h)/2,y=(p+m)/2,A>=O&&!nV(g,y,f,c,i,o)&&!rV(e,g,y,c,f,c,a,null)&&(O=A,t.x=g,t.y=y,N=!0))}return!(!F&&!N)&&(g=f/2,y=c/2,a.setRange(e(t.x-g),e(t.y-y),e(t.x+g),e(t.y+y)),t.align="center",t.baseline="middle",!0)}},floodfill:function(e,t,n,r){const i=e.width,o=e.height,a=t[0],s=t[1],u=e.bitmap();return function(t){const l=t.datum.datum.items[r].items,c=l.length,f=t.datum.fontSize,d=rz.width(t.datum,t.datum.text),h=[];let p,m,g,y,v,b,x,w,_,k,E,S,A=n?f:0,C=!1,D=!1,M=0;for(let r=0;r<c;++r){for(p=l[r].x,g=l[r].y,m=void 0===l[r].x2?p:l[r].x2,y=void 0===l[r].y2?g:l[r].y2,h.push([e((p+m)/2),e((g+y)/2)]);h.length;)if([x,w]=h.pop(),!(a.get(x,w)||s.get(x,w)||u.get(x,w))){u.set(x,w);for(let e=0;e<4;++e)v=x+iV[e],b=w+oV[e],u.outOfBounds(v,b,v,b)||h.push([v,b]);if(v=e.invert(x),b=e.invert(w),_=A,k=o,!nV(v,b,d,f,i,o)&&!rV(e,v,b,f,d,_,a,s)&&!rV(e,v,b,f,d,f,a,null)){for(;k-_>=1;)E=(_+k)/2,rV(e,v,b,f,d,E,a,s)?k=E:_=E;_>A&&(t.x=v,t.y=b,A=_,C=!0)}}C||n||(S=Math.abs(m-p+y-g),v=(p+m)/2,b=(g+y)/2,S>=M&&!nV(v,b,d,f,i,o)&&!rV(e,v,b,f,d,f,a,null)&&(M=S,t.x=v,t.y=b,D=!0))}return!(!C&&!D)&&(v=d/2,b=f/2,a.setRange(e(t.x-v),e(t.y-b),e(t.x+v),e(t.y+b)),t.align="center",t.baseline="middle",!0)}}};function fV(e,t,n,r,i,o,a,s,u,l,c){if(!e.length)return e;const f=Math.max(r.length,i.length),d=function(e,t){const n=new Float64Array(t),r=e.length;for(let t=0;t<r;++t)n[t]=e[t]||0;for(let e=r;e<t;++e)n[e]=n[r-1];return n}(r,f),h=function(e,t){const n=new Int8Array(t),r=e.length;for(let t=0;t<r;++t)n[t]|=lV[e[t]];for(let e=r;e<t;++e)n[e]=n[r-1];return n}(i,f),p=(x=e[0].datum)&&x.mark&&x.mark.marktype,m="group"===p&&e[0].datum.items[u].marktype,g="area"===m,y=function(e,t,n,r){const i=e=>[e.x,e.x,e.x,e.y,e.y,e.y];return e?"line"===e||"area"===e?e=>i(e.datum):"line"===t?e=>{const t=e.datum.items[r].items;return i(t.length?t["start"===n?0:t.length-1]:{x:NaN,y:NaN})}:e=>{const t=e.datum.bounds;return[t.x1,(t.x1+t.x2)/2,t.x2,t.y1,(t.y1+t.y2)/2,t.y2]}:i}(p,m,s,u),v=tV(t[0],t[1],l),b=g&&"naive"===c;var x;const w=e.map((e=>({datum:e,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:y(e)})));let _;if(!b){n&&w.sort(((e,t)=>n(e.datum,t.datum)));let t=!1;for(let e=0;e<h.length&&!t;++e)t=5===h[e]||d[e]<0;p&&(a||g)&&(o=[e.map((e=>e.datum))].concat(o)),_=o.length?XH(v,o,t,g):function(e,t){const n=e.bitmap();return(t||[]).forEach((t=>n.set(e(t.boundary[0]),e(t.boundary[3])))),[n,void 0]}(v,a&&w)}const k=g?cV[c](v,_,a,u):function(e,t,n,r){const i=e.width,o=e.height,a=t[0],s=t[1],u=r.length;return function(t){const l=t.boundary,c=t.datum.fontSize;if(l[2]<0||l[5]<0||l[0]>i||l[3]>o)return!1;let f,d,h,p,m,g,y,v,b,x,w,_,k,E,S,A=0;for(let i=0;i<u;++i){if(f=(3&n[i])-1,d=(n[i]>>>2&3)-1,h=0===f&&0===d||r[i]<0,p=f&&d?Math.SQRT1_2:1,m=r[i]<0?-1:1,g=l[1+f]+r[i]*f*p,w=l[4+d]+m*c*d/2+r[i]*d*p,v=w-c/2,b=w+c/2,_=e(g),E=e(v),S=e(b),!A){if(!uV(_,_,E,S,a,s,g,g,v,b,l,h))continue;A=rz.width(t.datum,t.datum.text)}if(x=g+m*A*f/2,g=x-A/2,y=x+A/2,_=e(g),k=e(y),uV(_,k,E,S,a,s,g,y,v,b,l,h))return t.x=f?f*m<0?y:g:x,t.y=d?d*m<0?b:v:w,t.align=aV[f*m+1],t.baseline=sV[d*m+1],a.setRange(_,E,k,S),!0}return!1}}(v,_,h,d);return w.forEach((e=>e.opacity=+k(e))),w}const dV=["x","y","opacity","align","baseline"],hV=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function pV(e){LE.call(this,null,e)}pV.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:hV},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:dV.length,default:dV}]},_y(pV,LE,{transform:function(e,t){const n=e.modified();if(!(n||t.changed(t.ADD_REM)||function(n){const r=e[n];return ay(r)&&t.modified(r.fields)}("sort")))return;e.size&&2===e.size.length||_g("Size parameter should be specified as a [width, height] array.");const r=e.as||dV;return fV(t.materialize(t.SOURCE).source,e.size,e.sort,iy(e.offset||1),iy(e.anchor||hV),e.avoidMarks||[],!1!==e.avoidBaseMark,e.lineAnchor||"end",e.markIndex||0,e.padding||0,e.method||"naive").forEach((e=>{const t=e.datum;t[r[0]]=e.x,t[r[1]]=e.y,t[r[2]]=e.opacity,t[r[3]]=e.align,t[r[4]]=e.baseline})),t.reflow(n).modifies(r)}}),t(YH,"label",(function(){return pV}));var mV={};function gV(e,t){var n,r,i,o,a,s,u=[],l=function(e){return e(o)};if(null==t)u.push(e);else for(n={},r=0,i=e.length;r<i;++r)o=e[r],(s=n[a=t.map(l)])||(n[a]=s=[],s.dims=a,u.push(s)),s.push(o);return u}function yV(e){LE.call(this,null,e)}yV.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]},_y(yV,LE,{transform:function(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=gV(t.materialize(t.SOURCE).source,e.groupby),i=(e.groupby||[]).map(yg),o=i.length,a=e.as||[yg(e.x),yg(e.y)],s=[];r.forEach((t=>{OS(t,e.x,e.y,e.bandwidth||.3).forEach((e=>{const n={};for(let e=0;e<o;++e)n[i[e]]=t.dims[e];n[a[0]]=e[0],n[a[1]]=e[1],s.push(sE(n))}))})),this.value&&(n.rem=this.value),this.value=n.add=n.source=s}return n}});const vV={linear:SS,log:AS,exp:CS,pow:DS,quad:MS,poly:FS};function bV(e){LE.call(this,null,e)}bV.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(vV)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]},_y(bV,LE,{transform:function(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=gV(t.materialize(t.SOURCE).source,e.groupby),i=(e.groupby||[]).map(yg),o=e.method||"linear",a=e.order||3,s=((e,t)=>"poly"===e?t:"quad"===e?2:1)(o,a),u=e.as||[yg(e.x),yg(e.y)],l=vV[o],c=[];let f=e.extent;vy(vV,o)||_g("Invalid regression method: "+o),null!=f&&"log"===o&&f[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),f=null),r.forEach((n=>{if(n.length<=s)return void t.dataflow.warn("Skipping regression with more parameters than data points.");const r=l(n,e.x,e.y,a);if(e.params)return void c.push(sE({keys:n.dims,coef:r.coef,rSquared:r.rSquared}));const d=f||my(n,e.x),h=e=>{const t={};for(let e=0;e<i.length;++e)t[i[e]]=n.dims[e];t[u[0]]=e[0],t[u[1]]=e[1],c.push(sE(t))};"linear"===o?d.forEach((e=>h([e,r.predict(e)]))):RS(r.predict,d,25,200).forEach(h)})),this.value&&(n.rem=this.value),this.value=n.add=n.source=c}return n}}),t(mV,"regression",(function(){return bV})),t(mV,"loess",(function(){return yV}));var xV={};const wV=Math.pow(2,-52),_V=new Uint32Array(512);class kV{static from(e,t=NV,n=OV){const r=e.length,i=new Float64Array(2*r);for(let o=0;o<r;o++){const r=e[o];i[2*o]=t(r),i[2*o+1]=n(r)}return new kV(i)}constructor(e){const t=e.length>>1;if(t>0&&"number"!=typeof e[0])throw new Error("Expected coords to contain numbers.");this.coords=e;const n=Math.max(2*t-5,0);this._triangles=new Uint32Array(3*n),this._halfedges=new Int32Array(3*n),this._hashSize=Math.ceil(Math.sqrt(t)),this._hullPrev=new Uint32Array(t),this._hullNext=new Uint32Array(t),this._hullTri=new Uint32Array(t),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(t),this._dists=new Float64Array(t),this.update()}update(){const{coords:e,_hullPrev:t,_hullNext:n,_hullTri:r,_hullHash:i}=this,o=e.length>>1;let a=1/0,s=1/0,u=-1/0,l=-1/0;for(let t=0;t<o;t++){const n=e[2*t],r=e[2*t+1];n<a&&(a=n),r<s&&(s=r),n>u&&(u=n),r>l&&(l=r),this._ids[t]=t}const c=(a+u)/2,f=(s+l)/2;let d,h,p,m=1/0;for(let t=0;t<o;t++){const n=EV(c,f,e[2*t],e[2*t+1]);n<m&&(d=t,m=n)}const g=e[2*d],y=e[2*d+1];m=1/0;for(let t=0;t<o;t++){if(t===d)continue;const n=EV(g,y,e[2*t],e[2*t+1]);n<m&&n>0&&(h=t,m=n)}let v=e[2*h],b=e[2*h+1],x=1/0;for(let t=0;t<o;t++){if(t===d||t===h)continue;const n=DV(g,y,v,b,e[2*t],e[2*t+1]);n<x&&(p=t,x=n)}let w=e[2*p],_=e[2*p+1];if(x===1/0){for(let t=0;t<o;t++)this._dists[t]=e[2*t]-e[0]||e[2*t+1]-e[1];MV(this._ids,this._dists,0,o-1);const t=new Uint32Array(o);let n=0;for(let e=0,r=-1/0;e<o;e++){const i=this._ids[e];this._dists[i]>r&&(t[n++]=i,r=this._dists[i])}return this.hull=t.subarray(0,n),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(AV(g,y,v,b,w,_)){const e=h,t=v,n=b;h=p,v=w,b=_,p=e,w=t,_=n}const k=function(e,t,n,r,i,o){const a=n-e,s=r-t,u=i-e,l=o-t,c=a*a+s*s,f=u*u+l*l,d=.5/(a*l-s*u);return{x:e+(l*c-s*f)*d,y:t+(a*f-u*c)*d}}(g,y,v,b,w,_);this._cx=k.x,this._cy=k.y;for(let t=0;t<o;t++)this._dists[t]=EV(e[2*t],e[2*t+1],k.x,k.y);MV(this._ids,this._dists,0,o-1),this._hullStart=d;let E=3;n[d]=t[p]=h,n[h]=t[d]=p,n[p]=t[h]=d,r[d]=0,r[h]=1,r[p]=2,i.fill(-1),i[this._hashKey(g,y)]=d,i[this._hashKey(v,b)]=h,i[this._hashKey(w,_)]=p,this.trianglesLen=0,this._addTriangle(d,h,p,-1,-1,-1);for(let o,a,s=0;s<this._ids.length;s++){const u=this._ids[s],l=e[2*u],c=e[2*u+1];if(s>0&&Math.abs(l-o)<=wV&&Math.abs(c-a)<=wV)continue;if(o=l,a=c,u===d||u===h||u===p)continue;let f=0;for(let e=0,t=this._hashKey(l,c);e<this._hashSize&&(f=i[(t+e)%this._hashSize],-1===f||f===n[f]);e++);f=t[f];let m,g=f;for(;m=n[g],!AV(l,c,e[2*g],e[2*g+1],e[2*m],e[2*m+1]);)if(g=m,g===f){g=-1;break}if(-1===g)continue;let y=this._addTriangle(g,u,n[g],-1,-1,r[g]);r[u]=this._legalize(y+2),r[g]=y,E++;let v=n[g];for(;m=n[v],AV(l,c,e[2*v],e[2*v+1],e[2*m],e[2*m+1]);)y=this._addTriangle(v,u,m,r[u],-1,r[v]),r[u]=this._legalize(y+2),n[v]=v,E--,v=m;if(g===f)for(;m=t[g],AV(l,c,e[2*m],e[2*m+1],e[2*g],e[2*g+1]);)y=this._addTriangle(m,u,g,-1,r[g],r[m]),this._legalize(y+2),r[m]=y,n[g]=g,E--,g=m;this._hullStart=t[u]=g,n[g]=t[v]=u,n[u]=v,i[this._hashKey(l,c)]=u,i[this._hashKey(e[2*g],e[2*g+1])]=g}this.hull=new Uint32Array(E);for(let e=0,t=this._hullStart;e<E;e++)this.hull[e]=t,t=n[t];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(e,t){return Math.floor(function(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}(e-this._cx,t-this._cy)*this._hashSize)%this._hashSize}_legalize(e){const{_triangles:t,_halfedges:n,coords:r}=this;let i=0,o=0;for(;;){const a=n[e],s=e-e%3;if(o=s+(e+2)%3,-1===a){if(0===i)break;e=_V[--i];continue}const u=a-a%3,l=s+(e+1)%3,c=u+(a+2)%3,f=t[o],d=t[e],h=t[l],p=t[c];if(CV(r[2*f],r[2*f+1],r[2*d],r[2*d+1],r[2*h],r[2*h+1],r[2*p],r[2*p+1])){t[e]=p,t[a]=f;const r=n[c];if(-1===r){let t=this._hullStart;do{if(this._hullTri[t]===c){this._hullTri[t]=e;break}t=this._hullPrev[t]}while(t!==this._hullStart)}this._link(e,r),this._link(a,n[o]),this._link(o,c);const s=u+(a+1)%3;i<_V.length&&(_V[i++]=s)}else{if(0===i)break;e=_V[--i]}}return o}_link(e,t){this._halfedges[e]=t,-1!==t&&(this._halfedges[t]=e)}_addTriangle(e,t,n,r,i,o){const a=this.trianglesLen;return this._triangles[a]=e,this._triangles[a+1]=t,this._triangles[a+2]=n,this._link(a,r),this._link(a+1,i),this._link(a+2,o),this.trianglesLen+=3,a}}function EV(e,t,n,r){const i=e-n,o=t-r;return i*i+o*o}function SV(e,t,n,r,i,o){const a=(r-t)*(i-e),s=(n-e)*(o-t);return Math.abs(a-s)>=33306690738754716e-32*Math.abs(a+s)?a-s:0}function AV(e,t,n,r,i,o){return(SV(i,o,e,t,n,r)||SV(e,t,n,r,i,o)||SV(n,r,i,o,e,t))<0}function CV(e,t,n,r,i,o,a,s){const u=e-a,l=t-s,c=n-a,f=r-s,d=i-a,h=o-s,p=c*c+f*f,m=d*d+h*h;return u*(f*m-p*h)-l*(c*m-p*d)+(u*u+l*l)*(c*h-f*d)<0}function DV(e,t,n,r,i,o){const a=n-e,s=r-t,u=i-e,l=o-t,c=a*a+s*s,f=u*u+l*l,d=.5/(a*l-s*u),h=(l*c-s*f)*d,p=(a*f-u*c)*d;return h*h+p*p}function MV(e,t,n,r){if(r-n<=20)for(let i=n+1;i<=r;i++){const r=e[i],o=t[r];let a=i-1;for(;a>=n&&t[e[a]]>o;)e[a+1]=e[a--];e[a+1]=r}else{let i=n+1,o=r;FV(e,n+r>>1,i),t[e[n]]>t[e[r]]&&FV(e,n,r),t[e[i]]>t[e[r]]&&FV(e,i,r),t[e[n]]>t[e[i]]&&FV(e,n,i);const a=e[i],s=t[a];for(;;){do{i++}while(t[e[i]]<s);do{o--}while(t[e[o]]>s);if(o<i)break;FV(e,i,o)}e[n+1]=e[o],e[o]=a,r-i+1>=o-n?(MV(e,t,i,r),MV(e,t,n,o-1)):(MV(e,t,n,o-1),MV(e,t,i,r))}}function FV(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function NV(e){return e[0]}function OV(e){return e[1]}const $V=1e-6;class TV{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(e,t){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(e,t){this._+=`L${this._x1=+e},${this._y1=+t}`}arc(e,t,n){const r=(e=+e)+(n=+n),i=t=+t;if(n<0)throw new Error("negative radius");null===this._x1?this._+=`M${r},${i}`:(Math.abs(this._x1-r)>$V||Math.abs(this._y1-i)>$V)&&(this._+="L"+r+","+i),n&&(this._+=`A${n},${n},0,1,1,${e-n},${t}A${n},${n},0,1,1,${this._x1=r},${this._y1=i}`)}rect(e,t,n,r){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${+n}v${+r}h${-n}Z`}value(){return this._||null}}class zV{constructor(){this._=[]}moveTo(e,t){this._.push([e,t])}closePath(){this._.push(this._[0].slice())}lineTo(e,t){this._.push([e,t])}value(){return this._.length?this._:null}}class RV{constructor(e,[t,n,r,i]=[0,0,960,500]){if(!((r=+r)>=(t=+t)&&(i=+i)>=(n=+n)))throw new Error("invalid bounds");this.delaunay=e,this._circumcenters=new Float64Array(2*e.points.length),this.vectors=new Float64Array(2*e.points.length),this.xmax=r,this.xmin=t,this.ymax=i,this.ymin=n,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:e,hull:t,triangles:n},vectors:r}=this,i=this.circumcenters=this._circumcenters.subarray(0,n.length/3*2);for(let t,r,o=0,a=0,s=n.length;o<s;o+=3,a+=2){const s=2*n[o],u=2*n[o+1],l=2*n[o+2],c=e[s],f=e[s+1],d=e[u],h=e[u+1],p=e[l],m=e[l+1],g=d-c,y=h-f,v=p-c,b=m-f,x=g*g+y*y,w=v*v+b*b,_=2*(g*b-y*v);if(_)if(Math.abs(_)<1e-8)t=(c+p)/2,r=(f+m)/2;else{const e=1/_;t=c+(b*x-y*w)*e,r=f+(g*w-v*x)*e}else t=(c+p)/2-1e8*b,r=(f+m)/2+1e8*v;i[a]=t,i[a+1]=r}let o,a,s,u=t[t.length-1],l=4*u,c=e[2*u],f=e[2*u+1];r.fill(0);for(let n=0;n<t.length;++n)u=t[n],o=l,a=c,s=f,l=4*u,c=e[2*u],f=e[2*u+1],r[o+2]=r[l]=s-f,r[o+3]=r[l+1]=c-a}render(e){const t=null==e?e=new TV:void 0,{delaunay:{halfedges:n,inedges:r,hull:i},circumcenters:o,vectors:a}=this;if(i.length<=1)return null;for(let t=0,r=n.length;t<r;++t){const r=n[t];if(r<t)continue;const i=2*Math.floor(t/3),a=2*Math.floor(r/3),s=o[i],u=o[i+1],l=o[a],c=o[a+1];this._renderSegment(s,u,l,c,e)}let s,u=i[i.length-1];for(let t=0;t<i.length;++t){s=u,u=i[t];const n=2*Math.floor(r[u]/3),l=o[n],c=o[n+1],f=4*s,d=this._project(l,c,a[f+2],a[f+3]);d&&this._renderSegment(l,c,d[0],d[1],e)}return t&&t.value()}renderBounds(e){const t=null==e?e=new TV:void 0;return e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),t&&t.value()}renderCell(e,t){const n=null==t?t=new TV:void 0,r=this._clip(e);if(null===r||!r.length)return;t.moveTo(r[0],r[1]);let i=r.length;for(;r[0]===r[i-2]&&r[1]===r[i-1]&&i>1;)i-=2;for(let e=2;e<i;e+=2)r[e]===r[e-2]&&r[e+1]===r[e-1]||t.lineTo(r[e],r[e+1]);return t.closePath(),n&&n.value()}*cellPolygons(){const{delaunay:{points:e}}=this;for(let t=0,n=e.length/2;t<n;++t){const e=this.cellPolygon(t);e&&(e.index=t,yield e)}}cellPolygon(e){const t=new zV;return this.renderCell(e,t),t.value()}_renderSegment(e,t,n,r,i){let o;const a=this._regioncode(e,t),s=this._regioncode(n,r);0===a&&0===s?(i.moveTo(e,t),i.lineTo(n,r)):(o=this._clipSegment(e,t,n,r,a,s))&&(i.moveTo(o[0],o[1]),i.lineTo(o[2],o[3]))}contains(e,t,n){return(t=+t)==t&&(n=+n)==n&&this.delaunay._step(e,t,n)===e}*neighbors(e){const t=this._clip(e);if(t)for(const n of this.delaunay.neighbors(e)){const e=this._clip(n);if(e)e:for(let r=0,i=t.length;r<i;r+=2)for(let o=0,a=e.length;o<a;o+=2)if(t[r]==e[o]&&t[r+1]==e[o+1]&&t[(r+2)%i]==e[(o+a-2)%a]&&t[(r+3)%i]==e[(o+a-1)%a]){yield n;break e}}}_cell(e){const{circumcenters:t,delaunay:{inedges:n,halfedges:r,triangles:i}}=this,o=n[e];if(-1===o)return null;const a=[];let s=o;do{const n=Math.floor(s/3);if(a.push(t[2*n],t[2*n+1]),s=s%3==2?s-2:s+1,i[s]!==e)break;s=r[s]}while(s!==o&&-1!==s);return a}_clip(e){if(0===e&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const t=this._cell(e);if(null===t)return null;const{vectors:n}=this,r=4*e;return n[r]||n[r+1]?this._clipInfinite(e,t,n[r],n[r+1],n[r+2],n[r+3]):this._clipFinite(e,t)}_clipFinite(e,t){const n=t.length;let r,i,o,a,s,u=null,l=t[n-2],c=t[n-1],f=this._regioncode(l,c);for(let d=0;d<n;d+=2)if(r=l,i=c,l=t[d],c=t[d+1],o=f,f=this._regioncode(l,c),0===o&&0===f)a=s,s=0,u?u.push(l,c):u=[l,c];else{let t,n,d,h,p;if(0===o){if(null===(t=this._clipSegment(r,i,l,c,o,f)))continue;[n,d,h,p]=t}else{if(null===(t=this._clipSegment(l,c,r,i,f,o)))continue;[h,p,n,d]=t,a=s,s=this._edgecode(n,d),a&&s&&this._edge(e,a,s,u,u.length),u?u.push(n,d):u=[n,d]}a=s,s=this._edgecode(h,p),a&&s&&this._edge(e,a,s,u,u.length),u?u.push(h,p):u=[h,p]}if(u)a=s,s=this._edgecode(u[0],u[1]),a&&s&&this._edge(e,a,s,u,u.length);else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return u}_clipSegment(e,t,n,r,i,o){for(;;){if(0===i&&0===o)return[e,t,n,r];if(i&o)return null;let a,s,u=i||o;8&u?(a=e+(n-e)*(this.ymax-t)/(r-t),s=this.ymax):4&u?(a=e+(n-e)*(this.ymin-t)/(r-t),s=this.ymin):2&u?(s=t+(r-t)*(this.xmax-e)/(n-e),a=this.xmax):(s=t+(r-t)*(this.xmin-e)/(n-e),a=this.xmin),i?(e=a,t=s,i=this._regioncode(e,t)):(n=a,r=s,o=this._regioncode(n,r))}}_clipInfinite(e,t,n,r,i,o){let a,s=Array.from(t);if((a=this._project(s[0],s[1],n,r))&&s.unshift(a[0],a[1]),(a=this._project(s[s.length-2],s[s.length-1],i,o))&&s.push(a[0],a[1]),s=this._clipFinite(e,s))for(let t,n=0,r=s.length,i=this._edgecode(s[r-2],s[r-1]);n<r;n+=2)t=i,i=this._edgecode(s[n],s[n+1]),t&&i&&(n=this._edge(e,t,i,s,n),r=s.length);else this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(s=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return s}_edge(e,t,n,r,i){for(;t!==n;){let n,o;switch(t){case 5:t=4;continue;case 4:t=6,n=this.xmax,o=this.ymin;break;case 6:t=2;continue;case 2:t=10,n=this.xmax,o=this.ymax;break;case 10:t=8;continue;case 8:t=9,n=this.xmin,o=this.ymax;break;case 9:t=1;continue;case 1:t=5,n=this.xmin,o=this.ymin}r[i]===n&&r[i+1]===o||!this.contains(e,n,o)||(r.splice(i,0,n,o),i+=2)}if(r.length>4)for(let e=0;e<r.length;e+=2){const t=(e+2)%r.length,n=(e+4)%r.length;(r[e]===r[t]&&r[t]===r[n]||r[e+1]===r[t+1]&&r[t+1]===r[n+1])&&(r.splice(t,2),e-=2)}return i}_project(e,t,n,r){let i,o,a,s=1/0;if(r<0){if(t<=this.ymin)return null;(i=(this.ymin-t)/r)<s&&(a=this.ymin,o=e+(s=i)*n)}else if(r>0){if(t>=this.ymax)return null;(i=(this.ymax-t)/r)<s&&(a=this.ymax,o=e+(s=i)*n)}if(n>0){if(e>=this.xmax)return null;(i=(this.xmax-e)/n)<s&&(o=this.xmax,a=t+(s=i)*r)}else if(n<0){if(e<=this.xmin)return null;(i=(this.xmin-e)/n)<s&&(o=this.xmin,a=t+(s=i)*r)}return[o,a]}_edgecode(e,t){return(e===this.xmin?1:e===this.xmax?2:0)|(t===this.ymin?4:t===this.ymax?8:0)}_regioncode(e,t){return(e<this.xmin?1:e>this.xmax?2:0)|(t<this.ymin?4:t>this.ymax?8:0)}}const PV=2*Math.PI,LV=Math.pow;function BV(e){return e[0]}function IV(e){return e[1]}function jV(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class UV{static from(e,t=BV,n=IV,r){return new UV("length"in e?function(e,t,n,r){const i=e.length,o=new Float64Array(2*i);for(let a=0;a<i;++a){const i=e[a];o[2*a]=t.call(r,i,a,e),o[2*a+1]=n.call(r,i,a,e)}return o}(e,t,n,r):Float64Array.from(function*(e,t,n,r){let i=0;for(const o of e)yield t.call(r,o,i,e),yield n.call(r,o,i,e),++i}(e,t,n,r)))}constructor(e){this._delaunator=new kV(e),this.inedges=new Int32Array(e.length/2),this._hullIndex=new Int32Array(e.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const e=this._delaunator,t=this.points;if(e.hull&&e.hull.length>2&&function(e){const{triangles:t,coords:n}=e;for(let e=0;e<t.length;e+=3){const r=2*t[e],i=2*t[e+1],o=2*t[e+2];if((n[o]-n[r])*(n[i+1]-n[r+1])-(n[i]-n[r])*(n[o+1]-n[r+1])>1e-10)return!1}return!0}(e)){this.collinear=Int32Array.from({length:t.length/2},((e,t)=>t)).sort(((e,n)=>t[2*e]-t[2*n]||t[2*e+1]-t[2*n+1]));const e=this.collinear[0],n=this.collinear[this.collinear.length-1],r=[t[2*e],t[2*e+1],t[2*n],t[2*n+1]],i=1e-8*Math.hypot(r[3]-r[1],r[2]-r[0]);for(let e=0,n=t.length/2;e<n;++e){const n=jV(t[2*e],t[2*e+1],i);t[2*e]=n[0],t[2*e+1]=n[1]}this._delaunator=new kV(t)}else delete this.collinear;const n=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,i=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let e=0,t=n.length;e<t;++e){const t=i[e%3==2?e-2:e+1];-1!==n[e]&&-1!==o[t]||(o[t]=e)}for(let e=0,t=r.length;e<t;++e)a[r[e]]=e;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],this.triangles[1]=r[1],this.triangles[2]=r[1],o[r[0]]=1,2===r.length&&(o[r[1]]=0))}voronoi(e){return new RV(this,e)}*neighbors(e){const{inedges:t,hull:n,_hullIndex:r,halfedges:i,triangles:o,collinear:a}=this;if(a){const t=a.indexOf(e);return t>0&&(yield a[t-1]),void(t<a.length-1&&(yield a[t+1]))}const s=t[e];if(-1===s)return;let u=s,l=-1;do{if(yield l=o[u],u=u%3==2?u-2:u+1,o[u]!==e)return;if(u=i[u],-1===u){const t=n[(r[e]+1)%n.length];return void(t!==l&&(yield t))}}while(u!==s)}find(e,t,n=0){if((e=+e)!=e||(t=+t)!=t)return-1;const r=n;let i;for(;(i=this._step(n,e,t))>=0&&i!==n&&i!==r;)n=i;return i}_step(e,t,n){const{inedges:r,hull:i,_hullIndex:o,halfedges:a,triangles:s,points:u}=this;if(-1===r[e]||!u.length)return(e+1)%(u.length>>1);let l=e,c=LV(t-u[2*e],2)+LV(n-u[2*e+1],2);const f=r[e];let d=f;do{let r=s[d];const f=LV(t-u[2*r],2)+LV(n-u[2*r+1],2);if(f<c&&(c=f,l=r),d=d%3==2?d-2:d+1,s[d]!==e)break;if(d=a[d],-1===d){if(d=i[(o[e]+1)%i.length],d!==r&&LV(t-u[2*d],2)+LV(n-u[2*d+1],2)<c)return d;break}}while(d!==f);return l}render(e){const t=null==e?e=new TV:void 0,{points:n,halfedges:r,triangles:i}=this;for(let t=0,o=r.length;t<o;++t){const o=r[t];if(o<t)continue;const a=2*i[t],s=2*i[o];e.moveTo(n[a],n[a+1]),e.lineTo(n[s],n[s+1])}return this.renderHull(e),t&&t.value()}renderPoints(e,t=2){const n=null==e?e=new TV:void 0,{points:r}=this;for(let n=0,i=r.length;n<i;n+=2){const i=r[n],o=r[n+1];e.moveTo(i+t,o),e.arc(i,o,t,0,PV)}return n&&n.value()}renderHull(e){const t=null==e?e=new TV:void 0,{hull:n,points:r}=this,i=2*n[0],o=n.length;e.moveTo(r[i],r[i+1]);for(let t=1;t<o;++t){const i=2*n[t];e.lineTo(r[i],r[i+1])}return e.closePath(),t&&t.value()}hullPolygon(){const e=new zV;return this.renderHull(e),e.value()}renderTriangle(e,t){const n=null==t?t=new TV:void 0,{points:r,triangles:i}=this,o=2*i[e*=3],a=2*i[e+1],s=2*i[e+2];return t.moveTo(r[o],r[o+1]),t.lineTo(r[a],r[a+1]),t.lineTo(r[s],r[s+1]),t.closePath(),n&&n.value()}*trianglePolygons(){const{triangles:e}=this;for(let t=0,n=e.length/3;t<n;++t)yield this.trianglePolygon(t)}trianglePolygon(e){const t=new zV;return this.renderTriangle(e,t),t.value()}}function qV(e){LE.call(this,null,e)}qV.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const WV=[-1e5,-1e5,1e5,1e5];function HV(e){const t=e[0][0],n=e[0][1];let r=e.length-1;for(;e[r][0]===t&&e[r][1]===n;--r);return"M"+e.slice(0,r+1).join("L")+"Z"}_y(qV,LE,{transform:function(e,t){const n=e.as||"path",r=t.source;if(!r||!r.length)return t;let i=e.size;i=i?[0,0,i[0],i[1]]:(i=e.extent)?[i[0][0],i[0][1],i[1][0],i[1][1]]:WV;const o=this.value=UV.from(r,e.x,e.y).voronoi(i);for(let e=0,t=r.length;e<t;++e){const t=o.cellPolygon(e);r[e][n]=t?HV(t):null}return t.reflow(e.modified()).modifies(n)}}),t(xV,"voronoi",(function(){return qV}));var VV={},GV=Math.PI/180,YV=2048;function XV(){var e,t,n,r,i,o,a,s=[256,256],u=ZV,l=[],c=Math.random,f={};function d(e,t,n){for(var r,i,o,a,l,f=t.x,d=t.y,h=Math.sqrt(s[0]*s[0]+s[1]*s[1]),p=u(s),m=c()<.5?1:-1,g=-m;(r=p(g+=m))&&(i=~~r[0],o=~~r[1],!(Math.min(Math.abs(i),Math.abs(o))>=h));)if(t.x=f+i,t.y=d+o,!(t.x+t.x0<0||t.y+t.y0<0||t.x+t.x1>s[0]||t.y+t.y1>s[1]||n&&JV(t,e,s[0])||n&&(l=n,!((a=t).x+a.x1>l[0].x&&a.x+a.x0<l[1].x&&a.y+a.y1>l[0].y&&a.y+a.y0<l[1].y)))){for(var y,v=t.sprite,b=t.width>>5,x=s[0]>>5,w=t.x-(b<<4),_=127&w,k=32-_,E=t.y1-t.y0,S=(t.y+t.y0)*x+(w>>5),A=0;A<E;A++){y=0;for(var C=0;C<=b;C++)e[S+C]|=y<<k|(C<b?(y=v[A*b+C])>>>_:0);S+=x}return t.sprite=null,!0}return!1}return f.layout=function(){for(var u=function(e){e.width=e.height=1;var t=Math.sqrt(e.getContext("2d").getImageData(0,0,1,1).data.length>>2);e.width=2048/t,e.height=YV/t;var n=e.getContext("2d");return n.fillStyle=n.strokeStyle="red",n.textAlign="center",{context:n,ratio:t}}(AD()),f=function(e){var t=[],n=-1;for(;++n<e;)t[n]=0;return t}((s[0]>>5)*s[1]),h=null,p=l.length,m=-1,g=[],y=l.map((s=>({text:e(s),font:t(s),style:r(s),weight:i(s),rotate:o(s),size:~~(n(s)+1e-14),padding:a(s),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:s}))).sort(((e,t)=>t.size-e.size));++m<p;){var v=y[m];v.x=s[0]*(c()+.5)>>1,v.y=s[1]*(c()+.5)>>1,QV(u,v,y,m),v.hasText&&d(f,v,h)&&(g.push(v),h?KV(h,v):h=[{x:v.x+v.x0,y:v.y+v.y0},{x:v.x+v.x1,y:v.y+v.y1}],v.x-=s[0]>>1,v.y-=s[1]>>1)}return g},f.words=function(e){return arguments.length?(l=e,f):l},f.size=function(e){return arguments.length?(s=[+e[0],+e[1]],f):s},f.font=function(e){return arguments.length?(t=eG(e),f):t},f.fontStyle=function(e){return arguments.length?(r=eG(e),f):r},f.fontWeight=function(e){return arguments.length?(i=eG(e),f):i},f.rotate=function(e){return arguments.length?(o=eG(e),f):o},f.text=function(t){return arguments.length?(e=eG(t),f):e},f.spiral=function(e){return arguments.length?(u=tG[e]||e,f):u},f.fontSize=function(e){return arguments.length?(n=eG(e),f):n},f.padding=function(e){return arguments.length?(a=eG(e),f):a},f.random=function(e){return arguments.length?(c=e,f):c},f}function QV(e,t,n,r){if(!t.sprite){var i=e.context,o=e.ratio;i.clearRect(0,0,2048/o,YV/o);var a,s,u,l,c,f=0,d=0,h=0,p=n.length;for(--r;++r<p;){if(t=n[r],i.save(),i.font=t.style+" "+t.weight+" "+~~((t.size+1)/o)+"px "+t.font,a=i.measureText(t.text+"m").width*o,u=t.size<<1,t.rotate){var m=Math.sin(t.rotate*GV),g=Math.cos(t.rotate*GV),y=a*g,v=a*m,b=u*g,x=u*m;a=Math.max(Math.abs(y+x),Math.abs(y-x))+31>>5<<5,u=~~Math.max(Math.abs(v+b),Math.abs(v-b))}else a=a+31>>5<<5;if(u>h&&(h=u),f+a>=2048&&(f=0,d+=h,h=0),d+u>=YV)break;i.translate((f+(a>>1))/o,(d+(u>>1))/o),t.rotate&&i.rotate(t.rotate*GV),i.fillText(t.text,0,0),t.padding&&(i.lineWidth=2*t.padding,i.strokeText(t.text,0,0)),i.restore(),t.width=a,t.height=u,t.xoff=f,t.yoff=d,t.x1=a>>1,t.y1=u>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,f+=a}for(var w=i.getImageData(0,0,2048/o,YV/o).data,_=[];--r>=0;)if((t=n[r]).hasText){for(s=(a=t.width)>>5,u=t.y1-t.y0,l=0;l<u*s;l++)_[l]=0;if(null==(f=t.xoff))return;d=t.yoff;var k=0,E=-1;for(c=0;c<u;c++){for(l=0;l<a;l++){var S=s*c+(l>>5),A=w[2048*(d+c)+(f+l)<<2]?1<<31-l%32:0;_[S]|=A,k|=A}k?E=c:(t.y0++,u--,c--,d++)}t.y1=t.y0+E,t.sprite=_.slice(0,(t.y1-t.y0)*s)}}}function JV(e,t,n){n>>=5;for(var r,i=e.sprite,o=e.width>>5,a=e.x-(o<<4),s=127&a,u=32-s,l=e.y1-e.y0,c=(e.y+e.y0)*n+(a>>5),f=0;f<l;f++){r=0;for(var d=0;d<=o;d++)if((r<<u|(d<o?(r=i[f*o+d])>>>s:0))&t[c+d])return!0;c+=n}return!1}function KV(e,t){var n=e[0],r=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>r.x&&(r.x=t.x+t.x1),t.y+t.y1>r.y&&(r.y=t.y+t.y1)}function ZV(e){var t=e[0]/e[1];return function(e){return[t*(e*=.1)*Math.cos(e),e*Math.sin(e)]}}function eG(e){return"function"==typeof e?e:function(){return e}}var tG={archimedean:ZV,rectangular:function(e){var t=4*e[0]/e[1],n=0,r=0;return function(e){var i=e<0?-1:1;switch(Math.sqrt(1+4*i*e)-i&3){case 0:n+=t;break;case 1:r+=4;break;case 2:n-=t;break;default:r-=4}return[n,r]}}};const nG=["x","y","font","fontSize","fontStyle","fontWeight","angle"],rG=["text","font","rotate","fontSize","fontStyle","fontWeight"];function iG(e){LE.call(this,XV(),e)}iG.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:nG}]},_y(iG,LE,{transform:function(e,t){!e.size||e.size[0]&&e.size[1]||_g("Wordcloud size dimensions must be non-zero.");const n=e.modified();if(!(n||t.changed(t.ADD_REM)||rG.some((function(n){const r=e[n];return ay(r)&&t.modified(r.fields)}))))return;const r=t.materialize(t.SOURCE).source,i=this.value,o=e.as||nG;let a,s=e.fontSize||14;if(ay(s)?a=e.fontSizeRange:s=dy(s),a){const e=s,t=WN("sqrt")().domain(my(r,e)).range(a);s=n=>t(e(n))}r.forEach((e=>{e[o[0]]=NaN,e[o[1]]=NaN,e[o[3]]=0}));const u=i.words(r).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(s).random(XE).layout(),l=i.size(),c=l[0]>>1,f=l[1]>>1,d=u.length;for(let e,t,n=0;n<d;++n)e=u[n],t=e.datum,t[o[0]]=e.x+c,t[o[1]]=e.y+f,t[o[2]]=e.font,t[o[3]]=e.size,t[o[4]]=e.style,t[o[5]]=e.weight,t[o[6]]=e.rotate;return t.reflow(n).modifies(o)}}),t(VV,"wordcloud",(function(){return iG}));var oG={};const aG=e=>new Uint8Array(e),sG=e=>new Uint16Array(e),uG=e=>new Uint32Array(e);function lG(e,t,n){const r=(t<257?aG:t<65537?sG:uG)(e);return n&&r.set(n),r}function cG(e,t,n){const r=1<<t;return{one:r,zero:~r,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd:function(e,t){const n=this,i=n.bisect(n.range,e.value),o=e.index,a=i[0],s=i[1],u=o.length;let l;for(l=0;l<a;++l)t[o[l]]|=r;for(l=s;l<u;++l)t[o[l]]|=r;return n}}}function fG(){let e=uG(0),t=[],n=0;return{insert:function(r,i,o){if(!i.length)return[];const a=n,s=i.length,u=uG(s);let l,c,f,d=Array(s);for(f=0;f<s;++f)d[f]=r(i[f]),u[f]=f;if(d=function(e,t){return e.sort.call(t,((t,n)=>{const r=e[t],i=e[n];return r<i?-1:r>i?1:0})),function(e,t){return Array.from(t,(t=>e[t]))}(e,t)}(d,u),a)l=t,c=e,t=Array(a+s),e=uG(a+s),function(e,t,n,r,i,o,a,s,u){let l,c=0,f=0;for(l=0;c<r&&f<a;++l)t[c]<i[f]?(s[l]=t[c],u[l]=n[c++]):(s[l]=i[f],u[l]=o[f++]+e);for(;c<r;++c,++l)s[l]=t[c],u[l]=n[c];for(;f<a;++f,++l)s[l]=i[f],u[l]=o[f]+e}(o,l,c,a,d,u,s,t,e);else{if(o>0)for(f=0;f<s;++f)u[f]+=o;t=d,e=u}return n=a+s,{index:u,value:d}},remove:function(r,i){const o=n;let a,s,u;for(s=0;!i[e[s]]&&s<o;++s);for(u=s;s<o;++s)i[a=e[s]]||(e[u]=a,t[u]=t[s],++u);n=o-r},bisect:function(e,r){let i;return r?i=r.length:(r=t,i=n),[Mb(r,e[0],0,i),Db(r,e[1],0,i)]},reindex:function(t){for(let r=0,i=n;r<i;++r)e[r]=t[e[r]]},index:()=>e,size:()=>n}}function dG(e){LE.call(this,function(){let e=8,t=[],n=uG(0),r=lG(0,e),i=lG(0,e);return{data:()=>t,seen:()=>{return e=n,r=t.length,n=e.length>=r?e:((i=i||new e.constructor(r)).set(e),i);var e,r,i},add:function(e){for(let n,r=0,i=t.length,o=e.length;r<o;++r)n=e[r],n._index=i++,t.push(n)},remove:function(e,n){const o=t.length,a=Array(o-e),s=t;let u,l,c;for(l=0;!n[l]&&l<o;++l)a[l]=t[l],s[l]=l;for(c=l;l<o;++l)u=t[l],n[l]?s[l]=-1:(s[l]=c,r[c]=r[l],i[c]=i[l],a[c]=u,u._index=c++),r[l]=0;return t=a,s},size:()=>t.length,curr:()=>r,prev:()=>i,reset:e=>i[e]=r[e],all:()=>e<257?255:e<65537?65535:4294967295,set:function(e,t){r[e]|=t},clear:function(e,t){r[e]&=~t},resize:function(t,n){(t>r.length||n>e)&&(e=Math.max(n,e),r=lG(t,e,r),i=lG(t,e))}}}(),e),this._indices=null,this._dims=null}function hG(e){LE.call(this,null,e)}dG.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]},_y(dG,LE,{transform:function(e,t){return this._dims?e.modified("fields")||e.fields.some((e=>t.modified(e.fields)))?this.reinit(e,t):this.eval(e,t):this.init(e,t)},init:function(e,t){const n=e.fields,r=e.query,i=this._indices={},o=this._dims=[],a=r.length;let s,u,l=0;for(;l<a;++l)s=n[l].fname,u=i[s]||(i[s]=fG()),o.push(cG(u,l,r[l]));return this.eval(e,t)},reinit:function(e,t){const n=t.materialize().fork(),r=e.fields,i=e.query,o=this._indices,a=this._dims,s=this.value,u=s.curr(),l=s.prev(),c=s.all(),f=n.rem=n.add,d=n.mod,h=i.length,p={};let m,g,y,v,b,x,w,_,k;if(l.set(u),t.rem.length&&(b=this.remove(e,t,n)),t.add.length&&s.add(t.add),t.mod.length)for(x={},v=t.mod,w=0,_=v.length;w<_;++w)x[v[w]._index]=1;for(w=0;w<h;++w)k=r[w],(!a[w]||e.modified("fields",w)||t.modified(k.fields))&&(y=k.fname,(m=p[y])||(o[y]=g=fG(),p[y]=m=g.insert(k,t.source,0)),a[w]=cG(g,w,i[w]).onAdd(m,u));for(w=0,_=s.data().length;w<_;++w)b[w]||(l[w]!==u[w]?f.push(w):x[w]&&u[w]!==c&&d.push(w));return s.mask=(1<<h)-1,n},eval:function(e,t){const n=t.materialize().fork(),r=this._dims.length;let i=0;return t.rem.length&&(this.remove(e,t,n),i|=(1<<r)-1),e.modified("query")&&!e.modified("fields")&&(i|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),i|=(1<<r)-1),t.mod.length&&(this.modify(t,n),i|=(1<<r)-1),this.value.mask=i,n},insert:function(e,t,n){const r=t.add,i=this.value,o=this._dims,a=this._indices,s=e.fields,u={},l=n.add,c=i.size()+r.length,f=o.length;let d,h,p,m=i.size();i.resize(c,f),i.add(r);const g=i.curr(),y=i.prev(),v=i.all();for(d=0;d<f;++d)h=s[d].fname,p=u[h]||(u[h]=a[h].insert(s[d],r,m)),o[d].onAdd(p,g);for(;m<c;++m)y[m]=v,g[m]!==v&&l.push(m)},modify:function(e,t){const n=t.mod,r=this.value,i=r.curr(),o=r.all(),a=e.mod;let s,u,l;for(s=0,u=a.length;s<u;++s)l=a[s]._index,i[l]!==o&&n.push(l)},remove:function(e,t,n){const r=this._indices,i=this.value,o=i.curr(),a=i.prev(),s=i.all(),u={},l=n.rem,c=t.rem;let f,d,h,p;for(f=0,d=c.length;f<d;++f)h=c[f]._index,u[h]=1,a[h]=p=o[h],o[h]=s,p!==s&&l.push(h);for(h in r)r[h].remove(d,u);return this.reindex(t,d,u),u},reindex:function(e,t,n){const r=this._indices,i=this.value;e.runAfter((()=>{const e=i.remove(t,n);for(const t in r)r[t].reindex(e)}))},update:function(e,t,n){const r=this._dims,i=e.query,o=t.stamp,a=r.length;let s,u,l=0;for(n.filters=0,u=0;u<a;++u)e.modified("query",u)&&(s=u,++l);if(1===l)l=r[s].one,this.incrementOne(r[s],i[s],n.add,n.rem);else for(u=0,l=0;u<a;++u)e.modified("query",u)&&(l|=r[u].one,this.incrementAll(r[u],i[u],o,n.add),n.rem=n.add);return l},incrementAll:function(e,t,n,r){const i=this.value,o=i.seen(),a=i.curr(),s=i.prev(),u=e.index(),l=e.bisect(e.range),c=e.bisect(t),f=c[0],d=c[1],h=l[0],p=l[1],m=e.one;let g,y,v;if(f<h)for(g=f,y=Math.min(h,d);g<y;++g)v=u[g],o[v]!==n&&(s[v]=a[v],o[v]=n,r.push(v)),a[v]^=m;else if(f>h)for(g=h,y=Math.min(f,p);g<y;++g)v=u[g],o[v]!==n&&(s[v]=a[v],o[v]=n,r.push(v)),a[v]^=m;if(d>p)for(g=Math.max(f,p),y=d;g<y;++g)v=u[g],o[v]!==n&&(s[v]=a[v],o[v]=n,r.push(v)),a[v]^=m;else if(d<p)for(g=Math.max(h,d),y=p;g<y;++g)v=u[g],o[v]!==n&&(s[v]=a[v],o[v]=n,r.push(v)),a[v]^=m;e.range=t.slice()},incrementOne:function(e,t,n,r){const i=this.value.curr(),o=e.index(),a=e.bisect(e.range),s=e.bisect(t),u=s[0],l=s[1],c=a[0],f=a[1],d=e.one;let h,p,m;if(u<c)for(h=u,p=Math.min(c,l);h<p;++h)m=o[h],i[m]^=d,n.push(m);else if(u>c)for(h=c,p=Math.min(u,f);h<p;++h)m=o[h],i[m]^=d,r.push(m);if(l>f)for(h=Math.max(u,f),p=l;h<p;++h)m=o[h],i[m]^=d,n.push(m);else if(l<f)for(h=Math.max(c,l),p=f;h<p;++h)m=o[h],i[m]^=d,r.push(m);e.range=t.slice()}}),hG.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]},_y(hG,LE,{transform:function(e,t){const n=~(e.ignore||0),r=e.filter,i=r.mask;if(0==(i&n))return t.StopPropagation;const o=t.fork(t.ALL),a=r.data(),s=r.curr(),u=r.prev(),l=e=>s[e]&n?null:a[e];return o.filter(o.MOD,l),i&i-1?(o.filter(o.ADD,(e=>{const t=s[e]&n;return!t&&t^u[e]&n?a[e]:null})),o.filter(o.REM,(e=>{const t=s[e]&n;return t&&!(t^t^u[e]&n)?a[e]:null}))):(o.filter(o.ADD,l),o.filter(o.REM,(e=>(s[e]&n)===i?a[e]:null))),o.filter(o.SOURCE,(e=>l(e._index)))}}),t(oG,"resolvefilter",(function(){return hG})),t(oG,"crossfilter",(function(){return dG})),n(pg,qE),n(pg,fx),n(pg,Hy),n(pg,fC);const pG="RawCode",mG="Literal",gG="Property",yG="Identifier",vG="ArrayExpression",bG="BinaryExpression",xG="CallExpression",wG="ConditionalExpression",_G="LogicalExpression",kG="MemberExpression",EG="ObjectExpression",SG="UnaryExpression";function AG(e){this.type=e}var CG,DG,MG,FG,NG;AG.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=function(e){switch(e.type){case vG:return e.elements;case bG:case _G:return[e.left,e.right];case xG:return[e.callee].concat(e.arguments);case wG:return[e.test,e.consequent,e.alternate];case kG:return[e.object,e.property];case EG:return e.properties;case gG:return[e.key,e.value];case SG:return[e.argument];case yG:case mG:case pG:default:return[]}}(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};(CG={})[1]="Boolean",CG[2]="<end>",CG[3]="Identifier",CG[4]="Keyword",CG[5]="Null",CG[6]="Numeric",CG[7]="Punctuator",CG[8]="String",CG[9]="RegularExpression";var OG="Identifier",$G="Unexpected token %0",TG="Invalid regular expression",zG="Invalid regular expression: missing /",RG="Octal literals are not allowed in strict mode.",PG="ILLEGAL",LG="Disabled.",BG=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),IG=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function jG(e,t){if(!e)throw new Error("ASSERT: "+t)}function UG(e){return e>=48&&e<=57}function qG(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function WG(e){return"01234567".indexOf(e)>=0}function HG(e){return 32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function VG(e){return 10===e||13===e||8232===e||8233===e}function GG(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||92===e||e>=128&&BG.test(String.fromCharCode(e))}function YG(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||92===e||e>=128&&IG.test(String.fromCharCode(e))}const XG={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function QG(){for(;MG<FG;){const e=DG.charCodeAt(MG);if(!HG(e)&&!VG(e))break;++MG}}function JG(e){var t,n,r,i=0;for(n="u"===e?4:2,t=0;t<n;++t)MG<FG&&qG(DG[MG])?(r=DG[MG++],i=16*i+"0123456789abcdef".indexOf(r.toLowerCase())):hY({},$G,PG);return String.fromCharCode(i)}function KG(){var e,t,n,r;for(t=0,"}"===(e=DG[MG])&&hY({},$G,PG);MG<FG&&qG(e=DG[MG++]);)t=16*t+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||"}"!==e)&&hY({},$G,PG),t<=65535?String.fromCharCode(t):(n=55296+(t-65536>>10),r=56320+(t-65536&1023),String.fromCharCode(n,r))}function ZG(){var e,t;for(e=DG.charCodeAt(MG++),t=String.fromCharCode(e),92===e&&(117!==DG.charCodeAt(MG)&&hY({},$G,PG),++MG,(e=JG("u"))&&"\\"!==e&&GG(e.charCodeAt(0))||hY({},$G,PG),t=e);MG<FG&&YG(e=DG.charCodeAt(MG));)++MG,t+=String.fromCharCode(e),92===e&&(t=t.substr(0,t.length-1),117!==DG.charCodeAt(MG)&&hY({},$G,PG),++MG,(e=JG("u"))&&"\\"!==e&&YG(e.charCodeAt(0))||hY({},$G,PG),t+=e);return t}function eY(){var e,t;return e=MG,{type:1===(t=92===DG.charCodeAt(MG)?ZG():function(){var e,t;for(e=MG++;MG<FG;){if(92===(t=DG.charCodeAt(MG)))return MG=e,ZG();if(!YG(t))break;++MG}return DG.slice(e,MG)}()).length?3:XG.hasOwnProperty(t)?4:"null"===t?5:"true"===t||"false"===t?1:3,value:t,start:e,end:MG}}function tY(){var e,t,n,r,i=MG,o=DG.charCodeAt(MG),a=DG[MG];switch(o){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++MG,{type:7,value:String.fromCharCode(o),start:i,end:MG};default:if(61===(e=DG.charCodeAt(MG+1)))switch(o){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return MG+=2,{type:7,value:String.fromCharCode(o)+String.fromCharCode(e),start:i,end:MG};case 33:case 61:return MG+=2,61===DG.charCodeAt(MG)&&++MG,{type:7,value:DG.slice(i,MG),start:i,end:MG}}}return">>>="===(r=DG.substr(MG,4))?{type:7,value:r,start:i,end:MG+=4}:">>>"===(n=r.substr(0,3))||"<<="===n||">>="===n?{type:7,value:n,start:i,end:MG+=3}:a===(t=n.substr(0,2))[1]&&"+-<>&|".indexOf(a)>=0||"=>"===t?{type:7,value:t,start:i,end:MG+=2}:("//"===t&&hY({},$G,PG),"<>=!+-*%&|^/".indexOf(a)>=0?{type:7,value:a,start:i,end:++MG}:void hY({},$G,PG))}function nY(){var e,t,n;if(jG(UG((n=DG[MG]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),t=MG,e="","."!==n){if(e=DG[MG++],n=DG[MG],"0"===e){if("x"===n||"X"===n)return++MG,function(e){let t="";for(;MG<FG&&qG(DG[MG]);)t+=DG[MG++];return 0===t.length&&hY({},$G,PG),GG(DG.charCodeAt(MG))&&hY({},$G,PG),{type:6,value:parseInt("0x"+t,16),start:e,end:MG}}(t);if(WG(n))return function(e){let t="0"+DG[MG++];for(;MG<FG&&WG(DG[MG]);)t+=DG[MG++];return(GG(DG.charCodeAt(MG))||UG(DG.charCodeAt(MG)))&&hY({},$G,PG),{type:6,value:parseInt(t,8),octal:!0,start:e,end:MG}}(t);n&&UG(n.charCodeAt(0))&&hY({},$G,PG)}for(;UG(DG.charCodeAt(MG));)e+=DG[MG++];n=DG[MG]}if("."===n){for(e+=DG[MG++];UG(DG.charCodeAt(MG));)e+=DG[MG++];n=DG[MG]}if("e"===n||"E"===n)if(e+=DG[MG++],"+"!==(n=DG[MG])&&"-"!==n||(e+=DG[MG++]),UG(DG.charCodeAt(MG)))for(;UG(DG.charCodeAt(MG));)e+=DG[MG++];else hY({},$G,PG);return GG(DG.charCodeAt(MG))&&hY({},$G,PG),{type:6,value:parseFloat(e),start:t,end:MG}}function rY(){var e,t,n,r;return NG=null,QG(),e=MG,t=function(){var e,t,n,r;for(jG("/"===(e=DG[MG]),"Regular expression literal must start with a slash"),t=DG[MG++],n=!1,r=!1;MG<FG;)if(t+=e=DG[MG++],"\\"===e)VG((e=DG[MG++]).charCodeAt(0))&&hY({},zG),t+=e;else if(VG(e.charCodeAt(0)))hY({},zG);else if(n)"]"===e&&(n=!1);else{if("/"===e){r=!0;break}"["===e&&(n=!0)}return r||hY({},zG),{value:t.substr(1,t.length-2),literal:t}}(),n=function(){var e,t,n;for(t="",n="";MG<FG&&YG((e=DG[MG]).charCodeAt(0));)++MG,"\\"===e&&MG<FG?hY({},$G,PG):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&hY({},TG,n),{value:n,literal:t}}(),r=function(e,t){let n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,((e,t)=>{if(parseInt(t,16)<=1114111)return"x";hY({},TG)})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(e){hY({},TG)}try{return new RegExp(e,t)}catch(e){return null}}(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:MG}}function iY(){if(QG(),MG>=FG)return{type:2,start:MG,end:MG};const e=DG.charCodeAt(MG);return GG(e)?eY():40===e||41===e||59===e?tY():39===e||34===e?function(){var e,t,n,r,i="",o=!1;for(jG("'"===(e=DG[MG])||'"'===e,"String literal must starts with a quote"),t=MG,++MG;MG<FG;){if((n=DG[MG++])===e){e="";break}if("\\"===n)if((n=DG[MG++])&&VG(n.charCodeAt(0)))"\r"===n&&"\n"===DG[MG]&&++MG;else switch(n){case"u":case"x":"{"===DG[MG]?(++MG,i+=KG()):i+=JG(n);break;case"n":i+="\n";break;case"r":i+="\r";break;case"t":i+="\t";break;case"b":i+="\b";break;case"f":i+="\f";break;case"v":i+="\v";break;default:WG(n)?(0!==(r="01234567".indexOf(n))&&(o=!0),MG<FG&&WG(DG[MG])&&(o=!0,r=8*r+"01234567".indexOf(DG[MG++]),"0123".indexOf(n)>=0&&MG<FG&&WG(DG[MG])&&(r=8*r+"01234567".indexOf(DG[MG++]))),i+=String.fromCharCode(r)):i+=n}else{if(VG(n.charCodeAt(0)))break;i+=n}}return""!==e&&hY({},$G,PG),{type:8,value:i,octal:o,start:t,end:MG}}():46===e?UG(DG.charCodeAt(MG+1))?nY():tY():UG(e)?nY():tY()}function oY(){const e=NG;return MG=e.end,NG=iY(),MG=e.end,e}function aY(){const e=MG;NG=iY(),MG=e}function sY(e,t,n){const r=new AG("||"===e||"&&"===e?"LogicalExpression":"BinaryExpression");return r.operator=e,r.left=t,r.right=n,r}function uY(e,t){const n=new AG("CallExpression");return n.callee=e,n.arguments=t,n}function lY(e){const t=new AG(OG);return t.name=e,t}function cY(e){const t=new AG("Literal");return t.value=e.value,t.raw=DG.slice(e.start,e.end),e.regex&&("//"===t.raw&&(t.raw="/(?:)/"),t.regex=e.regex),t}function fY(e,t,n){const r=new AG("MemberExpression");return r.computed="["===e,r.object=t,r.property=n,r.computed||(n.member=!0),r}function dY(e,t,n){const r=new AG("Property");return r.key=t,r.value=n,r.kind=e,r}function hY(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,((e,t)=>(jG(t<r.length,"Message reference must be in range"),r[t])));throw(n=new Error(i)).index=MG,n.description=i,n}function pY(e){2===e.type&&hY(e,"Unexpected end of input"),6===e.type&&hY(e,"Unexpected number"),8===e.type&&hY(e,"Unexpected string"),3===e.type&&hY(e,"Unexpected identifier"),4===e.type&&hY(e,"Unexpected reserved word"),hY(e,$G,e.value)}function mY(e){const t=oY();7===t.type&&t.value===e||pY(t)}function gY(e){return 7===NG.type&&NG.value===e}function yY(e){return 4===NG.type&&NG.value===e}function vY(){const e=[];for(MG=NG.start,mY("[");!gY("]");)gY(",")?(oY(),e.push(null)):(e.push(FY()),gY("]")||mY(","));return oY(),function(e){const t=new AG("ArrayExpression");return t.elements=e,t}(e)}function bY(){MG=NG.start;const e=oY();return 8===e.type||6===e.type?(e.octal&&hY(e,RG),cY(e)):lY(e.value)}function xY(){var e,t,n;return MG=NG.start,3===(e=NG).type?(n=bY(),mY(":"),dY("init",n,FY())):2!==e.type&&7!==e.type?(t=bY(),mY(":"),dY("init",t,FY())):void pY(e)}function wY(){var e,t,n=[],r={},i=String;for(MG=NG.start,mY("{");!gY("}");)t="$"+((e=xY()).key.type===OG?e.key.name:i(e.key.value)),Object.prototype.hasOwnProperty.call(r,t)?hY({},"Duplicate data property in object literal not allowed in strict mode"):r[t]=!0,n.push(e),gY("}")||mY(",");return mY("}"),function(e){const t=new AG("ObjectExpression");return t.properties=e,t}(n)}const _Y={if:1};function kY(){var e,t,n;if(gY("("))return function(){mY("(");const e=NY();return mY(")"),e}();if(gY("["))return vY();if(gY("{"))return wY();if(e=NG.type,MG=NG.start,3===e||_Y[NG.value])n=lY(oY().value);else if(8===e||6===e)NG.octal&&hY(NG,RG),n=cY(oY());else{if(4===e)throw new Error(LG);1===e?((t=oY()).value="true"===t.value,n=cY(t)):5===e?((t=oY()).value=null,n=cY(t)):gY("/")||gY("/=")?(n=cY(rY()),aY()):pY(oY())}return n}function EY(){const e=[];if(mY("("),!gY(")"))for(;MG<FG&&(e.push(FY()),!gY(")"));)mY(",");return mY(")"),e}function SY(){return mY("."),function(){MG=NG.start;const e=oY();return function(e){return 3===e.type||4===e.type||1===e.type||5===e.type}(e)||pY(e),lY(e.value)}()}function AY(){mY("[");const e=NY();return mY("]"),e}function CY(){const e=function(){var e;for(e=kY();;)if(gY("."))e=fY(".",e,SY());else if(gY("("))e=uY(e,EY());else{if(!gY("["))break;e=fY("[",e,AY())}return e}();if(7===NG.type&&(gY("++")||gY("--")))throw new Error(LG);return e}function DY(){var e,t;if(7!==NG.type&&4!==NG.type)t=CY();else{if(gY("++")||gY("--"))throw new Error(LG);if(gY("+")||gY("-")||gY("~")||gY("!"))e=oY(),t=DY(),t=function(e,t){const n=new AG("UnaryExpression");return n.operator=e,n.argument=t,n.prefix=!0,n}(e.value,t);else{if(yY("delete")||yY("void")||yY("typeof"))throw new Error(LG);t=CY()}}return t}function MY(e){let t=0;if(7!==e.type&&4!==e.type)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11}return t}function FY(){var e,t;return e=function(){var e,t,n,r,i,o,a,s,u,l;if(e=NG,u=DY(),0===(i=MY(r=NG)))return u;for(r.prec=i,oY(),t=[e,NG],o=[u,r,a=DY()];(i=MY(NG))>0;){for(;o.length>2&&i<=o[o.length-2].prec;)a=o.pop(),s=o.pop().value,u=o.pop(),t.pop(),n=sY(s,u,a),o.push(n);(r=oY()).prec=i,o.push(r),t.push(NG),n=DY(),o.push(n)}for(n=o[l=o.length-1],t.pop();l>1;)t.pop(),n=sY(o[l-1].value,o[l-2],n),l-=2;return n}(),gY("?")&&(oY(),t=FY(),mY(":"),e=function(e,t,n){const r=new AG("ConditionalExpression");return r.test=e,r.consequent=t,r.alternate=n,r}(e,t,FY())),e}function NY(){const e=FY();if(gY(","))throw new Error(LG);return e}function OY(e){MG=0,FG=(DG=e).length,NG=null,aY();const t=NY();if(2!==NG.type)throw new Error("Unexpect token after expression.");return t}var $Y={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function TY(e){function t(t,n,r){return i=>function(t,n,r,i){let o=e(n[0]);return r&&(o=r+"("+o+")",0===r.lastIndexOf("new ",0)&&(o="("+o+")")),o+"."+t+(i<0?"":0===i?"()":"("+n.slice(1).map(e).join(",")+")")}(t,i,n,r)}const n="new Date",r="String",i="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(t){t.length<3&&_g("Missing arguments to clamp function."),t.length>3&&_g("Too many arguments to clamp function.");const n=t.map(e);return"Math.max("+n[1]+", Math.min("+n[2]+","+n[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:n,date:t("getDate",n,0),day:t("getDay",n,0),year:t("getFullYear",n,0),month:t("getMonth",n,0),hours:t("getHours",n,0),minutes:t("getMinutes",n,0),seconds:t("getSeconds",n,0),milliseconds:t("getMilliseconds",n,0),time:t("getTime",n,0),timezoneoffset:t("getTimezoneOffset",n,0),utcdate:t("getUTCDate",n,0),utcday:t("getUTCDay",n,0),utcyear:t("getUTCFullYear",n,0),utcmonth:t("getUTCMonth",n,0),utchours:t("getUTCHours",n,0),utcminutes:t("getUTCMinutes",n,0),utcseconds:t("getUTCSeconds",n,0),utcmilliseconds:t("getUTCMilliseconds",n,0),length:t("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:t("toUpperCase",r,0),lower:t("toLowerCase",r,0),substring:t("substring",r),split:t("split",r),trim:t("trim",r,0),regexp:i,test:t("test",i),if:function(t){t.length<3&&_g("Missing arguments to if function."),t.length>3&&_g("Too many arguments to if function.");const n=t.map(e);return"("+n[0]+"?"+n[1]+":"+n[2]+")"}}}function zY(e){const t=(e=e||{}).allowed?Uy(e.allowed):{},n=e.forbidden?Uy(e.forbidden):{},r=e.constants||$Y,i=(e.functions||TY)(f),o=e.globalvar,a=e.fieldvar,s=ay(o)?o:e=>"".concat(o,'["').concat(e,'"]');let u={},l={},c=0;function f(e){if(My(e))return e;const t=d[e.type];return null==t&&_g("Unsupported type: "+e.type),t(e)}const d={Literal:e=>e.raw,Identifier:e=>{const i=e.name;return c>0?i:vy(n,i)?_g("Illegal identifier: "+i):vy(r,i)?r[i]:vy(t,i)?i:(u[i]=1,s(i))},MemberExpression:e=>{const t=!e.computed,n=f(e.object);t&&(c+=1);const r=f(e.property);return n===a&&(l[function(e){const t=e&&e.length-1;return t&&('"'===e[0]&&'"'===e[t]||"'"===e[0]&&"'"===e[t])?e.slice(1,-1):e}(r)]=1),t&&(c-=1),n+(t?"."+r:"["+r+"]")},CallExpression:e=>{"Identifier"!==e.callee.type&&_g("Illegal callee type: "+e.callee.type);const t=e.callee.name,n=e.arguments,r=vy(i,t)&&i[t];return r||_g("Unrecognized function: "+t),ay(r)?r(n):r+"("+n.map(f).join(",")+")"},ArrayExpression:e=>"["+e.elements.map(f).join(",")+"]",BinaryExpression:e=>"("+f(e.left)+" "+e.operator+" "+f(e.right)+")",UnaryExpression:e=>"("+e.operator+f(e.argument)+")",ConditionalExpression:e=>"("+f(e.test)+"?"+f(e.consequent)+":"+f(e.alternate)+")",LogicalExpression:e=>"("+f(e.left)+e.operator+f(e.right)+")",ObjectExpression:e=>"{"+e.properties.map(f).join(",")+"}",Property:e=>{c+=1;const t=f(e.key);return c-=1,t+":"+f(e.value)}};function h(e){const t={code:f(e),globals:Object.keys(u),fields:Object.keys(l)};return u={},l={},t}return h.functions=i,h.constants=r,h}const RY="intersect",PY="union";function LY(e,t){for(var n,r,i=t.fields,o=t.values,a=i.length,s=0;s<a;++s)if((r=i[s]).getter=Eg.getter||Eg(r.field),Sy(n=r.getter(e))&&(n=Ig(n)),Sy(o[s])&&(o[s]=Ig(o[s])),Sy(o[s][0])&&(o[s]=o[s].map(Ig)),"E"===r.type){if($g(o[s])?o[s].indexOf(n)<0:n!==o[s])return!1}else if("R"===r.type){if(!ky(n,o[s]))return!1}else if("R-RE"===r.type){if(!ky(n,o[s],!0,!1))return!1}else if("R-E"===r.type){if(!ky(n,o[s],!1,!1))return!1}else if("R-LE"===r.type&&!ky(n,o[s],!1,!0))return!1;return!0}const BY=Eg("_vgsid_"),IY=function(e){let t=e,n=e;function r(e,t,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){const o=r+i>>>1;n(e[o],t)<0?r=o+1:i=o}return r}return 1===e.length&&(t=(t,n)=>e(t)-n,n=function(e){return(t,n)=>{return(r=e(t))<(i=n)?-1:r>i?1:r>=i?0:NaN;var r,i}}(e)),{left:r,center:function(e,n,i,o){null==i&&(i=0),null==o&&(o=e.length);const a=r(e,n,i,o-1);return a>i&&t(e[a-1],n)>-t(e[a],n)?a-1:a},right:function(e,t,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){const o=r+i>>>1;n(e[o],t)>0?i=o:r=o+1}return r}}}(BY),jY=IY.left,UY=IY.right;var qY={E_union:function(e,t){if(!e.length)return t;for(var n=0,r=t.length;n<r;++n)e.indexOf(t[n])<0&&e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter((e=>t.indexOf(e)>=0)):t},R_union:function(e,t){var n=Ig(t[0]),r=Ig(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<r&&(e[1]=r),e):[n,r]},R_intersect:function(e,t){var n=Ig(t[0]),r=Ig(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?r<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>r&&(e[1]=r),e):[n,r]}};function WY(e,t,n,r){t[0].type!==mG&&_g("First argument to selection functions must be a string literal.");const i=t[0].value,o="unit",a="@unit",s=":"+i;(t.length>=2&&Bg(t).value)!==RY||vy(r,a)||(r["@unit"]=n.getData(i).indataRef(n,o)),vy(r,s)||(r[s]=n.getData(i).tuplesRef())}function HY(e){const t=this.context.data[e];return t?t.values.value:[]}const VY=e=>function(t,n){return this.context.dataflow.locale()[e](n)(t)},GY=VY("format"),YY=VY("timeFormat"),XY=VY("utcFormat"),QY=VY("timeParse"),JY=VY("utcParse"),KY=new Date(2e3,0,1);function ZY(e,t,n){return Number.isInteger(e)&&Number.isInteger(t)?(KY.setYear(2e3),KY.setMonth(e),KY.setDate(t),YY.call(this,KY,n)):""}function eX(e,t,n,r){t[0].type!==mG&&_g("First argument to data functions must be a string literal.");const i=t[0].value,o=":"+i;if(!vy(o,r))try{r[o]=n.getData(i).tuplesRef()}catch(e){}}function tX(e,t,n,r){if(t[0].type===mG)nX(n,r,t[0].value);else for(e in n.scales)nX(n,r,e)}function nX(e,t,n){const r="%"+n;if(!vy(t,r))try{t[r]=e.scaleRef(n)}catch(e){}}function rX(e,t){let n;return ay(e)?e:My(e)?(n=t.scales[e])&&n.value:void 0}function iX(e,t,n){t.__bandwidth=e=>e&&e.bandwidth?e.bandwidth():0,n._bandwidth=tX,n._range=tX,n._scale=tX;const r=t=>"_["+(t.type===mG?Py("%"+t.value):Py("%")+"+"+e(t))+"]";return{_bandwidth:e=>"this.__bandwidth(".concat(r(e[0]),")"),_range:e=>"".concat(r(e[0]),".range()"),_scale:t=>"".concat(r(t[0]),"(").concat(e(t[1]),")")}}function oX(e,t){return function(n,r,i){if(n){const t=rX(n,(i||this).context);return t&&t.path[e](r)}return t(r)}}const aX=oX("area",(function(e){return FB=new Fb,DB(e,NB),2*FB})),sX=oX("bounds",(function(e){var t,n,r,i,o,a,s;if(BB=LB=-(RB=PB=1/0),HB=[],DB(e,eI),n=HB.length){for(HB.sort(lI),t=1,o=[r=HB[0]];t<n;++t)cI(r,(i=HB[t])[0])||cI(r,i[1])?(uI(r[0],i[1])>uI(r[0],r[1])&&(r[1]=i[1]),uI(i[0],r[1])>uI(r[0],r[1])&&(r[0]=i[0])):o.push(r=i);for(a=-1/0,t=0,r=o[n=o.length-1];t<=n;r=i,++t)i=o[t],(s=uI(r[1],i[0]))>a&&(a=s,RB=i[0],LB=r[1])}return HB=VB=null,RB===1/0||PB===1/0?[[NaN,NaN],[NaN,NaN]]:[[RB,PB],[LB,BB]]})),uX=oX("centroid",(function(e){fI=dI=hI=pI=mI=gI=yI=vI=0,bI=new Fb,xI=new Fb,wI=new Fb,DB(e,CI);var t=+bI,n=+xI,r=+wI,i=uB(t,n,r);return i<XL&&(t=gI,n=yI,r=vI,dI<YL&&(t=hI,n=pI,r=mI),(i=uB(t,n,r))<XL)?[NaN,NaN]:[iB(n,t)*eB,gB(r/i)*eB]}));function lX(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(t){e.warn(t)}return n[n.length-1]}function cX(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function fX(e){const t=JD(e);return.2126*cX(t.r)+.7152*cX(t.g)+.0722*cX(t.b)}function dX(e,t){return e===t||e!=e&&t!=t||($g(e)?!(!$g(t)||e.length!==t.length)&&function(e,t){for(let n=0,r=e.length;n<r;++n)if(!dX(e[n],t[n]))return!1;return!0}(e,t):!(!Tg(e)||!Tg(t))&&hX(e,t))}function hX(e,t){for(const n in e)if(!dX(e[n],t[n]))return!1;return!0}function pX(e){return t=>hX(e,t)}const mX={};function gX(e){return $g(e)||ArrayBuffer.isView(e)?e:null}function yX(e){return gX(e)||(My(e)?e:null)}const vX=e=>e.data;function bX(e,t){const n=HY.call(t,e);return n.root&&n.root.lookup||{}}const xX=()=>"undefined"!=typeof window&&window||null;const wX={random:function(){return XE()},cumulativeNormal:aS,cumulativeLogNormal:dS,cumulativeUniform:vS,densityNormal:oS,densityLogNormal:fS,densityUniform:yS,quantileNormal:sS,quantileLogNormal:hS,quantileUniform:bS,sampleNormal:iS,sampleLogNormal:cS,sampleUniform:gS,isArray:$g,isBoolean:Ey,isDate:Sy,isDefined:function(e){return void 0!==e},isNumber:Cy,isObject:Tg,isRegExp:Dy,isString:My,isTuple:iE,isValid:function(e){return null!=e&&e==e},toBoolean:Ly,toDate:Iy,toNumber:Ig,toString:jy,indexof:function(e,...t){return yX(e).indexOf(...t)},join:function(e,...t){return gX(e).join(...t)},lastindexof:function(e,...t){return yX(e).lastIndexOf(...t)},replace:function(e,t,n){return ay(n)&&_g("Function argument passed to replace."),String(e).replace(t,n)},reverse:function(e){return gX(e).slice().reverse()},slice:function(e,...t){return yX(e).slice(...t)},flush:wy,lerp:Ny,merge:function(){const e=[].slice.call(arguments);return e.unshift({}),py(...e)},pad:zy,peek:Bg,pluck:function(e,t){const n=mX[t]||(mX[t]=Eg(t));return $g(e)?e.map(n):n(e)},span:Ry,inrange:ky,truncate:qy,rgb:JD,lab:mM,hcl:_M,hsl:iM,luminance:fX,contrast:function(e,t){const n=fX(e),r=fX(t);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)},sequence:Bb,format:GY,utcFormat:XY,utcParse:JY,utcOffset:Hw,utcSequence:Yw,timeFormat:YY,timeParse:QY,timeOffset:Ww,timeSequence:Gw,timeUnitSpecifier:gw,monthFormat:function(e){return ZY.call(this,e,1,"%B")},monthAbbrevFormat:function(e){return ZY.call(this,e,1,"%b")},dayFormat:function(e){return ZY.call(this,0,2+e,"%A")},dayAbbrevFormat:function(e){return ZY.call(this,0,2+e,"%a")},quarter:ny,utcquarter:ry,week:xw,utcweek:Aw,dayofyear:bw,utcdayofyear:Sw,warn:function(){return lX(this.context.dataflow,"warn",arguments)},info:function(){return lX(this.context.dataflow,"info",arguments)},debug:function(){return lX(this.context.dataflow,"debug",arguments)},extent:my,inScope:function(e){const t=this.context.group;let n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n},intersect:function(e,t,n){if(!e)return[];const[r,i]=e,o=(new C$).set(r[0],r[1],i[0],i[1]);return KR(n||this.context.dataflow.scenegraph().root,o,function(e){let t=null;if(e){const n=iy(e.marktype),r=iy(e.markname);t=e=>(!n.length||n.some((t=>e.marktype===t)))&&(!r.length||r.some((t=>e.name===t)))}return t}(t))},clampRange:oy,pinchDistance:function(e){const t=e.touches,n=t[0].clientX-t[1].clientX,r=t[0].clientY-t[1].clientY;return Math.sqrt(n*n+r*r)},pinchAngle:function(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)},screen:function(){const e=xX();return e?e.screen:{}},containerSize:function(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]},windowSize:function(){const e=xX();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]},bandspace:function(e,t,n){return mN(e||0,t||0,n||0)},setdata:function(e,t){const n=this.context.dataflow,r=this.context.data[e].input;return n.pulse(r,n.changeset().remove(Mg).insert(t)),1},pathShape:function(e){let t=null;return function(n){return n?QO(n,t=t||BO(e)):e}},panLinear:Gg,panLog:Yg,panPow:Xg,panSymlog:Qg,zoomLinear:Kg,zoomLog:Zg,zoomPow:ey,zoomSymlog:ty,encode:function(e,t,n){if(e){const n=this.context.dataflow,r=e.mark.source;n.pulse(r,n.changeset().encode(e,t))}return void 0!==n?n:e},modify:function(e,t,n,r,i,o){const a=this.context.dataflow,s=this.context.data[e],u=s.input,l=a.stamp();let c,f,d=s.changes;if(!1===a._trigger||!(u.value.length||t||r))return 0;if((!d||d.stamp<l)&&(s.changes=d=a.changeset(),d.stamp=l,a.runAfter((()=>{s.modified=!0,a.pulse(u,d).run()}),!0,1)),n&&(c=!0===n?Mg:$g(n)||iE(n)?n:pX(n),d.remove(c)),t&&d.insert(t),r&&(c=pX(r),u.value.some(c)?d.remove(c):d.insert(r)),i)for(f in o)d.modify(i,f,o[f]);return 1}},_X=["view","item","group","xy","x","y"],kX="this.",EX={},SX={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>"_[".concat(Py("$"+e),"]"),functions:function(e){const t=TY(e);_X.forEach((e=>t[e]="event.vega."+e));for(const e in wX)t[e]=kX+e;return py(t,iX(e,wX,EX)),t},constants:$Y,visitors:EX},AX=zY(SX);function CX(e,t,n){return 1===arguments.length?wX[e]:(wX[e]=t,n&&(EX[e]=n),AX&&(AX.functions[e]=kX+e),this)}function DX(e,t){const n={};let r;try{r=OY(e=My(e)?e:Py(e)+"")}catch(t){_g("Expression parse error: "+e)}r.visit((e=>{if(e.type!==xG)return;const r=e.callee.name,i=SX.visitors[r];i&&i(r,e.arguments,t,n)}));const i=AX(r);return i.globals.forEach((e=>{const r="$"+e;!vy(n,r)&&t.getSignal(e)&&(n[r]=t.signalRef(e))})),{$expr:py({code:i.code},t.options.ast?{ast:r}:null),$fields:i.fields,$params:n}}CX("bandwidth",(function(e,t){const n=rX(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}),tX),CX("copy",(function(e,t){const n=rX(e,(t||this).context);return n?n.copy():void 0}),tX),CX("domain",(function(e,t){const n=rX(e,(t||this).context);return n?n.domain():[]}),tX),CX("range",(function(e,t){const n=rX(e,(t||this).context);return n&&n.range?n.range():[]}),tX),CX("invert",(function(e,t,n){const r=rX(e,(n||this).context);return r?$g(t)?(r.invertRange||r.invert)(t):(r.invert||r.invertExtent)(t):void 0}),tX),CX("scale",(function(e,t,n){const r=rX(e,(n||this).context);return r?r(t):void 0}),tX),CX("gradient",(function(e,t,n,r,i){e=rX(e,(i||this).context);const o=TO(t,n);let a=e.domain(),s=a[0],u=Bg(a),l=Ag;return u-s?l=rO(e,s,u):e=(e.interpolator?WN("sequential")().interpolator(e.interpolator()):WN("linear")().interpolate(e.interpolate()).range(e.range())).domain([s=0,u=1]),e.ticks&&(a=e.ticks(+r||15),s!==a[0]&&a.unshift(s),u!==Bg(a)&&a.push(u)),a.forEach((t=>o.stop(l(t),e(t)))),o}),tX),CX("geoArea",aX,tX),CX("geoBounds",sX,tX),CX("geoCentroid",uX,tX),CX("geoShape",(function(e,t,n){const r=rX(e,(n||this).context);return function(e){return r?r.path.context(e)(t):""}}),tX),CX("indata",(function(e,t,n){const r=this.context.data[e]["index:"+t],i=r?r.value.get(n):void 0;return i?i.count:i}),(function(e,t,n,r){t[0].type!==mG&&_g("First argument to indata must be a string literal."),t[1].type!==mG&&_g("Second argument to indata must be a string literal.");const i=t[0].value,o=t[1].value,a="@"+o;vy(a,r)||(r[a]=n.getData(i).indataRef(n,o))})),CX("data",HY,eX),CX("treePath",(function(e,t,n){const r=bX(e,this),i=r[t],o=r[n];return i&&o?i.path(o).map(vX):void 0}),eX),CX("treeAncestors",(function(e,t){const n=bX(e,this)[t];return n?n.ancestors().map(vX):void 0}),eX),CX("vlSelectionTest",(function(e,t,n){for(var r,i,o,a,s,u=this.context.data[e],l=u?u.values.value:[],c=u?u["index:unit"]&&u["index:unit"].value:void 0,f=n===RY,d=l.length,h=0;h<d;++h)if(r=l[h],c&&f){if(-1===(o=(i=i||{})[a=r.unit]||0))continue;if(s=LY(t,r),i[a]=s?-1:++o,s&&1===c.size)return!0;if(!s&&o===c.get(a).count)return!1}else if(f^(s=LY(t,r)))return s;return d&&f}),WY),CX("vlSelectionIdTest",(function(e,t,n){const r=this.context.data[e],i=r?r.values.value:[],o=r?r["index:unit"]&&r["index:unit"].value:void 0,a=n===RY,s=BY(t),u=jY(i,s);if(u===i.length)return!1;if(BY(i[u])!==s)return!1;if(o&&a){if(1===o.size)return!0;if(UY(i,s)-u<o.size)return!1}return!0}),WY),CX("vlSelectionResolve",(function(e,t,n,r){for(var i,o,a,s,u,l,c,f,d,h,p,m=this.context.data[e],g=m?m.values.value:[],y={},v={},b={},x=g.length,w=0;w<x;++w){for(s=(i=g[w]).unit,o=i.fields,a=i.values,h=0,p=o.length;h<p;++h)u=o[h],c=(l=y[u.field]||(y[u.field]={}))[s]||(l[s]=[]),b[u.field]=f=u.type.charAt(0),d=qY[f+"_union"],l[s]=d(c,iy(a[h]));n&&(c=v[s]||(v[s]=[])).push(iy(a).reduce(((e,t,n)=>(e[o[n].field]=t,e)),{}))}if(t=t||PY,Object.keys(y).forEach((e=>{y[e]=Object.keys(y[e]).map((t=>y[e][t])).reduce(((n,r)=>void 0===n?r:qY[b[e]+"_"+t](n,r)))})),g=Object.keys(v),n&&g.length){y[r?"vlPoint":"vlMulti"]=t===PY?{or:g.reduce(((e,t)=>(e.push(...v[t]),e)),[])}:{and:g.map((e=>({or:v[e]})))}}return y}),WY),CX("vlSelectionTuples",(function(e,t){return e.map((e=>py({values:t.fields.map((t=>(t.getter||(t.getter=Eg(t.field)))(e.datum)))},t)))}));const MX=Uy(["rule"]),FX=Uy(["group","image","rect"]);function NX(e){return(e+"").toLowerCase()}function OX(e,t,n){";"!==n[n.length-1]&&(n="return("+n+");");const r=Function(...t.concat(n));return e&&e.functions?r.bind(e.functions):r}var $X={operator:(e,t)=>OX(e,["_"],t.code),parameter:(e,t)=>OX(e,["datum","_"],t.code),event:(e,t)=>OX(e,["event"],t.code),handler:(e,t)=>OX(e,["_","event"],"var datum=event.item&&event.item.datum;return ".concat(t.code,";")),encode:(e,t)=>{const{marktype:n,channels:r}=t;let i="var o=item,datum=o.datum,m=0,$;";for(const e in r){const t="o["+Py(e)+"]";i+="$=".concat(r[e].code,";if(").concat(t,"!==$)").concat(t,"=$,m=1;")}return i+=function(e,t){let n="";return MX[t]||(e.x2&&(e.x?(FX[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(FX[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}(r,n),i+="return m;",OX(e,["item","_"],i)},codegen:{get:function(e){const t="[".concat(e.map(Py).join("]["),"]"),n=Function("_","return _".concat(t,";"));return n.path=t,n},comparator:function(e,t){let n;const r=Function("a","b","var u, v; return "+e.map(((e,r)=>{const i=t[r];let o,a;return e.path?(o="a".concat(e.path),a="b".concat(e.path)):((n=n||{})["f"+r]=e,o="this.f".concat(r,"(a)"),a="this.f".concat(r,"(b)")),function(e,t,n,r){return"((u = ".concat(e,") < (v = ").concat(t,") || u == null) && v != null ? ").concat(n,"\n  : (u > v || v == null) && u != null ? ").concat(r,"\n  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ").concat(n,"\n  : v !== v && u === u ? ").concat(r," : ")}(o,a,-i,i)})).join("")+"0;");return n?r.bind(n):r}}};function TX(e,t,n){if(!e||!Tg(e))return e;for(let r,i=0,o=zX.length;i<o;++i)if(r=zX[i],vy(e,r.key))return r.parse(e,t,n);return e}var zX=[{key:"$ref",parse:function(e,t){return t.get(e.$ref)||_g("Operator not defined: "+e.$ref)}},{key:"$key",parse:function(e,t){const n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=Fy(e.$key,e.$flat,t.expr.codegen))}},{key:"$expr",parse:function(e,t,n){e.$params&&t.parseParameters(e.$params,n);const r="e:"+e.$expr.code+"_"+e.$name;return t.fn[r]||(t.fn[r]=gg(t.parameterExpression(e.$expr),e.$fields,e.$name))}},{key:"$field",parse:function(e,t){if(!e.$field)return null;const n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=Eg(e.$field,e.$name,t.expr.codegen))}},{key:"$encode",parse:function(e,t){const n=e.$encode,r={};for(const e in n){const i=n[e];r[e]=gg(t.encodeExpression(i.$expr),i.$fields),r[e].output=i.$output}return r}},{key:"$compare",parse:function(e,t){const n="c:"+e.$compare+"_"+e.$order,r=iy(e.$compare).map((e=>e&&e.$tupleid?oE:e));return t.fn[n]||(t.fn[n]=sy(r,e.$order,t.expr.codegen))}},{key:"$context",parse:function(e,t){return t}},{key:"$subflow",parse:function(e,t){const n=e.$subflow;return function(e,r,i){const o=t.fork().parse(n),a=o.get(n.operators[0].id),s=o.signals.parent;return s&&s.set(i),a.detachSubflow=()=>t.detach(o),a}}},{key:"$tupleid",parse:function(){return oE}}];const RX={skip:!0};function PX(e,t,n,r){return new LX(e,t,n,r)}function LX(e,t,n,r){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=r||$X,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function BX(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}function IX(e,t){e&&(null==t?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}LX.prototype=BX.prototype={fork:function(){const e=new BX(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach:function(e){this.subcontext=this.subcontext.filter((t=>t!==e));const t=Object.keys(e.nodes);for(const n of t)e.nodes[n]._targets=null;for(const n of t)e.nodes[n].detach();e.nodes=null},get:function(e){return this.nodes[e]},set:function(e,t){return this.nodes[e]=t},add:function(e,t){const n=this,r=n.dataflow,i=e.value;if(n.set(e.id,t),"collect"===NX(e.type)&&i&&(i.$ingest?r.ingest(t,i.$ingest,i.$format):i.$request?r.preload(t,i.$request,i.$format):r.pulse(t,r.changeset().insert(i))),e.root&&(n.root=t),e.parent){let i=n.get(e.parent.$ref);i?(r.connect(i,[t]),t.targets().add(i)):(n.unresolved=n.unresolved||[]).push((()=>{i=n.get(e.parent.$ref),r.connect(i,[t]),t.targets().add(i)}))}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(const r in e.data){const i=n.data[r]||(n.data[r]={});e.data[r].forEach((e=>i[e]=t))}},resolve:function(){return(this.unresolved||[]).forEach((e=>e())),delete this.unresolved,this},operator:function(e,t){this.add(e,this.dataflow.add(e.value,t))},transform:function(e,t){this.add(e,this.dataflow.add(this.transforms[NX(t)]))},stream:function(e,t){this.set(e.id,t)},update:function(e,t,n,r,i){this.dataflow.on(t,n,r,i,e.options)},operatorExpression:function(e){return this.expr.operator(this,e)},parameterExpression:function(e){return this.expr.parameter(this,e)},eventExpression:function(e){return this.expr.event(this,e)},handlerExpression:function(e){return this.expr.handler(this,e)},encodeExpression:function(e){return this.expr.encode(this,e)},parse:function(e){const t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach((e=>t.parseOperator(e))),n.forEach((e=>t.parseOperatorParameters(e))),(e.streams||[]).forEach((e=>t.parseStream(e))),(e.updates||[]).forEach((e=>t.parseUpdate(e))),t.resolve()},parseOperator:function(e){const t=this;"operator"!==NX(e.type)&&e.type?t.transform(e,e.type):t.operator(e,e.update?t.operatorExpression(e.update):null)},parseOperatorParameters:function(e){const t=this;if(e.params){const n=t.get(e.id);n||_g("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}},parseParameters:function(e,t){t=t||{};const n=this;for(const r in e){const i=e[r];t[r]=$g(i)?i.map((e=>TX(e,n,t))):TX(i,n,t)}return t},parseStream:function(e){var t,n=this,r=null!=e.filter?n.eventExpression(e.filter):void 0,i=null!=e.stream?n.get(e.stream):void 0;e.source?i=n.events(e.source,e.type,r):e.merge&&(i=(t=e.merge.map((e=>n.get(e))))[0].merge.apply(t[0],t.slice(1))),e.between&&(t=e.between.map((e=>n.get(e))),i=i.between(t[0],t[1])),e.filter&&(i=i.filter(r)),null!=e.throttle&&(i=i.throttle(+e.throttle)),null!=e.debounce&&(i=i.debounce(+e.debounce)),null==i&&_g("Invalid stream definition: "+JSON.stringify(e)),e.consume&&i.consume(!0),n.stream(e,i)},parseUpdate:function(e){var t,n=this,r=Tg(r=e.source)?r.$ref:r,i=n.get(r),o=e.update,a=void 0;i||_g("Source not defined: "+e.source),t=e.target&&e.target.$expr?n.eventExpression(e.target.$expr):n.get(e.target),o&&o.$expr&&(o.$params&&(a=n.parseParameters(o.$params)),o=n.handlerExpression(o.$expr)),n.update(e,i,t,o,a)},getState:function(e){var t=this,n={};if(e.signals){var r=n.signals={};Object.keys(t.signals).forEach((n=>{const i=t.signals[n];e.signals(n,i)&&(r[n]=i.value)}))}if(e.data){var i=n.data={};Object.keys(t.data).forEach((n=>{const r=t.data[n];e.data(n,r)&&(i[n]=r.input.value)}))}return t.subcontext&&!1!==e.recurse&&(n.subcontext=t.subcontext.map((t=>t.getState(e)))),n},setState:function(e){var t=this,n=t.dataflow,r=e.data,i=e.signals;Object.keys(i||{}).forEach((e=>{n.update(t.signals[e],i[e],RX)})),Object.keys(r||{}).forEach((e=>{n.pulse(t.data[e].input,n.changeset().remove(Mg).insert(r[e]))})),(e.subcontext||[]).forEach(((e,n)=>{const r=t.subcontext[n];r&&r.setState(e)}))}};const jX="default";function UX(e,t){const n=e.globalCursor()?"undefined"!=typeof document&&document.body:e.container();if(n)return null==t?n.style.removeProperty("cursor"):n.style.cursor=t}function qX(e,t){var n=e._runtime.data;return vy(n,t)||_g("Unrecognized data set: "+t),n[t]}function WX(e,t){dE(t)||_g("Second argument to changes must be a changeset.");const n=qX(this,e);return n.modified=!0,this.pulse(n.input,t)}function HX(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function VX(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function GX(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function YX(e,t,n){var r,i,o=e._renderer,a=o&&o.canvas();return a&&(i=GX(e),(r=Rz(t.changedTouches?t.changedTouches[0]:t,a))[0]-=i[0],r[1]-=i[1]),t.dataflow=e,t.item=n,t.vega=function(e,t,n){const r=t?"group"===t.mark.marktype?t:t.mark.group:null;function i(e){var n,i=r;if(e)for(n=t;n;n=n.mark.group)if(n.mark.name===e){i=n;break}return i&&i.mark&&i.mark.interactive?i:{}}function o(e){if(!e)return n;My(e)&&(e=i(e));const t=n.slice();for(;e;)t[0]-=e.x||0,t[1]-=e.y||0,e=e.mark&&e.mark.group;return t}return{view:dy(e),item:dy(t||{}),group:i,xy:o,x:e=>o(e)[0],y:e=>o(e)[1]}}(e,n,r),t}const XX="view",QX={trap:!1};function JX(e,t,n,r){e._eventListeners.push({type:n,sources:iy(t),handler:r})}function KX(e,t,n){const r=e._eventConfig&&e._eventConfig[t];return!(!1===r||Tg(r)&&!r[n])||(e.warn(`Blocked ${t} ${n} event listener.`),!1)}function ZX(e){return e.item}function eQ(e){return e.item.mark.source}function tQ(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function nQ(e,t,n){const r=document.createElement(e);for(const e in t)r.setAttribute(e,t[e]);return null!=n&&(r.textContent=n),r}function rQ(e,t,n,r){const i=n.event||"input",o=()=>e.update(t.value);r.signal(n.signal,t.value),t.addEventListener(i,o),JX(r,t,i,o),e.set=e=>{t.value=e,t.dispatchEvent(function(e){return"undefined"!=typeof Event?new Event(e):{type:e}}(i))}}function iQ(e,t,n,r){const i=r.signal(n.signal),o=nQ("div",{class:"vega-bind"}),a="radio"===n.input?o:o.appendChild(nQ("label"));a.appendChild(nQ("span",{class:"vega-bind-name"},n.name||n.signal)),t.appendChild(o);let s=oQ;switch(n.input){case"checkbox":s=aQ;break;case"select":s=sQ;break;case"radio":s=uQ;break;case"range":s=lQ}s(e,a,n,i)}function oQ(e,t,n,r){const i=nQ("input");for(const e in n)"signal"!==e&&"element"!==e&&i.setAttribute("input"===e?"type":e,n[e]);i.setAttribute("name",n.signal),i.value=r,t.appendChild(i),i.addEventListener("input",(()=>e.update(i.value))),e.elements=[i],e.set=e=>i.value=e}function aQ(e,t,n,r){const i={type:"checkbox",name:n.signal};r&&(i.checked=!0);const o=nQ("input",i);t.appendChild(o),o.addEventListener("change",(()=>e.update(o.checked))),e.elements=[o],e.set=e=>o.checked=!!e||null}function sQ(e,t,n,r){const i=nQ("select",{name:n.signal}),o=n.labels||[];n.options.forEach(((e,t)=>{const n={value:e};cQ(e,r)&&(n.selected=!0),i.appendChild(nQ("option",n,(o[t]||e)+""))})),t.appendChild(i),i.addEventListener("change",(()=>{e.update(n.options[i.selectedIndex])})),e.elements=[i],e.set=e=>{for(let t=0,r=n.options.length;t<r;++t)if(cQ(n.options[t],e))return void(i.selectedIndex=t)}}function uQ(e,t,n,r){const i=nQ("span",{class:"vega-bind-radio"}),o=n.labels||[];t.appendChild(i),e.elements=n.options.map(((t,a)=>{const s={type:"radio",name:n.signal,value:t};cQ(t,r)&&(s.checked=!0);const u=nQ("input",s);u.addEventListener("change",(()=>e.update(t)));const l=nQ("label",{},(o[a]||t)+"");return l.prepend(u),i.appendChild(l),u})),e.set=t=>{const n=e.elements,r=n.length;for(let e=0;e<r;++e)cQ(n[e].value,t)&&(n[e].checked=!0)}}function lQ(e,t,n,r){r=void 0!==r?r:(+n.max+ +n.min)/2;const i=null!=n.max?n.max:Math.max(100,+r)||100,o=n.min||Math.min(0,i,+r)||0,a=n.step||Vb(o,i,100),s=nQ("input",{type:"range",name:n.signal,min:o,max:i,step:a});s.value=r;const u=nQ("span",{},+r);t.appendChild(s),t.appendChild(u);const l=()=>{u.textContent=s.value,e.update(+s.value)};s.addEventListener("input",l),s.addEventListener("change",l),e.elements=[s],e.set=e=>{s.value=e,u.textContent=e}}function cQ(e,t){return e===t||e+""==t+""}function fQ(e,t,n,r,i,o){return(t=t||new r(e.loader())).initialize(n,HX(e),VX(e),GX(e),i,o).background(e.background())}function dQ(e,t){return t?function(){try{t.apply(this,arguments)}catch(t){e.error(t)}}:null}function hQ(e,t,n){if("string"==typeof t){if("undefined"==typeof document)return e.error("DOM document instance not found."),null;if(!(t=document.querySelector(t)))return e.error("Signal bind element not found: "+t),null}if(t&&n)try{t.innerHTML=""}catch(n){t=null,e.error(n)}return t}const pQ=e=>+e||0;function mQ(e){return Tg(e)?{top:pQ(e.top),bottom:pQ(e.bottom),left:pQ(e.left),right:pQ(e.right)}:(e=>({top:e,bottom:e,left:e,right:e}))(pQ(e))}async function gQ(e,t,n,r){const i=JR(t),o=i&&i.headless;return o||_g("Unrecognized renderer type: "+t),await e.runAsync(),fQ(e,null,null,o,n,r).renderAsync(e._scenegraph.root)}var yQ="width",vQ="height",bQ="padding",xQ={skip:!0};function wQ(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===bQ?r.left+r.right:0)}function _Q(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===bQ?r.top+r.bottom:0)}function kQ(e,t){return t.modified&&$g(t.input.value)&&e.indexOf("_:vega:_")}function EQ(e,t){return!("parent"===e||t instanceof BE.proxy)}function SQ(e,t,n,r){const i=e.element();i&&i.setAttribute("title",function(e){return null==e?"":$g(e)?AQ(e):Tg(e)&&!Sy(e)?(t=e,Object.keys(t).map((e=>{const n=t[e];return e+": "+($g(n)?AQ(n):CQ(n))})).join("\n")):e+"";var t}(r))}function AQ(e){return"["+e.map(CQ).join(", ")+"]"}function CQ(e){return $g(e)?"[]":Tg(e)&&!Sy(e)?"{}":e}function DQ(e,t){const n=this;if(t=t||{},RE.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),null!=t.logLevel&&n.logLevel(t.logLevel),t.locale||e.locale){const r=py({},e.locale,t.locale);n.locale(Xk(r.number,r.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||XR.Canvas,n._scenegraph=new Mz;const r=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||SQ,n._redraw=!0,n._handler=(new tR).scene(r),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=function(e){const t=py({defaults:{}},e),n=(e,t)=>{t.forEach((t=>{$g(e[t])&&(e[t]=Uy(e[t]))}))};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const i=function(e,t,n){return PX(e,BE,wX,n).parse(t)}(n,e,t.expr);n._runtime=i,n._signals=i.signals,n._bind=(e.bindings||[]).map((e=>({state:null,param:py({},e)}))),i.root&&i.root.set(r),r.source=i.data.root.input,n.pulse(i.data.root.input,n.changeset().insert(r.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=wQ(n,n._width),n._viewHeight=_Q(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,function(e){var t=e._signals,n=t.width,r=t.height,i=t.padding;function o(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,(t=>{e._width=t.size,e._viewWidth=wQ(e,t.size),o()}),{size:n}),e._resizeHeight=e.add(null,(t=>{e._height=t.size,e._viewHeight=_Q(e,t.size),o()}),{size:r});const a=e.add(null,o,{pad:i});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=r.rank+1,a.rank=i.rank+1}(n),function(e){e.add(null,(t=>(e._background=t.bg,e._resize=1,t.bg)),{bg:e._signals.background})}(n),function(e){const t=e._signals.cursor||(e._signals.cursor=e.add({user:jX,item:null}));e.on(e.events("view","mousemove"),t,((e,n)=>{const r=t.value,i=r?My(r)?r:r.user:jX,o=n.item&&n.item.cursor||null;return r&&i===r.user&&o==r.item?r:{user:i,item:o}})),e.add(null,(function(t){let n=t.cursor,r=this.value;return My(n)||(r=n.item,n=n.user),UX(e,n&&n!==jX?n:r||n),r}),{cursor:t})}(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind)}function MQ(e,t){return vy(e._signals,t)?e._signals[t]:_g("Unrecognized signal name: "+Py(t))}function FQ(e,t){const n=(e._targets||[]).filter((e=>e._update&&e._update.handler===t));return n.length?n[0]:null}function NQ(e,t,n,r){let i=FQ(n,r);return i||(i=dQ(e,(()=>r(t,n.value))),i.handler=r,e.on(n,null,i)),e}function OQ(e,t,n){const r=FQ(t,n);return r&&t._targets.remove(r),e}_y(DQ,RE,{evaluate:async function(e,t,n){if(await RE.prototype.evaluate.call(this,e,t),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,i=GX(r=this),o=HX(r),a=VX(r),r._renderer.background(r.background()),r._renderer.resize(o,a,i),r._handler.origin(i),r._resizeListeners.forEach((e=>{try{e(o,a)}catch(e){r.error(e)}}))),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(e){this.error(e)}var r,i,o,a;return n&&tE(this,n),this},dirty:function(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description:function(e){if(arguments.length){const t=null!=e?e+"":null;return t!==this._desc&&IX(this._el,this._desc=t),this}return this._desc},container:function(){return this._el},scenegraph:function(){return this._scenegraph},origin:function(){return this._origin.slice()},signal:function(e,t,n){const r=MQ(this,e);return 1===arguments.length?r.value:this.update(r,t,n)},width:function(e){return arguments.length?this.signal("width",e):this.signal("width")},height:function(e){return arguments.length?this.signal("height",e):this.signal("height")},padding:function(e){return arguments.length?this.signal("padding",mQ(e)):mQ(this.signal("padding"))},autosize:function(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background:function(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer:function(e){return arguments.length?(JR(e)||_g("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip:function(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader:function(e){return arguments.length?(e!==this._loader&&(RE.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize:function(){return this._autosize=1,this.touch(MQ(this,"autosize"))},_resetRenderer:function(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:function(e,t,n,r,i,o){this.runAfter((a=>{let s=0;a._autosize=0,a.width()!==n&&(s=1,a.signal(yQ,n,xQ),a._resizeWidth.skip(!0)),a.height()!==r&&(s=1,a.signal(vQ,r,xQ),a._resizeHeight.skip(!0)),a._viewWidth!==e&&(a._resize=1,a._viewWidth=e),a._viewHeight!==t&&(a._resize=1,a._viewHeight=t),a._origin[0]===i[0]&&a._origin[1]===i[1]||(a._resize=1,a._origin=i),s&&a.run("enter"),o&&a.runAfter((e=>e.resize()))}),!1,1)},addEventListener:function(e,t,n){let r=t;return n&&!1===n.trap||(r=dQ(this,t),r.raw=t),this._handler.on(e,r),this},removeEventListener:function(e,t){for(var n,r,i=this._handler.handlers(e),o=i.length;--o>=0;)if(r=i[o].type,n=i[o].handler,e===r&&(t===n||t===n.raw)){this._handler.off(r,n);break}return this},addResizeListener:function(e){const t=this._resizeListeners;return t.indexOf(e)<0&&t.push(e),this},removeResizeListener:function(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener:function(e,t){return NQ(this,e,MQ(this,e),t)},removeSignalListener:function(e,t){return OQ(this,MQ(this,e),t)},addDataListener:function(e,t){return NQ(this,e,qX(this,e).values,t)},removeDataListener:function(e,t){return OQ(this,qX(this,e).values,t)},globalCursor:function(e){if(arguments.length){if(this._globalCursor!==!!e){const t=UX(this,null);this._globalCursor=!!e,t&&UX(this,t)}return this}return this._globalCursor},preventDefault:function(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:function(e,t){this._timers.push(function(e,t,n){var r=new pW,i=t;return null==t?(r.restart(e,t,n),r):(r._restart=r.restart,r.restart=function(e,t,n){t=+t,n=null==n?dW():+n,r._restart((function o(a){a+=i,r._restart(o,i+=t,n),e(a)}),t,n)},r.restart(e,t,n),r)}((function(t){e({timestamp:Date.now(),elapsed:t})}),t))},events:function(e,t,n){var r,i=this,o=new wE(n),a=function(n,r){i.runAsync(null,(()=>{e===XX&&function(e,t){var n=e._eventConfig.defaults,r=n.prevent,i=n.allow;return!1!==r&&!0!==i&&(!0===r||!1===i||(r?r[t]:i?!i[t]:e.preventDefault()))}(i,t)&&n.preventDefault(),o.receive(YX(i,n,r))}))};if("timer"===e)KX(i,"timer",t)&&i.timer(a,t);else if(e===XX)KX(i,"view",t)&&i.addEventListener(t,a,QX);else if("window"===e?KX(i,"window",t)&&"undefined"!=typeof window&&(r=[window]):"undefined"!=typeof document&&KX(i,"selector",t)&&(r=document.querySelectorAll(e)),r){for(var s=0,u=r.length;s<u;++s)r[s].addEventListener(t,a);JX(i,r,t,a)}else i.warn("Can not resolve event source: "+e);return o},finalize:function(){var e,t,n,r=this._tooltip,i=this._timers,o=this._eventListeners;for(e=i.length;--e>=0;)i[e].stop();for(e=o.length;--e>=0;)for(t=(n=o[e]).sources.length;--t>=0;)n.sources[t].removeEventListener(n.type,n.handler);return r&&r.call(this,this._handler,null,null,null),this},hover:function(e,t){return t=[t||"update",(e=[e||"hover"])[0]],this.on(this.events("view","mouseover",ZX),eQ,tQ(e)),this.on(this.events("view","mouseout",ZX),eQ,tQ(t)),this},data:function(e,t){return arguments.length<2?qX(this,e).values.value:WX.call(this,e,hE().remove(Mg).insert(t))},change:WX,insert:function(e,t){return WX.call(this,e,hE().insert(t))},remove:function(e,t){return WX.call(this,e,hE().remove(t))},scale:function(e){var t=this._runtime.scales;return vy(t,e)||_g("Unrecognized scale or projection: "+e),t[e].value},initialize:function(e,t){const n=this,r=n._renderType,i=n._eventConfig.bind,o=JR(r);e=n._el=e?hQ(n,e,!0):null,function(e){const t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),IX(t,e.description()))}(n),o||n.error("Unrecognized renderer type: "+r);const a=o.handler||tR,s=e?o.renderer:o.headless;return n._renderer=s?fQ(n,n._renderer,e,s):null,n._handler=function(e,t,n,r){const i=new r(e.loader(),dQ(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,GX(e),e);return t&&t.handlers().forEach((e=>{i.on(e.type,e.handler)})),i}(n,n._handler,e,a),n._redraw=!0,e&&"none"!==i&&(t=t?n._elBind=hQ(n,t,!0):e.appendChild(nQ("form",{class:"vega-bindings"})),n._bind.forEach((e=>{e.param.element&&"container"!==i&&(e.element=hQ(n,e.param.element,!!e.param.input))})),n._bind.forEach((e=>{!function(e,t,n){if(!t)return;const r=n.param;let i=n.state;i||(i=n.state={elements:null,active:!1,set:null,update:t=>{t!=e.signal(r.signal)&&e.runAsync(null,(()=>{i.source=!0,e.signal(r.signal,t)}))}},r.debounce&&(i.update=hy(r.debounce,i.update))),(null==r.input&&r.element?rQ:iQ)(i,t,r,e),i.active||(e.on(e._signals[r.signal],null,(()=>{i.source?i.source=!1:i.set(e.signal(r.signal))})),i.active=!0)}(n,e.element||t,e)}))),n},toImageURL:async function(e,t){e!==XR.Canvas&&e!==XR.SVG&&e!==XR.PNG&&_g("Unrecognized image type: "+e);const n=await gQ(this,e,t);return e===XR.SVG?function(e,t){const n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")},toCanvas:async function(e,t){return(await gQ(this,XR.Canvas,e,t)).canvas()},toSVG:async function(e){return(await gQ(this,XR.SVG,e)).svg()},getState:function(e){return this._runtime.getState(e||{data:kQ,signals:EQ,recurse:!0})},setState:function(e){return this.runAsync(null,(t=>{t._trigger=!1,t._runtime.setState(e)}),(e=>{e._trigger=!0})),this}});const $Q="[",TQ="]",zQ=/[[\]{}]/,RQ={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let PQ,LQ;function BQ(e,t,n){return PQ=t||"view",LQ=n||RQ,jQ(e.trim()).map(UQ)}function IQ(e,t,n,r,i){const o=e.length;let a,s=0;for(;t<o;++t){if(a=e[t],!s&&a===n)return t;i&&i.indexOf(a)>=0?--s:r&&r.indexOf(a)>=0&&++s}return t}function jQ(e){const t=[],n=e.length;let r=0,i=0;for(;i<n;)i=IQ(e,i,",","[{","]}"),t.push(e.substring(r,i).trim()),r=++i;if(0===t.length)throw"Empty event selector: "+e;return t}function UQ(e){return"["===e[0]?function(e){const t=e.length;let n,r=1;if(r=IQ(e,r,TQ,$Q,TQ),r===t)throw"Empty between selector: "+e;if(n=jQ(e.substring(1,r)),2!==n.length)throw"Between selector must have two elements: "+e;if(">"!==(e=e.slice(r+1).trim())[0])throw"Expected '>' after between selector: "+e;n=n.map(UQ);const i=UQ(e.slice(1).trim());if(i.between)return{between:n,stream:i};i.between=n;return i}(e):function(e){const t={source:PQ},n=[];let r,i,o=[0,0],a=0,s=0,u=e.length,l=0;if("}"===e[u-1]){if(l=e.lastIndexOf("{"),!(l>=0))throw"Unmatched right brace: "+e;try{o=function(e){const t=e.split(",");if(!e.length||t.length>2)throw e;return t.map((t=>{const n=+t;if(n!=n)throw e;return n}))}(e.substring(l+1,u-1))}catch(t){throw"Invalid throttle specification: "+e}u=(e=e.slice(0,l).trim()).length,l=0}if(!u)throw e;"@"===e[0]&&(a=++l);r=IQ(e,l,":"),r<u&&(n.push(e.substring(s,r).trim()),s=l=++r);if(l=IQ(e,l,$Q),l===u)n.push(e.substring(s,u).trim());else if(n.push(e.substring(s,l).trim()),i=[],s=++l,s===u)throw"Unmatched left bracket: "+e;for(;l<u;){if(l=IQ(e,l,TQ),l===u)throw"Unmatched left bracket: "+e;if(i.push(e.substring(s,l).trim()),l<u-1&&e[++l]!==$Q)throw"Expected left bracket: "+e;s=++l}if(!(u=n.length)||zQ.test(n[u-1]))throw"Invalid event selector: "+e;u>1?(t.type=n[1],a?t.markname=n[0].slice(1):(c=n[0],LQ[c]?t.marktype=n[0]:t.source=n[0])):t.type=n[0];var c;"!"===t.type.slice(-1)&&(t.consume=!0,t.type=t.type.slice(0,-1));null!=i&&(t.filter=i);o[0]&&(t.throttle=o[0]);o[1]&&(t.debounce=o[1]);return t}(e)}function qQ(e){return Tg(e)?e:{type:e||"pad"}}const WQ=e=>+e||0;function HQ(e){return Tg(e)?e.signal?e:{top:WQ(e.top),bottom:WQ(e.bottom),left:WQ(e.left),right:WQ(e.right)}:{top:t=WQ(e),bottom:t,left:t,right:t};var t}const VQ=e=>Tg(e)&&!$g(e)?py({},e):{value:e};function GQ(e,t,n,r){if(null!=n){return Tg(n)&&!$g(n)||$g(n)&&n.length&&Tg(n[0])?e.update[t]=n:e[r||"enter"][t]={value:n},1}return 0}function YQ(e,t,n){for(const n in t)GQ(e,n,t[n]);for(const t in n)GQ(e,t,n[t],"update")}function XQ(e,t,n){for(const r in t)n&&vy(n,r)||(e[r]=py(e[r]||{},t[r]));return e}function QQ(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}const JQ="mark",KQ="frame",ZQ="scope",eJ="legend-label",tJ="title-text",nJ="title-subtitle";function rJ(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}const iJ=e=>My(e)?Py(e):e.signal?"(".concat(e.signal,")"):uJ(e);function oJ(e){if(null!=e.gradient)return function(e){const t=[e.start,e.stop,e.count].map((e=>null==e?null:Py(e)));for(;t.length&&null==Bg(t);)t.pop();return t.unshift(iJ(e.gradient)),"gradient(".concat(t.join(","),")")}(e);let t=e.signal?"(".concat(e.signal,")"):e.color?function(e){return e.c?aJ("hcl",e.h,e.c,e.l):e.h||e.s?aJ("hsl",e.h,e.s,e.l):e.l||e.a?aJ("lab",e.l,e.a,e.b):e.r||e.g||e.b?aJ("rgb",e.r,e.g,e.b):null}(e.color):null!=e.field?uJ(e.field):void 0!==e.value?Py(e.value):void 0;return null!=e.scale&&(t=function(e,t){const n=iJ(e.scale);null!=e.range?t="lerp(_range(".concat(n,"), ").concat(+e.range,")"):(void 0!==t&&(t="_scale(".concat(n,", ").concat(t,")")),e.band&&(t=(t?t+"+":"")+"_bandwidth(".concat(n,")")+(1==+e.band?"":"*"+sJ(e.band)),e.extra&&(t="(datum.extra ? _scale(".concat(n,", datum.extra.value) : ").concat(t,")"))),null==t&&(t="0"));return t}(e,t)),void 0===t&&(t=null),null!=e.exponent&&(t="pow(".concat(t,",").concat(sJ(e.exponent),")")),null!=e.mult&&(t+="*".concat(sJ(e.mult))),null!=e.offset&&(t+="+".concat(sJ(e.offset))),e.round&&(t="round(".concat(t,")")),t}const aJ=(e,t,n,r)=>"(".concat(e,"(").concat([t,n,r].map(oJ).join(","),")+'')");function sJ(e){return Tg(e)?"("+oJ(e)+")":e}function uJ(e){return lJ(Tg(e)?e:{datum:e})}function lJ(e){let t,n,r;if(e.signal)t="datum",r=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t="item";n-- >0;)t+=".mark.group";e.parent?(r=e.parent,t+=".datum"):r=e.group}else e.datum?(t="datum",r=e.datum):_g("Invalid field reference: "+Py(e));return e.signal||(r=My(r)?kg(r).map(Py).join("]["):lJ(r)),t+"["+r+"]"}function cJ(e,t,n,r,i,o){const a={};(o=o||{}).encoders={$encode:a},e=function(e,t,n,r,i){const o={},a={};let s,u,l,c;for(u in u="lineBreak","text"!==t||null==i[u]||QQ(u,e)||rJ(o,u,i[u]),("legend"==n||String(n).startsWith("axis"))&&(n=null),c=n===KQ?i.group:n===JQ?py({},i.mark,i[t]):null,c)l=QQ(u,e)||("fill"===u||"stroke"===u)&&(QQ("fill",e)||QQ("stroke",e)),l||rJ(o,u,c[u]);for(u in iy(r).forEach((t=>{const n=i.style&&i.style[t];for(const t in n)QQ(t,e)||rJ(o,t,n[t])})),e=py({},e),o)c=o[u],c.signal?(s=s||{})[u]=c:a[u]=c;return e.enter=py(a,e.enter),s&&(e.update=py(s,e.update)),e}(e,t,n,r,i.config);for(const n in e)a[n]=fJ(e[n],t,o,i);return o}function fJ(e,t,n,r){const i={},o={};for(const t in e)null!=e[t]&&(i[t]=dJ((a=e[t],$g(a)?function(e){let t="";return e.forEach((e=>{const n=oJ(e);t+=e.test?"(".concat(e.test,")?").concat(n,":"):n})),":"===Bg(t)&&(t+="null"),t}(a):oJ(a)),r,n,o));var a;return{$expr:{marktype:t,channels:i},$fields:Object.keys(o),$output:Object.keys(e)}}function dJ(e,t,n,r){const i=DX(e,t);return i.$fields.forEach((e=>r[e]=1)),py(n,i.$params),i.$expr}const hJ=["value","update","init","react","bind"];function pJ(e,t){_g(e+' for "outer" push: '+Py(t))}function mJ(e,t){const n=e.name;if("outer"===e.push)t.signals[n]||pJ("No prior signal definition",n),hJ.forEach((t=>{void 0!==e[t]&&pJ("Invalid property ",t)}));else{const r=t.addSignal(n,e.value);!1===e.react&&(r.react=!1),e.bind&&t.addBinding(n,e.bind)}}function gJ(e,t,n,r){this.id=-1,this.type=e,this.value=t,this.params=n,r&&(this.parent=r)}function yJ(e,t,n,r){return new gJ(e,t,n,r)}function vJ(e,t){return yJ("operator",e,t)}function bJ(e){const t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function xJ(e,t){return t?{$field:e,$name:t}:{$field:e}}const wJ=xJ("key");function _J(e,t){return{$compare:e,$order:t}}function kJ(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}const EJ="scope",SJ="view";function AJ(e){return e&&e.signal}function CJ(e){if(AJ(e))return!0;if(Tg(e))for(const t in e)if(CJ(e[t]))return!0;return!1}function DJ(e,t){return null!=e?e:t}function MJ(e){return e&&e.signal||e}const FJ="timer";function NJ(e,t){return(e.merge?OJ:e.stream?$J:e.type?TJ:_g("Invalid stream specification: "+Py(e)))(e,t)}function OJ(e,t){const n=zJ({merge:e.merge.map((e=>NJ(e,t)))},e,t);return t.addStream(n).id}function $J(e,t){const n=zJ({stream:NJ(e.stream,t)},e,t);return t.addStream(n).id}function TJ(e,t){let n;var r;e.type===FJ?(n=t.event(FJ,e.throttle),e={between:e.between,filter:e.filter}):n=t.event((r=e.source)===EJ?SJ:r||SJ,e.type);const i=zJ({stream:n},e,t);return 1===Object.keys(i).length?n:t.addStream(i).id}function zJ(e,t,n){let r=t.between;return r&&(2!==r.length&&_g('Stream "between" parameter must have 2 entries: '+Py(t)),e.between=[NJ(r[0],n),NJ(r[1],n)]),r=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&r.push(function(e,t,n){const r="event.item";return r+(e&&"*"!==e?"&&"+r+".mark.marktype==='"+e+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(t?"&&"+r+".mark.name==='"+t+"'":"")}(t.marktype,t.markname,t.markrole)),t.source===EJ&&r.push("inScope(event.item)"),r.length&&(e.filter=DX("("+r.join(")&&(")+")",n).$expr),null!=(r=t.throttle)&&(e.throttle=+r),null!=(r=t.debounce)&&(e.debounce=+r),t.consume&&(e.consume=!0),e}const RJ={code:"_.$value",ast:{type:"Identifier",value:"value"}};function PJ(e,t,n){const r=e.encode,i={target:n};let o=e.events,a=e.update,s=[];o||_g("Signal update missing events specification."),My(o)&&(o=BQ(o,t.isSubscope()?EJ:SJ)),o=iy(o).filter((e=>e.signal||e.scale?(s.push(e),0):1)),s.length>1&&(s=[LJ(s)]),o.length&&s.push(o.length>1?{merge:o}:o[0]),null!=r&&(a&&_g("Signal encode and update are mutually exclusive."),a="encode(item(),"+Py(r)+")"),i.update=My(a)?DX(a,t):null!=a.expr?DX(a.expr,t):null!=a.value?a.value:null!=a.signal?{$expr:RJ,$params:{$value:t.signalRef(a.signal)}}:_g("Invalid signal update specification."),e.force&&(i.options={force:!0}),s.forEach((e=>t.addUpdate(py(function(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):NJ(e,t)}}(e,t),i))))}function LJ(e){return{signal:"["+e.map((e=>e.scale?'scale("'+e.scale+'")':e.signal))+"]"}}const BJ=e=>(t,n,r)=>yJ(e,n,t||void 0,r),IJ=BJ("aggregate"),jJ=BJ("axisticks"),UJ=BJ("bound"),qJ=BJ("collect"),WJ=BJ("compare"),HJ=BJ("datajoin"),VJ=BJ("encode"),GJ=BJ("expression"),YJ=BJ("facet"),XJ=BJ("field"),QJ=BJ("key"),JJ=BJ("legendentries"),KJ=BJ("load"),ZJ=BJ("mark"),eK=BJ("multiextent"),tK=BJ("multivalues"),nK=BJ("overlap"),rK=BJ("params"),iK=BJ("prefacet"),oK=BJ("projection"),aK=BJ("proxy"),sK=BJ("relay"),uK=BJ("render"),lK=BJ("scale"),cK=BJ("sieve"),fK=BJ("sortitems"),dK=BJ("viewlayout"),hK=BJ("values");let pK=0;const mK={min:"min",max:"max",count:"sum"};function gK(e,t){const n=t.getScale(e.name).params;let r;var i;for(r in n.domain=xK(e.domain,e,t),null!=e.range&&(n.range=DK(e,t,n)),null!=e.interpolate&&function(e,t){t.interpolate=yK(e.type||e),null!=e.gamma&&(t.interpolateGamma=yK(e.gamma))}(e.interpolate,n),null!=e.nice&&(n.nice=Tg(i=e.nice)?{interval:yK(i.interval),step:yK(i.step)}:yK(i)),null!=e.bins&&(n.bins=function(e,t){return e.signal||$g(e)?vK(e,t):t.objectProperty(e)}(e.bins,t)),e)vy(n,r)||"name"===r||(n[r]=yK(e[r],t))}function yK(e,t){return Tg(e)?e.signal?t.signalRef(e.signal):_g("Unsupported object: "+Py(e)):e}function vK(e,t){return e.signal?t.signalRef(e.signal):e.map((e=>yK(e,t)))}function bK(e){_g("Can not find data set: "+Py(e))}function xK(e,t,n){if(e)return e.signal?n.signalRef(e.signal):($g(e)?wK:e.fields?kK:_K)(e,t,n);null==t.domainMin&&null==t.domainMax||_g("No scale domain defined for domainMin/domainMax to override.")}function wK(e,t,n){return e.map((e=>yK(e,n)))}function _K(e,t,n){const r=n.getData(e.data);return r||bK(e.data),YN(t.type)?r.valuesRef(n,e.field,SK(e.sort,!1)):KN(t.type)?r.domainRef(n,e.field):r.extentRef(n,e.field)}function kK(e,t,n){const r=e.data,i=e.fields.reduce(((e,t)=>(t=My(t)?{data:r,field:t}:$g(t)||t.signal?function(e,t){const n="_:vega:_"+pK++,r=qJ({});if($g(e))r.value={$ingest:e};else if(e.signal){const i="setdata("+Py(n)+","+e.signal+")";r.params.input=t.signalRef(i)}return t.addDataPipeline(n,[r,cK({})]),{data:n,field:"data"}}(t,n):t,e.push(t),e)),[]);return(YN(t.type)?EK:KN(t.type)?AK:CK)(e,n,i)}function EK(e,t,n){const r=SK(e.sort,!0);let i,o;const a=n.map((e=>{const n=t.getData(e.data);return n||bK(e.data),n.countsRef(t,e.field,r)})),s={groupby:wJ,pulse:a};r&&(i=r.op||"count",o=r.field?kJ(i,r.field):"count",s.ops=[mK[i]],s.fields=[t.fieldRef(o)],s.as=[o]),i=t.add(IJ(s));const u=t.add(qJ({pulse:bJ(i)}));return o=t.add(hK({field:wJ,sort:t.sortRef(r),pulse:bJ(u)})),bJ(o)}function SK(e,t){return e&&(e.field||e.op?e.field||"count"===e.op?t&&e.field&&e.op&&!mK[e.op]&&_g("Multiple domain scales can not be sorted using "+e.op):_g("No field provided for sort aggregate op: "+e.op):Tg(e)?e.field="key":e={field:"key"}),e}function AK(e,t,n){const r=n.map((e=>{const n=t.getData(e.data);return n||bK(e.data),n.domainRef(t,e.field)}));return bJ(t.add(tK({values:r})))}function CK(e,t,n){const r=n.map((e=>{const n=t.getData(e.data);return n||bK(e.data),n.extentRef(t,e.field)}));return bJ(t.add(eK({extents:r})))}function DK(e,t,n){const r=t.config.range;let i=e.range;if(i.signal)return t.signalRef(i.signal);if(My(i)){if(r&&vy(r,i))return DK(e=py({},e,{range:r[i]}),t,n);"width"===i?i=[0,{signal:"width"}]:"height"===i?i=YN(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:_g("Unrecognized scale range value: "+Py(i))}else{if(i.scheme)return n.scheme=$g(i.scheme)?vK(i.scheme,t):yK(i.scheme,t),i.extent&&(n.schemeExtent=vK(i.extent,t)),void(i.count&&(n.schemeCount=yK(i.count,t)));if(i.step)return void(n.rangeStep=yK(i.step,t));if(YN(e.type)&&!$g(i))return xK(i,e,t);$g(i)||_g("Unsupported range type: "+Py(i))}return i.map((e=>($g(e)?vK:yK)(e,t)))}function MK(e,t,n){return $g(e)?e.map((e=>MK(e,t,n))):Tg(e)?e.signal?n.signalRef(e.signal):"fit"===t?e:_g("Unsupported parameter object: "+Py(e)):e}const FK="top",NK="left",OK="right",$K="bottom",TK="center",zK="index",RK="label",PK="perc",LK="value",BK="guide-label",IK="guide-title",jK="group-title",UK="group-subtitle",qK="symbol",WK="gradient",HK="discrete",VK="size",GK=[VK,"shape","fill","stroke","strokeWidth","strokeDash","opacity"],YK={name:1,style:1,interactive:1},XK={value:0},QK={value:1},JK="group",KK="rect",ZK="rule",eZ="text";function tZ(e){return e.type=JK,e.interactive=e.interactive||!1,e}function nZ(e,t){const n=(n,r)=>DJ(e[n],DJ(t[n],r));return n.isVertical=n=>"vertical"===DJ(e.direction,t.direction||(n?t.symbolDirection:t.gradientDirection)),n.gradientLength=()=>DJ(e.gradientLength,t.gradientLength||t.gradientWidth),n.gradientThickness=()=>DJ(e.gradientThickness,t.gradientThickness||t.gradientHeight),n.entryColumns=()=>DJ(e.columns,DJ(t.columns,+n.isVertical(!0))),n}function rZ(e,t){const n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function iZ(e,t,n){return"item.anchor === '".concat("start","' ? ").concat(e," : item.anchor === '").concat("end","' ? ").concat(t," : ").concat(n)}const oZ=iZ(Py(NK),Py(OK),Py(TK));function aZ(e,t){return t?e?Tg(e)?Object.assign({},e,{offset:aZ(e.offset,t)}):{value:e,offset:t}:t:e}function sZ(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=XQ(e.encode,t,YK)):e.interactive=!1,e}function uZ(e,t,n,r){const i=nZ(e,n),o=i.isVertical(),a=i.gradientThickness(),s=i.gradientLength();let u,l,c,f,d;o?(l=[0,1],c=[0,0],f=a,d=s):(l=[0,0],c=[1,0],f=s,d=a);const h={enter:u={opacity:XK,x:XK,y:XK,width:VQ(f),height:VQ(d)},update:py({},u,{opacity:QK,fill:{gradient:t,start:l,stop:c}}),exit:{opacity:XK}};return YQ(h,{stroke:i("gradientStrokeColor"),strokeWidth:i("gradientStrokeWidth")},{opacity:i("gradientOpacity")}),sZ({type:KK,role:"legend-gradient",encode:h},r)}function lZ(e,t,n,r,i){const o=nZ(e,n),a=o.isVertical(),s=o.gradientThickness(),u=o.gradientLength();let l,c,f,d,h="";a?(l="y",f="y2",c="x",d="width",h="1-"):(l="x",f="x2",c="y",d="height");const p={opacity:XK,fill:{scale:t,field:LK}};p[l]={signal:h+"datum."+PK,mult:u},p[c]=XK,p[f]={signal:h+"datum.perc2",mult:u},p[d]=VQ(s);const m={enter:p,update:py({},p,{opacity:QK}),exit:{opacity:XK}};return YQ(m,{stroke:o("gradientStrokeColor"),strokeWidth:o("gradientStrokeWidth")},{opacity:o("gradientOpacity")}),sZ({type:KK,role:"legend-band",key:LK,from:i,encode:m},r)}const cZ="datum.".concat(PK,'<=0?"').concat(NK,'":datum.').concat(PK,'>=1?"').concat(OK,'":"').concat(TK,'"'),fZ="datum.".concat(PK,'<=0?"').concat($K,'":datum.').concat(PK,'>=1?"').concat(FK,'":"').concat("middle",'"');function dZ(e,t,n,r){const i=nZ(e,t),o=i.isVertical(),a=VQ(i.gradientThickness()),s=i.gradientLength();let u,l,c,f,d=i("labelOverlap"),h="";const p={enter:u={opacity:XK},update:l={opacity:QK,text:{field:RK}},exit:{opacity:XK}};return YQ(p,{fill:i("labelColor"),fillOpacity:i("labelOpacity"),font:i("labelFont"),fontSize:i("labelFontSize"),fontStyle:i("labelFontStyle"),fontWeight:i("labelFontWeight"),limit:DJ(e.labelLimit,t.gradientLabelLimit)}),o?(u.align={value:"left"},u.baseline=l.baseline={signal:fZ},c="y",f="x",h="1-"):(u.align=l.align={signal:cZ},u.baseline={value:"top"},c="x",f="y"),u[c]=l[c]={signal:h+"datum."+PK,mult:s},u[f]=l[f]=a,a.offset=DJ(e.labelOffset,t.gradientLabelOffset)||0,d=d?{separation:i("labelSeparation"),method:d,order:"datum.index"}:void 0,sZ({type:eZ,role:eJ,style:BK,key:LK,from:r,encode:p,overlap:d},n)}function hZ(e,t,n,r,i){const o=nZ(e,t),a=n.entries,s=!(!a||!a.interactive),u=a?a.name:void 0,l=o("clipHeight"),c=o("symbolOffset"),f={data:"value"},d="(".concat(i,") ? datum.").concat("offset"," : datum.").concat(VK),h=l?VQ(l):{field:VK},p="datum.".concat(zK),m="max(1, ".concat(i,")");let g,y,v,b,x;h.mult=.5,g={enter:y={opacity:XK,x:{signal:d,mult:.5,offset:c},y:h},update:v={opacity:QK,x:y.x,y:y.y},exit:{opacity:XK}};let w=null,_=null;e.fill||(w=t.symbolBaseFillColor,_=t.symbolBaseStrokeColor),YQ(g,{fill:o("symbolFillColor",w),shape:o("symbolType"),size:o("symbolSize"),stroke:o("symbolStrokeColor",_),strokeDash:o("symbolDash"),strokeDashOffset:o("symbolDashOffset"),strokeWidth:o("symbolStrokeWidth")},{opacity:o("symbolOpacity")}),GK.forEach((t=>{e[t]&&(v[t]=y[t]={scale:e[t],field:LK})}));const k=sZ({type:"symbol",role:"legend-symbol",key:LK,from:f,clip:!!l||void 0,encode:g},n.symbols),E=VQ(c);E.offset=o("labelOffset"),g={enter:y={opacity:XK,x:{signal:d,offset:E},y:h},update:v={opacity:QK,text:{field:RK},x:y.x,y:y.y},exit:{opacity:XK}},YQ(g,{align:o("labelAlign"),baseline:o("labelBaseline"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontStyle:o("labelFontStyle"),fontWeight:o("labelFontWeight"),limit:o("labelLimit")});const S=sZ({type:eZ,role:eJ,style:BK,key:LK,from:f,encode:g},n.labels);return g={enter:{noBound:{value:!l},width:XK,height:l?VQ(l):XK,opacity:XK},exit:{opacity:XK},update:v={opacity:QK,row:{signal:null},column:{signal:null}}},o.isVertical(!0)?(b="ceil(item.mark.items.length / ".concat(m,")"),v.row.signal="".concat(p,"%").concat(b),v.column.signal="floor(".concat(p," / ").concat(b,")"),x={field:["row",p]}):(v.row.signal="floor(".concat(p," / ").concat(m,")"),v.column.signal="".concat(p," % ").concat(m),x={field:p}),v.column.signal="(".concat(i,")?").concat(v.column.signal,":").concat(p),tZ({role:ZQ,from:r={facet:{data:r,name:"value",groupby:zK}},encode:XQ(g,a,YK),marks:[k,S],name:u,interactive:s,sort:x})}const pZ='item.orient === "left"',mZ='item.orient === "right"',gZ="(".concat(pZ," || ").concat(mZ,")"),yZ="datum.vgrad && ".concat(gZ),vZ=iZ('"top"','"bottom"','"middle"'),bZ=iZ('"right"','"left"','"center"'),xZ="datum.vgrad && ".concat(mZ," ? (").concat(bZ,") : (").concat(gZ," && !(datum.vgrad && ").concat(pZ,')) ? "left" : ').concat(oZ),wZ="item._anchor || (".concat(gZ,' ? "middle" : "start")'),_Z="".concat(yZ," ? (").concat(pZ," ? -90 : 90) : 0"),kZ="".concat(gZ," ? (datum.vgrad ? (").concat(mZ,' ? "bottom" : "top") : ').concat(vZ,') : "top"');function EZ(e,t){let n;return Tg(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+SZ(e.path)+")":e.sphere&&(n="geoShape("+SZ(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function SZ(e){return Tg(e)&&e.signal?e.signal:Py(e)}function AZ(e){const t=e.role||"";return t.indexOf("axis")&&t.indexOf("legend")&&t.indexOf("title")?e.type===JK?ZQ:t||JQ:t}function CZ(e){return{marktype:e.type,name:e.name||void 0,role:e.role||AZ(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function DZ(e,t){return e&&e.signal?t.signalRef(e.signal):!1!==e}function MZ(e,t){const n=IE(e.type);n||_g("Unrecognized transform type: "+Py(e.type));const r=yJ(n.type.toLowerCase(),null,FZ(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(r)),r.metadata=n.metadata||{},r}function FZ(e,t,n){const r={},i=e.params.length;for(let o=0;o<i;++o){const i=e.params[o];r[i.name]=NZ(i,t,n)}return r}function NZ(e,t,n){const r=e.type,i=t[e.name];return"index"===r?function(e,t,n){My(t.from)||_g('Lookup "from" parameter must be a string literal.');return n.getData(t.from).lookupRef(n,t.key)}(0,t,n):void 0!==i?"param"===r?function(e,t,n){const r=t[e.name];return e.array?($g(r)||_g("Expected an array of sub-parameters. Instead: "+Py(r)),r.map((t=>$Z(e,t,n)))):$Z(e,r,n)}(e,t,n):"projection"===r?n.projectionRef(t[e.name]):e.array&&!AJ(i)?i.map((t=>OZ(e,t,n))):OZ(e,i,n):void(e.required&&_g("Missing required "+Py(t.type)+" parameter: "+Py(e.name)))}function OZ(e,t,n){const r=e.type;if(AJ(t))return PZ(r)?_g("Expression references can not be signals."):LZ(r)?n.fieldRef(t):BZ(r)?n.compareRef(t):n.signalRef(t.signal);{const i=e.expr||LZ(r);return i&&TZ(t)?n.exprRef(t.expr,t.as):i&&zZ(t)?xJ(t.field,t.as):PZ(r)?DX(t,n):RZ(r)?bJ(n.getData(t).values):LZ(r)?xJ(t):BZ(r)?n.compareRef(t):t}}function $Z(e,t,n){const r=e.params.length;let i;for(let n=0;n<r;++n){i=e.params[n];for(const e in i.key)if(i.key[e]!==t[e]){i=null;break}if(i)break}i||_g("Unsupported parameter: "+Py(t));const o=py(FZ(i,t,n),i.key);return bJ(n.add(rK(o)))}const TZ=e=>e&&e.expr,zZ=e=>e&&e.field,RZ=e=>"data"===e,PZ=e=>"expr"===e,LZ=e=>"field"===e,BZ=e=>"compare"===e;function IZ(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:bJ(t.getData(e.data).output)}function jZ(e,t,n,r,i){this.scope=e,this.input=t,this.output=n,this.values=r,this.aggregate=i,this.index={}}function UZ(e){return My(e)?e:null}function qZ(e,t,n){const r=kJ(n.op,n.field);let i;if(t.ops){for(let e=0,n=t.as.length;e<n;++e)if(t.as[e]===r)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((i=n.op.signal)?e.signalRef(i):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(r))}function WZ(e,t,n,r,i,o,a){const s=t[n]||(t[n]={}),u=function(e){return Tg(e)?("descending"===e.order?"-":"+")+kJ(e.op,e.field):""}(o);let l,c,f=UZ(i);if(null!=f&&(e=t.scope,f+=u?"|"+u:"",l=s[f]),!l){const n=o?{field:wJ,pulse:t.countsRef(e,i,o)}:{field:e.fieldRef(i),pulse:bJ(t.output)};u&&(n.sort=e.sortRef(o)),c=e.add(yJ(r,void 0,n)),a&&(t.index[i]=c),l=bJ(c),null!=f&&(s[f]=l)}return l}function HZ(e,t,n){const r=e.remove,i=e.insert,o=e.toggle,a=e.modify,s=e.values,u=t.add(vJ()),l=DX("if("+e.trigger+',modify("'+n+'",'+[i,r,o,a,s].map((e=>null==e?"null":e)).join(",")+"),0)",t);u.update=l.$expr,u.params=l.$params}function VZ(e,t){const n=AZ(e),r=e.type===JK,i=e.from&&e.from.facet,o=e.overlap;let a,s,u,l,c,f,d,h=e.layout||n===ZQ||n===KQ;const p=n===JQ||h||i,m=function(e,t,n){let r,i,o,a,s;return e?(r=e.facet)&&(t||_g("Only group marks can be faceted."),null!=r.field?a=s=IZ(r,n):(e.data?s=bJ(n.getData(e.data).aggregate):(o=MZ(py({type:"aggregate",groupby:iy(r.groupby)},r.aggregate),n),o.params.key=n.keyRef(r.groupby),o.params.pulse=IZ(r,n),a=s=bJ(n.add(o))),i=n.keyRef(r.groupby,!0))):a=bJ(n.add(qJ(null,[{}]))),a||(a=IZ(e,n)),{key:i,pulse:a,parent:s}}(e.from,r,t);s=t.add(HJ({key:m.key||(e.key?xJ(e.key):void 0),pulse:m.pulse,clean:!r}));const g=bJ(s);s=u=t.add(qJ({pulse:g})),s=t.add(ZJ({markdef:CZ(e),interactive:DZ(e.interactive,t),clip:EZ(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:bJ(s)}));const y=bJ(s);s=l=t.add(VJ(cJ(e.encode,e.type,n,e.style,t,{mod:!1,pulse:y}))),s.params.parent=t.encode(),e.transform&&e.transform.forEach((e=>{const n=MZ(e,t),r=n.metadata;(r.generates||r.changes)&&_g("Mark transforms should not generate new data."),r.nomod||(l.params.mod=!0),n.params.pulse=bJ(s),t.add(s=n)})),e.sort&&(s=t.add(fK({sort:t.compareRef(e.sort),pulse:bJ(s)})));const v=bJ(s);(i||h)&&(h=t.add(dK({layout:t.objectProperty(e.layout),legends:t.legends,mark:y,pulse:v})),f=bJ(h));const b=t.add(UJ({mark:y,pulse:f||v}));d=bJ(b),r&&(p&&(a=t.operators,a.pop(),h&&a.pop()),t.pushState(v,f||d,g),i?function(e,t,n){const r=e.from.facet,i=r.name,o=IZ(r,t);let a;r.name||_g("Facet must have a name: "+Py(r)),r.data||_g("Facet must reference a data set: "+Py(r)),r.field?a=t.add(iK({field:t.fieldRef(r.field),pulse:o})):r.groupby?a=t.add(YJ({key:t.keyRef(r.groupby),group:bJ(t.proxy(n.parent)),pulse:o})):_g("Facet must specify groupby or field: "+Py(r));const s=t.fork(),u=s.add(qJ()),l=s.add(cK({pulse:bJ(u)}));s.addData(i,new jZ(s,u,u,l)),s.addSignal("parent",null),a.params.subflow={$subflow:s.parse(e).toRuntime()}}(e,t,m):p?function(e,t,n){const r=t.add(iK({pulse:n.pulse})),i=t.fork();i.add(cK()),i.addSignal("parent",null),r.params.subflow={$subflow:i.parse(e).toRuntime()}}(e,t,m):t.parse(e),t.popState(),p&&(h&&a.push(h),a.push(b))),o&&(d=function(e,t,n){const r=e.method,i=e.bound,o=e.separation,a={separation:AJ(o)?n.signalRef(o.signal):o,method:AJ(r)?n.signalRef(r.signal):r,pulse:t};e.order&&(a.sort=n.compareRef({field:e.order}));if(i){const e=i.tolerance;a.boundTolerance=AJ(e)?n.signalRef(e.signal):+e,a.boundScale=n.scaleRef(i.scale),a.boundOrient=i.orient}return bJ(n.add(nK(a)))}(o,d,t));const x=t.add(uK({pulse:d})),w=t.add(cK({pulse:bJ(x)},void 0,t.parent()));null!=e.name&&(c=e.name,t.addData(c,new jZ(t,u,x,w)),e.on&&e.on.forEach((e=>{(e.insert||e.remove||e.toggle)&&_g("Marks only support modify triggers."),HZ(e,t,c)})))}function GZ(e,t){const n=t.config.legend,r=e.encode||{},i=nZ(e,n),o=r.legend||{},a=o.name||void 0,s=o.interactive,u=o.style,l={};let c,f,d,h=0;GK.forEach((t=>e[t]?(l[t]=e[t],h=h||e[t]):0)),h||_g("Missing valid scale for legend.");const p=function(e,t){let n=e.type||qK;e.type||1!==function(e){return GK.reduce(((t,n)=>t+(e[n]?1:0)),0)}(e)||!e.fill&&!e.stroke||(n=GN(t)?WK:XN(t)?HK:qK);return n!==WK?n:XN(t)?HK:WK}(e,t.scaleType(h)),m={title:null!=e.title,scales:l,type:p,vgrad:"symbol"!==p&&i.isVertical()},g=bJ(t.add(qJ(null,[m]))),y=bJ(t.add(JJ(f={type:p,scale:t.scaleRef(h),count:t.objectProperty(i("tickCount")),limit:t.property(i("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));return p===WK?(d=[uZ(e,h,n,r.gradient),dZ(e,n,r.labels,y)],f.count=f.count||t.signalRef("max(2,2*floor((".concat(MJ(i.gradientLength()),")/100))"))):p===HK?d=[lZ(e,h,n,r.gradient,y),dZ(e,n,r.labels,y)]:(c=function(e,t){const n=nZ(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}(e,n),d=[hZ(e,n,r,y,MJ(c.columns))],f.size=function(e,t,n){const r=MJ(XZ("size",e,n)),i=MJ(XZ("strokeWidth",e,n)),o=MJ(function(e,t,n){return rZ("fontSize",e)||function(e,t,n){const r=t.config.style[n];return r&&r[e]}("fontSize",t,n)}(n[1].encode,t,BK));return DX("max(ceil(sqrt(".concat(r,")+").concat(i,"),").concat(o,")"),t)}(e,t,d[0].marks)),d=[tZ({role:"legend-entry",from:g,encode:{enter:{x:{value:0},y:{value:0}}},marks:d,layout:c,interactive:s})],m.title&&d.push(function(e,t,n,r){const i=nZ(e,t),o={enter:{opacity:XK},update:{opacity:QK,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:XK}};return YQ(o,{orient:i("titleOrient"),_anchor:i("titleAnchor"),anchor:{signal:wZ},angle:{signal:_Z},align:{signal:xZ},baseline:{signal:kZ},text:e.title,fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),baseline:i("titleBaseline")}),sZ({type:eZ,role:"legend-title",style:IK,from:r,encode:o},n)}(e,n,r.title,g)),VZ(tZ({role:"legend",from:g,encode:XQ(YZ(i,e,n),o,YK),marks:d,aria:i("aria"),description:i("description"),zindex:i("zindex"),name:a,interactive:s,style:u}),t)}function YZ(e,t,n){const r={enter:{},update:{}};return YQ(r,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),r}function XZ(e,t,n){return t[e]?'scale("'.concat(t[e],'",datum)'):rZ(e,n[0].encode)}jZ.fromEntries=function(e,t){const n=t.length,r=t[n-1],i=t[n-2];let o=t[0],a=null,s=1;for(o&&"load"===o.type&&(o=t[1]),e.add(t[0]);s<n;++s)t[s].params.pulse=bJ(t[s-1]),e.add(t[s]),"aggregate"===t[s].type&&(a=t[s]);return new jZ(e,o,i,r,a)},jZ.prototype={countsRef:function(e,t,n){const r=this,i=r.counts||(r.counts={}),o=UZ(t);let a,s,u;return null!=o&&(e=r.scope,a=i[o]),a?n&&n.field&&qZ(e,a.agg.params,n):(u={groupby:e.fieldRef(t,"key"),pulse:bJ(r.output)},n&&n.field&&qZ(e,u,n),s=e.add(IJ(u)),a=e.add(qJ({pulse:bJ(s)})),a={agg:s,ref:bJ(a)},null!=o&&(i[o]=a)),a.ref},tuplesRef:function(){return bJ(this.values)},extentRef:function(e,t){return WZ(e,this,"extent","extent",t,!1)},domainRef:function(e,t){return WZ(e,this,"domain","values",t,!1)},valuesRef:function(e,t,n){return WZ(e,this,"vals","values",t,n||!0)},lookupRef:function(e,t){return WZ(e,this,"lookup","tupleindex",t,!1)},indataRef:function(e,t){return WZ(e,this,"indata","tupleindex",t,!0,!0)}};const QZ='item.orient==="'.concat(NK,'"?-90:item.orient==="').concat(OK,'"?90:0');function JZ(e,t){const n=nZ(e=My(e)?{text:e}:e,t.config.title),r=e.encode||{},i=r.group||{},o=i.name||void 0,a=i.interactive,s=i.style,u=[],l=bJ(t.add(qJ(null,[{}])));return u.push(function(e,t,n,r){const i={value:0},o=e.text,a={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return YQ(a,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),sZ({type:eZ,role:tJ,style:jK,from:r,encode:a},n)}(e,n,function(e){const t=e.encode;return t&&t.title||py({name:e.name,interactive:e.interactive,style:e.style},t)}(e),l)),e.subtitle&&u.push(function(e,t,n,r){const i={value:0},o=e.subtitle,a={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return YQ(a,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),sZ({type:eZ,role:nJ,style:UK,from:r,encode:a},n)}(e,n,r.subtitle,l)),VZ(tZ({role:"title",from:l,encode:KZ(n,i),marks:u,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:o,interactive:a,style:s}),t)}function KZ(e,t){const n={enter:{},update:{}};return YQ(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:oZ},angle:{signal:QZ},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),XQ(n,t,YK)}function ZZ(e,t){const n=[];e.transform&&e.transform.forEach((e=>{n.push(MZ(e,t))})),e.on&&e.on.forEach((n=>{HZ(n,t,e.name)})),t.addDataPipeline(e.name,function(e,t,n){const r=[];let i,o,a,s,u,l=null,c=!1,f=!1;e.values?AJ(e.values)||CJ(e.format)?(r.push(t0(t,e)),r.push(l=e0())):r.push(l=e0({$ingest:e.values,$format:e.format})):e.url?CJ(e.url)||CJ(e.format)?(r.push(t0(t,e)),r.push(l=e0())):r.push(l=e0({$request:e.url,$format:e.format})):e.source&&(l=i=iy(e.source).map((e=>bJ(t.getData(e).output))),r.push(null));for(o=0,a=n.length;o<a;++o)s=n[o],u=s.metadata,l||u.source||r.push(l=e0()),r.push(s),u.generates&&(f=!0),u.modifies&&!f&&(c=!0),u.source?l=s:u.changes&&(l=null);i&&(a=i.length-1,r[0]=sK({derive:c,pulse:a?i:i[0]}),(c||a)&&r.splice(1,0,e0()));l||r.push(e0());return r.push(cK({})),r}(e,t,n))}function e0(e){const t=qJ({},e);return t.metadata={source:!0},t}function t0(e,t){return KJ({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}const n0=e=>e===$K||e===FK,r0=(e,t,n)=>AJ(e)?l0(e.signal,t,n):e===NK||e===FK?t:n,i0=(e,t,n)=>AJ(e)?s0(e.signal,t,n):n0(e)?t:n,o0=(e,t,n)=>AJ(e)?u0(e.signal,t,n):n0(e)?n:t,a0=(e,t,n)=>AJ(e)?c0(e.signal,t,n):e===FK?{value:t}:{value:n},s0=(e,t,n)=>d0("".concat(e," === '").concat(FK,"' || ").concat(e," === '").concat($K,"'"),t,n),u0=(e,t,n)=>d0("".concat(e," !== '").concat(FK,"' && ").concat(e," !== '").concat($K,"'"),t,n),l0=(e,t,n)=>p0("".concat(e," === '").concat(NK,"' || ").concat(e," === '").concat(FK,"'"),t,n),c0=(e,t,n)=>p0("".concat(e," === '").concat(FK,"'"),t,n),f0=(e,t,n)=>p0("".concat(e," === '").concat(OK,"'"),t,n),d0=(e,t,n)=>(t=null!=t?VQ(t):t,n=null!=n?VQ(n):n,h0(t)&&h0(n)?(t=t?t.signal||Py(t.value):null,n=n?n.signal||Py(n.value):null,{signal:"".concat(e," ? (").concat(t,") : (").concat(n,")")}):[py({test:e},t)].concat(n||[])),h0=e=>null==e||1===Object.keys(e).length,p0=(e,t,n)=>({signal:"".concat(e," ? (").concat(m0(t),") : (").concat(m0(n),")")}),m0=e=>AJ(e)?e.signal:null==e?null:Py(e),g0=(e,t)=>{const n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function y0(e,t,n,r){let i;if(t&&vy(t,e))return t[e];if(vy(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":i="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":i=e[5].toLowerCase()+e.slice(6)}return r["guide-title"][i]}if(e.startsWith("label")){switch(e){case"labelColor":i="fill";break;case"labelFont":case"labelFontSize":i=e[5].toLowerCase()+e.slice(6)}return r["guide-label"][i]}return null}function v0(e){const t={};for(const n of e)if(n)for(const e in n)t[e]=1;return Object.keys(t)}function b0(e,t){return{scale:e.scale,range:t}}function x0(e,t,n,r,i){const o=nZ(e,t),a=e.orient,s=e.gridScale,u=r0(a,1,-1),l=function(e,t){if(1===t);else if(Tg(e)){let n=e=py({},e);for(;null!=n.mult;){if(!Tg(n.mult))return n.mult=AJ(t)?{signal:"(".concat(n.mult,") * (").concat(t.signal,")")}:n.mult*t,e;n=n.mult=py({},n.mult)}n.mult=t}else e=AJ(t)?{signal:"(".concat(t.signal,") * (").concat(e||0,")")}:t*(e||0);return e}(e.offset,u);let c,f,d;const h={enter:c={opacity:XK},update:d={opacity:QK},exit:f={opacity:XK}};YQ(h,{stroke:o("gridColor"),strokeCap:o("gridCap"),strokeDash:o("gridDash"),strokeDashOffset:o("gridDashOffset"),strokeOpacity:o("gridOpacity"),strokeWidth:o("gridWidth")});const p={scale:e.scale,field:LK,band:i.band,extra:i.extra,offset:i.offset,round:o("tickRound")},m=i0(a,{signal:"height"},{signal:"width"}),g=s?{scale:s,range:0,mult:u,offset:l}:{value:0,offset:l},y=s?{scale:s,range:1,mult:u,offset:l}:py(m,{mult:u,offset:l});return c.x=d.x=i0(a,p,g),c.y=d.y=o0(a,p,g),c.x2=d.x2=o0(a,y),c.y2=d.y2=i0(a,y),f.x=i0(a,p),f.y=o0(a,p),sZ({type:ZK,role:"axis-grid",key:LK,from:r,encode:h},n)}function w0(e,t,n,r,i){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+r+","+i+")"}}function _0(e,t,n,r,i,o){const a=nZ(e,t),s=e.orient,u=e.scale,l=r0(s,-1,1),c=MJ(a("labelFlush")),f=MJ(a("labelFlushOffset")),d=a("labelAlign"),h=a("labelBaseline");let p,m=0===c||!!c;const g=VQ(i);g.mult=l,g.offset=VQ(a("labelPadding")||0),g.offset.mult=l;const y={scale:u,field:LK,band:.5,offset:aZ(o.offset,a("labelOffset"))},v=i0(s,m?w0(u,c,'"left"','"right"','"center"'):{value:"center"},((e,t,n)=>AJ(e)?f0(e.signal,t,n):e===OK?{value:t}:{value:n})(s,"left","right")),b=i0(s,a0(s,"bottom","top"),m?w0(u,c,'"top"','"bottom"','"middle"'):{value:"middle"}),x=w0(u,c,"-(".concat(f,")"),f,0);m=m&&f;const w={opacity:XK,x:i0(s,y,g),y:o0(s,y,g)},_={enter:w,update:p={opacity:QK,text:{field:RK},x:w.x,y:w.y,align:v,baseline:b},exit:{opacity:XK,x:w.x,y:w.y}};YQ(_,{dx:!d&&m?i0(s,x):null,dy:!h&&m?o0(s,x):null}),YQ(_,{angle:a("labelAngle"),fill:a("labelColor"),fillOpacity:a("labelOpacity"),font:a("labelFont"),fontSize:a("labelFontSize"),fontWeight:a("labelFontWeight"),fontStyle:a("labelFontStyle"),limit:a("labelLimit"),lineHeight:a("labelLineHeight")},{align:d,baseline:h});const k=a("labelBound");let E=a("labelOverlap");return E=E||k?{separation:a("labelSeparation"),method:E,order:"datum.index",bound:k?{scale:u,orient:s,tolerance:k}:null}:void 0,p.align!==v&&(p.align=g0(p.align,v)),p.baseline!==b&&(p.baseline=g0(p.baseline,b)),sZ({type:eZ,role:"axis-label",style:BK,key:LK,from:r,encode:_,overlap:E},n)}function k0(e,t,n,r){const i=nZ(e,t),o=e.orient,a=r0(o,-1,1);let s,u;const l={enter:s={opacity:XK,anchor:VQ(i("titleAnchor",null)),align:{signal:oZ}},update:u=py({},s,{opacity:QK,text:VQ(e.title)}),exit:{opacity:XK}},c={signal:'lerp(range("'.concat(e.scale,'"), ').concat(iZ(0,1,.5),")")};return u.x=i0(o,c),u.y=o0(o,c),s.angle=i0(o,XK,((e,t)=>0===t?0:AJ(e)?{signal:"(".concat(e.signal,") * ").concat(t)}:{value:e*t})(a,90)),s.baseline=i0(o,a0(o,$K,FK),{value:$K}),u.angle=s.angle,u.baseline=s.baseline,YQ(l,{fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),angle:i("titleAngle"),baseline:i("titleBaseline")}),function(e,t,n,r){const i=(e,t)=>null!=e?(n.update[t]=g0(VQ(e),n.update[t]),!1):!QQ(t,r),o=i(e("titleX"),"x"),a=i(e("titleY"),"y");n.enter.auto=a===o?VQ(a):i0(t,VQ(a),VQ(o))}(i,o,l,n),l.update.align=g0(l.update.align,s.align),l.update.angle=g0(l.update.angle,s.angle),l.update.baseline=g0(l.update.baseline,s.baseline),sZ({type:eZ,role:"axis-title",style:IK,from:r,encode:l},n)}function E0(e,t){const n=function(e,t){var n,r,i,o,a,s,u,l,c=t.config,f=c.style,d=c.axis,h="band"===t.scaleType(e.scale)&&c.axisBand,p=e.orient;if(AJ(p)){const e=v0([c.axisX,c.axisY]),t=v0([c.axisTop,c.axisBottom,c.axisLeft,c.axisRight]);for(i of(n={},e))n[i]=i0(p,y0(i,c.axisX,d,f),y0(i,c.axisY,d,f));for(i of(r={},t))r[i]=(o=p.signal,a=y0(i,c.axisTop,d,f),s=y0(i,c.axisBottom,d,f),u=y0(i,c.axisLeft,d,f),l=y0(i,c.axisRight,d,f),{signal:(null!=u?"".concat(o," === '").concat(NK,"' ? (").concat(m0(u),") : "):"")+(null!=s?"".concat(o," === '").concat($K,"' ? (").concat(m0(s),") : "):"")+(null!=l?"".concat(o," === '").concat(OK,"' ? (").concat(m0(l),") : "):"")+(null!=a?"".concat(o," === '").concat(FK,"' ? (").concat(m0(a),") : "):"")+"(null)"})}else n=p===FK||p===$K?c.axisX:c.axisY,r=c["axis"+p[0].toUpperCase()+p.slice(1)];return n||r||h?py({},d,n,r,h):d}(e,t),r=e.encode||{},i=r.axis||{},o=i.name||void 0,a=i.interactive,s=i.style,u=nZ(e,n),l=function(e){const t=e("tickBand");let n,r,i=e("tickOffset");return t?t.signal?(n={signal:"(".concat(t.signal,") === 'extent' ? 1 : 0.5")},r={signal:"(".concat(t.signal,") === 'extent'")},Tg(i)||(i={signal:"(".concat(t.signal,") === 'extent' ? 0 : ").concat(i)})):"extent"===t?(n=1,r=!0,i=0):(n=.5,r=!1):(n=e("bandPosition"),r=e("tickExtra")),{extra:r,band:n,offset:i}}(u),c={scale:e.scale,ticks:!!u("ticks"),labels:!!u("labels"),grid:!!u("grid"),domain:!!u("domain"),title:null!=e.title},f=bJ(t.add(qJ({},[c]))),d=bJ(t.add(jJ({scale:t.scaleRef(e.scale),extra:t.property(l.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),h=[];let p;return c.grid&&h.push(x0(e,n,r.grid,d,l)),c.ticks&&(p=u("tickSize"),h.push(function(e,t,n,r,i,o){const a=nZ(e,t),s=e.orient,u=r0(s,-1,1);let l,c,f;const d={enter:l={opacity:XK},update:f={opacity:QK},exit:c={opacity:XK}};YQ(d,{stroke:a("tickColor"),strokeCap:a("tickCap"),strokeDash:a("tickDash"),strokeDashOffset:a("tickDashOffset"),strokeOpacity:a("tickOpacity"),strokeWidth:a("tickWidth")});const h=VQ(i);h.mult=u;const p={scale:e.scale,field:LK,band:o.band,extra:o.extra,offset:o.offset,round:a("tickRound")};return f.y=l.y=i0(s,XK,p),f.y2=l.y2=i0(s,h),c.x=i0(s,p),f.x=l.x=o0(s,XK,p),f.x2=l.x2=o0(s,h),c.y=o0(s,p),sZ({type:ZK,role:"axis-tick",key:LK,from:r,encode:d},n)}(e,n,r.ticks,d,p,l))),c.labels&&(p=c.ticks?p:0,h.push(_0(e,n,r.labels,d,p,l))),c.domain&&h.push(function(e,t,n,r){const i=nZ(e,t),o=e.orient;let a,s;const u={enter:a={opacity:XK},update:s={opacity:QK},exit:{opacity:XK}};YQ(u,{stroke:i("domainColor"),strokeCap:i("domainCap"),strokeDash:i("domainDash"),strokeDashOffset:i("domainDashOffset"),strokeWidth:i("domainWidth"),strokeOpacity:i("domainOpacity")});const l=b0(e,0),c=b0(e,1);return a.x=s.x=i0(o,l,XK),a.x2=s.x2=i0(o,c),a.y=s.y=o0(o,l,XK),a.y2=s.y2=o0(o,c),sZ({type:ZK,role:"axis-domain",from:r,encode:u},n)}(e,n,r.domain,f)),c.title&&h.push(k0(e,n,r.title,f)),VZ(tZ({role:"axis",from:f,encode:XQ(S0(u,e),i,YK),marks:h,aria:u("aria"),description:u("description"),zindex:u("zindex"),name:o,interactive:a,style:s}),t)}function S0(e,t){const n={enter:{},update:{}};return YQ(n,{orient:e("orient"),offset:e("offset")||0,position:DJ(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:'abs(span(range("'.concat(t.scale,'")))')},translate:e("translate"),format:t.format,formatType:t.formatType}),n}function A0(e,t,n){const r=iy(e.signals),i=iy(e.scales);return n||r.forEach((e=>mJ(e,t))),iy(e.projections).forEach((e=>function(e,t){const n=t.config.projection||{},r={};for(const n in e)"name"!==n&&(r[n]=MK(e[n],n,t));for(const e in n)null==r[e]&&(r[e]=MK(n[e],e,t));t.addProjection(e.name,r)}(e,t))),i.forEach((e=>function(e,t){const n=e.type||"linear";HN(n)||_g("Unrecognized scale type: "+Py(n)),t.addScale(e.name,{type:n,domain:void 0})}(e,t))),iy(e.data).forEach((e=>ZZ(e,t))),i.forEach((e=>gK(e,t))),(n||r).forEach((e=>function(e,t){const n=t.getSignal(e.name);let r=e.update;e.init&&(r?_g("Signals can not include both init and update expressions."):(r=e.init,n.initonly=!0)),r&&(r=DX(r,t),n.update=r.$expr,n.params=r.$params),e.on&&e.on.forEach((e=>PJ(e,t,n.id)))}(e,t))),iy(e.axes).forEach((e=>E0(e,t))),iy(e.marks).forEach((e=>VZ(e,t))),iy(e.legends).forEach((e=>GZ(e,t))),e.title&&JZ(e.title,t),t.parseLambdas(),t}function C0(e,t){const n=t.config,r=bJ(t.root=t.add(vJ())),i=function(e,t){const n=n=>DJ(e[n],t[n]),r=[D0("background",n("background")),D0("autosize",qQ(n("autosize"))),D0("padding",HQ(n("padding"))),D0("width",n("width")||0),D0("height",n("height")||0)],i=r.reduce(((e,t)=>(e[t.name]=t,e)),{}),o={};return iy(e.signals).forEach((e=>{vy(i,e.name)?e=py(i[e.name],e):r.push(e),o[e.name]=e})),iy(t.signals).forEach((e=>{vy(o,e.name)||vy(i,e.name)||r.push(e)})),r}(e,n);i.forEach((e=>mJ(e,t))),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;const o=t.add(qJ()),a=t.add(VJ(cJ((e=>XQ({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e))(e.encode),JK,KQ,e.style,t,{pulse:bJ(o)}))),s=t.add(dK({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:r,pulse:bJ(a)}));t.operators.pop(),t.pushState(bJ(a),bJ(s),null),A0(e,t,i),t.operators.push(s);let u=t.add(UJ({mark:r,pulse:bJ(s)}));return u=t.add(uK({pulse:bJ(u)})),u=t.add(cK({pulse:bJ(u)})),t.addData("root",new jZ(t,o,o,u)),t}function D0(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function M0(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function F0(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}function N0(e){return($g(e)?O0:$0)(e)}function O0(e){const t=e.length;let n="[";for(let r=0;r<t;++r){const t=e[r];n+=(r>0?",":"")+(Tg(t)?t.signal||N0(t):Py(t))}return n+"]"}function $0(e){let t,n,r="{",i=0;for(t in e)n=e[t],r+=(++i>1?",":"")+Py(t)+":"+(Tg(n)?n.signal||N0(n):Py(n));return r+"}"}function T0(e,t,n){return Tg(e)||_g("Input Vega specification must be an object."),C0(e,new M0(t=Rg(function(){const e="sans-serif",t="#4c78a8",n="#000",r="#888",i="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:t},area:{fill:t},image:null,line:{stroke:t,strokeWidth:2},path:{stroke:t},rect:{fill:t},rule:{stroke:n},shape:{stroke:t},symbol:{fill:t,size:64},text:{fill:n,font:e,fontSize:11},trail:{fill:t,size:2},style:{"guide-label":{fill:n,font:e,fontSize:10},"guide-title":{fill:n,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:n,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:n,font:e,fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:i}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:r,grid:!1,gridWidth:1,gridColor:i,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:r,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:i,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:r,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}(),t,e.config),n)).toRuntime()}M0.prototype=F0.prototype={parse:function(e){return A0(e,this)},fork:function(){return new F0(this)},isSubscope:function(){return this._subid>0},toRuntime:function(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id:function(){return(this._subid?this._subid+":":0)+this._id++},add:function(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach((t=>{t.$ref=e.id})),e.refs=null),e},proxy:function(e){const t=e instanceof gJ?bJ(e):e;return this.add(aK({value:t}))},addStream:function(e){return this.streams.push(e),e.id=this.id(),e},addUpdate:function(e){return this.updates.push(e),e},finish:function(){let e,t;for(e in this.root&&(this.root.root=!0),this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(e,t,n){let r,i;e&&(r=e.data||(e.data={}),i=r[t]||(r[t]=[]),i.push(n))}for(e in this.data){t=this.data[e],n(t.input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values");for(const r in t.index)n(t.index[r],e,"index:"+r)}return this},pushState:function(e,t,n){this._encode.push(bJ(this.add(cK({pulse:e})))),this._parent.push(t),this._lookup.push(n?bJ(this.proxy(n)):null),this._markpath.push(-1)},popState:function(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent:function(){return Bg(this._parent)},encode:function(){return Bg(this._encode)},lookup:function(){return Bg(this._lookup)},markpath:function(){const e=this._markpath;return++e[e.length-1]},fieldRef:function(e,t){if(My(e))return xJ(e,t);e.signal||_g("Unsupported field reference: "+Py(e));const n=e.signal;let r=this.field[n];if(!r){const e={name:this.signalRef(n)};t&&(e.as=t),this.field[n]=r=bJ(this.add(XJ(e)))}return r},compareRef:function(e){let t=!1;const n=e=>AJ(e)?(t=!0,this.signalRef(e.signal)):function(e){return e&&e.expr}(e)?(t=!0,this.exprRef(e.expr)):e,r=iy(e.field).map(n),i=iy(e.order).map(n);return t?bJ(this.add(WJ({fields:r,orders:i}))):_J(r,i)},keyRef:function(e,t){let n=!1;const r=this.signals;return e=iy(e).map((e=>AJ(e)?(n=!0,bJ(r[e.signal])):e)),n?bJ(this.add(QJ({fields:e,flat:t}))):function(e,t){const n={$key:e};return t&&(n.$flat=!0),n}(e,t)},sortRef:function(e){if(!e)return e;const t=kJ(e.op,e.field),n=e.order||"ascending";return n.signal?bJ(this.add(WJ({fields:t,orders:this.signalRef(n.signal)}))):_J(t,n)},event:function(e,t){const n=e+":"+t;if(!this.events[n]){const r=this.id();this.streams.push({id:r,source:e,type:t}),this.events[n]=r}return this.events[n]},hasOwnSignal:function(e){return vy(this.signals,e)},addSignal:function(e,t){this.hasOwnSignal(e)&&_g("Duplicate signal name: "+Py(e));const n=t instanceof gJ?t:this.add(vJ(t));return this.signals[e]=n},getSignal:function(e){return this.signals[e]||_g("Unrecognized signal name: "+Py(e)),this.signals[e]},signalRef:function(e){return this.signals[e]?bJ(this.signals[e]):(vy(this.lambdas,e)||(this.lambdas[e]=this.add(vJ(null))),bJ(this.lambdas[e]))},parseLambdas:function(){const e=Object.keys(this.lambdas);for(let t=0,n=e.length;t<n;++t){const n=e[t],r=DX(n,this),i=this.lambdas[n];i.params=r.$params,i.update=r.$expr}},property:function(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty:function(e){return e&&Tg(e)?this.signalRef(e.signal||N0(e)):e},exprRef:function(e,t){const n={expr:DX(e,this)};return t&&(n.expr.$name=t),bJ(this.add(GJ(n)))},addBinding:function(e,t){this.bindings||_g("Nested signals do not support binding: "+Py(e)),this.bindings.push(py({signal:e},t))},addScaleProj:function(e,t){vy(this.scales,e)&&_g("Duplicate scale or projection name: "+Py(e)),this.scales[e]=this.add(t)},addScale:function(e,t){this.addScaleProj(e,lK(t))},addProjection:function(e,t){this.addScaleProj(e,oK(t))},getScale:function(e){return this.scales[e]||_g("Unrecognized scale name: "+Py(e)),this.scales[e]},scaleRef:function(e){return bJ(this.getScale(e))},scaleType:function(e){return this.getScale(e).params.type},projectionRef:function(e){return this.scaleRef(e)},projectionType:function(e){return this.scaleType(e)},addData:function(e,t){return vy(this.data,e)&&_g("Duplicate data set name: "+Py(e)),this.data[e]=t},getData:function(e){return this.data[e]||_g("Undefined data set name: "+Py(e)),this.data[e]},addDataPipeline:function(e,t){return vy(this.data,e)&&_g("Duplicate data set name: "+Py(e)),this.addData(e,jZ.fromEntries(this,t))}},t(pg,"tupleid",(function(){return oE})),t(pg,"transforms",(function(){return BE})),t(pg,"transform",(function(){return jE})),t(pg,"isTuple",(function(){return iE})),t(pg,"ingest",(function(){return sE})),t(pg,"definition",(function(){return IE})),t(pg,"changeset",(function(){return hE})),t(pg,"Transform",(function(){return LE})),t(pg,"Pulse",(function(){return CE})),t(pg,"Parameters",(function(){return mE})),t(pg,"Operator",(function(){return vE})),t(pg,"MultiPulse",(function(){return NE})),t(pg,"EventStream",(function(){return wE})),t(pg,"Dataflow",(function(){return RE})),t(pg,"scheme",(function(){return uO})),t(pg,"scale",(function(){return WN})),t(pg,"quantizeInterpolator",(function(){return nO})),t(pg,"interpolateRange",(function(){return eO})),t(pg,"interpolateColors",(function(){return tO})),t(pg,"interpolate",(function(){return iO})),t(pg,"projection",(function(){return rq})),t(pg,"View",(function(){return DQ})),t(pg,"timeFormatLocale",(function(){return Gk})),t(pg,"resetDefaultLocale",(function(){return Jk})),t(pg,"locale",(function(){return Xk})),t(pg,"formatLocale",(function(){return Uk})),t(pg,"defaultLocale",(function(){return Qk})),t(pg,"expressionFunction",(function(){return CX})),t(pg,"parse",(function(){return T0})),t(pg,"runtimeContext",(function(){return PX})),t(pg,"parseExpression",(function(){return OY})),t(pg,"codegenExpression",(function(){return zY})),t(pg,"parseSelector",(function(){return BQ}));var z0="5.20.2";py(BE,UE,cC,gL,GL,zq,YH,TW,mV,xV,VV,oG);const R0=z0;t(pg,"version",(function(){return R0}));var P0={},L0=e(JSON.parse('{"name":"vega-lite","author":"Dominik Moritz, Kanit \\"Ham\\" Wongsuphasawat, Arvind Satyanarayan, Jeffrey Heer","version":"5.1.0","collaborators":["Kanit Wongsuphasawat (http://kanitw.yellowpigz.com)","Dominik Moritz (https://www.domoritz.de)","Arvind Satyanarayan (https://arvindsatya.com)","Jeffrey Heer (https://jheer.org)"],"homepage":"https://vega.github.io/vega-lite/","description":"Vega-Lite is a concise high-level language for interactive visualization.","main":"build/vega-lite.js","unpkg":"build/vega-lite.min.js","jsdelivr":"build/vega-lite.min.js","module":"build/src/index","types":"build/src/index.d.ts","bin":{"vl2png":"./bin/vl2png","vl2svg":"./bin/vl2svg","vl2pdf":"./bin/vl2pdf","vl2vg":"./bin/vl2vg"},"directories":{"test":"test"},"files":["bin","build","src","vega-lite*","tsconfig.json"],"scripts":{"changelog":"conventional-changelog -p angular -r 2","prebuild":"yarn clean:build","build":"yarn build:only","build:only":"tsc -p tsconfig.build.json && rollup -c","prebuild:examples":"yarn build:only","build:examples":"yarn data && TZ=America/Los_Angeles scripts/build-examples.sh","prebuild:examples-full":"yarn build:only","build:examples-full":"TZ=America/Los_Angeles scripts/build-examples.sh 1","build:example":"TZ=America/Los_Angeles scripts/build-example.sh","build:toc":"yarn build:jekyll && scripts/generate-toc","build:site":"rollup -c site/rollup.config.js","build:jekyll":"pushd site && bundle exec jekyll build -q && popd","build:versions":"scripts/update-version.sh","clean":"yarn clean:build && del-cli \'site/data/*\' \'examples/compiled/*.png\' && find site/examples ! -name \'index.md\' ! -name \'data\' -type f -delete","clean:build":"del-cli \'build/*\' !build/vega-lite-schema.json","predeploy:site":"yarn presite","deploy:site":"gh-pages -d site","data":"rsync -r node_modules/vega-datasets/data/* site/data","schema":"mkdir -p build && ts-json-schema-generator -f tsconfig.json -p src/index.ts -t TopLevelSpec --no-type-check --no-ref-encode > build/vega-lite-schema.json && yarn renameschema && cp build/vega-lite-schema.json site/_data/","renameschema":"scripts/rename-schema.sh","presite":"yarn data && yarn schema && yarn build:site && yarn build:versions && scripts/create-example-pages.sh","site":"yarn site:only","site:only":"pushd site && bundle exec jekyll serve -I -l && popd","prettierbase":"prettier \'**/*.{md,css,yml}\'","eslintbase":"eslint .","format":"yarn eslintbase --fix && yarn prettierbase --write","lint":"yarn eslintbase && yarn prettierbase --check","test":"jest test/ && yarn lint && yarn schema && jest examples/ && yarn test:runtime","test:cover":"jest --collectCoverage test/","test:inspect":"node --inspect-brk ./node_modules/.bin/jest --runInBand test","test:runtime":"TZ=America/Los_Angeles jest test-runtime/ --config test-runtime/jest-config.json","test:runtime:generate":"yarn build:only && del-cli test-runtime/resources && VL_GENERATE_TESTS=true yarn test:runtime","watch":"tsc -p tsconfig.build.json -w","watch:site":"yarn build:site -w","watch:test":"jest --watch test/"},"repository":{"type":"git","url":"https://github.com/vega/vega-lite.git"},"license":"BSD-3-Clause","bugs":{"url":"https://github.com/vega/vega-lite/issues"},"devDependencies":{"@babel/core":"^7.13.15","@babel/preset-env":"^7.13.15","@babel/preset-typescript":"^7.13.0","@rollup/plugin-babel":"^5.3.0","@rollup/plugin-commonjs":"^18.0.0","@rollup/plugin-json":"^4.1.0","@rollup/plugin-node-resolve":"^11.2.1","@types/chai":"^4.2.16","@types/d3":"^6.3.0","@types/jest":"^26.0.22","@types/mkdirp":"^1.0.1","@types/pako":"^1.0.1","@typescript-eslint/eslint-plugin":"^4.22.0","@typescript-eslint/parser":"^4.22.0","ajv":"^8.1.0","ajv-formats":"^2.0.2","chai":"^4.3.4","cheerio":"^1.0.0-rc.6","conventional-changelog-cli":"^2.1.1","d3":"^6.7.0","del-cli":"^3.0.1","eslint":"^7.24.0","eslint-config-prettier":"^8.2.0","eslint-plugin-jest":"^24.3.5","eslint-plugin-prettier":"^3.4.0","gh-pages":"^3.1.0","highlight.js":"^10.7.2","jest":"^26.6.3","jest-dev-server":"^5.0.0","mkdirp":"^1.0.4","pako":"^2.0.3","prettier":"^2.2.1","puppeteer":"^8.0.0","rollup":"^2.45.2","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-sourcemaps":"^0.6.3","rollup-plugin-terser":"^7.0.2","serve":"^11.3.2","terser":"^5.6.1","ts-json-schema-generator":"^0.90.0","typescript":"~4.2.4","vega-cli":"^5.20.2","vega-datasets":"~2.2.0","vega-embed":"^6.17.0","vega-tooltip":"^0.25.1","yaml-front-matter":"^4.1.1"},"dependencies":{"@types/clone":"~2.1.0","@types/fast-json-stable-stringify":"^2.0.0","array-flat-polyfill":"^1.0.1","clone":"~2.1.2","fast-deep-equal":"~3.1.3","fast-json-stable-stringify":"~2.1.0","json-stringify-pretty-compact":"~3.0.0","tslib":"~2.2.0","vega-event-selector":"~2.0.6","vega-expression":"~4.0.1","vega-util":"~1.16.1","yargs":"~16.2.0"},"peerDependencies":{"vega":"^5.20.0"},"jest":{"testPathIgnorePatterns":["<rootDir>/node_modules","<rootDir>/build","<rootDir>/_site","<rootDir>/src"],"coverageDirectory":"./coverage/","collectCoverage":false,"setupFiles":["./test/jest.overrides.ts"]}}')),B0={};Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function e(){var t=isNaN(arguments[0])?1:Number(arguments[0]);return t?Array.prototype.reduce.call(this,(function(n,r){return Array.isArray(r)?n.push.apply(n,e.call(r,t-1)):n.push(r),n}),[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(e){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var I0={},j0=kv,U0=function(){function e(e,t){return null!=t&&e instanceof t}var t,n,r;try{t=Map}catch(e){t=function(){}}try{n=Set}catch(e){n=function(){}}try{r=Promise}catch(e){r=function(){}}function i(o,s,u,l,c){"object"==typeof s&&(u=s.depth,l=s.prototype,c=s.includeNonEnumerable,s=s.circular);var f=[],d=[],h=void 0!==j0;return void 0===s&&(s=!0),void 0===u&&(u=1/0),function o(u,p){if(null===u)return null;if(0===p)return u;var m,g;if("object"!=typeof u)return u;if(e(u,t))m=new t;else if(e(u,n))m=new n;else if(e(u,r))m=new r((function(e,t){u.then((function(t){e(o(t,p-1))}),(function(e){t(o(e,p-1))}))}));else if(i.__isArray(u))m=[];else if(i.__isRegExp(u))m=new RegExp(u.source,a(u)),u.lastIndex&&(m.lastIndex=u.lastIndex);else if(i.__isDate(u))m=new Date(u.getTime());else{if(h&&j0.isBuffer(u))return m=j0.allocUnsafe?j0.allocUnsafe(u.length):new j0(u.length),u.copy(m),m;e(u,Error)?m=Object.create(u):void 0===l?(g=Object.getPrototypeOf(u),m=Object.create(g)):(m=Object.create(l),g=l)}if(s){var y=f.indexOf(u);if(-1!=y)return d[y];f.push(u),d.push(m)}for(var v in e(u,t)&&u.forEach((function(e,t){var n=o(t,p-1),r=o(e,p-1);m.set(n,r)})),e(u,n)&&u.forEach((function(e){var t=o(e,p-1);m.add(t)})),u){var b;g&&(b=Object.getOwnPropertyDescriptor(g,v)),b&&null==b.set||(m[v]=o(u[v],p-1))}if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(u);for(v=0;v<x.length;v++){var w=x[v];(!(k=Object.getOwnPropertyDescriptor(u,w))||k.enumerable||c)&&(m[w]=o(u[w],p-1),k.enumerable||Object.defineProperty(m,w,{enumerable:!1}))}}if(c){var _=Object.getOwnPropertyNames(u);for(v=0;v<_.length;v++){var k,E=_[v];(k=Object.getOwnPropertyDescriptor(u,E))&&k.enumerable||(m[E]=o(u[E],p-1),Object.defineProperty(m,E,{enumerable:!1}))}}return m}(o,u)}function o(e){return Object.prototype.toString.call(e)}function a(e){var t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),t}return i.clonePrototype=function(e){if(null===e)return null;var t=function(){};return t.prototype=e,new t},i.__objToStr=o,i.__isDate=function(e){return"object"==typeof e&&"[object Date]"===o(e)},i.__isArray=function(e){return"object"==typeof e&&"[object Array]"===o(e)},i.__isRegExp=function(e){return"object"==typeof e&&"[object RegExp]"===o(e)},i.__getRegExpFlags=a,i}();I0&&(I0=U0);var q0=e(I0),W0=e((function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var r,i,o;if(Array.isArray(t)){if((r=t.length)!=n.length)return!1;for(i=r;0!=i--;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((r=(o=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(i=r;0!=i--;)if(!Object.prototype.hasOwnProperty.call(n,o[i]))return!1;for(i=r;0!=i--;){var a=o[i];if(!e(t[a],n[a]))return!1}return!0}return t!=t&&n!=n})),H0=e((function(e,t){t||(t={}),"function"==typeof t&&(t={cmp:t});var n,r="boolean"==typeof t.cycles&&t.cycles,i=t.cmp&&(n=t.cmp,function(e){return function(t,r){var i={key:t,value:e[t]},o={key:r,value:e[r]};return n(i,o)}}),o=[];return function e(t){if(t&&t.toJSON&&"function"==typeof t.toJSON&&(t=t.toJSON()),void 0!==t){if("number"==typeof t)return isFinite(t)?""+t:"null";if("object"!=typeof t)return JSON.stringify(t);var n,a;if(Array.isArray(t)){for(a="[",n=0;n<t.length;n++)n&&(a+=","),a+=e(t[n])||"null";return a+"]"}if(null===t)return"null";if(-1!==o.indexOf(t)){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var s=o.push(t)-1,u=Object.keys(t).sort(i&&i(t));for(a="",n=0;n<u.length;n++){var l=u[n],c=e(t[l]);c&&(a&&(a+=","),a+=JSON.stringify(l)+":"+c)}return o.splice(s,1),"{"+a+"}"}}(e)}));function V0(e){return!!e.or}function G0(e){return!!e.and}function Y0(e){return!!e.not}function X0(e,t){if(Y0(e))X0(e.not,t);else if(G0(e))for(const n of e.and)X0(n,t);else if(V0(e))for(const n of e.or)X0(n,t);else t(e)}function Q0(e,t){return Y0(e)?{not:Q0(e.not,t)}:G0(e)?{and:e.and.map((e=>Q0(e,t)))}:V0(e)?{or:e.or.map((e=>Q0(e,t)))}:t(e)}const J0=W0;t(B0,"deepEqual",(function(){return J0}));const K0=q0;function Z0(e,t){const n={};for(const r of t)vy(e,r)&&(n[r]=e[r]);return n}function e1(e,t){const n={...e};for(const e of t)delete n[e];return n}t(B0,"duplicate",(function(){return K0})),t(B0,"pick",(function(){return Z0})),t(B0,"omit",(function(){return e1})),Set.prototype.toJSON=function(){return`Set(${[...this].map((e=>H0(e))).join(",")})`};const t1=H0;function n1(e){if(Cy(e))return e;const t=My(e)?e:H0(e);if(t.length<250)return t;let n=0;for(let e=0;e<t.length;e++){n=(n<<5)-n+t.charCodeAt(e),n&=n}return n}function r1(e){return!1===e||null===e}function i1(e,t){return e.includes(t)}function o1(e,t){let n=0;for(const[r,i]of e.entries())if(t(i,r,n++))return!0;return!1}function a1(e,t){let n=0;for(const[r,i]of e.entries())if(!t(i,r,n++))return!1;return!0}function s1(e,...t){for(const n of t)u1(e,n??{});return e}function u1(e,t){for(const n of g1(t))Pg(e,n,t[n],!0)}function l1(e,t){const n=[],r={};let i;for(const o of e)i=t(o),i in r||(r[i]=1,n.push(o));return n}function c1(e,t){const n=g1(e),r=g1(t);if(n.length!==r.length)return!1;for(const r of n)if(e[r]!==t[r])return!1;return!0}function f1(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function d1(e,t){for(const n of e)if(t.has(n))return!0;return!1}function h1(e){const t=new Set;for(const n of e){const e=kg(n).map(((e,t)=>0===t?e:`[${e}]`)),r=e.map(((t,n)=>e.slice(0,n+1).join("")));for(const e of r)t.add(e)}return t}function p1(e,t){return void 0===e||void 0===t||d1(h1(e),h1(t))}function m1(e){return 0===g1(e).length}t(B0,"stringify",(function(){return t1})),t(B0,"hash",(function(){return n1})),t(B0,"isNullOrFalse",(function(){return r1})),t(B0,"contains",(function(){return i1})),t(B0,"some",(function(){return o1})),t(B0,"every",(function(){return a1})),t(B0,"mergeDeep",(function(){return s1})),t(B0,"unique",(function(){return l1})),t(B0,"isEqual",(function(){return c1})),t(B0,"setEqual",(function(){return f1})),t(B0,"hasIntersection",(function(){return d1})),t(B0,"prefixGenerator",(function(){return h1})),t(B0,"fieldIntersection",(function(){return p1})),t(B0,"isEmpty",(function(){return m1}));const g1=Object.keys;t(B0,"keys",(function(){return g1}));const y1=Object.values;t(B0,"vals",(function(){return y1}));const v1=Object.entries;function b1(e){return!0===e||!1===e}function x1(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function w1(e,t){return Y0(e)?`!(${w1(e.not,t)})`:G0(e)?`(${e.and.map((e=>w1(e,t))).join(") && (")})`:V0(e)?`(${e.or.map((e=>w1(e,t))).join(") || (")})`:t(e)}function _1(e,t){if(0===t.length)return!0;const n=t.shift();return n in e&&_1(e[n],t)&&delete e[n],m1(e)}function k1(e){return e.charAt(0).toUpperCase()+e.substr(1)}function E1(e,t="datum"){const n=kg(e),r=[];for(let e=1;e<=n.length;e++){const i=`[${n.slice(0,e).map(Py).join("][")}]`;r.push(`${t}${i}`)}return r.join(" && ")}function S1(e,t="datum"){return`${t}[${Py(kg(e).join("."))}]`}function A1(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function C1(e){return`${kg(e).map(A1).join("\\.")}`}function D1(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function M1(e){return`${kg(e).join(".")}`}function F1(e){return e?kg(e).length:0}function N1(...e){for(const t of e)if(void 0!==t)return t}t(B0,"entries",(function(){return v1})),t(B0,"isBoolean",(function(){return b1})),t(B0,"varName",(function(){return x1})),t(B0,"logicalExpr",(function(){return w1})),t(B0,"deleteNestedProperty",(function(){return _1})),t(B0,"titleCase",(function(){return k1})),t(B0,"accessPathWithDatum",(function(){return E1})),t(B0,"flatAccessWithDatum",(function(){return S1})),t(B0,"replacePathInField",(function(){return C1})),t(B0,"replaceAll",(function(){return D1})),t(B0,"removePathFromField",(function(){return M1})),t(B0,"accessPathDepth",(function(){return F1})),t(B0,"getFirstDefined",(function(){return N1}));let O1=42;function $1(e){const t=++O1;return e?String(e)+t:t}function T1(){O1=42}function z1(e){return R1(e)?e:`__${e}`}function R1(e){return e.startsWith("__")}function P1(e){if(void 0!==e)return(e%360+360)%360}function L1(e){return!!Cy(e)||!isNaN(e)&&!isNaN(parseFloat(e))}t(B0,"uniqueId",(function(){return $1})),t(B0,"resetIdCounter",(function(){return T1})),t(B0,"internalField",(function(){return z1})),t(B0,"isInternalField",(function(){return R1})),t(B0,"normalizeAngle",(function(){return P1})),t(B0,"isNumeric",(function(){return L1}));const B1="row",I1="column",j1="facet",U1="x",q1="y",W1="x2",H1="y2",V1="radius",G1="radius2",Y1="theta",X1="theta2",Q1="latitude",J1="longitude",K1="latitude2",Z1="longitude2",e2="color",t2="fill",n2="stroke",r2="shape",i2="size",o2="angle",a2="opacity",s2="fillOpacity",u2="strokeOpacity",l2="strokeWidth",c2="strokeDash",f2="text",d2="order",h2="detail",p2="key",m2="tooltip",g2="href",y2="url",v2="description",b2={theta:1,theta2:1,radius:1,radius2:1};function x2(e){return e in b2}const w2={longitude:1,longitude2:1,latitude:1,latitude2:1};const _2=g1(w2),k2={x:1,y:1,x2:1,y2:1,...b2,...w2,color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1};function E2(e){return e===e2||e===t2||e===n2}const S2={row:1,column:1,facet:1},A2=g1(S2),C2={...k2,...S2},D2=g1(C2),{order:M2,detail:F2,tooltip:N2,...O2}=C2,{row:$2,column:T2,facet:z2,...R2}=O2;g1(O2),g1(R2);function P2(e){return!!C2[e]}const L2=[W1,H1,K1,Z1,X1,G1];function B2(e){return I2(e)!==e}function I2(e){switch(e){case W1:return U1;case H1:return q1;case K1:return Q1;case Z1:return J1;case X1:return Y1;case G1:return V1}return e}function j2(e){if(x2(e))switch(e){case Y1:return"startAngle";case X1:return"endAngle";case V1:return"outerRadius";case G1:return"innerRadius"}return e}function U2(e){switch(e){case U1:return W1;case q1:return H1;case Q1:return K1;case J1:return Z1;case Y1:return X1;case V1:return G1}}function q2(e){switch(e){case U1:case W1:return"width";case q1:case H1:return"height"}}g1(k2);const{x:W2,y:H2,x2:V2,y2:G2,latitude:Y2,longitude:X2,latitude2:Q2,longitude2:J2,theta:K2,theta2:Z2,radius:e3,radius2:t3,...n3}=k2,r3=g1(n3),i3={x:1,y:1},o3=g1(i3);function a3(e){return e in i3}const s3={theta:1,radius:1},u3=g1(s3);function l3(e){return"width"===e?U1:q1}const{text:c3,tooltip:f3,href:d3,url:h3,description:p3,detail:m3,key:g3,order:y3,...v3}=n3,b3=g1(v3);const x3={...i3,...s3,...v3},w3=g1(x3);function _3(e){return!!x3[e]}function k3(e,t){return function(e){switch(e){case e2:case t2:case n2:case v2:case h2:case p2:case m2:case g2:case d2:case a2:case s2:case u2:case l2:case j1:case B1:case I1:return E3;case U1:case q1:case Q1:case J1:return A3;case W1:case H1:case K1:case Z1:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case i2:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case c2:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case r2:return{point:"always",geoshape:"always"};case f2:return{text:"always"};case o2:return{point:"always",square:"always",text:"always"};case y2:return{image:"always"};case Y1:case V1:return{text:"always",arc:"always"};case X1:case G1:return{arc:"always"}}}(e)[t]}const E3={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},{geoshape:S3,...A3}=E3;function C3(e){switch(e){case U1:case q1:case Y1:case V1:case i2:case o2:case l2:case a2:case s2:case u2:case W1:case H1:case X1:case G1:return;case j1:case B1:case I1:case r2:case c2:case f2:case m2:case g2:case y2:case v2:return"discrete";case e2:case t2:case n2:return"flexible";case Q1:case J1:case K1:case Z1:case h2:case p2:case d2:return}}const D3={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},M3={count:1,min:1,max:1};function F3(e){return!!e&&!!e.argmin}function N3(e){return!!e&&!!e.argmax}g1(D3);function O3(e){return My(e)&&!!D3[e]}const $3=["count","valid","missing","distinct"];function T3(e){return My(e)&&i1($3,e)}const z3=["count","sum","distinct","valid","missing"],R3=Uy(["mean","average","median","q1","q3","min","max"]);function P3(e){return Ey(e)&&(e=N9(e,void 0)),"bin"+g1(e).map((t=>j3(e[t])?x1(`_${t}_${v1(e[t])}`):x1(`_${t}_${e[t]}`))).join("")}function L3(e){return!0===e||I3(e)&&!e.binned}function B3(e){return"binned"===e||I3(e)&&!0===e.binned}function I3(e){return Tg(e)}function j3(e){return e?.param}function U3(e){switch(e){case B1:case I1:case i2:case e2:case t2:case n2:case l2:case a2:case s2:case u2:case r2:return 6;case c2:return 4;default:return 10}}function q3(e){return e&&!!e.expr}function W3(e){const t=g1(e||{}),n={};for(const r of t)n[r]=e5(e[r]);return n}function H3(e){const{anchor:t,frame:n,offset:r,orient:i,color:o,subtitleColor:a,subtitleFont:s,subtitleFontSize:u,subtitleFontStyle:l,subtitleFontWeight:c,subtitleLineHeight:f,subtitlePadding:d,...h}=e,p={...h,...o?{fill:o}:{}},m={...t?{anchor:t}:{},...n?{frame:n}:{},...r?{offset:r}:{},...i?{orient:i}:{}},g={...a?{subtitleColor:a}:{},...s?{subtitleFont:s}:{},...u?{subtitleFontSize:u}:{},...l?{subtitleFontStyle:l}:{},...c?{subtitleFontWeight:c}:{},...f?{subtitleLineHeight:f}:{},...d?{subtitlePadding:d}:{}};return{titleMarkConfig:p,subtitleMarkConfig:Z0(p,["align","baseline","dx","dy","limit"]),nonMark:m,subtitle:g}}function V3(e){return My(e)||$g(e)&&My(e[0])}function G3(e){return e&&!!e.signal}function Y3(e){return!!e.step}function X3(e){return!$g(e)&&("field"in e&&"data"in e)}const Q3=g1({aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1,url:1,smooth:1}),J3={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},K3=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function Z3(e){const t=$g(e.condition)?e.condition.map(t5):t5(e.condition);return{...e5(e),condition:t}}function e5(e){if(q3(e)){const{expr:t,...n}=e;return{signal:t,...n}}return e}function t5(e){if(q3(e)){const{expr:t,...n}=e;return{signal:t,...n}}return e}function n5(e){if(q3(e)){const{expr:t,...n}=e;return{signal:t,...n}}return G3(e)?e:void 0!==e?{value:e}:void 0}function r5(e){return G3(e)?e.signal:Py(e.value)}function i5(e){return G3(e)?e.signal:null==e?null:Py(e)}function o5(e,t,n){for(const r of n){const n=u5(r,t.markDef,t.config);void 0!==n&&(e[r]=n5(n))}return e}function a5(e){return[].concat(e.type,e.style??[])}function s5(e,t,n,r={}){const{vgChannel:i,ignoreVgConfig:o}=r;return i&&void 0!==t[i]?t[i]:void 0!==t[e]?t[e]:!o||i&&i!==e?u5(e,t,n,r):void 0}function u5(e,t,n,{vgChannel:r}={}){return N1(r?l5(e,t,n.style):void 0,l5(e,t,n.style),r?n[t.type][r]:void 0,n[t.type][e],r?n.mark[r]:n.mark[e])}function l5(e,t,n){return c5(e,a5(t),n)}function c5(e,t,n){let r;t=iy(t);for(const i of t){const t=n[i];t&&void 0!==t[e]&&(r=t[e])}return r}function f5(e,t){return iy(e).reduce(((e,n)=>(e.field.push(y9(n,t)),e.order.push(n.sort??"ascending"),e)),{field:[],order:[]})}function d5(e,t){const n=[...e];return t.forEach((e=>{for(const t of n)if(J0(t,e))return;n.push(e)})),n}function h5(e,t){return J0(e,t)||!t?e:e?[...iy(e),...iy(t)].join(", "):t}function p5(e,t){const n=e.value,r=t.value;if(null==n||null===r)return{explicit:e.explicit,value:null};if((V3(n)||G3(n))&&(V3(r)||G3(r)))return{explicit:e.explicit,value:h5(n,r)};if(V3(n)||G3(n))return{explicit:e.explicit,value:n};if(V3(r)||G3(r))return{explicit:e.explicit,value:r};if(!(V3(n)||G3(n)||V3(r)||G3(r)))return{explicit:e.explicit,value:d5(n,r)};throw new Error("It should never reach here")}var m5={},g5={};function y5(e){return`Invalid specification ${t1(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}t(g5,"invalidSpec",(function(){return y5}));function v5(e){return`${"width"==e?"Width":"Height"} "container" only works for single views and layered views.`}function b5(e){return`${"width"==e?"Width":"Height"} "container" only works well with autosize "fit" or "fit-${"width"==e?"x":"y"}".`}function x5(e){return e?`Dropping "fit-${e}" because spec has discrete ${q2(e)}.`:'Dropping "fit" because spec has discrete size.'}function w5(e){return`Unknown field for ${e}. Cannot calculate view size.`}function _5(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function k5(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function E5(e){return`The "nearest" transform is not supported for ${e} marks.`}function S5(e){return`Selection not supported for ${e} yet.`}function A5(e){return`Cannot find a selection named "${e}".`}t(g5,"FIT_NON_SINGLE",(function(){return'Autosize "fit" only works for single views and layered views.'})),t(g5,"containerSizeNonSingle",(function(){return v5})),t(g5,"containerSizeNotCompatibleWithAutosize",(function(){return b5})),t(g5,"droppingFit",(function(){return x5})),t(g5,"unknownField",(function(){return w5})),t(g5,"cannotProjectOnChannelWithoutField",(function(){return _5})),t(g5,"cannotProjectAggregate",(function(){return k5})),t(g5,"nearestNotSupportForContinuous",(function(){return E5})),t(g5,"selectionNotSupported",(function(){return S5})),t(g5,"selectionNotFound",(function(){return A5}));t(g5,"SCALE_BINDINGS_CONTINUOUS",(function(){return"Scale bindings are currently only supported for scales with unbinned, continuous domains."}));function C5(e){return`Lookups can only be performed on selection parameters. "${e}" is a variable parameter.`}function D5(e){return`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`}t(g5,"LEGEND_BINDINGS_MUST_HAVE_PROJECTION",(function(){return"Legend bindings are only supported for selections over an individual field or encoding channel."})),t(g5,"cannotLookupVariableParameter",(function(){return C5})),t(g5,"noSameUnitLookup",(function(){return D5}));t(g5,"NEEDS_SAME_SELECTION",(function(){return"The same selection must be used to override scale domains in a layered view."}));function M5(e){return`Unknown repeated value "${e}".`}function F5(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}t(g5,"INTERVAL_INITIALIZED_WITH_X_Y",(function(){return'Interval selections should be initialized using "x" and/or "y" keys.'})),t(g5,"noSuchRepeatedValue",(function(){return M5})),t(g5,"columnsNotSupportByRowCol",(function(){return F5}));function N5(e){return`Unrecognized parse "${e}".`}function O5(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`}t(g5,"CONCAT_CANNOT_SHARE_AXIS",(function(){return"Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415)."})),t(g5,"unrecognizedParse",(function(){return N5})),t(g5,"differentParse",(function(){return O5}));function $5(e){return`Ignoring an invalid transform: ${t1(e)}.`}t(g5,"ADD_SAME_CHILD_TWICE",(function(){return"Attempt to add the same child twice."})),t(g5,"invalidTransformIgnored",(function(){return $5}));function T5(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function z5(e){const{parentProjection:t,projection:n}=e;return`Layer's shared projection ${t1(t)} is overridden by a child projection ${t1(n)}.`}t(g5,"NO_FIELDS_NEEDS_AS",(function(){return'If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.'})),t(g5,"customFormatTypeNotAllowed",(function(){return T5})),t(g5,"projectionOverridden",(function(){return z5}));function R5(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${t1(n)}}.`}function P5(e){return`Invalid field type "${e}".`}function L5(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}function B5(e){return`Invalid aggregation operator "${e}".`}function I5(e,t){return`Missing type for channel "${e}", using "${t}" instead.`}function j5(e,t){const{fill:n,stroke:r}=t;return`Dropping color ${e} as the plot also has ${n&&r?"fill and stroke":n?"fill":"stroke"}.`}function U5(e){return`Position range does not support relative band size for ${e}.`}function q5(e,t){return`Dropping ${t1(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`}t(g5,"REPLACE_ANGLE_WITH_THETA",(function(){return"Arc marks uses theta channel rather than angle, replacing angle with theta."})),t(g5,"primitiveChannelDef",(function(){return R5})),t(g5,"invalidFieldType",(function(){return P5})),t(g5,"invalidFieldTypeForCountAggregate",(function(){return L5})),t(g5,"invalidAggregate",(function(){return B5})),t(g5,"missingFieldType",(function(){return I5})),t(g5,"droppingColor",(function(){return j5})),t(g5,"relativeBandSizeNotSupported",(function(){return U5})),t(g5,"emptyFieldDef",(function(){return q5}));function W5(e,t,n){return`${e} dropped as it is incompatible with "${t}"${n?` when ${n}`:""}.`}function H5(e){return`${e}-encoding is dropped as ${e} is not a valid encoding channel.`}function V5(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`}function G5(e){return`${e} encoding should be discrete (ordinal / nominal / binned) or use a discretizing scale (e.g. threshold).`}function Y5(e){return`Facet encoding dropped as ${e.join(" and ")} ${e.length>1?"are":"is"} also specified.`}function X5(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${"ordinal"===t?"order":"magnitude"}.`}function Q5(e){return`The ${e} for range marks cannot be an expression`}function J5(e,t){return`Line mark is for continuous lines and thus cannot be used with ${e&&t?"x2 and y2":e?"x2":"y2"}. We will use the rule mark (line segments) instead.`}function K5(e,t){return`Specified orient "${e}" overridden with "${t}".`}t(g5,"LINE_WITH_VARYING_SIZE",(function(){return"Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead."})),t(g5,"incompatibleChannel",(function(){return W5})),t(g5,"invalidEncodingChannel",(function(){return H5})),t(g5,"channelShouldBeDiscrete",(function(){return V5})),t(g5,"channelShouldBeDiscreteOrDiscretizing",(function(){return G5})),t(g5,"facetChannelDropped",(function(){return Y5})),t(g5,"discreteChannelCannotEncode",(function(){return X5})),t(g5,"rangeMarkAlignmentCannotBeExpression",(function(){return Q5})),t(g5,"lineWithRange",(function(){return J5})),t(g5,"orientOverridden",(function(){return K5}));function Z5(e){return`Cannot use the scale property "${e}" with non-color channel.`}function e6(e){return`Cannot use the relative band size with ${e} scale.`}function t6(e){return`Using unaggregated domain with raw field has no effect (${t1(e)}).`}function n6(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function r6(e){return`Unaggregated domain is currently unsupported for log scale (${t1(e)}).`}function i6(e){return`Cannot apply size to non-oriented mark "${e}".`}function o6(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`}function a6(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}function s6(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function u6(e,t){return`Scale type "${t}" does not work with mark "${e}".`}function l6(e){return`The step for "${e}" is dropped because the ${"width"===e?"x":"y"} is continuous.`}function c6(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${t1(n)} and ${t1(r)}). Using ${t1(n)}.`}function f6(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${t1(n)} and ${t1(r)}). Using the union of the two domains.`}function d6(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}function h6(e){return`Dropping sort property ${t1(e)} as unioned domains only support boolean or op "count", "min", and "max".`}t(g5,"CANNOT_UNION_CUSTOM_DOMAIN_WITH_FIELD_DOMAIN",(function(){return"Custom domain scale cannot be unioned with default field-based domain."})),t(g5,"cannotUseScalePropertyWithNonColor",(function(){return Z5})),t(g5,"cannotUseRelativeBandSizeWithNonBandScale",(function(){return e6})),t(g5,"unaggregateDomainHasNoEffectForRawField",(function(){return t6})),t(g5,"unaggregateDomainWithNonSharedDomainOp",(function(){return n6})),t(g5,"unaggregatedDomainWithLogScale",(function(){return r6})),t(g5,"cannotApplySizeToNonOrientedMark",(function(){return i6})),t(g5,"scaleTypeNotWorkWithChannel",(function(){return o6})),t(g5,"scaleTypeNotWorkWithFieldDef",(function(){return a6})),t(g5,"scalePropertyNotWorkWithScaleType",(function(){return s6})),t(g5,"scaleTypeNotWorkWithMark",(function(){return u6})),t(g5,"stepDropped",(function(){return l6})),t(g5,"mergeConflictingProperty",(function(){return c6})),t(g5,"mergeConflictingDomainProperty",(function(){return f6})),t(g5,"independentScaleMeansIndependentGuide",(function(){return d6})),t(g5,"domainSortDropped",(function(){return h6}));t(g5,"MORE_THAN_ONE_SORT",(function(){return"Domains that should be unioned has conflicting sort properties. Sort will be set to true."}));t(g5,"FACETED_INDEPENDENT_DIFFERENT_SOURCES",(function(){return"Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect."}));t(g5,"FACETED_INDEPENDENT_SAME_FIELDS_DIFFERENT_SOURCES",(function(){return"Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect."}));t(g5,"FACETED_INDEPENDENT_SAME_SOURCE",(function(){return"Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect."}));function p6(e){return`Cannot stack "${e}" if there is already "${e}2".`}function m6(e){return`Cannot stack non-linear scale (${e}).`}function g6(e){return`Stacking is applied even though the aggregate function is non-summative ("${e}").`}function y6(e,t){return`Invalid ${e}: ${t1(t)}.`}function v6(e){return`Dropping day from datetime ${t1(e)} as day cannot be combined with other units.`}function b6(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}function x6(e,t,n){return`${e} is not usually used with ${t} for ${n}.`}function w6(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}function _6(e){return`1D error band does not support ${e}.`}function k6(e){return`Channel ${e} is required for "binned" bin.`}function E6(e){return`Channel ${e} should not be used with "binned" bin.`}function S6(e){return`Domain for ${e} is required for threshold scale.`}t(g5,"INVALID_CHANNEL_FOR_AXIS",(function(){return"Invalid channel for axis."})),t(g5,"cannotStackRangedMark",(function(){return p6})),t(g5,"cannotStackNonLinearScale",(function(){return m6})),t(g5,"stackNonSummativeAggregate",(function(){return g6})),t(g5,"invalidTimeUnit",(function(){return y6})),t(g5,"droppedDay",(function(){return v6})),t(g5,"errorBarCenterAndExtentAreNotNeeded",(function(){return b6})),t(g5,"errorBarCenterIsUsedWithWrongExtent",(function(){return x6})),t(g5,"errorBarContinuousAxisHasCustomizedAggregate",(function(){return w6})),t(g5,"errorBand1DNotSupport",(function(){return _6})),t(g5,"channelRequiredForBinned",(function(){return k6})),t(g5,"channelShouldNotBeUsedForBinned",(function(){return E6})),t(g5,"domainRequiredForThresholdScale",(function(){return S6}));t(m5,"message",(function(){return g5}));const A6=Og(2);let C6=A6;function D6(e){return C6=e,C6}function M6(){return C6=A6,C6}function F6(...e){C6.warn(...e)}function N6(...e){C6.debug(...e)}function O6(e){if(e&&Tg(e))for(const t of I6)if(t in e)return!0;return!1}new WeakMap,t(m5,"set",(function(){return D6})),t(m5,"reset",(function(){return M6})),t(m5,"warn",(function(){return F6})),t(m5,"debug",(function(){return N6}));const $6=["january","february","march","april","may","june","july","august","september","october","november","december"],T6=$6.map((e=>e.substr(0,3))),z6=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],R6=z6.map((e=>e.substr(0,3)));function P6(e,t){const n=[];if(t&&void 0!==e.day&&g1(e).length>1&&(m5.warn(g5.droppedDay(e)),delete(e=K0(e)).day),void 0!==e.year?n.push(e.year):n.push(2012),void 0!==e.month){const r=t?function(e){if(L1(e)&&(e=+e),Cy(e))return e-1;{const t=e.toLowerCase(),n=$6.indexOf(t);if(-1!==n)return n;const r=t.substr(0,3),i=T6.indexOf(r);if(-1!==i)return i;throw new Error(g5.invalidTimeUnit("month",e))}}(e.month):e.month;n.push(r)}else if(void 0!==e.quarter){const r=t?function(e){if(L1(e)&&(e=+e),Cy(e))return e>4&&m5.warn(g5.invalidTimeUnit("quarter",e)),e-1;throw new Error(g5.invalidTimeUnit("quarter",e))}(e.quarter):e.quarter;n.push(Cy(r)?3*r:`${r}*3`)}else n.push(0);if(void 0!==e.date)n.push(e.date);else if(void 0!==e.day){const r=t?function(e){if(L1(e)&&(e=+e),Cy(e))return e%7;{const t=e.toLowerCase(),n=z6.indexOf(t);if(-1!==n)return n;const r=t.substr(0,3),i=R6.indexOf(r);if(-1!==i)return i;throw new Error(g5.invalidTimeUnit("day",e))}}(e.day):e.day;n.push(Cy(r)?r+1:`${r}+1`)}else n.push(1);for(const t of["hours","minutes","seconds","milliseconds"]){const r=e[t];n.push(void 0===r?0:r)}return n}function L6(e){const t=P6(e,!0).join(", ");return e.utc?`utc(${t})`:`datetime(${t})`}const B6={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},I6=g1(B6);function j6(e){return e.startsWith("utc")}const U6={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function q6(e){return I6.filter((t=>W6(e,t)))}function W6(e,t){const n=e.indexOf(t);return!(n<0)&&(!(n>0&&"seconds"===t&&"i"===e.charAt(n-1))&&(!(e.length>n+3&&"day"===t&&"o"===e.charAt(n+3))&&!(n>0&&"year"===t&&"f"===e.charAt(n-1))))}function H6(e,t,{end:n}={end:!1}){const r=E1(t),i=j6(e)?"utc":"";let o;const a={};for(const t of I6)W6(e,t)&&(a[t]="quarter"===(s=t)?`(${i}quarter(${r})-1)`:`${i}${s}(${r})`,o=t);var s;return n&&(a[o]+="+1"),function(e){const t=P6(e,!1).join(", ");return e.utc?`utc(${t})`:`datetime(${t})`}(a)}function V6(e){if(!e)return;const t=q6(e);return`timeUnitSpecifier(${t1(t)}, ${t1(U6)})`}function G6(e){if(!e)return;let t;return My(e)?t={unit:e}:Tg(e)&&(t={...e,...e.unit?{unit:e.unit}:{}}),j6(t.unit)&&(t.utc=!0,t.unit=t.unit.substr(3)),t}function Y6(e){return e&&!!e.field&&void 0!==e.equal}function X6(e){return e&&!!e.field&&void 0!==e.lt}function Q6(e){return e&&!!e.field&&void 0!==e.lte}function J6(e){return e&&!!e.field&&void 0!==e.gt}function K6(e){return e&&!!e.field&&void 0!==e.gte}function Z6(e){if(e&&e.field){if($g(e.range)&&2===e.range.length)return!0;if(G3(e.range))return!0}return!1}function e4(e){return e&&!!e.field&&($g(e.oneOf)||$g(e.in))}function t4(e){return e4(e)||Y6(e)||Z6(e)||X6(e)||J6(e)||Q6(e)||K6(e)}function n4(e,t){return T9(e,{timeUnit:t,wrapTime:!0})}function r4(e,t=!0){const{field:n}=e,r=G6(e.timeUnit)?.unit,i=r?`time(${H6(r,n)})`:y9(e,{expr:"datum"});if(Y6(e))return`${i}===${n4(e.equal,r)}`;if(X6(e)){return`${i}<${n4(e.lt,r)}`}if(J6(e)){return`${i}>${n4(e.gt,r)}`}if(Q6(e)){return`${i}<=${n4(e.lte,r)}`}if(K6(e)){return`${i}>=${n4(e.gte,r)}`}if(e4(e))return`indexof([${function(e,t){return e.map((e=>n4(e,t)))}(e.oneOf,r).join(",")}], ${i}) !== -1`;if(function(e){return e&&!!e.field&&void 0!==e.valid}(e))return i4(i,e.valid);if(Z6(e)){const{range:n}=e,o=G3(n)?{signal:`${n.signal}[0]`}:n[0],a=G3(n)?{signal:`${n.signal}[1]`}:n[1];if(null!==o&&null!==a&&t)return"inrange("+i+", ["+n4(o,r)+", "+n4(a,r)+"])";const s=[];return null!==o&&s.push(`${i} >= ${n4(o,r)}`),null!==a&&s.push(`${i} <= ${n4(a,r)}`),s.length>0?s.join(" && "):"true"}throw new Error(`Invalid field predicate: ${t1(e)}`)}function i4(e,t=!0){return t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function o4(e){return t4(e)&&e.timeUnit?{...e,timeUnit:G6(e.timeUnit)?.unit}:e}const a4={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"},s4=a4.quantitative,u4=a4.ordinal,l4=a4.temporal,c4=a4.nominal,f4=a4.geojson;g1(a4);const d4="linear",h4="log",p4="pow",m4="sqrt",g4="symlog",y4="time",v4="utc",b4="quantile",x4="quantize",w4="threshold",_4="point",k4="band",E4={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"};g1(E4);function S4(e,t){const n=E4[e],r=E4[t];return n===r||"ordinal-position"===n&&"time"===r||"ordinal-position"===r&&"time"===n}const A4={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function C4(e){return A4[e]}const D4=["linear","log","pow","sqrt","symlog","time","utc"],M4=Uy(D4),F4=Uy(["linear","log","pow","sqrt","symlog"]);const N4=Uy(["quantile","quantize","threshold"]),O4=Uy(D4.concat(["quantile","quantize","threshold","sequential","identity"])),$4=Uy(["ordinal","bin-ordinal","point","band"]);function T4(e){return e in $4}function z4(e){return e in O4}function R4(e){return e in M4}function P4(e){return e in N4}function L4(e){return e?.param}const B4={type:1,domain:1,domainMax:1,domainMin:1,domainMid:1,align:1,range:1,rangeMax:1,rangeMin:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},{type:I4,domain:j4,range:U4,rangeMax:q4,rangeMin:W4,scheme:H4,...V4}=(g1(B4),B4),G4=g1(V4);function Y4(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!["point","band","identity"].includes(e);case"bins":return!["point","band","identity","ordinal"].includes(e);case"round":return R4(e)||"band"===e||"point"===e;case"padding":case"rangeMin":case"rangeMax":return R4(e)||["point","band"].includes(e);case"paddingOuter":case"align":return["point","band"].includes(e);case"paddingInner":return"band"===e;case"domainMax":case"domainMid":case"domainMin":case"clamp":return R4(e);case"nice":return R4(e)||"quantize"===e||"threshold"===e;case"exponent":return"pow"===e;case"base":return"log"===e;case"constant":return"symlog"===e;case"zero":return z4(e)&&!i1(["log","time","utc","threshold","quantile"],e)}}function X4(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return E2(e)?void 0:g5.cannotUseScalePropertyWithNonColor(e);case"align":case"type":case"bins":case"domain":case"domainMax":case"domainMin":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeMax":case"rangeMin":case"reverse":case"round":case"clamp":case"zero":return}}const Q4={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},J4=Q4.arc,K4=Q4.area,Z4=Q4.bar,e8=Q4.image,t8=Q4.line,n8=Q4.point,r8=Q4.rect,i8=Q4.rule,o8=Q4.text,a8=Q4.tick,s8=Q4.trail,u8=Q4.circle,l8=Q4.square,c8=Q4.geoshape;function f8(e){return["line","area","trail"].includes(e)}function d8(e){return["rect","bar","image","arc"].includes(e)}const h8=g1(Q4);function p8(e){return e.type}Uy(h8);const m8=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit","fill","fillOpacity"],g8=g1({color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBandSize:1,timeUnitBandPosition:1}),y8=g1({mark:1,arc:1,area:1,bar:1,circle:1,image:1,line:1,point:1,rect:1,rule:1,square:1,text:1,tick:1,trail:1,geoshape:1});function v8(e){return e&&null!=e.band}const b8={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},x8={binSpacing:1,continuousBandSize:5,timeUnitBandPosition:.5},w8={binSpacing:0,continuousBandSize:5,timeUnitBandPosition:.5};function _8(e){const{channel:t,channelDef:n,markDef:r,scale:i,config:o}=e,a=D8(e);return i9(n)&&!T3(n.aggregate)&&i&&R4(i.get("type"))&&!1===i.get("zero")?k8({fieldDef:n,channel:t,markDef:r,ref:a,config:o}):a}function k8({fieldDef:e,channel:t,markDef:n,ref:r,config:i}){if(f8(n.type))return r;return null===s5("invalid",n,i)?r:[E8(e,t),r]}function E8(e,t){return{test:S8(e,!0),..."y"===I2(t)?{field:{group:"height"}}:{value:0}}}function S8(e,t=!0){return i4(My(e)?e:y9(e,{expr:"datum"}),!t)}function A8(e,t,n,r){const i={};if(t&&(i.scale=t),a9(e)){const{datum:t}=e;O6(t)?i.signal=L6(t):G3(t)?i.signal=t.signal:q3(t)?i.signal=t.expr:i.value=t}else i.field=y9(e,n);if(r){const{offset:e,band:t}=r;e&&(i.offset=e),t&&(i.band=t)}return i}function C8({scaleName:e,fieldOrDatumDef:t,fieldOrDatumDef2:n,offset:r,startSuffix:i,bandPosition:o=.5}){const a=0<o&&o<1?"datum":void 0,s=y9(t,{expr:a,suffix:i}),u=void 0!==n?y9(n,{expr:a}):y9(t,{suffix:"end",expr:a}),l={};if(0===o||1===o){l.scale=e;const t=0===o?s:u;l.field=t}else{const t=G3(o)?`${o.signal} * ${s} + (1-${o.signal}) * ${u}`:`${o} * ${s} + ${1-o} * ${u}`;l.signal=`scale("${e}", ${t})`}return r&&(l.offset=r),l}function D8({channel:e,channelDef:t,channel2Def:n,markDef:r,config:i,scaleName:o,scale:a,stack:s,offset:u,defaultRef:l,bandPosition:c}){if(t){if(l9(t)){if(c9(t)){c??(c=K8({fieldDef:t,fieldDef2:n,markDef:r,config:i}));const{bin:a,timeUnit:l,type:f}=t;if(L3(a)||c&&l&&f===l4)return s&&s.impute?A8(t,o,{binSuffix:"mid"},{offset:u}):c?C8({scaleName:o,fieldOrDatumDef:t,bandPosition:c,offset:u}):A8(t,o,R9(t,e)?{binSuffix:"range"}:{},{offset:u});if(B3(a)){if(i9(n))return C8({scaleName:o,fieldOrDatumDef:t,fieldOrDatumDef2:n,bandPosition:c,offset:u});{const t=e===U1?W1:H1;m5.warn(g5.channelRequiredForBinned(t))}}}const l=a?.get?.("type");return A8(t,o,T4(l)?{binSuffix:"range"}:{},{offset:u,band:"band"===l?c??t.bandPosition??.5:void 0})}if(f9(t)){const n=u?{offset:u}:{};return{...M8(e,t.value),...n}}}return ay(l)&&(l=l()),l?{...l,...u?{offset:u}:{}}:l}function M8(e,t){return i1(["x","x2"],e)&&"width"===t?{field:{group:"width"}}:i1(["y","y2"],e)&&"height"===t?{field:{group:"height"}}:n5(t)}function F8(e){return e&&"number"!==e&&"time"!==e}function N8(e,t,n){return`${e}(${t}${n?`, ${t1(n)}`:""})`}function O8({fieldOrDatumDef:e,format:t,formatType:n,expr:r,normalizeStack:i,config:o}){if(F8(n))return T8({fieldOrDatumDef:e,format:t,formatType:n,expr:r,config:o});const a=$8(e,r,i);if($9(e)){const n=function(e,t,n,r,i){return!t||n?`${i?"utc":"time"}Format(${e}, '${n=My(n)?n:r}')`:function(e,t,n){if(!e)return;const r=V6(e);return`${n||j6(e)?"utc":"time"}Format(${t}, ${r})`}(t,e,i)}(a,i9(e)?G6(e.timeUnit)?.unit:void 0,t,o.timeFormat,d9(e)&&e.scale?.type===v4);return n?{signal:n}:void 0}if(t=P8(o9(e),t,o),i9(e)&&L3(e.bin)){return{signal:I8(a,y9(e,{expr:r,binSuffix:"end"}),t,n,o)}}return t||"quantitative"===o9(e)?{signal:`${L8(a,t)}`}:{signal:`isValid(${a}) ? ${a} : ""+${a}`}}function $8(e,t,n){return i9(e)?n?`${y9(e,{expr:t,suffix:"end"})}-${y9(e,{expr:t,suffix:"start"})}`:y9(e,{expr:t}):function(e){const{datum:t}=e;return O6(t)?L6(t):`${t1(t)}`}(e)}function T8({fieldOrDatumDef:e,format:t,formatType:n,expr:r,normalizeStack:i,config:o,field:a}){if(a??(a=$8(e,r,i)),i9(e)&&L3(e.bin)){return{signal:I8(a,y9(e,{expr:r,binSuffix:"end"}),t,n,o)}}return{signal:N8(n,a,t)}}function z8(e,t,n,r,i,o){if(!F8(r)){if($9(e)){return function(e,t,n,r){if(e)return e;if(t)return{signal:V6(t)};return r?void 0:n.timeFormat}(n,i9(e)?G6(e.timeUnit)?.unit:void 0,i,o)}return P8(t,n,i)}}function R8(e,t,n){return e&&(G3(e)||"number"===e||"time"===e)?e:$9(t)&&"time"!==n&&"utc"!==n?"time":void 0}function P8(e,t,n){return My(t)?t:e===s4?n.numberFormat:void 0}function L8(e,t){return`format(${e}, "${t||""}")`}function B8(e,t,n,r){return F8(n)?N8(n,e,t):L8(e,(My(t)?t:void 0)??r.numberFormat)}function I8(e,t,n,r,i){const o=B8(e,n,r,i),a=B8(t,n,r,i);return`${i4(e,!1)} ? "null" : ${o} + "  " + ${a}`}const j8="min",U8={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function q8(e){return e in U8}function W8(e){return!!e&&!!e.encoding}function H8(e){return!(!e||"count"!==e.op&&!e.field)}function V8(e){return!!e&&$g(e)}function G8(e){return"row"in e||"column"in e}function Y8(e){return!!e&&"header"in e}function X8(e){return"facet"in e}function Q8(e){const{field:t,timeUnit:n,bin:r,aggregate:i}=e;return{...n?{timeUnit:n}:{},...r?{bin:r}:{},...i?{aggregate:i}:{},field:t}}function J8(e){return"sort"in e}function K8({fieldDef:e,fieldDef2:t,markDef:n,config:r}){if(l9(e)&&void 0!==e.bandPosition)return e.bandPosition;if(i9(e)){const{timeUnit:i,bin:o}=e;if(i&&!t)return d8(n.type)?0:u5("timeUnitBandPosition",n,r);if(L3(o))return.5}}function Z8({channel:e,fieldDef:t,fieldDef2:n,markDef:r,config:i,scaleType:o,useVlSizeChannel:a}){const s=q2(e),u=s5(a?"size":s,r,i,{vgChannel:s});if(void 0!==u)return u;if(i9(t)){const{timeUnit:e,bin:a}=t;if(e&&!n)return{band:u5("timeUnitBandSize",r,i)};if(L3(a)&&!T4(o))return{band:1}}return d8(r.type)?o?T4(o)?i[r.type]?.discreteBandSize||{band:1}:i[r.type]?.continuousBandSize:i[r.type]?.discreteBandSize:void 0}function e9(e,t,n,r){return!!(L3(e.bin)||e.timeUnit&&c9(e)&&"temporal"===e.type)&&void 0!==K8({fieldDef:e,fieldDef2:t,markDef:n,config:r})}function t9(e){return!!e&&"condition"in e}function n9(e){const t=e&&e.condition;return!!t&&!$g(t)&&i9(t)}function r9(e){const t=e&&e.condition;return!!t&&!$g(t)&&l9(t)}function i9(e){return!(!e||!e.field&&"count"!==e.aggregate)}function o9(e){return e&&e.type}function a9(e){return!!e&&"datum"in e}function s9(e){return c9(e)&&!v9(e)||u9(e)}function u9(e){return a9(e)&&Cy(e.datum)}function l9(e){return i9(e)||a9(e)}function c9(e){return!!e&&("field"in e||"count"===e.aggregate)&&"type"in e}function f9(e){return e&&"value"in e&&"value"in e}function d9(e){return!!e&&("scale"in e||"sort"in e)}function h9(e){return e&&("axis"in e||"stack"in e||"impute"in e)}function p9(e){return!!e&&"legend"in e}function m9(e){return!!e&&("format"in e||"formatType"in e)}function g9(e){return e1(e,["legend","axis","header","scale"])}function y9(e,t={}){let n=e.field;const r=t.prefix;let i=t.suffix,o="";if(function(e){return"count"===e.aggregate}(e))n=z1("count");else{let r;if(!t.nofn)if(function(e){return"op"in e}(e))r=e.op;else{const{bin:a,aggregate:s,timeUnit:u}=e;L3(a)?(r=P3(a),i=(t.binSuffix??"")+(t.suffix??"")):s?N3(s)?(o=`["${n}"]`,n=`argmax_${s.argmax}`):F3(s)?(o=`["${n}"]`,n=`argmin_${s.argmin}`):r=String(s):u&&(r=function(e){const{utc:t,...n}=G6(e);return n.unit?(t?"utc":"")+g1(n).map((e=>x1(`${"unit"===e?"":`_${e}_`}${n[e]}`))).join(""):(t?"utc":"")+"timeunit"+g1(n).map((e=>x1(`_${e}_${n[e]}`))).join("")}(u),i=(!["range","mid"].includes(t.binSuffix)&&t.binSuffix||"")+(t.suffix??""))}r&&(n=n?`${r}_${n}`:r)}return i&&(n=`${n}_${i}`),r&&(n=`${r}_${n}`),t.forAs?M1(n):t.expr?S1(n,t.expr)+o:C1(n)+o}function v9(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return i9(e)&&!!e.bin;case"temporal":return!1}throw new Error(g5.invalidFieldType(e.type))}const b9=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return function(e){const{aggregate:t,bin:n,timeUnit:r,field:i}=e;if(N3(t))return`${i} for argmax(${t.argmax})`;if(F3(t))return`${i} for argmin(${t.argmin})`;const o=G6(r),a=t||o?.unit||o?.maxbins&&"timeunit"||L3(n)&&"bin";return a?`${a.toUpperCase()}(${i})`:i}(e);default:return function(e,t){const{field:n,bin:r,timeUnit:i,aggregate:o}=e;if("count"===o)return t.countTitle;if(L3(r))return`${n} (binned)`;if(i){const e=G6(i)?.unit;if(e)return`${n} (${q6(e).join("-")})`}else if(o)return N3(o)?`${n} for max ${o.argmax}`:F3(o)?`${n} for min ${o.argmin}`:`${k1(o)} of ${n}`;return n}(e,t)}};let x9=b9;function w9(e){x9=e}function _9(e,t,{allowDisabling:n,includeDefault:r=!0}){const i=k9(e)?.title;if(!i9(e))return i;const o=e,a=r?E9(o,t):void 0;return n?N1(i,o.title,a):i??o.title??a}function k9(e){return h9(e)&&e.axis?e.axis:p9(e)&&e.legend?e.legend:Y8(e)&&e.header?e.header:void 0}function E9(e,t){return x9(e,t)}function S9(e){if(m9(e)){const{format:t,formatType:n}=e;return{format:t,formatType:n}}{const t=k9(e)??{},{format:n,formatType:r}=t;return{format:n,formatType:r}}}function A9(e){return i9(e)?e:n9(e)?e.condition:void 0}function C9(e){return l9(e)?e:r9(e)?e.condition:void 0}function D9(e,t,n,r={}){if(My(e)||Cy(e)||Ey(e)){const n=My(e)?"string":Cy(e)?"number":"boolean";return m5.warn(g5.primitiveChannelDef(t,n,e)),{value:e}}return l9(e)?M9(e,t,n,r):r9(e)?{...e,condition:M9(e.condition,t,n,r)}:e}function M9(e,t,n,r){if(m9(e)){const{format:i,formatType:o,...a}=e;if(F8(o)&&!n.customFormatTypes)return m5.warn(g5.customFormatTypeNotAllowed(t)),M9(a,t,n,r)}else{const i=h9(e)?"axis":p9(e)?"legend":Y8(e)?"header":null;if(i&&e[i]){const{format:o,formatType:a,...s}=e[i];if(F8(a)&&!n.customFormatTypes)return m5.warn(g5.customFormatTypeNotAllowed(t)),M9({...e,[i]:s},t,n,r)}}return i9(e)?F9(e,t,r):function(e){let t=e.type;if(t)return e;const{datum:n}=e;return t=Cy(n)?"quantitative":My(n)?"nominal":O6(n)?"temporal":void 0,{...e,type:t}}(e)}function F9(e,t,{compositeMark:n=!1}={}){const{aggregate:r,timeUnit:i,bin:o,field:a}=e,s={...e};if(n||!r||O3(r)||N3(r)||F3(r)||(m5.warn(g5.invalidAggregate(r)),delete s.aggregate),i&&(s.timeUnit=G6(i)),a&&(s.field=`${a}`),L3(o)&&(s.bin=N9(o,t)),B3(o)&&!a3(t)&&m5.warn(g5.channelShouldNotBeUsedForBinned(t)),c9(s)){const{type:e}=s,t=function(e){if(e)switch(e=e.toLowerCase()){case"q":case s4:return"quantitative";case"t":case l4:return"temporal";case"o":case u4:return"ordinal";case"n":case c4:return"nominal";case f4:return"geojson"}}(e);e!==t&&(s.type=t),"quantitative"!==e&&T3(r)&&(m5.warn(g5.invalidFieldTypeForCountAggregate(e,r)),s.type="quantitative")}else if(!B2(t)){const e=function(e,t){switch(t){case"latitude":case"longitude":return"quantitative";case"row":case"column":case"facet":case"shape":case"strokeDash":return"nominal";case"order":return"ordinal"}if(J8(e)&&$g(e.sort))return"ordinal";const{aggregate:n,bin:r,timeUnit:i}=e;if(i)return"temporal";if(r||n&&!N3(n)&&!F3(n))return"quantitative";if(d9(e)&&e.scale?.type)switch(E4[e.scale.type]){case"numeric":case"discretizing":return"quantitative";case"time":return"temporal"}return"nominal"}(s,t);s.type=e}if(c9(s)){const{compatible:e,warning:n}=function(e,t){const n=e.type;if("geojson"===n&&"shape"!==t)return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case B1:case I1:case j1:return v9(e)?O9:{compatible:!1,warning:g5.channelShouldBeDiscrete(t)};case U1:case q1:case e2:case t2:case n2:case f2:case h2:case p2:case m2:case g2:case y2:case o2:case Y1:case V1:case v2:return O9;case J1:case Z1:case Q1:case K1:return n!==s4?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:O9;case a2:case s2:case u2:case l2:case i2:case X1:case G1:case W1:case H1:return"nominal"!==n||e.sort?O9:{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`};case r2:case c2:return v9(e)||d9(r=e)&&P4(r.scale?.type)?O9:{compatible:!1,warning:g5.channelShouldBeDiscreteOrDiscretizing(t)};case d2:return"nominal"!==e.type||"sort"in e?O9:{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}}var r}(s,t)||{};!1===e&&m5.warn(n)}if(J8(s)&&My(s.sort)){const{sort:e}=s;if(q8(e))return{...s,sort:{encoding:e}};const t=e.substr(1);if("-"===e.charAt(0)&&q8(t))return{...s,sort:{encoding:t,order:"descending"}}}if(Y8(s)){const{header:e}=s;if(e){const{orient:t,...n}=e;if(t)return{...s,header:{...n,labelOrient:e.labelOrient||t,titleOrient:e.titleOrient||t}}}}return s}function N9(e,t){return Ey(e)?{maxbins:U3(t)}:"binned"===e?{binned:!0}:e.maxbins||e.step?e:{...e,maxbins:U3(t)}}const O9={compatible:!0};function $9(e){const{formatType:t}=S9(e);return"time"===t||!t&&((n=e)&&("temporal"===n.type||i9(n)&&!!n.timeUnit));var n}function T9(e,{timeUnit:t,type:n,wrapTime:r,undefinedIfExprNotRequired:i}){const o=t&&G6(t)?.unit;let a,s=o||"temporal"===n;return q3(e)?a=e.expr:G3(e)?a=e.signal:O6(e)?(s=!0,a=L6(e)):(My(e)||Cy(e))&&s&&(a=`datetime(${t1(e)})`,function(e){return!!B6[e]}(o)&&(Cy(e)&&e<1e4||My(e)&&isNaN(Date.parse(e)))&&(a=L6({[o]:e}))),a?r&&s?`time(${a})`:a:i?void 0:t1(e)}function z9(e,t){const{type:n}=e;return t.map((t=>{const r=T9(t,{timeUnit:i9(e)?e.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return void 0!==r?{signal:r}:t}))}function R9(e,t){return L3(e.bin)?_3(t)&&["ordinal","nominal"].includes(e.type):(console.warn("Only call this method for binned field defs."),!1)}const P9={labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDashOffset"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDashOffset"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"}};function L9(e){return e&&e.condition}const B9=["domain","grid","labels","ticks","title"],I9={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"both",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},j9={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},U9={...j9,style:1,labelExpr:1,encoding:1};function q9(e){return!!U9[e]}g1(U9);const W9=g1({axis:1,axisBand:1,axisBottom:1,axisDiscrete:1,axisLeft:1,axisPoint:1,axisQuantitative:1,axisRight:1,axisTemporal:1,axisTop:1,axisX:1,axisXBand:1,axisXDiscrete:1,axisXPoint:1,axisXQuantitative:1,axisXTemporal:1,axisY:1,axisYBand:1,axisYDiscrete:1,axisYPoint:1,axisYQuantitative:1,axisYTemporal:1});function H9(e){return"mark"in e}class V9{constructor(e,t){this.name=e,this.run=t}hasMatchingType(e){return!!H9(e)&&(p8(t=e.mark)?t.type:t)===this.name;var t}}function G9(e,t){const n=e&&e[t];return!!n&&($g(n)?o1(n,(e=>!!e.field)):i9(n)||n9(n))}function Y9(e){return o1(D2,(t=>{if(G9(e,t)){const n=e[t];if($g(n))return o1(n,(e=>!!e.aggregate));{const e=A9(n);return e&&!!e.aggregate}}return!1}))}function X9(e,t){const n=[],r=[],i=[],o=[],a={};return K9(e,((s,u)=>{if(i9(s)){const{field:l,aggregate:c,bin:f,timeUnit:d,...h}=s;if(c||d||f){const e=k9(s),p=e&&e.title;let m=y9(s,{forAs:!0});const g={...p?[]:{title:_9(s,t,{allowDisabling:!0})},...h,field:m};if(c){let e;if(N3(c)?(e="argmax",m=y9({op:"argmax",field:c.argmax},{forAs:!0}),g.field=`${m}.${l}`):F3(c)?(e="argmin",m=y9({op:"argmin",field:c.argmin},{forAs:!0}),g.field=`${m}.${l}`):"boxplot"!==c&&"errorbar"!==c&&"errorband"!==c&&(e=c),e){const t={op:e,as:m};l&&(t.field=l),o.push(t)}}else if(n.push(m),c9(s)&&L3(f)){if(r.push({bin:f,field:l,as:m}),n.push(y9(s,{binSuffix:"end"})),R9(s,u)&&n.push(y9(s,{binSuffix:"range"})),a3(u)){const e={field:`${m}_end`};a[`${u}2`]=e}g.bin="binned",B2(u)||(g.type=s4)}else if(d){i.push({timeUnit:d,field:l,as:m});const e=c9(s)&&s.type!==l4&&"time";e&&(u===f2||u===m2?g.formatType=e:!function(e){return!!n3[e]}(u)?a3(u)&&(g.axis={formatType:e,...g.axis}):g.legend={formatType:e,...g.legend})}a[u]=g}else n.push(l),a[u]=e[u]}else a[u]=e[u]})),{bins:r,timeUnits:i,aggregate:o,groupby:n,encoding:a}}function Q9(e,t,n,r){return g1(e).reduce(((i,o)=>{if(!P2(o))return m5.warn(g5.invalidEncodingChannel(o)),i;const a=e[o];if("angle"!==o||"arc"!==t||e.theta||(m5.warn(g5.REPLACE_ANGLE_WITH_THETA),o=Y1),!function(e,t,n){const r=k3(t,n);if(!r)return!1;if("binned"===r){const n=e[t===W1?U1:q1];return!!(i9(n)&&i9(e[t])&&B3(n.bin))}return!0}(e,o,t))return m5.warn(g5.incompatibleChannel(o,t)),i;if(o===i2&&"line"===t){if(A9(e[o])?.aggregate)return m5.warn(g5.LINE_WITH_VARYING_SIZE),i}if(o===e2&&(n?"fill"in e:"stroke"in e))return m5.warn(g5.droppingColor("encoding",{fill:"fill"in e,stroke:"stroke"in e})),i;if(o===h2||o===d2&&!$g(a)&&!f9(a)||o===m2&&$g(a))a&&(i[o]=iy(a).reduce(((e,t)=>(i9(t)?e.push(F9(t,o)):m5.warn(g5.emptyFieldDef(t,o)),e)),[]));else{if(o===m2&&null===a)i[o]=null;else if(!(i9(a)||a9(a)||f9(a)||t9(a)||G3(a)))return m5.warn(g5.emptyFieldDef(a,o)),i;i[o]=D9(a,o,r)}return i}),{})}function J9(e,t){const n={};for(const r of g1(e)){const i=D9(e[r],r,t,{compositeMark:!0});n[r]=i}return n}function K9(e,t,n){if(e)for(const r of g1(e)){const i=e[r];if($g(i))for(const e of i)t.call(n,e,r);else t.call(n,i,r)}}function Z9(e,t){return g1(t).reduce(((n,r)=>{switch(r){case U1:case q1:case g2:case v2:case y2:case W1:case H1:case Y1:case X1:case V1:case G1:case Q1:case J1:case K1:case Z1:case f2:case r2:case o2:case m2:return n;case d2:if("line"===e||"trail"===e)return n;case h2:case p2:{const e=t[r];if($g(e)||i9(e))for(const t of iy(e))t.aggregate||n.push(y9(t,{}));return n}case i2:if("trail"===e)return n;case e2:case t2:case n2:case a2:case s2:case u2:case c2:case l2:{const e=A9(t[r]);return e&&!e.aggregate&&n.push(y9(e,{})),n}}}),[])}function e7(e,t,n,r=!0){if("tooltip"in n)return{tooltip:n.tooltip};return{tooltip:[...e.map((({fieldPrefix:e,titlePrefix:n})=>{const i=r?` of ${t7(t)}`:"";return{field:e+t.field,type:t.type,title:G3(n)?{signal:`${n}"${escape(i)}"`}:n+i}})),...l1(function(e){const t=[];for(const n of g1(e))if(G9(e,n)){const r=iy(e[n]);for(const e of r)i9(e)?t.push(e):n9(e)&&t.push(e.condition)}return t}(n).map(g9),n1)]}}function t7(e){const{title:t,field:n}=e;return N1(t,n)}function n7(e,t,n,r,i){const{scale:o,axis:a}=n;return({partName:s,mark:u,positionPrefix:l,endPositionPrefix:c,extraEncoding:f={}})=>{const d=t7(n);return r7(e,s,i,{mark:u,encoding:{[t]:{field:`${l}_${n.field}`,type:n.type,...void 0!==d?{title:d}:{},...void 0!==o?{scale:o}:{},...void 0!==a?{axis:a}:{}},...My(c)?{[`${t}2`]:{field:`${c}_${n.field}`}}:{},...r,...f}})}}function r7(e,t,n,r){const{clip:i,color:o,opacity:a}=e,s=e.type;return e[t]||void 0===e[t]&&n[t]?[{...r,mark:{...n[t],...i?{clip:i}:{},...o?{color:o}:{},...a?{opacity:a}:{},...p8(r.mark)?r.mark:{type:r.mark},style:`${s}-${t}`,...Ey(e[t])?{}:e[t]}}]:[]}function i7(e,t,n){const{encoding:r}=e,i="vertical"===t?"y":"x",o=r[i],a=r[`${i}2`],s=r[`${i}Error`],u=r[`${i}Error2`];return{continuousAxisChannelDef:o7(o,n),continuousAxisChannelDef2:o7(a,n),continuousAxisChannelDefError:o7(s,n),continuousAxisChannelDefError2:o7(u,n),continuousAxis:i}}function o7(e,t){if(e&&e.aggregate){const{aggregate:n,...r}=e;return n!==t&&m5.warn(g5.errorBarContinuousAxisHasCustomizedAggregate(n,t)),r}return e}function a7(e,t){const{mark:n,encoding:r}=e,{x:i,y:o}=r;if(p8(n)&&n.orient)return n.orient;if(s9(i)){if(s9(o)){const e=i9(i)&&i.aggregate,n=i9(o)&&o.aggregate;if(e||n!==t){if(n||e!==t){if(e===t&&n===t)throw new Error("Both x and y cannot have aggregate");return $9(o)&&!$9(i)?"horizontal":"vertical"}return"horizontal"}return"vertical"}return"horizontal"}if(s9(o))return"vertical";throw new Error(`Need a valid continuous axis for ${t}s`)}const s7="boxplot",u7=new V9(s7,c7);function l7(e){return Cy(e)?"tukey":e}function c7(e,{config:t}){e={...e,encoding:J9(e.encoding,t)};const{mark:n,encoding:r,params:i,projection:o,...a}=e,s=p8(n)?n:{type:n};i&&m5.warn(g5.selectionNotSupported("boxplot"));const u=s.extent??t.boxplot.extent,l=s5("size",s,t),c=l7(u),{bins:f,timeUnits:d,transform:h,continuousAxisChannelDef:p,continuousAxis:m,groupby:g,aggregate:y,encodingWithoutContinuousAxis:v,ticksOrient:b,boxOrient:x,customTooltipWithoutAggregatedField:w}=function(e,t,n){const r=a7(e,s7),{continuousAxisChannelDef:i,continuousAxis:o}=i7(e,r,s7),a=i.field,s=l7(t),u=[...f7(a),{op:"median",field:a,as:`mid_box_${a}`},{op:"min",field:a,as:("min-max"===s?"lower_whisker_":"min_")+a},{op:"max",field:a,as:("min-max"===s?"upper_whisker_":"max_")+a}],l="min-max"===s||"tukey"===s?[]:[{calculate:`datum["upper_box_${a}"] - datum["lower_box_${a}"]`,as:`iqr_${a}`},{calculate:`min(datum["upper_box_${a}"] + datum["iqr_${a}"] * ${t}, datum["max_${a}"])`,as:`upper_whisker_${a}`},{calculate:`max(datum["lower_box_${a}"] - datum["iqr_${a}"] * ${t}, datum["min_${a}"])`,as:`lower_whisker_${a}`}],{[o]:c,...f}=e.encoding,{customTooltipWithoutAggregatedField:d,filteredEncoding:h}=function(e){const{tooltip:t,...n}=e;if(!t)return{filteredEncoding:n};let r,i;if($g(t)){for(const e of t)e.aggregate?(r||(r=[]),r.push(e)):(i||(i=[]),i.push(e));r&&(n.tooltip=r)}else t.aggregate?n.tooltip=t:i=t;return $g(i)&&1===i.length&&(i=i[0]),{customTooltipWithoutAggregatedField:i,filteredEncoding:n}}(f),{bins:p,timeUnits:m,aggregate:g,groupby:y,encoding:v}=X9(h,n),b="vertical"===r?"horizontal":"vertical",x=r,w=[...p,...m,{aggregate:[...g,...u],groupby:y},...l];return{bins:p,timeUnits:m,transform:w,groupby:y,aggregate:g,continuousAxisChannelDef:i,continuousAxis:o,encodingWithoutContinuousAxis:v,ticksOrient:b,boxOrient:x,customTooltipWithoutAggregatedField:d}}(e,u,t),{color:_,size:k,...E}=v,S=e=>n7(s,m,p,e,t.boxplot),A=S(E),C=S(v),D=S({...E,...k?{size:k}:{}}),M=e7([{fieldPrefix:"min-max"===c?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:"min-max"===c?"lower_whisker_":"min_",titlePrefix:"Min"}],p,v),F={type:"tick",color:"black",opacity:1,orient:b,invalid:null,aria:!1},N="min-max"===c?M:e7([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],p,v),O=[...A({partName:"rule",mark:{type:"rule",invalid:null,aria:!1},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:N}),...A({partName:"rule",mark:{type:"rule",invalid:null,aria:!1},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:N}),...A({partName:"ticks",mark:F,positionPrefix:"lower_whisker",extraEncoding:N}),...A({partName:"ticks",mark:F,positionPrefix:"upper_whisker",extraEncoding:N})],$=[..."tukey"!==c?O:[],...C({partName:"box",mark:{type:"bar",...l?{size:l}:{},orient:x,invalid:null,ariaRoleDescription:"box"},positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:M}),...D({partName:"median",mark:{type:"tick",invalid:null,...Tg(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{},...l?{size:l}:{},orient:b,aria:!1},positionPrefix:"mid_box",extraEncoding:M})];if("min-max"===c)return{...a,transform:(a.transform??[]).concat(h),layer:$};const T=`datum["lower_box_${p.field}"]`,z=`datum["upper_box_${p.field}"]`,R=`(${z} - ${T})`,P=`${T} - ${u} * ${R}`,L=`${z} + ${u} * ${R}`,B=`datum["${p.field}"]`,I={joinaggregate:f7(p.field),groupby:g},j={transform:[{filter:`(${P} <= ${B}) && (${B} <= ${L})`},{aggregate:[{op:"min",field:p.field,as:`lower_whisker_${p.field}`},{op:"max",field:p.field,as:`upper_whisker_${p.field}`},{op:"min",field:`lower_box_${p.field}`,as:`lower_box_${p.field}`},{op:"max",field:`upper_box_${p.field}`,as:`upper_box_${p.field}`},...y],groupby:g}],layer:O},{tooltip:U,...q}=E,{scale:W,axis:H}=p,V=t7(p),G=e1(H,["title"]),Y=r7(s,"outliers",t.boxplot,{transform:[{filter:`(${B} < ${P}) || (${B} > ${L})`}],mark:"point",encoding:{[m]:{field:p.field,type:p.type,...void 0!==V?{title:V}:{},...void 0!==W?{scale:W}:{},...m1(G)?{}:{axis:G}},...q,..._?{color:_}:{},...w?{tooltip:w}:{}}})[0];let X;const Q=[...f,...d,I];return Y?X={transform:Q,layer:[Y,j]}:(X=j,X.transform.unshift(...Q)),{...a,layer:[X,{transform:h,layer:$}]}}function f7(e){return[{op:"q1",field:e,as:`lower_box_${e}`},{op:"q3",field:e,as:`upper_box_${e}`}]}const d7="errorbar",h7=new V9(d7,p7);function p7(e,{config:t}){e={...e,encoding:J9(e.encoding,t)};const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:o,ticksOrient:a,markDef:s,outerSpec:u,tooltipEncoding:l}=g7(e,d7,t);delete o.size;const c=n7(s,i,r,o,t.errorbar),f=s.thickness,d=s.size,h={type:"tick",orient:a,aria:!1,...void 0!==f?{thickness:f}:{},...void 0!==d?{size:d}:{}},p=[...c({partName:"ticks",mark:h,positionPrefix:"lower",extraEncoding:l}),...c({partName:"ticks",mark:h,positionPrefix:"upper",extraEncoding:l}),...c({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar",...void 0!==f?{size:f}:{}},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l})];return{...u,transform:n,...p.length>1?{layer:p}:{...p[0]}}}function m7(e,t){const{encoding:n}=e;if(function(e){return(l9(e.x)||l9(e.y))&&!l9(e.x2)&&!l9(e.y2)&&!l9(e.xError)&&!l9(e.xError2)&&!l9(e.yError)&&!l9(e.yError2)}(n))return{orient:a7(e,t),inputType:"raw"};const r=function(e){return l9(e.x2)||l9(e.y2)}(n),i=function(e){return l9(e.xError)||l9(e.xError2)||l9(e.yError)||l9(e.yError2)}(n),o=n.x,a=n.y;if(r){if(i)throw new Error(`${t} cannot be both type aggregated-upper-lower and aggregated-error`);const e=n.x2,r=n.y2;if(l9(e)&&l9(r))throw new Error(`${t} cannot have both x2 and y2`);if(l9(e)){if(s9(o))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${t}`)}if(l9(r)){if(s9(a))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${t}`)}throw new Error("No ranged axis")}{const e=n.xError,r=n.xError2,i=n.yError,s=n.yError2;if(l9(r)&&!l9(e))throw new Error(`${t} cannot have xError2 without xError`);if(l9(s)&&!l9(i))throw new Error(`${t} cannot have yError2 without yError`);if(l9(e)&&l9(i))throw new Error(`${t} cannot have both xError and yError with both are quantiative`);if(l9(e)){if(s9(o))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}if(l9(i)){if(s9(a))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function g7(e,t,n){const{mark:r,encoding:i,params:o,projection:a,...s}=e,u=p8(r)?r:{type:r};o&&m5.warn(g5.selectionNotSupported(t));const{orient:l,inputType:c}=m7(e,t),{continuousAxisChannelDef:f,continuousAxisChannelDef2:d,continuousAxisChannelDefError:h,continuousAxisChannelDefError2:p,continuousAxis:m}=i7(e,l,t),{errorBarSpecificAggregate:g,postAggregateCalculates:y,tooltipSummary:v,tooltipTitleWithFieldName:b}=function(e,t,n,r,i,o,a,s){let u=[],l=[];const c=t.field;let f,d=!1;if("raw"===o){const t=e.center?e.center:e.extent?"iqr"===e.extent?"median":"mean":s.errorbar.center,n=e.extent?e.extent:"mean"===t?"stderr":"iqr";if("median"===t!=("iqr"===n)&&m5.warn(g5.errorBarCenterIsUsedWithWrongExtent(t,n,a)),"stderr"===n||"stdev"===n)u=[{op:n,field:c,as:`extent_${c}`},{op:t,field:c,as:`center_${c}`}],l=[{calculate:`datum["center_${c}"] + datum["extent_${c}"]`,as:`upper_${c}`},{calculate:`datum["center_${c}"] - datum["extent_${c}"]`,as:`lower_${c}`}],f=[{fieldPrefix:"center_",titlePrefix:k1(t)},{fieldPrefix:"upper_",titlePrefix:y7(t,n,"+")},{fieldPrefix:"lower_",titlePrefix:y7(t,n,"-")}],d=!0;else{let e,t,r;"ci"===n?(e="mean",t="ci0",r="ci1"):(e="median",t="q1",r="q3"),u=[{op:t,field:c,as:`lower_${c}`},{op:r,field:c,as:`upper_${c}`},{op:e,field:c,as:`center_${c}`}],f=[{fieldPrefix:"upper_",titlePrefix:_9({field:c,aggregate:r,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:_9({field:c,aggregate:t,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:_9({field:c,aggregate:e,type:"quantitative"},s,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&m5.warn(g5.errorBarCenterAndExtentAreNotNeeded(e.center,e.extent)),"aggregated-upper-lower"===o?(f=[],l=[{calculate:`datum["${n.field}"]`,as:`upper_${c}`},{calculate:`datum["${c}"]`,as:`lower_${c}`}]):"aggregated-error"===o&&(f=[{fieldPrefix:"",titlePrefix:c}],l=[{calculate:`datum["${c}"] + datum["${r.field}"]`,as:`upper_${c}`}],i?l.push({calculate:`datum["${c}"] + datum["${i.field}"]`,as:`lower_${c}`}):l.push({calculate:`datum["${c}"] - datum["${r.field}"]`,as:`lower_${c}`}));for(const e of l)f.push({fieldPrefix:e.as.substring(0,6),titlePrefix:D1(D1(e.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:l,errorBarSpecificAggregate:u,tooltipSummary:f,tooltipTitleWithFieldName:d}}(u,f,d,h,p,c,t,n),{[m]:x,["x"===m?"x2":"y2"]:w,["x"===m?"xError":"yError"]:_,["x"===m?"xError2":"yError2"]:k,...E}=i,{bins:S,timeUnits:A,aggregate:C,groupby:D,encoding:M}=X9(E,n),F=[...C,...g],N="raw"!==c?[]:D,O=e7(v,f,M,b);return{transform:[...s.transform??[],...S,...A,...0===F.length?[]:[{aggregate:F,groupby:N}],...y],groupby:N,continuousAxisChannelDef:f,continuousAxis:m,encodingWithoutContinuousAxis:M,ticksOrient:"vertical"===l?"horizontal":"vertical",markDef:u,outerSpec:s,tooltipEncoding:O}}function y7(e,t,n){return`${k1(e)} ${n} ${t}`}const v7="errorband",b7=new V9(v7,x7);function x7(e,{config:t}){e={...e,encoding:J9(e.encoding,t)};const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:o,markDef:a,outerSpec:s,tooltipEncoding:u}=g7(e,v7,t),l=a,c=n7(l,i,r,o,t.errorband),f=void 0!==e.encoding.x&&void 0!==e.encoding.y;let d={type:f?"area":"rect"},h={type:f?"line":"rule"};const p={...l.interpolate?{interpolate:l.interpolate}:{},...l.tension&&l.interpolate?{tension:l.tension}:{}};return f?(d={...d,...p,ariaRoleDescription:"errorband"},h={...h,...p,aria:!1}):l.interpolate?m5.warn(g5.errorBand1DNotSupport("interpolate")):l.tension&&m5.warn(g5.errorBand1DNotSupport("tension")),{...s,transform:n,layer:[...c({partName:"band",mark:d,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"lower",extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"upper",extraEncoding:u})]}}const w7={};function _7(e,t,n){const r=new V9(e,t);w7[e]={normalizer:r,parts:n}}_7(s7,c7,["box","median","outliers","rule","ticks"]),_7(d7,p7,["ticks","rule"]),_7(v7,x7,["band","borders"]);const k7=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],E7={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},S7={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},A7=g1(E7),C7=g1(S7),D7=g1({header:1,headerRow:1,headerColumn:1,headerFacet:1}),M7=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],F7={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},N7=(g1(F7),"_vgsid_"),O7={point:{on:"click",fields:[N7],toggle:"event.shiftKey",resolve:"global",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function $7(e){return!(!e||"legend"!==e&&!e.legend)}function T7(e){return $7(e)&&Tg(e)}function z7(e){return!!e.select}function R7(e){const t=[];for(const n of e||[]){if(z7(n))continue;const{expr:e,bind:r,...i}=n;if(r&&e){const n={...i,bind:r,init:e};t.push(n)}else{const n={...i,...e?{update:e}:{},...r?{bind:r}:{}};t.push(n)}}return t}function P7(e){return"concat"in e}function L7(e){return"vconcat"in e}function B7(e){return"hconcat"in e}function I7(e){return Tg(e)&&void 0!==e.step}function j7(e){return e.view||e.width||e.height}const U7=g1({align:1,bounds:1,center:1,columns:1,spacing:1});function q7(e,t){return e[t]??e["width"===t?"continuousWidth":"continuousHeight"]}function W7(e,t){const n=H7(e,t);return I7(n)?n.step:V7}function H7(e,t){return N1(e[t]??e["width"===t?"discreteWidth":"discreteHeight"],{step:e.step})}const V7=20,G7={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:{continuousWidth:200,continuousHeight:200,step:V7},mark:{color:"#4c78a8",invalid:"filter",timeUnitBandSize:1},arc:{},area:{},bar:x8,circle:{},geoshape:{},image:{},line:{},point:{},rect:w8,rule:{color:"black"},square:{},text:{color:"black"},tick:{thickness:1},trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:{pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4},projection:{},legend:{gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:O7,style:{},title:{},facet:{spacing:20},concat:{spacing:20}},Y7=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],X7={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},Q7={blue:Y7[0],orange:Y7[1],red:Y7[2],teal:Y7[3],green:Y7[4],yellow:Y7[5],purple:Y7[6],pink:Y7[7],brown:Y7[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function J7(e){const t=g1(e||{}),n={};for(const r of t){const t=e[r];n[r]=L9(t)?Z3(t):e5(t)}return n}const K7=[...y8,...W9,...D7,"background","padding","legend","lineBreak","scale","style","title","view"];function Z7(e={}){const{color:t,font:n,fontSize:r,...i}=e,o=Rg({},G7,n?function(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}(n):{},t?function(e={}){return{signals:[{name:"color",value:Tg(e)?{...Q7,...e}:Q7}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}(t):{},r?function(e){return{signals:[{name:"fontSize",value:Tg(e)?{...X7,...e}:X7}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}(r):{},i||{}),a=e1(o,K7);for(const e of["background","lineBreak","padding"])o[e]&&(a[e]=e5(o[e]));for(const e of y8)o[e]&&(a[e]=W3(o[e]));for(const e of W9)o[e]&&(a[e]=J7(o[e]));for(const e of D7)o[e]&&(a[e]=W3(o[e]));return o.legend&&(a.legend=W3(o.legend)),o.scale&&(a.scale=W3(o.scale)),o.style&&(a.style=function(e){const t=g1(e),n={};for(const r of t)n[r]=J7(e[r]);return n}(o.style)),o.title&&(a.title=W3(o.title)),o.view&&(a.view=W3(o.view)),a}const eee=["view",...h8],tee=["color","fontSize","background","padding","facet","concat","numberFormat","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],nee={view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"],area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]};function ree(e){e=K0(e);for(const t of tee)delete e[t];if(e.axis)for(const t in e.axis)L9(e.axis[t])&&delete e.axis[t];if(e.legend)for(const t of k7)delete e.legend[t];if(e.mark){for(const t of g8)delete e.mark[t];e.mark.tooltip&&Tg(e.mark.tooltip)&&delete e.mark.tooltip}e.params&&(e.signals=(e.signals||[]).concat(R7(e.params)),delete e.params);for(const t of eee){for(const n of g8)delete e[t][n];const n=nee[t];if(n)for(const r of n)delete e[t][r];iee(e,t)}for(const t of g1(w7))delete e[t];!function(e){const{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:r}=H3(e.title);m1(t)||(e.style["group-title"]={...e.style["group-title"],...t});m1(n)||(e.style["group-subtitle"]={...e.style["group-subtitle"],...n});m1(r)?delete e.title:e.title=r}(e);for(const t in e)Tg(e[t])&&m1(e[t])&&delete e[t];return m1(e)?void 0:e}function iee(e,t,n,r){"view"===t&&(n="cell");const i={...r?e[t][r]:e[t],...e.style[n??t]};m1(i)||(e.style[n??t]=i),r||delete e[t]}function oee(e){return"layer"in e}class aee{map(e,t){return X8(e)?this.mapFacet(e,t):function(e){return"repeat"in e}(e)?this.mapRepeat(e,t):B7(e)?this.mapHConcat(e,t):L7(e)?this.mapVConcat(e,t):P7(e)?this.mapConcat(e,t):this.mapLayerOrUnit(e,t)}mapLayerOrUnit(e,t){if(oee(e))return this.mapLayer(e,t);if(H9(e))return this.mapUnit(e,t);throw new Error(g5.invalidSpec(e))}mapLayer(e,t){return{...e,layer:e.layer.map((e=>this.mapLayerOrUnit(e,t)))}}mapHConcat(e,t){return{...e,hconcat:e.hconcat.map((e=>this.map(e,t)))}}mapVConcat(e,t){return{...e,vconcat:e.vconcat.map((e=>this.map(e,t)))}}mapConcat(e,t){const{concat:n,...r}=e;return{...r,concat:n.map((e=>this.map(e,t)))}}mapFacet(e,t){return{...e,spec:this.map(e.spec,t)}}mapRepeat(e,t){return{...e,spec:this.map(e.spec,t)}}}const see={zero:1,center:1,normalize:1};const uee=new Set([J4,Z4,K4,i8,n8,u8,l8,t8,o8,a8]),lee=new Set([Z4,K4,J4]);function cee(e,t){const n="x"===t?"y":"radius",r=e[t],i=e[n];if(i9(r)&&i9(i))if("quantitative"===o9(r)&&"quantitative"===o9(i)){if(r.stack)return t;if(i.stack)return n;const e=i9(r)&&!!r.aggregate;if(e!==(i9(i)&&!!i.aggregate))return e?t:n;{const e=r.scale?.type,o=i.scale?.type;if(e&&"linear"!==e)return n;if(o&&"linear"!==o)return t}}else{if("quantitative"===o9(r))return t;if("quantitative"===o9(i))return n}else{if("quantitative"===o9(r))return t;if("quantitative"===o9(i))return n}}function fee(e,t,n={}){const r=p8(e)?e.type:e;if(!uee.has(r))return null;const i=cee(t,"x")||cee(t,"theta");if(!i)return null;const o=t[i],a=i9(o)?y9(o,{}):void 0;let s=function(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}(i),u=t[s],l=i9(u)?y9(u,{}):void 0;l===a&&(l=void 0,u=void 0,s=void 0);const c=r3.reduce(((e,n)=>{if("tooltip"!==n&&G9(t,n)){const r=t[n];for(const t of iy(r)){const r=A9(t);if(r.aggregate)continue;const i=y9(r,{});i&&i===l||e.push({channel:n,fieldDef:r})}}return e}),[]);let f;if(void 0!==o.stack?f=Ey(o.stack)?o.stack?"zero":null:o.stack:lee.has(r)&&(f="zero"),!f||!(f in see))return null;if(Y9(t)&&0===c.length)return null;if(o?.scale?.type&&o?.scale?.type!==d4){if(n.disallowNonLinearStack)return null;m5.warn(g5.cannotStackNonLinearScale(o.scale.type))}return l9(t[U2(i)])?(void 0!==o.stack&&m5.warn(g5.cannotStackRangedMark(i)),null):(i9(o)&&o.aggregate&&!i1(z3,o.aggregate)&&m5.warn(g5.stackNonSummativeAggregate(o.aggregate)),{groupbyChannel:u?s:void 0,groupbyField:l,fieldChannel:i,impute:null!==o.impute&&f8(r),stackBy:c,offset:f})}function dee(e){const{point:t,line:n,...r}=e;return g1(r).length>1?r:r.type}function hee(e){for(const t of["line","area","rule","trail"])e[t]&&(e={...e,[t]:e1(e[t],["point","line"])});return e}function pee(e,t={},n){return"transparent"===e.point?{opacity:0}:e.point?Tg(e.point)?e.point:{}:void 0!==e.point?null:t.point||n.shape?Tg(t.point)?t.point:{}:void 0}function mee(e,t={}){return e.line?!0===e.line?{}:e.line:void 0!==e.line?null:t.line?!0===t.line?{}:t.line:void 0}class gee{constructor(){this.name="path-overlay"}hasMatchingType(e,t){if(H9(e)){const{mark:n,encoding:r}=e,i=p8(n)?n:{type:n};switch(i.type){case"line":case"rule":case"trail":return!!pee(i,t[i.type],r);case"area":return!!pee(i,t[i.type],r)||!!mee(i,t[i.type])}}return!1}run(e,t,n){const{config:r}=t,{params:i,projection:o,mark:a,encoding:s,...u}=e,l=J9(s,r),c=p8(a)?a:{type:a},f=pee(c,r[c.type],l),d="area"===c.type&&mee(c,r[c.type]),h=[{...i?{params:i}:{},mark:dee({..."area"===c.type&&void 0===c.opacity&&void 0===c.fillOpacity?{opacity:.7}:{},...c}),encoding:e1(l,["shape"])}],p=fee(c,l);let m=l;if(p){const{fieldChannel:e,offset:t}=p;m={...l,[e]:{...l[e],...t?{stack:t}:{}}}}return d&&h.push({...o?{projection:o}:{},mark:{type:"line",...Z0(c,["clip","interpolate","tension","tooltip"]),...d},encoding:m}),f&&h.push({...o?{projection:o}:{},mark:{type:"point",opacity:1,filled:!0,...Z0(c,["clip","tooltip"]),...f},encoding:m}),n({...u,layer:h},{...t,config:hee(r)})}}function yee(e,t){return t?G8(e)?kee(e,t):xee(e,t):e}function vee(e,t){return t?kee(e,t):e}function bee(e,t,n){const r=t[e];return(i=r)&&!My(i)&&"repeat"in i?r.repeat in n?{...t,[e]:n[r.repeat]}:void m5.warn(g5.noSuchRepeatedValue(r.repeat)):t;var i}function xee(e,t){if(void 0!==(e=bee("field",e,t))){if(null===e)return null;if(J8(e)&&H8(e.sort)){const n=bee("field",e.sort,t);e={...e,...n?{sort:n}:{}}}return e}}function wee(e,t){if(i9(e))return xee(e,t);{const n=bee("datum",e,t);return n===e||n.type||(n.type="nominal"),n}}function _ee(e,t){if(!l9(e)){if(r9(e)){const n=wee(e.condition,t);if(n)return{...e,condition:n};{const{condition:t,...n}=e;return n}}return e}{const n=wee(e,t);if(n)return n;if(t9(e))return{condition:e.condition}}}function kee(e,t){const n={};for(const r in e)if(vy(e,r)){const i=e[r];if($g(i))n[r]=i.map((e=>_ee(e,t))).filter((e=>e));else{const e=_ee(i,t);void 0!==e&&(n[r]=e)}}return n}class Eee{constructor(){this.name="RuleForRangedLine"}hasMatchingType(e){if(H9(e)){const{encoding:t,mark:n}=e;if("line"===n||p8(n)&&"line"===n.type)for(const e of L2){const n=t[I2(e)];if(t[e]&&(i9(n)&&!B3(n.bin)||a9(n)))return!0}}return!1}run(e,t,n){const{encoding:r,mark:i}=e;return m5.warn(g5.lineWithRange(!!r.x2,!!r.y2)),console.log(i),n({...e,mark:Tg(i)?{...i,type:"rule"}:"rule"},t)}}function See({parentEncoding:e,encoding:t={},layer:n}){let r={};if(e){const i=new Set([...g1(e),...g1(t)]);for(const o of i){const i=t[o],a=e[o];if(l9(i)){const e={...a,...i};r[o]=e}else r9(i)?r[o]={...i,condition:{...a,...i.condition}}:i||null===i?r[o]=i:(n||f9(a)||G3(a)||l9(a)||$g(a))&&(r[o]=a)}}else r=t;return!r||m1(r)?void 0:r}function Aee(e){const{parentProjection:t,projection:n}=e;return t&&n&&m5.warn(g5.projectionOverridden({parentProjection:t,projection:n})),n??t}function Cee(e){return"filter"in e}function Dee(e){return"lookup"in e}function Mee(e){return"pivot"in e}function Fee(e){return"density"in e}function Nee(e){return"quantile"in e}function Oee(e){return"regression"in e}function $ee(e){return"loess"in e}function Tee(e){return"sample"in e}function zee(e){return"window"in e}function Ree(e){return"joinaggregate"in e}function Pee(e){return"flatten"in e}function Lee(e){return"calculate"in e}function Bee(e){return"bin"in e}function Iee(e){return"impute"in e}function jee(e){return"timeUnit"in e}function Uee(e){return"aggregate"in e}function qee(e){return"stack"in e}function Wee(e){return"fold"in e}function Hee(e,t){const{transform:n,...r}=e;if(n){return{...r,transform:n.map((e=>{if(Cee(e))return{filter:Yee(e,t)};if(Bee(e)&&I3(e.bin))return{...e,bin:Gee(e.bin)};if(Dee(e)){const{selection:t,...n}=e.from;return t?{...e,from:{param:t,...n}}:e}return e}))}}return e}function Vee(e,t){const n=K0(e);if(i9(n)&&I3(n.bin)&&(n.bin=Gee(n.bin)),d9(n)&&n.scale?.domain?.selection){const{selection:e,...t}=n.scale.domain;n.scale.domain={...t,...e?{param:e}:{}}}if(t9(n))if($g(n.condition))n.condition=n.condition.map((e=>{const{selection:n,param:r,test:i,...o}=e;return r?e:{...o,test:Yee(e,t)}}));else{const{selection:e,param:r,test:i,...o}=Vee(n.condition,t);n.condition=r?n.condition:{...o,test:Yee(n.condition,t)}}return n}function Gee(e){const t=e.extent;if(t?.selection){const{selection:n,...r}=t;return{...e,extent:{...r,param:n}}}return e}function Yee(e,t){const n=e=>Q0(e,(e=>{var n;const r={param:e,empty:t.emptySelections[e]??!0};return(n=t.selectionPredicates)[e]??(n[e]=[]),t.selectionPredicates[e].push(r),r}));return e.selection?n(e.selection):Q0(e.test||e.filter,(e=>e.selection?n(e.selection):e))}class Xee extends aee{map(e,t){const n=t.selections??[];if(e.params&&!H9(e)){const t=[];for(const r of e.params)z7(r)?n.push(r):t.push(r);e.params=t}return t.selections=n,super.map(e,Qee(e,t))}mapUnit(e,t){const n=t.selections;if(!n||!n.length)return e;const r=(t.path??[]).concat(e.name),i=[];for(const t of n)if(t.views&&t.views.length)for(const n of t.views)(My(n)&&(n===e.name||r.indexOf(n)>=0)||$g(n)&&n.map((e=>r.indexOf(e))).every(((e,t,n)=>-1!==e&&(0===t||e>n[t-1]))))&&i.push(t);else i.push(t);return i.length&&(e.params=i),e}}for(const e of["mapFacet","mapRepeat","mapHConcat","mapVConcat","mapLayer"]){const t=Xee.prototype[e];Xee.prototype[e]=function(e,n){return t.call(this,e,Qee(e,n))}}function Qee(e,t){return e.name?{...t,path:(t.path??[]).concat(e.name)}:t}function Jee(e,t){void 0===t&&(t=Z7(e.config));const n=function(e,t={}){const n={config:t};return ete.map(Kee.map(Zee.map(e,n),n),n)}(e,t),{width:r,height:i}=e,o=function(e,t,n){let{width:r,height:i}=t;const o=H9(e)||oee(e),a={};o?"container"==r&&"container"==i?(a.type="fit",a.contains="padding"):"container"==r?(a.type="fit-x",a.contains="padding"):"container"==i&&(a.type="fit-y",a.contains="padding"):("container"==r&&(m5.warn(g5.containerSizeNonSingle("width")),r=void 0),"container"==i&&(m5.warn(g5.containerSizeNonSingle("height")),i=void 0));const s={type:"pad",...a,...n?tte(n.autosize):{},...tte(e.autosize)};"fit"!==s.type||o||(m5.warn(g5.FIT_NON_SINGLE),s.type="pad");"container"==r&&"fit"!=s.type&&"fit-x"!=s.type&&m5.warn(g5.containerSizeNotCompatibleWithAutosize("width"));"container"==i&&"fit"!=s.type&&"fit-y"!=s.type&&m5.warn(g5.containerSizeNotCompatibleWithAutosize("height"));if(J0(s,{type:"pad"}))return;return s}(n,{width:r,height:i,autosize:e.autosize},t);return{...n,...o?{autosize:o}:{}}}const Kee=new class extends aee{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[u7,h7,b7,new gee,new Eee]}map(e,t){if(H9(e)){const n=G9(e.encoding,B1),r=G9(e.encoding,I1),i=G9(e.encoding,j1);if(n||r||i)return this.mapFacetedUnit(e,t)}return super.map(e,t)}mapUnit(e,t){const{parentEncoding:n,parentProjection:r}=t,i=vee(e.encoding,t.repeater),o={...e,...i?{encoding:i}:{}};if(n||r)return this.mapUnitWithParentEncodingOrProjection(o,t);const a=this.mapLayerOrUnit.bind(this);for(const e of this.nonFacetUnitNormalizers)if(e.hasMatchingType(o,t.config))return e.run(o,t,a);return o}mapRepeat(e,t){return function(e){return!$g(e.repeat)&&e.repeat.layer}(e)?this.mapLayerRepeat(e,t):this.mapNonLayerRepeat(e,t)}mapLayerRepeat(e,t){const{repeat:n,spec:r,...i}=e,{row:o,column:a,layer:s}=n,{repeater:u={},repeaterPrefix:l=""}=t;return o||a?this.mapRepeat({...e,repeat:{...o?{row:o}:{},...a?{column:a}:{}},spec:{repeat:{layer:s},spec:r}},t):{...i,layer:s.map((e=>{const n={...u,layer:e},i=`${(r.name||"")+l}child__layer_${x1(e)}`,o=this.mapLayerOrUnit(r,{...t,repeater:n,repeaterPrefix:i});return o.name=i,o}))}}mapNonLayerRepeat(e,t){const{repeat:n,spec:r,data:i,...o}=e;!$g(n)&&e.columns&&(e=e1(e,["columns"]),m5.warn(g5.columnsNotSupportByRowCol("repeat")));const a=[],{repeater:s={},repeaterPrefix:u=""}=t,l=!$g(n)&&n.row||[s?s.row:null],c=!$g(n)&&n.column||[s?s.column:null],f=$g(n)&&n||[s?s.repeat:null];for(const e of f)for(const i of l)for(const o of c){const l={repeat:e,row:i,column:o,layer:s.layer},c=(r.name||"")+u+"child__"+($g(n)?`${x1(e)}`:(n.row?`row_${x1(i)}`:"")+(n.column?`column_${x1(o)}`:"")),f=this.map(r,{...t,repeater:l,repeaterPrefix:c});f.name=c,a.push(e1(f,["data"]))}const d=$g(n)?e.columns:n.column?n.column.length:1;return{data:r.data??i,align:"all",...o,columns:d,concat:a}}mapFacet(e,t){const{facet:n}=e;return G8(n)&&e.columns&&(e=e1(e,["columns"]),m5.warn(g5.columnsNotSupportByRowCol("facet"))),super.mapFacet(e,t)}mapUnitWithParentEncodingOrProjection(e,t){const{encoding:n,projection:r}=e,{parentEncoding:i,parentProjection:o,config:a}=t,s=Aee({parentProjection:o,projection:r}),u=See({parentEncoding:i,encoding:vee(n,t.repeater)});return this.mapUnit({...e,...s?{projection:s}:{},...u?{encoding:u}:{}},{config:a})}mapFacetedUnit(e,t){const{row:n,column:r,facet:i,...o}=e.encoding,{mark:a,width:s,projection:u,height:l,view:c,params:f,encoding:d,...h}=e,{facetMapping:p,layout:m}=this.getFacetMappingAndLayout({row:n,column:r,facet:i},t),g=vee(o,t.repeater);return this.mapFacet({...h,...m,facet:p,spec:{...s?{width:s}:{},...l?{height:l}:{},...c?{view:c}:{},...u?{projection:u}:{},mark:a,encoding:g,...f?{params:f}:{}}},t)}getFacetMappingAndLayout(e,t){const{row:n,column:r,facet:i}=e;if(n||r){i&&m5.warn(g5.facetChannelDropped([...n?[B1]:[],...r?[I1]:[]]));const t={},o={};for(const n of[B1,I1]){const r=e[n];if(r){const{align:e,center:i,spacing:a,columns:s,...u}=r;t[n]=u;for(const e of["align","center","spacing"])void 0!==r[e]&&(o[e]??(o[e]={}),o[e][n]=r[e])}}return{facetMapping:t,layout:o}}{const{align:e,center:n,spacing:r,columns:o,...a}=i;return{facetMapping:yee(a,t.repeater),layout:{...e?{align:e}:{},...n?{center:n}:{},...r?{spacing:r}:{},...o?{columns:o}:{}}}}}mapLayer(e,{parentEncoding:t,parentProjection:n,...r}){const{encoding:i,projection:o,...a}=e,s={...r,parentEncoding:See({parentEncoding:t,encoding:i,layer:!0}),parentProjection:Aee({parentProjection:n,projection:o})};return super.mapLayer(a,s)}},Zee=new class extends aee{map(e,t){return t.emptySelections??(t.emptySelections={}),t.selectionPredicates??(t.selectionPredicates={}),e=Hee(e,t),super.map(e,t)}mapLayerOrUnit(e,t){if((e=Hee(e,t)).encoding){const n={};for(const[r,i]of v1(e.encoding))n[r]=Vee(i,t);e={...e,encoding:n}}return super.mapLayerOrUnit(e,t)}mapUnit(e,t){const{selection:n,...r}=e;return n?{...r,params:v1(n).map((([e,n])=>{const{init:r,bind:i,empty:o,...a}=n;"single"===a.type?(a.type="point",a.toggle=!1):"multi"===a.type&&(a.type="point"),t.emptySelections[e]="none"!==o;for(const n of y1(t.selectionPredicates[e]??{}))n.empty="none"!==o;return{name:e,value:r,select:a,bind:i}}))}:e}},ete=new Xee;function tte(e){return My(e)?{type:e}:e??{}}const nte=["background","padding"];function rte(e,t){const n={};for(const t of nte)e&&void 0!==e[t]&&(n[t]=e5(e[t]));return t&&(n.params=e.params),n}class ite{constructor(e={},t={}){this.explicit=e,this.implicit=t}clone(){return new ite(K0(this.explicit),K0(this.implicit))}combine(){return{...this.explicit,...this.implicit}}get(e){return N1(this.explicit[e],this.implicit[e])}getWithExplicit(e){return void 0!==this.explicit[e]?{explicit:!0,value:this.explicit[e]}:void 0!==this.implicit[e]?{explicit:!1,value:this.implicit[e]}:{explicit:!1,value:void 0}}setWithExplicit(e,{value:t,explicit:n}){void 0!==t&&this.set(e,t,n)}set(e,t,n){return delete this[n?"implicit":"explicit"][e],this[n?"explicit":"implicit"][e]=t,this}copyKeyFromSplit(e,{explicit:t,implicit:n}){void 0!==t[e]?this.set(e,t[e],!0):void 0!==n[e]&&this.set(e,n[e],!1)}copyKeyFromObject(e,t){void 0!==t[e]&&this.set(e,t[e],!0)}copyAll(e){for(const t of g1(e.combine())){const n=e.getWithExplicit(t);this.setWithExplicit(t,n)}}}function ote(e){return{explicit:!0,value:e}}function ate(e){return{explicit:!1,value:e}}function ste(e){return(t,n,r,i)=>{const o=e(t.value,n.value);return o>0?t:o<0?n:ute(t,n,r,i)}}function ute(e,t,n,r){return e.explicit&&t.explicit&&m5.warn(g5.mergeConflictingProperty(n,r,e.value,t.value)),e}function lte(e,t,n,r,i=ute){return void 0===e||void 0===e.value?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:J0(e.value,t.value)?e:i(e,t,n,r)}class cte extends ite{constructor(e={},t={},n=!1){super(e,t),this.explicit=e,this.implicit=t,this.parseNothing=n}clone(){const e=super.clone();return e.parseNothing=this.parseNothing,e}}function fte(e){return"url"in e}function dte(e){return"values"in e}function hte(e){return"name"in e&&!fte(e)&&!dte(e)&&!pte(e)}function pte(e){return e&&(mte(e)||gte(e)||yte(e))}function mte(e){return"sequence"in e}function gte(e){return"sphere"in e}function yte(e){return"graticule"in e}var vte,bte;function xte(e,t=!0,n=Ag){if($g(e)){const r=e.map((e=>xte(e,t,n)));return t?`[${r.join(", ")}]`:r}return O6(e)?n(t?L6(e):function(e){const t=P6(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}(e)):t?n(t1(e)):e}function wte(e,t){for(const n of y1(e.component.selection??{})){const r=n.name;let i=`${r}${One}, ${"global"===n.resolve?"true":`{unit: ${Rne(e)}}`}`;for(const r of zne)r.defined(n)&&(r.signals&&(t=r.signals(e,n,t)),r.modifyExpr&&(i=r.modifyExpr(e,n,i)));t.push({name:r+$ne,on:[{events:{signal:n.name+One},update:`modify(${Py(n.name+Nne)}, ${i})`}]})}return Ete(t)}function _te(e,t){if(e.component.selection&&g1(e.component.selection).length){const n=Py(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:BQ("mousemove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return Ete(t)}function kte(e,t){for(const n of y1(e.component.selection??{}))for(const r of zne)r.defined(n)&&r.marks&&(t=r.marks(e,n,t));return t}function Ete(e){return e.map((e=>(e.on&&!e.on.length&&delete e.on,e)))}(bte=vte||(vte={}))[bte.Raw=0]="Raw",bte[bte.Main=1]="Main",bte[bte.Row=2]="Row",bte[bte.Column=3]="Column",bte[bte.Lookup=4]="Lookup";class Ste{constructor(e,t){this.debugName=t,this._children=[],this._parent=null,e&&(this.parent=e)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(e){this._parent=e,e&&e.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(e,t){this._children.includes(e)?m5.warn(g5.ADD_SAME_CHILD_TWICE):void 0!==t?this._children.splice(t,0,e):this._children.push(e)}removeChild(e){const t=this._children.indexOf(e);return this._children.splice(t,1),t}remove(){let e=this._parent.removeChild(this);for(const t of this._children)t._parent=this._parent,this._parent.addChild(t,e++)}insertAsParentOf(e){const t=e.parent;t.removeChild(this),this.parent=t,e.parent=this}swapWithParent(){const e=this._parent,t=e.parent;for(const t of this._children)t.parent=e;this._children=[],e.removeChild(this),e.parent.removeChild(e),this.parent=t,e.parent=this}}class Ate extends Ste{constructor(e,t,n,r){super(e,t),this.type=n,this.refCounts=r,this._source=this._name=t,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}clone(){const e=new this.constructor;return e.debugName=`clone_${this.debugName}`,e._source=this._source,e._name=`clone_${this._name}`,e.type=this.type,e.refCounts=this.refCounts,e.refCounts[e._name]=0,e}dependentFields(){return new Set}producedFields(){return new Set}hash(){return void 0===this._hash&&(this._hash=`Output ${$1()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(e){this._source=e}}class Cte extends Ste{constructor(e,t){super(e),this.formula=t}clone(){return new Cte(null,K0(this.formula))}static makeFromEncoding(e,t){const n=t.reduceFieldDef(((e,t)=>{const{field:n,timeUnit:r}=t;if(r){const i=y9(t,{forAs:!0});e[n1({as:i,field:n,timeUnit:r})]={as:i,field:n,timeUnit:r}}return e}),{});return m1(n)?null:new Cte(e,n)}static makeFromTransform(e,t){const{timeUnit:n,...r}={...t},i={...r,timeUnit:G6(n)};return new Cte(e,{[n1(i)]:i})}merge(e){this.formula={...this.formula};for(const t in e.formula)this.formula[t]||(this.formula[t]=e.formula[t]);for(const t of e.children)e.removeChild(t),t.parent=this;e.remove()}removeFormulas(e){const t={};for(const[n,r]of v1(this.formula))e.has(r.as)||(t[n]=r);this.formula=t}producedFields(){return new Set(y1(this.formula).map((e=>e.as)))}dependentFields(){return new Set(y1(this.formula).map((e=>e.field)))}hash(){return`TimeUnit ${n1(this.formula)}`}assemble(){const e=[];for(const t of y1(this.formula)){const{field:n,as:r,timeUnit:i}=t,{unit:o,utc:a,...s}=G6(i);e.push({field:C1(n),type:"timeunit",...o?{units:q6(o)}:{},...a?{timezone:"utc"}:{},...s,as:[r,`${r}_end`]})}return e}}const Dte="_tuple_fields";class Mte{constructor(...e){this.items=e,this.hasChannel={},this.hasField={}}}const Fte={defined:()=>!0,parse:(e,t,n)=>{const r=t.name,i=t.project??(t.project=new Mte),o={},a={},s=new Set,u=(e,t)=>{const n="visual"===t?e.channel:e.field;let i=x1(`${r}_${n}`);for(let e=1;s.has(i);e++)i=x1(`${r}_${n}_${e}`);return s.add(i),{[t]:i}},l=t.type,c=e.config.selection[l],f=void 0!==n.value?iy(n.value):null;let{fields:d,encodings:h}=Tg(n.select)?n.select:{};if(!d&&!h&&f)for(const e of f)if(Tg(e))for(const t of g1(e))R2[t]?(h||(h=[])).push(t):"interval"===l?(m5.warn(g5.INTERVAL_INITIALIZED_WITH_X_Y),h=c.encodings):(d||(d=[])).push(t);d||h||(h=c.encodings,d=c.fields);for(const t of h??[]){const n=e.fieldDef(t);if(n){let r=n.field;if(n.aggregate){m5.warn(g5.cannotProjectAggregate(t,n.aggregate));continue}if(!r){m5.warn(g5.cannotProjectOnChannelWithoutField(t));continue}if(n.timeUnit){r=e.vgField(t);const i={timeUnit:n.timeUnit,as:r,field:n.field};a[n1(i)]=i}if(!o[r]){let a="E";if("interval"===l){z4(e.getScaleComponent(t).get("type"))&&(a="R")}else n.bin&&(a="R-RE");const s={field:r,channel:t,type:a};s.signals={...u(s,"data"),...u(s,"visual")},i.items.push(o[r]=s),i.hasField[r]=i.hasChannel[t]=o[r]}}else m5.warn(g5.cannotProjectOnChannelWithoutField(t))}for(const e of d??[]){if(i.hasField[e])continue;const t={type:"E",field:e};t.signals={...u(t,"data")},i.items.push(t),i.hasField[e]=t}f&&(t.init=f.map((e=>i.items.map((t=>Tg(e)?void 0!==e[t.channel]?e[t.channel]:e[t.field]:e))))),m1(a)||(i.timeUnit=new Cte(null,a))},signals:(e,t,n)=>{const r=t.name+Dte;return n.filter((e=>e.name===r)).length>0?n:n.concat({name:r,value:t.project.items.map((e=>{const{signals:t,hasLegend:n,...r}=e;return r.field=C1(r.field),r}))})}},Nte={defined:e=>"interval"===e.type&&"global"===e.resolve&&e.bind&&"scales"===e.bind,parse:(e,t)=>{const n=t.scales=[];for(const r of t.project.items){const i=r.channel;if(!_3(i))continue;const o=e.getScaleComponent(i),a=o?o.get("type"):void 0;o&&z4(a)?(o.set("selectionExtent",{param:t.name,field:r.field},!0),n.push(r)):m5.warn(g5.SCALE_BINDINGS_CONTINUOUS)}},topLevelSignals:(e,t,n)=>{const r=t.scales.filter((e=>0===n.filter((t=>t.name===e.signals.data)).length));if(!e.parent||$te(e)||0===r.length)return n;const i=n.filter((e=>e.name===t.name))[0];let o=i.update;if(o.indexOf(Tne)>=0)i.update=`{${r.map((e=>`${Py(C1(e.field))}: ${e.signals.data}`)).join(", ")}}`;else{for(const e of r){const t=`${Py(C1(e.field))}: ${e.signals.data}`;o.includes(t)||(o=`${o.substring(0,o.length-1)}, ${t}}`)}i.update=o}return n.concat(r.map((e=>({name:e.signals.data}))))},signals:(e,t,n)=>{if(e.parent&&!$te(e))for(const e of t.scales){const t=n.filter((t=>t.name===e.signals.data))[0];t.push="outer",delete t.value,delete t.update}return n}};function Ote(e,t){return`domain(${Py(e.scaleName(t))})`}function $te(e){return(e.parent&&woe(e.parent)&&!e.parent.parent)??$te(e.parent.parent)}const Tte="_brush",zte="_scale_trigger",Rte={defined:e=>"interval"===e.type,signals:(e,t,n)=>{const r=t.name,i=r+Dte,o=Nte.defined(t),a=t.init?t.init[0]:null,s=[],u=[];if(t.translate&&!o){const e=`!event.item || event.item.mark.name !== ${Py(r+Tte)}`;Pte(t,((t,n)=>{var r;const i=iy((r=n.between[0]).filter??(r.filter=[]));return i.includes(e)||i.push(e),t}))}t.project.items.forEach(((r,i)=>{const o=r.channel;if(o!==U1&&o!==q1)return void m5.warn("Interval selections only support x and y encoding channels.");const l=a?a[i]:null,c=function(e,t,n,r){const i=n.channel,o=n.signals.visual,a=n.signals.data,s=Nte.defined(t),u=Py(e.scaleName(i)),l=e.getScaleComponent(i),c=l?l.get("type"):void 0,f=e=>`scale(${u}, ${e})`,d=e.getSizeSignalRef(i===U1?"width":"height").signal,h=`${i}(unit)`,p=Pte(t,((e,t)=>[...e,{events:t.between[0],update:`[${h}, ${h}]`},{events:t,update:`[${o}[0], clamp(${h}, 0, ${d})]`}]));return p.push({events:{signal:t.name+zte},update:z4(c)?`[${f(`${a}[0]`)}, ${f(`${a}[1]`)}]`:"[0, 0]"}),s?[{name:a,on:[]}]:[{name:o,...r?{init:xte(r,!0,f)}:{value:[]},on:p},{name:a,...r?{init:xte(r)}:{},on:[{events:{signal:o},update:`${o}[0] === ${o}[1] ? null : invert(${u}, ${o})`}]}]}(e,t,r,l),f=r.signals.data,d=r.signals.visual,h=Py(e.scaleName(o)),p=z4(e.getScaleComponent(o).get("type"))?"+":"";n.push(...c),s.push(f),u.push({scaleName:e.scaleName(o),expr:`(!isArray(${f}) || (${p}invert(${h}, ${d})[0] === ${p}${f}[0] && ${p}invert(${h}, ${d})[1] === ${p}${f}[1]))`})})),o||n.push({name:r+zte,value:{},on:[{events:u.map((e=>({scale:e.scaleName}))),update:`${u.map((e=>e.expr)).join(" && ")} ? ${r+zte} : {}`}]});const l=`unit: ${Rne(e)}, fields: ${i}, values`;return n.concat({name:r+One,...a?{init:`{${l}: ${xte(a)}}`}:{},on:[{events:[{signal:s.join(" || ")}],update:`${s.join(" && ")} ? {${l}: [${s}]} : null`}]})},marks:(e,t,n)=>{const r=t.name,{x:i,y:o}=t.project.hasChannel,a=i&&i.signals.visual,s=o&&o.signals.visual,u=`data(${Py(t.name+Nne)})`;if(Nte.defined(t))return n;const l={x:void 0!==i?{signal:`${a}[0]`}:{value:0},y:void 0!==o?{signal:`${s}[0]`}:{value:0},x2:void 0!==i?{signal:`${a}[1]`}:{field:{group:"width"}},y2:void 0!==o?{signal:`${s}[1]`}:{field:{group:"height"}}};if("global"===t.resolve)for(const t of g1(l))l[t]=[{test:`${u}.length && ${u}[0].unit === ${Rne(e)}`,...l[t]},{value:0}];const{fill:c,fillOpacity:f,cursor:d,...h}=t.mark,p=g1(h).reduce(((e,t)=>(e[t]=[{test:[void 0!==i&&`${a}[0] !== ${a}[1]`,void 0!==o&&`${s}[0] !== ${s}[1]`].filter((e=>e)).join(" && "),value:h[t]},{value:null}],e)),{});return[{name:`${r+Tte}_bg`,type:"rect",clip:!0,encode:{enter:{fill:{value:c},fillOpacity:{value:f}},update:l}},...n,{name:r+Tte,type:"rect",clip:!0,encode:{enter:{...d?{cursor:{value:d}}:{},fill:{value:"transparent"}},update:{...l,...p}}}]}};function Pte(e,t){return e.events.reduce(((e,n)=>n.between?t(e,n):(m5.warn(`${n} is not an ordered event stream for interval selections.`),e)),[])}const Lte={defined:e=>"point"===e.type,signals:(e,t,n)=>{const r=t.name,i=r+Dte,o=t.project,a="(item().isVoronoi ? datum.datum : datum)",s=o.items.map((t=>{const n=e.fieldDef(t.channel);return n&&n.bin?`[${a}[${Py(e.vgField(t.channel,{}))}], ${a}[${Py(e.vgField(t.channel,{binSuffix:"end"}))}]]`:`${a}[${Py(t.field)}]`})).join(", "),u=`unit: ${Rne(e)}, fields: ${i}, values`,l=t.events;return n.concat([{name:r+One,on:l?[{events:l,update:`datum && item().mark.marktype !== 'group' ? {${u}: [${s}]} : null`,force:!0}]:[]}])}};function Bte(e,t,n,r){const i=t9(t)&&t.condition,o=r(t);if(i){return{[n]:[...iy(i).map((t=>{const n=r(t);if(function(e){return e.param}(t)){const{param:r,empty:i}=t;return{test:qne(e,{param:r,empty:i}),...n}}return{test:Hne(e,t.test),...n}})),...void 0!==o?[o]:[]]}}return void 0!==o?{[n]:o}:{}}function Ite(e,t="text"){const n=e.encoding[t];return Bte(e,n,t,(t=>jte(t,e.config)))}function jte(e,t,n="datum"){if(e){if(f9(e))return n5(e.value);if(l9(e)){const{format:r,formatType:i}=S9(e);return O8({fieldOrDatumDef:e,format:r,formatType:i,expr:n,config:t})}}}function Ute(e,t={}){const{encoding:n,markDef:r,config:i,stack:o}=e,a=n.tooltip;if($g(a))return{tooltip:Wte({tooltip:a},o,i,t)};{const s=t.reactiveGeom?"datum.datum":"datum";return Bte(e,a,"tooltip",(e=>{const a=jte(e,i,s);if(a)return a;if(null===e)return;let u=s5("tooltip",r,i);return!0===u&&(u={content:"encoding"}),My(u)?{value:u}:Tg(u)?G3(u)?u:"encoding"===u.content?Wte(n,o,i,t):{signal:s}:void 0}))}}function qte(e,t,n,{reactiveGeom:r}={}){const i={},o=r?"datum.datum":"datum",a=[];function s(r,s){const u=I2(s),l=c9(r)?r:{...r,type:e[u].type},c=iy(l.title||E9(l,n)).join(", ");let f;if(a3(s)){const r="x"===s?"x2":"y2",a=A9(e[r]);if(B3(l.bin)&&a){const e=y9(l,{expr:o}),t=y9(a,{expr:o}),{format:s,formatType:u}=S9(l);f=I8(e,t,s,u,n),i[r]=!0}else if(t&&t.fieldChannel===s&&"normalize"===t.offset){const{format:e,formatType:t}=S9(l);f=O8({fieldOrDatumDef:l,format:e,formatType:t,expr:o,config:n,normalizeStack:!0}).signal}}f??(f=jte(l,n,o).signal),a.push({channel:s,key:c,value:f})}K9(e,((e,t)=>{i9(e)?s(e,t):n9(e)&&s(e.condition,t)}));const u={};for(const{channel:e,key:t,value:n}of a)i[e]||u[t]||(u[t]=n);return u}function Wte(e,t,n,{reactiveGeom:r}={}){const i=qte(e,t,n,{reactiveGeom:r}),o=v1(i).map((([e,t])=>`"${e}": ${t}`));return o.length>0?{signal:`{${o.join(", ")}}`}:void 0}function Hte(e){const{markDef:t,config:n}=e,r=s5("aria",t,n);return!1===r?{}:{...r?{aria:r}:{},...Vte(e),...Gte(e)}}function Vte(e){const{mark:t,markDef:n,config:r}=e;if(!1===r.aria)return{};const i=s5("ariaRoleDescription",n,r);return null!=i?{ariaRoleDescription:{value:i}}:t in J3?{}:{ariaRoleDescription:{value:t}}}function Gte(e){const{encoding:t,markDef:n,config:r,stack:i}=e,o=t.description;if(o)return Bte(e,o,"description",(t=>jte(t,e.config)));const a=s5("description",n,r);if(null!=a)return{description:n5(a)};if(!1===r.aria)return{};const s=qte(t,i,r);return m1(s)?void 0:{description:{signal:v1(s).map((([e,t],n)=>`"${n>0?"; ":""}${e}: " + (${t})`)).join(" + ")}}}function Yte(e,t,n={}){const{markDef:r,encoding:i,config:o}=t,{vgChannel:a}=n;let{defaultRef:s,defaultValue:u}=n;void 0===s&&(u??(u=s5(e,r,o,{vgChannel:a,ignoreVgConfig:!0})),void 0!==u&&(s=n5(u)));const l=i[e];return Bte(t,l,a??e,(n=>D8({channel:e,channelDef:n,markDef:r,config:o,scaleName:t.scaleName(e),scale:t.getScaleComponent(e),stack:null,defaultRef:s})))}function Xte(e,t={filled:void 0}){const{markDef:n,encoding:r,config:i}=e,{type:o}=n,a=t.filled??s5("filled",n,i),s=i1(["bar","point","circle","square","geoshape"],o)?"transparent":void 0,u=s5(!0===a?"color":void 0,n,i,{vgChannel:"fill"})??i.mark[!0===a&&"color"]??s,l=s5(!1===a?"color":void 0,n,i,{vgChannel:"stroke"})??i.mark[!1===a&&"color"],c=a?"fill":"stroke",f={...u?{fill:n5(u)}:{},...l?{stroke:n5(l)}:{}};return n.color&&(a?n.fill:n.stroke)&&m5.warn(g5.droppingColor("property",{fill:"fill"in n,stroke:"stroke"in n})),{...f,...Yte("color",e,{vgChannel:c,defaultValue:a?u:l}),...Yte("fill",e,{defaultValue:r.fill?u:void 0}),...Yte("stroke",e,{defaultValue:r.stroke?l:void 0})}}function Qte(e){const{encoding:t,mark:n}=e,r=t.order;return!f8(n)&&f9(r)?Bte(e,r,"zindex",(e=>n5(e.value))):{}}function Jte(e,t){const n=t[function(e){switch(e){case U1:return"xOffset";case q1:return"yOffset";case W1:return"x2Offset";case H1:return"y2Offset";case Y1:return"thetaOffset";case V1:return"radiusOffset";case X1:return"theta2Offset";case G1:return"radius2Offset"}}(e)];if(n)return n}function Kte(e,t,{defaultPos:n,vgChannel:r}){const{encoding:i,markDef:o,config:a,stack:s}=t,u=i[e],l=i[U2(e)],c=t.scaleName(e),f=t.getScaleComponent(e),d=Jte(e,o),h=Zte({model:t,defaultPos:n,channel:e,scaleName:c,scale:f}),p=!u&&a3(e)&&(i.latitude||i.longitude)?{field:t.getName(e)}:function(e){const{channel:t,channelDef:n,scaleName:r,stack:i,offset:o,markDef:a}=e;if(l9(n)&&i&&t===i.fieldChannel){if(i9(n)){let e=n.bandPosition;if(void 0!==e||"text"!==a.type||"radius"!==t&&"theta"!==t||(e=.5),void 0!==e)return C8({scaleName:r,fieldOrDatumDef:n,startSuffix:"start",bandPosition:e,offset:o})}return A8(n,r,{suffix:"end"},{offset:o})}return _8(e)}({channel:e,channelDef:u,channel2Def:l,markDef:o,config:a,scaleName:c,scale:f,stack:s,offset:d,defaultRef:h});return p?{[r||e]:p}:void 0}function Zte({model:e,defaultPos:t,channel:n,scaleName:r,scale:i}){const{markDef:o,config:a}=e;return()=>{const s=I2(n),u=j2(n),l=s5(n,o,a,{vgChannel:u});if(void 0!==l)return M8(n,l);switch(t){case"zeroOrMin":case"zeroOrMax":if(r){const e=i.get("type");if(i1([h4,y4,v4],e));else if(i.domainDefinitelyIncludesZero())return{scale:r,value:0}}if("zeroOrMin"===t)return"y"===s?{field:{group:"height"}}:{value:0};switch(s){case"radius":return{signal:`min(${e.width.signal},${e.height.signal})/2`};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":return{...e[q2(n)],mult:.5}}}}const ene={left:"x",center:"xc",right:"x2"},tne={top:"y",middle:"yc",bottom:"y2"};function nne(e,t,n,r="middle"){if("radius"===e||"theta"===e)return j2(e);const i="x"===e?"align":"baseline",o=s5(i,t,n);let a;return G3(o)?(m5.warn(g5.rangeMarkAlignmentCannotBeExpression(i)),a=void 0):a=o,"x"===e?ene[a||("top"===r?"left":"center")]:tne[a||r]}function rne(e,t,{defaultPos:n,defaultPos2:r,range:i}){return i?ine(e,t,{defaultPos:n,defaultPos2:r}):Kte(e,t,{defaultPos:n})}function ine(e,t,{defaultPos:n,defaultPos2:r}){const{markDef:i,config:o}=t,a=U2(e),s=q2(e),u=function(e,t,n){const{encoding:r,mark:i,markDef:o,stack:a,config:s}=e,u=I2(n),l=q2(n),c=j2(n),f=r[u],d=e.scaleName(u),h=e.getScaleComponent(u),p=Jte(n in r||n in o?n:u,e.markDef);if(!f&&("x2"===n||"y2"===n)&&(r.latitude||r.longitude)){const t=q2(n),r=e.markDef[t];return null!=r?{[t]:{value:r}}:{[c]:{field:e.getName(n)}}}const m=function({channel:e,channelDef:t,channel2Def:n,markDef:r,config:i,scaleName:o,scale:a,stack:s,offset:u,defaultRef:l}){if(l9(t)&&s&&e.charAt(0)===s.fieldChannel.charAt(0))return A8(t,o,{suffix:"start"},{offset:u});return _8({channel:e,channelDef:n,scaleName:o,scale:a,stack:s,markDef:r,config:i,offset:u,defaultRef:l})}({channel:n,channelDef:f,channel2Def:r[n],markDef:o,config:s,scaleName:d,scale:h,stack:a,offset:p,defaultRef:void 0});if(void 0!==m)return{[c]:m};return one(n,o)||one(n,{[n]:l5(n,o,s.style),[l]:l5(l,o,s.style)})||one(n,s[i])||one(n,s.mark)||{[c]:Zte({model:e,defaultPos:t,channel:n,scaleName:d,scale:h})()}}(t,r,a);return{...Kte(e,t,{defaultPos:n,vgChannel:u[s]?nne(e,i,o):j2(e)}),...u}}function one(e,t){const n=q2(e),r=j2(e);if(void 0!==t[r])return{[r]:M8(e,t[r])};if(void 0!==t[e])return{[r]:M8(e,t[e])};if(t[n]){const r=t[n];if(!v8(r))return{[n]:M8(e,r)};m5.warn(g5.relativeBandSizeNotSupported(n))}}function ane(e,t,n){const{config:r,encoding:i,markDef:o}=e,a=U2(t),s=q2(t),u=i[t],l=i[a],c=e.getScaleComponent(t),f=c?c.get("type"):void 0,d=e.scaleName(t),h=o.orient,p=i[s]??i.size??s5("size",o,r,{vgChannel:s}),m="bar"===n&&("x"===t?"vertical"===h:"horizontal"===h);if(!i9(u)||!(L3(u.bin)||B3(u.bin)||u.timeUnit&&!l)||p&&!v8(p)||T4(f))return(l9(u)&&T4(f)||m)&&!l?function(e,t,n){const{markDef:r,encoding:i,config:o,stack:a}=n,s=r.orient,u=n.scaleName(t),l=n.getScaleComponent(t),c=q2(t),f=U2(t),d="horizontal"===s&&"y"===t||"vertical"===s&&"x"===t;let h;(i.size||r.size)&&(d?h=Yte("size",n,{vgChannel:c,defaultRef:n5(r.size)}):m5.warn(g5.cannotApplySizeToNonOrientedMark(r.type)));const p=Z8({channel:t,fieldDef:e,markDef:r,config:o,scaleType:l?.get?.("type"),useVlSizeChannel:d});h=h||{[c]:sne(c,u,l,o,p)};const m="band"===l?.get?.("type")&&"band"in h[c]?"top":"middle",g=nne(t,r,o,m),y="xc"===g||"yc"===g,v=Jte(t,r),b=_8({channel:t,channelDef:e,markDef:r,config:o,scaleName:u,scale:l,stack:a,offset:v,defaultRef:Zte({model:n,defaultPos:"mid",channel:t,scaleName:u,scale:l}),bandPosition:y?.5:G3(p)?{signal:`(1-${p})/2`}:v8(p)?(1-p.band)/2:0});if(c)return{[g]:b,...h};{const e=j2(f),t=h[c],n=v?{...t,offset:v}:t;return{[g]:b,[e]:$g(b)?[b[0],{...b[1],offset:n}]:{...b,offset:n}}}}(u,t,e):ine(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"});return function({fieldDef:e,fieldDef2:t,channel:n,bandSize:r,scaleName:i,markDef:o,spacing:a=0,axisTranslate:s,reverse:u,config:l}){const c=U2(n),f=j2(n),d=j2(c),h=Jte(n,o),p=G3(r)?{signal:`(1-${r.signal})/2`}:v8(r)?(1-r.band)/2:.5;if(L3(e.bin)||e.timeUnit)return{[d]:lne({channel:n,fieldDef:e,scaleName:i,markDef:o,bandPosition:p,offset:une(c,a,u,s,h),config:l}),[f]:lne({channel:n,fieldDef:e,scaleName:i,markDef:o,bandPosition:G3(p)?{signal:`1-${p.signal}`}:1-p,offset:une(n,a,u,s,h),config:l})};if(B3(e.bin)){const r=A8(e,i,{},{offset:une(c,a,u,s,h)});if(i9(t))return{[d]:r,[f]:A8(t,i,{},{offset:une(n,a,u,s,h)})};if(I3(e.bin)&&e.bin.step)return{[d]:r,[f]:{signal:`scale("${i}", ${y9(e,{expr:"datum"})} + ${e.bin.step})`,offset:une(n,a,u,s,h)}}}return void m5.warn(g5.channelRequiredForBinned(c))}({fieldDef:u,fieldDef2:l,channel:t,markDef:o,scaleName:d,bandSize:Z8({channel:t,fieldDef:u,markDef:o,config:r,scaleType:f}),axisTranslate:e.component.axes[t]?.[0]?.get?.("translate")??.5,spacing:a3(t)?s5("binSpacing",o,r):void 0,reverse:c.get("reverse"),config:r})}function sne(e,t,n,r,i){if(v8(i)){if(!n)return{mult:i.band,field:{group:e}};{const e=n.get("type");if("band"===e)return{scale:t,band:i.band};1!==i.band&&(m5.warn(g5.cannotUseRelativeBandSizeWithNonBandScale(e)),i=void 0)}}else{if(G3(i))return i;if(i)return{value:i}}if(n){const e=n.get("range");if(Y3(e)&&Cy(e.step))return{value:e.step-2}}return{value:W7(r.view,e)-2}}function une(e,t,n,r,i){if(x2(e))return 0;const o="x"===e||"y2"===e?-t/2:t/2;if(G3(n)||G3(i)||G3(r)){const e=i5(n),t=i5(i),a=i5(r);return{signal:(a?`${a} + `:"")+(e?`(${e} ? -1 : 1) * `:"")+(t?`(${t} + ${o})`:o)}}return i=i||0,r+(n?-i-o:+i+o)}function lne({channel:e,fieldDef:t,scaleName:n,markDef:r,bandPosition:i,offset:o,config:a}){return k8({fieldDef:t,channel:e,markDef:r,ref:C8({scaleName:n,fieldOrDatumDef:t,bandPosition:i,offset:o}),config:a})}const cne=new Set(["aria","width","height"]);function fne(e,t){const{fill:n,stroke:r}="include"===t.color?Xte(e):{};return{...hne(e.markDef,t),...dne(e,"fill",n),...dne(e,"stroke",r),...Yte("opacity",e),...Yte("fillOpacity",e),...Yte("strokeOpacity",e),...Yte("strokeWidth",e),...Yte("strokeDash",e),...Qte(e),...Ute(e),...Ite(e,"href"),...Hte(e)}}function dne(e,t,n){const{config:r,mark:i,markDef:o}=e;if("hide"===s5("invalid",o,r)&&n&&!f8(i)){const r=function(e,{invalid:t=!1,channels:n}){const r=n.reduce(((t,n)=>{const r=e.getScaleComponent(n);if(r){const i=r.get("type"),o=e.vgField(n,{expr:"datum"});o&&z4(i)&&(t[o]=!0)}return t}),{}),i=g1(r);if(i.length>0){const e=t?"||":"&&";return i.map((e=>S8(e,t))).join(` ${e} `)}return}(e,{invalid:!0,channels:w3});if(r)return{[t]:[{test:r,value:null},...iy(n)]}}return n?{[t]:n}:{}}function hne(e,t){return Q3.reduce(((n,r)=>(cne.has(r)||void 0===e[r]||"ignore"===t[r]||(n[r]=n5(e[r])),n)),{})}function pne(e){const{config:t,markDef:n}=e;if(s5("invalid",n,t)){const t=function(e,{invalid:t=!1,channels:n}){const r=n.reduce(((t,n)=>{const r=e.getScaleComponent(n);if(r){const i=r.get("type"),o=e.vgField(n,{expr:"datum"});o&&z4(i)&&(t[o]=!0)}return t}),{}),i=g1(r);if(i.length>0){const e=t?"||":"&&";return i.map((e=>S8(e,t))).join(` ${e} `)}return}(e,{channels:o3});if(t)return{defined:{signal:t}}}return{}}function mne(e,t){if(void 0!==t)return{[e]:n5(t)}}const gne="voronoi",yne={defined:e=>"point"===e.type&&e.nearest,parse:(e,t)=>{if(t.events)for(const n of t.events)n.markname=e.getName(gne)},marks:(e,t,n)=>{const{x:r,y:i}=t.project.hasChannel,o=e.mark;if(f8(o))return m5.warn(g5.nearestNotSupportForContinuous(o)),n;const a={name:e.getName(gne),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:{fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0},...Ute(e,{reactiveGeom:!0})}},transform:[{type:"voronoi",x:{expr:r||!i?"datum.datum.x || 0":"0"},y:{expr:i||!r?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let s=0,u=!1;return n.forEach(((t,n)=>{const r=t.name??"";r===e.component.mark[0].name?s=n:r.indexOf(gne)>=0&&(u=!0)})),u||n.splice(s+1,0,a),n}},vne={defined:e=>"point"===e.type&&"global"===e.resolve&&e.bind&&"scales"!==e.bind&&!$7(e.bind),parse:(e,t,n)=>Lne(t,n),topLevelSignals:(e,t,n)=>{const r=t.name,i=t.project,o=t.bind,a=t.init&&t.init[0],s=yne.defined(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return i.items.forEach(((e,i)=>{const u=x1(`${r}_${e.field}`);n.filter((e=>e.name===u)).length||n.unshift({name:u,...a?{init:xte(a[i])}:{value:null},on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${s}[${Py(e.field)}] : null`}]:[],bind:o[e.field]??o[e.channel]??o})})),n},signals:(e,t,n)=>{const r=t.name,i=t.project,o=n.filter((e=>e.name===r+One))[0],a=r+Dte,s=i.items.map((e=>x1(`${r}_${e.field}`))),u=s.map((e=>`${e} !== null`)).join(" && ");return s.length&&(o.update=`${u} ? {fields: ${a}, values: [${s.join(", ")}]} : null`),delete o.value,delete o.on,n}},bne="_toggle",xne={defined:e=>"point"===e.type&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+bne,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{const n=t.name+One,r=t.name+bne;return`${r} ? null : ${n}, `+("global"===t.resolve?`${r} ? null : true, `:`${r} ? null : {unit: ${Rne(e)}}, `)+`${r} ? ${n} : null`}},wne={defined:e=>void 0!==e.clear&&!1!==e.clear,parse:(e,t)=>{t.clear&&(t.clear=My(t.clear)?BQ(t.clear,"view"):t.clear)},topLevelSignals:(e,t,n)=>{if(vne.defined(t))for(const e of t.project.items){const r=n.findIndex((n=>n.name===x1(`${t.name}_${e.field}`)));-1!==r&&n[r].on.push({events:t.clear,update:"null"})}return n},signals:(e,t,n)=>{function r(e,r){-1!==e&&n[e].on&&n[e].on.push({events:t.clear,update:r})}if("interval"===t.type)for(const e of t.project.items){const t=n.findIndex((t=>t.name===e.signals.visual));if(r(t,"[0, 0]"),-1===t){r(n.findIndex((t=>t.name===e.signals.data)),"null")}}else{let e=n.findIndex((e=>e.name===t.name+One));r(e,"null"),xne.defined(t)&&(e=n.findIndex((e=>e.name===t.name+bne)),r(e,"false"))}return n}},_ne={defined:e=>{const t="global"===e.resolve&&e.bind&&$7(e.bind),n=1===e.project.items.length&&e.project.items[0].field!==N7;return t&&!n&&m5.warn(g5.LEGEND_BINDINGS_MUST_HAVE_PROJECTION),t&&n},parse:(e,t,n)=>{const r=K0(n);if(r.select=My(r.select)?{type:r.select,toggle:t.toggle}:{...r.select,toggle:t.toggle},Lne(t,r),Tg(n.select)&&(n.select.on||n.select.clear)){const e='event.item && indexof(event.item.mark.role, "legend") < 0';for(const n of t.events)n.filter=iy(n.filter??[]),n.filter.includes(e)||n.filter.push(e)}const i=T7(t.bind)?t.bind.legend:"click",o=My(i)?BQ(i,"view"):iy(i);t.bind={legend:{merge:o}}},topLevelSignals:(e,t,n)=>{const r=t.name,i=T7(t.bind)&&t.bind.legend,o=e=>t=>{const n=K0(t);return n.markname=e,n};for(const e of t.project.items){if(!e.hasLegend)continue;const a=`${x1(e.field)}_legend`,s=`${r}_${a}`;if(0===n.filter((e=>e.name===s)).length){const e=i.merge.map(o(`${a}_symbols`)).concat(i.merge.map(o(`${a}_labels`))).concat(i.merge.map(o(`${a}_entries`)));n.unshift({name:s,...t.init?{}:{value:null},on:[{events:e,update:"datum.value || item().items[0].items[0].datum.value",force:!0},{events:i.merge,update:`!event.item || !datum ? null : ${s}`,force:!0}]})}}return n},signals:(e,t,n)=>{const r=t.name,i=t.project,o=n.find((e=>e.name===r+One)),a=r+Dte,s=i.items.filter((e=>e.hasLegend)).map((e=>x1(`${r}_${x1(e.field)}_legend`))),u=`${s.map((e=>`${e} !== null`)).join(" && ")} ? {fields: ${a}, values: [${s.join(", ")}]} : null`;t.events&&s.length>0?o.on.push({events:s.map((e=>({signal:e}))),update:u}):s.length>0&&(o.update=u,delete o.value,delete o.on);const l=n.find((e=>e.name===r+bne)),c=T7(t.bind)&&t.bind.legend;return l&&(t.events?l.on.push({...l.on[0],events:c}):l.on[0].events=c),n}};const kne="_translate_anchor",Ene="_translate_delta",Sne={defined:e=>"interval"===e.type&&e.translate,signals:(e,t,n)=>{const r=t.name,i=Nte.defined(t),o=r+kne,{x:a,y:s}=t.project.hasChannel;let u=BQ(t.translate,"scope");return i||(u=u.map((e=>(e.between[0].markname=r+Tte,e)))),n.push({name:o,value:{},on:[{events:u.map((e=>e.between[0])),update:"{x: x(unit), y: y(unit)"+(void 0!==a?`, extent_x: ${i?Ote(e,U1):`slice(${a.signals.visual})`}`:"")+(void 0!==s?`, extent_y: ${i?Ote(e,q1):`slice(${s.signals.visual})`}`:"")+"}"}]},{name:r+Ene,value:{},on:[{events:u,update:`{x: ${o}.x - x(unit), y: ${o}.y - y(unit)}`}]}),void 0!==a&&Ane(e,t,a,"width",n),void 0!==s&&Ane(e,t,s,"height",n),n}};function Ane(e,t,n,r,i){const o=t.name,a=o+kne,s=o+Ene,u=n.channel,l=Nte.defined(t),c=i.filter((e=>e.name===n.signals[l?"data":"visual"]))[0],f=e.getSizeSignalRef(r).signal,d=e.getScaleComponent(u),h=d.get("type"),p=d.get("reverse"),m=`${a}.extent_${u}`,g=`${l?"log"===h?"panLog":"symlog"===h?"panSymlog":"pow"===h?"panPow":"panLinear":"panLinear"}(${m}, ${`${l?u===U1?p?"":"-":p?"-":"":""}${s}.${u} / ${l?`${f}`:`span(${m})`}`}${l?"pow"===h?`, ${d.get("exponent")??1}`:"symlog"===h?`, ${d.get("constant")??1}`:"":""})`;c.on.push({events:{signal:s},update:l?g:`clampRange(${g}, 0, ${f})`})}const Cne="_zoom_anchor",Dne="_zoom_delta",Mne={defined:e=>"interval"===e.type&&e.zoom,signals:(e,t,n)=>{const r=t.name,i=Nte.defined(t),o=r+Dne,{x:a,y:s}=t.project.hasChannel,u=Py(e.scaleName(U1)),l=Py(e.scaleName(q1));let c=BQ(t.zoom,"scope");return i||(c=c.map((e=>(e.markname=r+Tte,e)))),n.push({name:r+Cne,on:[{events:c,update:i?"{"+[u?`x: invert(${u}, x(unit))`:"",l?`y: invert(${l}, y(unit))`:""].filter((e=>!!e)).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:o,on:[{events:c,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),void 0!==a&&Fne(e,t,a,"width",n),void 0!==s&&Fne(e,t,s,"height",n),n}};function Fne(e,t,n,r,i){const o=t.name,a=n.channel,s=Nte.defined(t),u=i.filter((e=>e.name===n.signals[s?"data":"visual"]))[0],l=e.getSizeSignalRef(r).signal,c=e.getScaleComponent(a),f=c.get("type"),d=s?Ote(e,a):u.name,h=o+Dne,p=`${s?"log"===f?"zoomLog":"symlog"===f?"zoomSymlog":"pow"===f?"zoomPow":"zoomLinear":"zoomLinear"}(${d}, ${`${o}_zoom_anchor.${a}`}, ${h}${s?"pow"===f?`, ${c.get("exponent")??1}`:"symlog"===f?`, ${c.get("constant")??1}`:"":""})`;u.on.push({events:{signal:h},update:s?p:`clampRange(${p}, 0, ${l})`})}const Nne="_store",One="_tuple",$ne="_modify",Tne="vlSelectionResolve",zne=[Lte,Rte,Fte,xne,vne,Nte,_ne,wne,Sne,Mne,yne];function Rne(e,{escape:t}={escape:!0}){let n=t?Py(e.name):e.name;const r=function(e){let t=e.parent;for(;t&&!boe(t);)t=t.parent;return t}(e);if(r){const{facet:e}=r;for(const t of A2)e[t]&&(n+=` + '__facet_${t}_' + (facet[${Py(r.vgField(t))}])`)}return n}function Pne(e){return y1(e.component.selection??{}).reduce(((e,t)=>e||t.project.items.some((e=>e.field===N7))),!1)}function Lne(e,t){!My(t.select)&&t.select.on||delete e.events,!My(t.select)&&t.select.clear||delete e.clear,!My(t.select)&&t.select.toggle||delete e.toggle}function Bne(e){const t=[];return"Identifier"===e.type?[e.name]:"Literal"===e.type?[e.value]:("MemberExpression"===e.type&&(t.push(...Bne(e.object)),t.push(...Bne(e.property))),t)}function Ine(e){return"MemberExpression"===e.object.type?Ine(e.object):"datum"===e.object.name}function jne(e){const t=OY(e),n=new Set;return t.visit((e=>{"MemberExpression"===e.type&&Ine(e)&&n.add(Bne(e).slice(1).join("."))})),n}class Une extends Ste{constructor(e,t,n){super(e),this.model=t,this.filter=n,this.expr=Hne(this.model,this.filter,this),this._dependentFields=jne(this.expr)}clone(){return new Une(null,this.model,K0(this.filter))}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function qne(e,t,n,r="datum"){const i=My(t)?t:t.param,o=x1(i),a=Py(o+Nne);let s;try{s=e.getSelectionComponent(o,i)}catch(e){return`!!${o}`}if(s.project.timeUnit){const t=n??e.component.data.raw,r=s.project.timeUnit.clone();t.parent?r.insertAsParentOf(t):t.parent=r}const u=`vlSelectionTest(${a}, ${r}${"global"===s.resolve?")":`, ${Py(s.resolve)})`}`,l=`length(data(${a}))`;return!1===t.empty?`${l} && ${u}`:`!${l} || ${u}`}function Wne(e,t,n){const r=x1(t),i=n.encoding;let o,a=n.field;try{o=e.getSelectionComponent(r,t)}catch(e){return r}if(i||a){if(i&&!a){const e=o.project.items.filter((e=>e.channel===i));!e.length||e.length>1?(a=o.project.items[0].field,m5.warn((e.length?"Multiple ":"No ")+`matching ${Py(i)} encoding found for selection ${Py(n.param)}. `+`Using "field": ${Py(a)}.`)):a=e[0].field}}else a=o.project.items[0].field,o.project.items.length>1&&m5.warn(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${Py(a)}.`);return`${o.name}[${Py(C1(a))}]`}function Hne(e,t,n){return w1(t,(t=>My(t)?t:function(e){return e?.param}(t)?qne(e,t,n):r4(t)))}function Vne(e,t,n,r){var i,o;e.encode??(e.encode={}),(i=e.encode)[t]??(i[t]={}),(o=e.encode[t]).update??(o.update={}),e.encode[t].update[n]=r}function Gne(e,t,n,r={header:!1}){const{disable:i,orient:o,scale:a,labelExpr:s,title:u,zindex:l,...c}=e.combine();if(!i){for(const e in c){const n=I9[e],r=c[e];if(n&&n!==t&&"both"!==n)delete c[e];else if(L9(r)){const{condition:t,...n}=r,i=iy(t),o=P9[e];if(o){const{vgProp:t,part:r}=o;Vne(c,r,t,[...i.map((e=>{const{test:t,...n}=e;return{test:Hne(null,t),...n}})),n]),delete c[e]}else if(null===o){const t={signal:i.map((e=>{const{test:t,...n}=e;return`${Hne(null,t)} ? ${r5(n)} : `})).join("")+r5(n)};c[e]=t}}else if(G3(r)){const t=P9[e];if(t){const{vgProp:n,part:i}=t;Vne(c,i,n,r),delete c[e]}}i1(["labelAlign","labelBaseline"],e)&&null===c[e]&&delete c[e]}if("grid"===t){if(!c.grid)return;if(c.encode){const{grid:e}=c.encode;c.encode={...e?{grid:e}:{}},m1(c.encode)&&delete c.encode}return{scale:a,orient:o,...c,domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:N1(l,0)}}{if(!r.header&&e.mainExtracted)return;if(void 0!==s){let e=s;c.encode?.labels?.update&&G3(c.encode.labels.update.text)&&(e=D1(s,"datum.label",c.encode.labels.update.text.signal)),Vne(c,"labels","text",{signal:e})}if(null===c.labelAlign&&delete c.labelAlign,c.encode){for(const t of B9)e.hasAxisPart(t)||delete c.encode[t];m1(c.encode)&&delete c.encode}const t=function(e,t){if(e)return $g(e)&&!V3(e)?e.map((e=>E9(e,t))).join(", "):e}(u,n);return{scale:a,orient:o,grid:!1,...t?{title:t}:{},...c,...!1===n.aria?{aria:!1}:{},zindex:N1(l,0)}}}}function Yne(e){const{axes:t}=e.component,n=[];for(const r of o3)if(t[r])for(const i of t[r])if(!i.get("disable")&&!i.get("gridScale")){const t="x"===r?"height":"width",i=e.getSizeSignalRef(t).signal;t!==i&&n.push({name:t,update:i})}return n}function Xne(e,t,n,r){return Object.assign.apply(null,[{},...e.map((e=>{if("axisOrient"===e){const e="x"===n?"bottom":"left",i=t["x"===n?"axisBottom":"axisLeft"]||{},o=t["x"===n?"axisTop":"axisRight"]||{},a=new Set([...g1(i),...g1(o)]),s={};for(const t of a.values())s[t]={signal:`${r.signal} === "${e}" ? ${i5(i[t])} : ${i5(o[t])}`};return s}return t[e]}))])}function Qne(e,t,n,r){const i="band"===t?["axisDiscrete","axisBand"]:"point"===t?["axisDiscrete","axisPoint"]:t in F4?["axisQuantitative"]:"time"===t||"utc"===t?["axisTemporal"]:[];const o="x"===e?"axisX":"axisY",a=G3(n)?"axisOrient":`axis${k1(n)}`,s=[...i,...i.map((e=>o+e.substr(4)))],u=["axis",a,o];return{vlOnlyAxisConfig:Xne(s,r,e,n),vgAxisConfig:Xne(u,r,e,n),axisConfigStyle:Jne([...u,...s],r)}}function Jne(e,t){const n=[{}];for(const r of e){let e=t[r]?.style;if(e){e=iy(e);for(const r of e)n.push(t.style[r])}}return Object.assign.apply(null,n)}function Kne(e,t,n,r={}){const i=c5(e,n,t);if(void 0!==i)return{configFrom:"style",configValue:i};for(const t of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(void 0!==r[t]?.[e])return{configFrom:t,configValue:r[t][e]};return{}}const Zne={scale:({model:e,channel:t})=>e.scaleName(t),format:({fieldOrDatumDef:e,config:t,axis:n})=>{const{format:r,formatType:i}=n;return z8(e,e.type,r,i,t,!0)},formatType:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:r}=e;return R8(r,t,n)},grid:({fieldOrDatumDef:e,axis:t,scaleType:n})=>t.grid??function(e,t){return!T4(e)&&i9(t)&&!L3(t?.bin)&&!B3(t?.bin)}(n,e),gridScale:({model:e,channel:t})=>function(e,t){const n="x"===t?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n);return}(e,t),labelAlign:({axis:e,labelAngle:t,orient:n,channel:r})=>e.labelAlign||nre(t,n,r),labelAngle:({labelAngle:e})=>e,labelBaseline:({axis:e,labelAngle:t,orient:n,channel:r})=>e.labelBaseline||tre(t,n,r),labelFlush:({axis:e,fieldOrDatumDef:t,channel:n})=>e.labelFlush??function(e,t){if("x"===t&&i1(["quantitative","temporal"],e))return!0;return}(t.type,n),labelOverlap:({axis:e,fieldOrDatumDef:t,scaleType:n})=>e.labelOverlap??function(e,t,n,r){if(n&&!Tg(r)||"nominal"!==e&&"ordinal"!==e)return"log"!==t&&"symlog"!==t||"greedy";return}(t.type,n,i9(t)&&!!t.timeUnit,i9(t)?t.sort:void 0),orient:({orient:e})=>e,tickCount:({channel:e,model:t,axis:n,fieldOrDatumDef:r,scaleType:i})=>{const o="x"===e?"width":"y"===e?"height":void 0,a=o?t.getSizeSignalRef(o):void 0;return n.tickCount??function({fieldOrDatumDef:e,scaleType:t,size:n,values:r}){if(!r&&!T4(t)&&"log"!==t){if(i9(e)){if(L3(e.bin))return{signal:`ceil(${n.signal}/10)`};if(e.timeUnit&&i1(["month","hours","day","quarter"],G6(e.timeUnit)?.unit))return}return{signal:`ceil(${n.signal}/40)`}}return}({fieldOrDatumDef:r,scaleType:i,size:a,values:n.values})},title:({axis:e,model:t,channel:n})=>{if(void 0!==e.title)return e.title;const r=rre(t,n);if(void 0!==r)return r;const i=t.typedFieldDef(n),o="x"===n?"x2":"y2",a=t.fieldDef(o);return d5(i?[Q8(i)]:[],i9(a)?[Q8(a)]:[])},values:({axis:e,fieldOrDatumDef:t})=>function(e,t){const n=e.values;if($g(n))return z9(t,n);if(G3(n))return n;return}(e,t),zindex:({axis:e,fieldOrDatumDef:t,mark:n})=>e.zindex??function(e,t){if("rect"===e&&v9(t))return 1;return 0}(n,t)};function ere(e){return`(((${e.signal} % 360) + 360) % 360)`}function tre(e,t,n,r){if(void 0!==e){if("x"===n){if(G3(e)){const n=ere(e);return{signal:`(45 < ${n} && ${n} < 135) || (225 < ${n} && ${n} < 315) ? "middle" :(${n} <= 45 || 315 <= ${n}) === ${G3(t)?`(${t.signal} === "top")`:"top"===t} ? "bottom" : "top"`}}if(45<e&&e<135||225<e&&e<315)return"middle";if(G3(t)){const n=e<=45||315<=e?"===":"!==";return{signal:`${t.signal} ${n} "top" ? "bottom" : "top"`}}return(e<=45||315<=e)==("top"===t)?"bottom":"top"}if(G3(e)){const n=ere(e);return{signal:`${n} <= 45 || 315 <= ${n} || (135 <= ${n} && ${n} <= 225) ? ${r?'"middle"':"null"} : (45 <= ${n} && ${n} <= 135) === ${G3(t)?`(${t.signal} === "left")`:"left"===t} ? "top" : "bottom"`}}if(e<=45||315<=e||135<=e&&e<=225)return r?"middle":null;if(G3(t)){const n=45<=e&&e<=135?"===":"!==";return{signal:`${t.signal} ${n} "left" ? "top" : "bottom"`}}return(45<=e&&e<=135)==("left"===t)?"top":"bottom"}}function nre(e,t,n){if(void 0===e)return;const r="x"===n,i=r?0:90,o=r?"bottom":"left";if(G3(e)){const n=ere(e);return{signal:`(${i?`(${n} + 90)`:n} % 180 === 0) ? ${r?null:'"center"'} :(${i} < ${n} && ${n} < ${180+i}) === ${G3(t)?`(${t.signal} === "${o}")`:t===o} ? "left" : "right"`}}if((e+i)%180==0)return r?null:"center";if(G3(t)){const n=i<e&&e<180+i?"===":"!==";return{signal:`${`${t.signal} ${n} "${o}"`} ? "left" : "right"`}}return(i<e&&e<180+i)==(t===o)?"left":"right"}function rre(e,t){const n="x"===t?"x2":"y2",r=e.fieldDef(t),i=e.fieldDef(n),o=r?r.title:void 0,a=i?i.title:void 0;return o&&a?h5(o,a):o||(a||(void 0!==o?o:void 0!==a?a:void 0))}class ire extends Ste{constructor(e,t){super(e),this.transform=t,this._dependentFields=jne(this.transform.calculate)}clone(){return new ire(null,K0(this.transform))}static parseAllForSortIndex(e,t){return t.forEachFieldDef(((t,n)=>{if(d9(t)&&V8(t.sort)){const{field:r,timeUnit:i}=t,o=t.sort,a=o.map(((e,t)=>`${r4({field:r,timeUnit:i,equal:e})} ? ${t} : `)).join("")+o.length;e=new ire(e,{calculate:a,as:ore(t,n,{forAs:!0})})}})),e}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${n1(this.transform)}`}}function ore(e,t,n){return y9(e,{prefix:t,suffix:"sort_index",...n??{}})}function are(e,t){return i1(["top","bottom"],t)?"column":i1(["left","right"],t)||"row"===e?"row":"column"}function sre(e,t,n,r){const i="row"===r?n.headerRow:"column"===r?n.headerColumn:n.headerFacet;return N1((t||{})[e],i[e],n.header[e])}function ure(e,t,n,r){const i={};for(const o of e){const e=sre(o,t||{},n,r);void 0!==e&&(i[o]=e)}return i}const lre=["row","column"],cre=["header","footer"];function fre(e,t){const n=e.component.layoutHeaders[t].title,r=e.config?e.config:void 0,i=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:o,titleAngle:a,titleOrient:s}=ure(["titleAnchor","titleAngle","titleOrient"],i.header,r,t),u=are(t,s),l=P1(a);return{name:`${t}-title`,type:"group",role:`${u}-title`,title:{text:n,..."row"===t?{orient:"left"}:{},style:"guide-title",...hre(l,u),...dre(u,l,o),...xre(r,i,t,A7,E7)}}}function dre(e,t,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}const r=nre(t,"row"===e?"left":"top","row"===e?"y":"x");return r?{align:r}:{}}function hre(e,t){const n=tre(e,"row"===t?"left":"top","row"===t?"y":"x",!0);return n?{baseline:n}:{}}function pre(e,t){const n=e.component.layoutHeaders[t],r=[];for(const i of cre)if(n[i])for(const o of n[i]){const a=yre(e,t,i,n,o);null!=a&&r.push(a)}return r}function mre(e,t){const{sort:n}=e;return H8(n)?{field:y9(n,{expr:"datum"}),order:n.order??"ascending"}:$g(n)?{field:ore(e,t,{expr:"datum"}),order:"ascending"}:{field:y9(e,{expr:"datum"}),order:n??"ascending"}}function gre(e,t,n){const{format:r,formatType:i,labelAngle:o,labelAnchor:a,labelOrient:s,labelExpr:u}=ure(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e.header,n,t),l=O8({fieldOrDatumDef:e,format:r,formatType:i,expr:"parent",config:n}).signal,c=are(t,s);return{text:{signal:u?D1(D1(u,"datum.label",l),"datum.value",y9(e,{expr:"parent"})):l},..."row"===t?{orient:"left"}:{},style:"guide-label",frame:"group",...hre(o,c),...dre(c,o,a),...xre(n,e,t,C7,S7)}}function yre(e,t,n,r,i){if(i){let o=null;const{facetFieldDef:a}=r,s=e.config?e.config:void 0;if(a&&i.labels){const{labelOrient:e}=ure(["labelOrient"],a.header,s,t);("row"===t&&!i1(["top","bottom"],e)||"column"===t&&!i1(["left","right"],e))&&(o=gre(a,t,s))}const u=boe(e)&&!G8(e.facet),l=i.axes,c=l?.length>0;if(o||c){const s="row"===t?"height":"width";return{name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`,...r.facetFieldDef?{from:{data:e.getName(`${t}_domain`)},sort:mre(a,t)}:{},...c&&u?{from:{data:e.getName(`facet_domain_${t}`)}}:{},...o?{title:o}:{},...i.sizeSignal?{encode:{update:{[s]:i.sizeSignal}}}:{},...c?{axes:l}:{}}}}return null}const vre={column:{start:0,end:1},row:{start:1,end:0}};function bre(e,t){return vre[t][e]}function xre(e,t,n,r,i){const o={};for(const a of r){if(!i[a])continue;const r=sre(a,t?.header,e,n);void 0!==r&&(o[i[a]]=r)}return o}function wre(e){return[..._re(e,"width"),..._re(e,"height"),..._re(e,"childWidth"),..._re(e,"childHeight")]}function _re(e,t){const n="width"===t?"x":"y",r=e.component.layoutSize.get(t);if(!r||"merged"===r)return[];const i=e.getSizeSignalRef(t).signal;if("step"===r){const t=e.getScaleComponent(n);if(t){const r=t.get("type"),o=t.get("range");if(T4(r)&&Y3(o)){const r=e.scaleName(n);if(boe(e.parent)){if("independent"===e.parent.component.resolve.scale[n])return[kre(r,o)]}return[kre(r,o),{name:i,update:Ere(r,t,`domain('${r}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}if("container"==r){const t=i.endsWith("width"),n=t?"containerSize()[0]":"containerSize()[1]",r=`isFinite(${n}) ? ${n} : ${q7(e.config.view,t?"width":"height")}`;return[{name:i,init:r,on:[{update:r,events:"window:resize"}]}]}return[{name:i,value:r}]}function kre(e,t){return{name:`${e}_step`,value:t.step}}function Ere(e,t,n){const r=t.get("type"),i=t.get("padding"),o=N1(t.get("paddingOuter"),i);let a=t.get("paddingInner");return a="band"===r?void 0!==a?a:i:1,`bandspace(${n}, ${i5(a)}, ${i5(o)}) * ${e}_step`}function Sre(e){return"childWidth"===e?"width":"childHeight"===e?"height":e}function Are(e,t){return g1(e).reduce(((n,r)=>{const i=e[r];return{...n,...Bte(t,i,r,(e=>n5(e.value)))}}),{})}function Cre(e,t){if(woe(t)||boe(t))return"shared";if(xoe(t))return a3(e)?"independent":"shared";throw new Error("invalid model type for resolve")}function Dre(e,t){const n=e.scale[t],r=a3(t)?"axis":"legend";return"independent"===n?("shared"===e[r][t]&&m5.warn(g5.independentScaleMeansIndependentGuide(t)),"independent"):e[r][t]||"shared"}const Mre={...F7,disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1},Fre=g1(Mre);class Nre extends ite{}const Ore={symbols:function(e,{fieldOrDatumDef:t,model:n,channel:r,legendCmpt:i,legendType:o}){if("symbol"!==o)return;const{markDef:a,encoding:s,config:u,mark:l}=n,c=a.filled&&"trail"!==l;let f={...o5({},n,m8),...Xte(n,{filled:c})};const d=i.get("symbolOpacity")??u.legend.symbolOpacity,h=i.get("symbolFillColor")??u.legend.symbolFillColor,p=i.get("symbolStrokeColor")??u.legend.symbolStrokeColor,m=void 0===d?$re(s.opacity)??a.opacity:void 0;if(f.fill)if("fill"===r||c&&r===e2)delete f.fill;else if(f.fill.field)h?delete f.fill:(f.fill=n5(u.legend.symbolBaseFillColor??"black"),f.fillOpacity=n5(m??1));else if($g(f.fill)){const e=Tre(s.fill??s.color)??a.fill??(c&&a.color);e&&(f.fill=n5(e))}if(f.stroke)if("stroke"===r||!c&&r===e2)delete f.stroke;else if(f.stroke.field||p)delete f.stroke;else if($g(f.stroke)){const e=N1(Tre(s.stroke||s.color),a.stroke,c?a.color:void 0);e&&(f.stroke={value:e})}if(r!==a2){const e=i9(t)&&Rre(n,i,t);e?f.opacity=[{test:e,...n5(m??1)},n5(u.legend.unselectedOpacity)]:m&&(f.opacity=n5(m))}return f={...f,...e},m1(f)?void 0:f},gradient:function(e,{model:t,legendType:n,legendCmpt:r}){if("gradient"!==n)return;const{config:i,markDef:o,encoding:a}=t;let s={};const u=void 0===(r.get("gradientOpacity")??i.legend.gradientOpacity)?$re(a.opacity)||o.opacity:void 0;u&&(s.opacity=n5(u));return s={...s,...e},m1(s)?void 0:s},labels:function(e,{fieldOrDatumDef:t,model:n,channel:r,legendCmpt:i}){const o=n.legend(r)||{},a=n.config,s=i9(t)?Rre(n,i,t):void 0,u=s?[{test:s,value:1},{value:a.legend.unselectedOpacity}]:void 0,{format:l,formatType:c}=o,f=F8(c)?T8({fieldOrDatumDef:t,field:"datum.value",format:l,formatType:c,config:a}):void 0,d={...u?{opacity:u}:{},...f?{text:f}:{},...e};return m1(d)?void 0:d},entries:function(e,{legendCmpt:t}){return t.get("selections")?.length?{...e,fill:{value:"transparent"}}:e}};function $re(e){return zre(e,((e,t)=>Math.max(e,t.value)))}function Tre(e){return zre(e,((e,t)=>N1(e,t.value)))}function zre(e,t){return function(e){const t=e&&e.condition;return!!t&&($g(t)||f9(t))}(e)?iy(e.condition).reduce(t,e.value):f9(e)?e.value:void 0}function Rre(e,t,n){const r=t.get("selections");if(!r?.length)return;const i=Py(n.field);return r.map((e=>`(!length(data(${Py(x1(e)+Nne)})) || (${e}[${i}] && indexof(${e}[${i}], datum.value) >= 0))`)).join(" || ")}const Pre={direction:({direction:e})=>e,format:({fieldOrDatumDef:e,legend:t,config:n})=>{const{format:r,formatType:i}=t;return z8(e,e.type,r,i,n,!1)},formatType:({legend:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:r}=e;return R8(r,t,n)},gradientLength:e=>{const{legend:t,legendConfig:n}=e;return t.gradientLength??n.gradientLength??function({legendConfig:e,model:t,direction:n,orient:r,scaleType:i}){const{gradientHorizontalMaxLength:o,gradientHorizontalMinLength:a,gradientVerticalMaxLength:s,gradientVerticalMinLength:u}=e;if(R4(i))return"horizontal"===n?"top"===r||"bottom"===r?Ire(t,"width",a,o):a:Ire(t,"height",u,s);return}(e)},labelOverlap:({legend:e,legendConfig:t,scaleType:n})=>e.labelOverlap??t.labelOverlap??function(e){if(i1(["quantile","threshold","log","symlog"],e))return"greedy";return}(n),symbolType:({legend:e,markDef:t,channel:n,encoding:r})=>e.symbolType??function(e,t,n,r){if("shape"!==t){const e=Tre(n)??r;if(e)return e}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}(t.type,n,r.shape,t.shape),title:({fieldOrDatumDef:e,config:t})=>_9(e,t,{allowDisabling:!0}),type:({legendType:e,scaleType:t,channel:n})=>{if(E2(n)&&R4(t)){if("gradient"===e)return}else if("symbol"===e)return;return e},values:({fieldOrDatumDef:e,legend:t})=>function(e,t){const n=e.values;if($g(n))return z9(t,n);if(G3(n))return n;return}(t,e)};function Lre(e){const{legend:t}=e;return N1(t.type,function({channel:e,timeUnit:t,scaleType:n}){if(E2(e)){if(i1(["quarter","month","day"],t))return"symbol";if(R4(n))return"gradient"}return"symbol"}(e))}function Bre({legendConfig:e,legendType:t,orient:n,legend:r}){return r.direction??e[t?"gradientDirection":"symbolDirection"]??function(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return"gradient"===t?"horizontal":void 0}}(n,t)}function Ire(e,t,n,r){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${r})`}}function jre(e){const t=voe(e)?function(e){const{encoding:t}=e,n={};for(const r of[e2,...M7]){const i=C9(t[r]);i&&e.getScaleComponent(r)&&(r===r2&&i9(i)&&i.type===f4||(n[r]=qre(e,r)))}return n}(e):function(e){const{legends:t,resolve:n}=e.component;for(const r of e.children){jre(r);for(const i of g1(r.component.legends))n.legend[i]=Dre(e.component.resolve,i),"shared"===n.legend[i]&&(t[i]=Wre(t[i],r.component.legends[i]),t[i]||(n.legend[i]="independent",delete t[i]))}for(const r of g1(t))for(const t of e.children)t.component.legends[r]&&"shared"===n.legend[r]&&delete t.component.legends[r];return t}(e);return e.component.legends=t,t}function Ure(e,t,n,r){switch(t){case"disable":return void 0!==n;case"values":return!!n?.values;case"title":if("title"===t&&e===r?.title)return!0}return e===(n||{})[t]}function qre(e,t){let n=e.legend(t);const{markDef:r,encoding:i,config:o}=e,a=o.legend,s=new Nre({},function(e,t){const n=e.scaleName(t);if("trail"===e.mark){if("color"===t)return{stroke:n};if("size"===t)return{strokeWidth:n}}return"color"===t?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n}}(e,t));!function(e,t,n){const r=e.fieldDef(t)?.field;for(const i of y1(e.component.selection??{})){const e=i.project.hasField[r]??i.project.hasChannel[t];if(e&&_ne.defined(i)){const t=n.get("selections")??[];t.push(i.name),n.set("selections",t,!1),e.hasLegend=!0}}}(e,t,s);const u=void 0!==n?!n:a.disable;if(s.set("disable",u,void 0!==n),u)return s;n=n||{};const l=e.getScaleComponent(t).get("type"),c=C9(i[t]),f=i9(c)?G6(c.timeUnit)?.unit:void 0,d=n.orient||o.legend.orient||"right",h=Lre({legend:n,channel:t,timeUnit:f,scaleType:l}),p={legend:n,channel:t,model:e,markDef:r,encoding:i,fieldOrDatumDef:c,legendConfig:a,config:o,scaleType:l,orient:d,legendType:h,direction:Bre({legend:n,legendType:h,orient:d,legendConfig:a})};for(const r of Fre){if("gradient"===h&&r.startsWith("symbol")||"symbol"===h&&r.startsWith("gradient"))continue;const i=r in Pre?Pre[r](p):n[r];if(void 0!==i){const a=Ure(i,r,n,e.fieldDef(t));(a||void 0===o.legend[r])&&s.set(r,i,a)}}const m=n?.encoding??{},g=s.get("selections"),y={},v={fieldOrDatumDef:c,model:e,channel:t,legendCmpt:s,legendType:h};for(const t of["labels","legend","title","symbols","gradient","entries"]){const n=Are(m[t]??{},e),r=t in Ore?Ore[t](n,v):n;void 0===r||m1(r)||(y[t]={...g?.length&&i9(c)?{name:`${x1(c.field)}_legend_${t}`}:{},...g?.length?{interactive:!!g}:{},update:r})}return m1(y)||s.set("encode",y,!!n?.encoding),s}function Wre(e,t){if(!e)return t.clone();const n=e.getWithExplicit("orient"),r=t.getWithExplicit("orient");if(n.explicit&&r.explicit&&n.value!==r.value)return;let i=!1;for(const n of Fre){const r=lte(e.getWithExplicit(n),t.getWithExplicit(n),n,"legend",((e,t)=>{switch(n){case"symbolType":return Hre(e,t);case"title":return p5(e,t);case"type":return i=!0,ate("symbol")}return ute(e,t,n,"legend")}));e.setWithExplicit(n,r)}return i&&(e.implicit?.encode?.gradient&&_1(e.implicit,["encode","gradient"]),e.explicit?.encode?.gradient&&_1(e.explicit,["encode","gradient"])),e}function Hre(e,t){return"circle"===t.value?t:e}function Vre(e){const t=e.component.legends,n={};for(const r of g1(t)){const i=e.getScaleComponent(r),o=t1(i.get("domains"));if(n[o])for(const e of n[o]){Wre(e,t[r])||n[o].push(t[r])}else n[o]=[t[r].clone()]}return y1(n).flat().map((t=>function(e,t){const{disable:n,labelExpr:r,selections:i,...o}=e.combine();if(n)return;!1===t.aria&&null==o.aria&&(o.aria=!1);if(o.encode?.symbols){const e=o.encode.symbols.update;!e.fill||"transparent"===e.fill.value||e.stroke||o.stroke||(e.stroke={value:"transparent"});for(const t of M7)o[t]&&delete e[t]}o.title||delete o.title;if(void 0!==r){let e=r;o.encode?.labels?.update&&G3(o.encode.labels.update.text)&&(e=D1(r,"datum.label",o.encode.labels.update.text.signal)),function(e,t,n,r){var i,o;e.encode??(e.encode={}),(i=e.encode)[t]??(i[t]={}),(o=e.encode[t]).update??(o.update={}),e.encode[t].update[n]=r}(o,"labels","text",{signal:e})}return o}(t,e.config))).filter((e=>void 0!==e))}function Gre(e){return woe(e)||xoe(e)?function(e){return e.children.reduce(((e,t)=>e.concat(t.assembleProjections())),Yre(e))}(e):Yre(e)}function Yre(e){const t=e.component.projection;if(!t||t.merged)return[];const n=t.combine(),{name:r}=n;if(t.data){const i={signal:`[${t.size.map((e=>e.signal)).join(", ")}]`},o=t.data.reduce(((t,n)=>{const r=G3(n)?n.signal:`data('${e.lookupDataSource(n)}')`;return i1(t,r)||t.push(r),t}),[]);if(o.length<=0)throw new Error("Projection's fit didn't find any data sources");return[{name:r,size:i,fit:{signal:o.length>1?`[${o.join(", ")}]`:o[0]},...n}]}return[{name:r,translate:{signal:"[width / 2, height / 2]"},...n}]}const Xre=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class Qre extends ite{constructor(e,t,n,r){super({...t},{name:e}),this.specifiedProjection=t,this.size=n,this.data=r,this.merged=!1}get isFit(){return!!this.data}}function Jre(e){e.component.projection=voe(e)?function(e){if(e.hasProjection){const t=W3(e.specifiedProjection),n=!(t&&(null!=t.scale||null!=t.translate)),r=n?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,i=n?function(e){const t=[],{encoding:n}=e;for(const r of[[J1,Q1],[Z1,K1]])(C9(n[r[0]])||C9(n[r[1]]))&&t.push({signal:e.getName(`geojson_${t.length}`)});e.channelHasField(r2)&&e.typedFieldDef(r2).type===f4&&t.push({signal:e.getName(`geojson_${t.length}`)});0===t.length&&t.push(e.requestDataName(vte.Main));return t}(e):void 0,o=new Qre(e.projectionName(!0),{...W3(e.config.projection)??{},...t??{}},r,i);return o.get("type")||o.set("type","equalEarth",!1),o}return}(e):function(e){if(0===e.children.length)return;let t;for(const t of e.children)Jre(t);const n=a1(e.children,(e=>{const n=e.component.projection;if(n){if(t){const e=function(e,t){const n=a1(Xre,(n=>!vy(e.explicit,n)&&!vy(t.explicit,n)||!!(vy(e.explicit,n)&&vy(t.explicit,n)&&J0(e.get(n),t.get(n)))));if(J0(e.size,t.size)){if(n)return e;if(J0(e.explicit,{}))return t;if(J0(t.explicit,{}))return e}return null}(t,n);return e&&(t=e),!!e}return t=n,!0}return!0}));if(t&&n){const n=e.projectionName(!0),r=new Qre(n,t.specifiedProjection,t.size,K0(t.data));for(const t of e.children){const e=t.component.projection;e&&(e.isFit&&r.data.push(...t.component.projection.data),t.renameProjection(e.get("name"),n),e.merged=!0)}return r}return}(e)}function Kre(e,t,n,r){if(R9(t,n)){const i=voe(e)?e.axis(n)??e.legend(n)??{}:{},o=y9(t,{expr:"datum"}),a=y9(t,{expr:"datum",binSuffix:"end"});return{formulaAs:y9(t,{binSuffix:"range",forAs:!0}),formula:I8(o,a,i.format,i.formatType,r)}}return{}}function Zre(e,t){return`${P3(e)}_${t}`}function eie(e,t,n){const r=Zre(N9(n,void 0)??{},t);return e.getName(`${r}_bins`)}function tie(e,t,n){let r,i;r=function(e){return"as"in e}(e)?My(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:[y9(e,{forAs:!0}),y9(e,{binSuffix:"end",forAs:!0})];const o={...N9(t,void 0)},a=Zre(o,e.field),{signal:s,extentSignal:u}=function(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)}}(n,a);if(j3(o.extent)){const e=o.extent;i=Wne(n,e.param,e),delete o.extent}return{key:a,binComponent:{bin:o,field:e.field,as:[r],...s?{signal:s}:{},...u?{extentSignal:u}:{},...i?{span:i}:{}}}}class nie extends Ste{constructor(e,t){super(e),this.bins=t}clone(){return new nie(null,K0(this.bins))}static makeFromEncoding(e,t){const n=t.reduceFieldDef(((e,n,r)=>{if(c9(n)&&L3(n.bin)){const{key:i,binComponent:o}=tie(n,n.bin,t);e[i]={...o,...e[i],...Kre(t,n,r,t.config)}}return e}),{});return m1(n)?null:new nie(e,n)}static makeFromTransform(e,t,n){const{key:r,binComponent:i}=tie(t,t.bin,n);return new nie(e,{[r]:i})}merge(e,t){for(const n of g1(e.bins))n in this.bins?(t(e.bins[n].signal,this.bins[n].signal),this.bins[n].as=l1([...this.bins[n].as,...e.bins[n].as],n1)):this.bins[n]=e.bins[n];for(const t of e.children)e.removeChild(t),t.parent=this;e.remove()}producedFields(){return new Set(y1(this.bins).map((e=>e.as)).flat(2))}dependentFields(){return new Set(y1(this.bins).map((e=>e.field)))}hash(){return`Bin ${n1(this.bins)}`}assemble(){return y1(this.bins).flatMap((e=>{const t=[],[n,...r]=e.as,{extent:i,...o}=e.bin,a={type:"bin",field:C1(e.field),as:n,signal:e.signal,...j3(i)?{extent:null}:{extent:i},...e.span?{span:{signal:`span(${e.span})`}}:{},...o};!i&&e.extentSignal&&(t.push({type:"extent",field:C1(e.field),signal:e.extentSignal}),a.extent={signal:e.extentSignal}),t.push(a);for(const e of r)for(let r=0;r<2;r++)t.push({type:"formula",expr:y9({field:n[r]},{expr:"datum"}),as:e[r]});return e.formula&&t.push({type:"formula",expr:e.formula,as:e.formulaAs}),t}))}}function rie(e,t,n,r){const i=voe(r)?r.encoding[U2(t)]:void 0;if(c9(n)&&voe(r)&&e9(n,i,r.markDef,r.config))e.add(y9(n,{})),e.add(y9(n,{suffix:"end"})),n.bin&&R9(n,t)&&e.add(y9(n,{binSuffix:"range"}));else if(t in w2){const n=function(e){switch(e){case Q1:return"y";case K1:return"y2";case J1:return"x";case Z1:return"x2"}}(t);e.add(r.getName(n))}else e.add(y9(n));return e}class iie extends Ste{constructor(e,t,n){super(e),this.dimensions=t,this.measures=n}clone(){return new iie(null,new Set(this.dimensions),K0(this.measures))}get groupBy(){return this.dimensions}static makeFromEncoding(e,t){let n=!1;t.forEachFieldDef((e=>{e.aggregate&&(n=!0)}));const r={},i=new Set;return n?(t.forEachFieldDef(((e,n)=>{const{aggregate:o,field:a}=e;if(o)if("count"===o)r["*"]??(r["*"]={}),r["*"].count=new Set([y9(e,{forAs:!0})]);else{if(F3(o)||N3(o)){const e=F3(o)?"argmin":"argmax",t=o[e];r[t]??(r[t]={}),r[t][e]=new Set([y9({op:e,field:t},{forAs:!0})])}else r[a]??(r[a]={}),r[a][o]=new Set([y9(e,{forAs:!0})]);_3(n)&&"unaggregated"===t.scaleDomain(n)&&(r[a]??(r[a]={}),r[a].min=new Set([y9({field:a,aggregate:"min"},{forAs:!0})]),r[a].max=new Set([y9({field:a,aggregate:"max"},{forAs:!0})]))}else rie(i,n,e,t)})),i.size+g1(r).length===0?null:new iie(e,i,r)):null}static makeFromTransform(e,t){const n=new Set,r={};for(const e of t.aggregate){const{op:t,field:n,as:i}=e;t&&("count"===t?(r["*"]??(r["*"]={}),r["*"].count=new Set([i||y9(e,{forAs:!0})])):(r[n]??(r[n]={}),r[n][t]=new Set([i||y9(e,{forAs:!0})])))}for(const e of t.groupby??[])n.add(e);return n.size+g1(r).length===0?null:new iie(e,n,r)}merge(e){return f1(this.dimensions,e.dimensions)?(function(e,t){for(const n of g1(t)){const r=t[n];for(const t of g1(r))n in e?e[n][t]=new Set([...e[n][t]??[],...r[t]]):e[n]={[t]:r[t]}}}(this.measures,e.measures),!0):(m5.debug("different dimensions, cannot merge"),!1)}addDimensions(e){e.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...g1(this.measures)])}producedFields(){const e=new Set;for(const t of g1(this.measures))for(const n of g1(this.measures[t])){const r=this.measures[t][n];0===r.size?e.add(`${n}_${t}`):r.forEach(e.add,e)}return e}hash(){return`Aggregate ${n1({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const e=[],t=[],n=[];for(const r of g1(this.measures))for(const i of g1(this.measures[r]))for(const o of this.measures[r][i])n.push(o),e.push(i),t.push("*"===r?null:C1(r));return{type:"aggregate",groupby:[...this.dimensions].map(C1),ops:e,fields:t,as:n}}}class oie extends Ste{constructor(e,t,n,r){super(e),this.model=t,this.name=n,this.data=r;for(const e of A2){const n=t.facet[e];if(n){const{bin:r,sort:i}=n;this[e]={name:t.getName(`${e}_domain`),fields:[y9(n),...L3(r)?[y9(n,{binSuffix:"end"})]:[]],...H8(i)?{sortField:i}:$g(i)?{sortIndexField:ore(n,e)}:{}}}}this.childModel=t.child}hash(){let e="Facet";for(const t of A2)this[t]&&(e+=` ${t.charAt(0)}:${n1(this[t])}`);return e}get fields(){const e=[];for(const t of A2)this[t]?.fields&&e.push(...this[t].fields);return e}dependentFields(){const e=new Set(this.fields);for(const t of A2)this[t]&&(this[t].sortField&&e.add(this[t].sortField.field),this[t].sortIndexField&&e.add(this[t].sortIndexField));return e}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const e={};for(const t of o3){const n=this.childModel.component.scales[t];if(n&&!n.merged){const r=n.get("type"),i=n.get("range");if(T4(r)&&Y3(i)){const n=Jie(Kie(this.childModel,t));n?e[t]=n:m5.warn(g5.unknownField(t))}}}return e}assembleRowColumnHeaderData(e,t,n){const r={row:"y",column:"x",facet:void 0}[e],i=[],o=[],a=[];r&&n&&n[r]&&(t?(i.push(`distinct_${n[r]}`),o.push("max")):(i.push(n[r]),o.push("distinct")),a.push(`distinct_${n[r]}`));const{sortField:s,sortIndexField:u}=this[e];if(s){const{op:e=j8,field:t}=s;i.push(t),o.push(e),a.push(y9(s,{forAs:!0}))}else u&&(i.push(u),o.push("max"),a.push(u));return{name:this[e].name,source:t??this.data,transform:[{type:"aggregate",groupby:this[e].fields,...i.length?{fields:i,ops:o,as:a}:{}}]}}assembleFacetHeaderData(e){const{columns:t}=this.model.layout,{layoutHeaders:n}=this.model.component,r=[],i={};for(const e of lre){for(const t of cre){const r=(n[e]&&n[e][t])??[];for(const t of r)if(t.axes?.length>0){i[e]=!0;break}}if(i[e]){const n=`length(data("${this.facet.name}"))`,i="row"===e?t?{signal:`ceil(${n} / ${t})`}:1:t?{signal:`min(${n}, ${t})`}:{signal:n};r.push({name:`${this.facet.name}_${e}`,transform:[{type:"sequence",start:0,stop:i}]})}}const{row:o,column:a}=i;return(o||a)&&r.unshift(this.assembleRowColumnHeaderData("facet",null,e)),r}assemble(){const e=[];let t=null;const n=this.getChildIndependentFieldsWithStep(),{column:r,row:i,facet:o}=this;if(r&&i&&(n.x||n.y)){t=`cross_${this.column.name}_${this.row.name}`;const r=[].concat(n.x??[],n.y??[]),i=r.map((()=>"distinct"));e.push({name:t,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:r,ops:i}]})}for(const r of[I1,B1])this[r]&&e.push(this.assembleRowColumnHeaderData(r,t,n));if(o){const t=this.assembleFacetHeaderData(n);t&&e.push(...t)}return e}}function aie(e){return"'"===e[0]&&"'"===e[e.length-1]||'"'===e[0]&&'"'===e[e.length-1]?e.slice(1,-1):e}function sie(e){const t={};return X0(e.filter,(e=>{if(t4(e)){let n=null;Y6(e)?n=e5(e.equal):Q6(e)?n=e5(e.lte):X6(e)?n=e5(e.lt):J6(e)?n=e5(e.gt):K6(e)?n=e5(e.gte):Z6(e)?n=e.range[0]:e4(e)&&(n=(e.oneOf??e.in)[0]),n&&(O6(n)?t[e.field]="date":Cy(n)?t[e.field]="number":My(n)&&(t[e.field]="string")),e.timeUnit&&(t[e.field]="date")}})),t}function uie(e){const t={};function n(e){var n;$9(e)?t[e.field]="date":"quantitative"===e.type&&(My(n=e.aggregate)&&i1(["min","max"],n))?t[e.field]="number":F1(e.field)>1?e.field in t||(t[e.field]="flatten"):d9(e)&&H8(e.sort)&&F1(e.sort.field)>1&&(e.sort.field in t||(t[e.sort.field]="flatten"))}if((voe(e)||boe(e))&&e.forEachFieldDef(((t,r)=>{if(c9(t))n(t);else{const i=I2(r),o=e.fieldDef(i);n({...t,type:o.type})}})),voe(e)){const{mark:n,markDef:r,encoding:i}=e;if(f8(n)&&!e.encoding.order){const e=i["horizontal"===r.orient?"y":"x"];i9(e)&&"quantitative"===e.type&&!(e.field in t)&&(t[e.field]="number")}}return t}class lie extends Ste{constructor(e,t){super(e),this._parse=t}clone(){return new lie(null,K0(this._parse))}hash(){return`Parse ${n1(this._parse)}`}static makeExplicit(e,t,n){let r={};const i=t.data;return!pte(i)&&i&&i.format&&i.format.parse&&(r=i.format.parse),this.makeWithAncestors(e,r,{},n)}static makeWithAncestors(e,t,n,r){for(const e of g1(n)){const t=r.getWithExplicit(e);void 0!==t.value&&(t.explicit||t.value===n[e]||"derived"===t.value||"flatten"===n[e]?delete n[e]:m5.warn(g5.differentParse(e,n[e],t.value)))}for(const e of g1(t)){const n=r.get(e);void 0!==n&&(n===t[e]?delete t[e]:m5.warn(g5.differentParse(e,t[e],n)))}const i=new ite(t,n);r.copyAll(i);const o={};for(const e of g1(i.combine())){const t=i.get(e);null!==t&&(o[e]=t)}return 0===g1(o).length||r.parseNothing?null:new lie(e,o)}get parse(){return this._parse}merge(e){this._parse={...this._parse,...e.parse},e.remove()}assembleFormatParse(){const e={};for(const t of g1(this._parse)){const n=this._parse[t];1===F1(t)&&(e[t]=n)}return e}producedFields(){return new Set(g1(this._parse))}dependentFields(){return new Set(g1(this._parse))}assembleTransforms(e=!1){return g1(this._parse).filter((t=>!e||F1(t)>1)).map((e=>{const t=function(e,t){const n=E1(e);if("number"===t)return`toNumber(${n})`;if("boolean"===t)return`toBoolean(${n})`;if("string"===t)return`toString(${n})`;if("date"===t)return`toDate(${n})`;if("flatten"===t)return n;if(t.startsWith("date:"))return`timeParse(${n},'${aie(t.slice(5,t.length))}')`;if(t.startsWith("utc:"))return`utcParse(${n},'${aie(t.slice(4,t.length))}')`;return m5.warn(g5.unrecognizedParse(t)),null}(e,this._parse[e]);if(!t)return null;return{type:"formula",expr:t,as:M1(e)}})).filter((e=>null!==e))}}class cie extends Ste{clone(){return new cie(null)}constructor(e){super(e)}dependentFields(){return new Set}producedFields(){return new Set([N7])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:N7}}}var fie={};class die extends Ste{constructor(e,t){super(e),this.params=t}clone(){return new die(null,this.params)}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${n1(this.params)}`}assemble(){return{type:"graticule",...!0===this.params?{}:this.params}}}class hie extends Ste{constructor(e,t){super(e),this.params=t}clone(){return new hie(null,this.params)}dependentFields(){return new Set}producedFields(){return new Set([this.params.as??"data"])}hash(){return`Hash ${n1(this.params)}`}assemble(){return{type:"sequence",...this.params}}}class pie extends Ste{constructor(e){let t;if(super(null),e??(e={name:"source"}),pte(e)||(t=e.format?{...e1(e.format,["parse"])}:{}),dte(e))this._data={values:e.values};else if(fte(e)){if(this._data={url:e.url},!t.type){let n=/(?:\.([^.]+))?$/.exec(e.url)[1];i1(["json","csv","tsv","dsv","topojson"],n)||(n="json"),t.type=n}}else gte(e)?this._data={values:[{type:"Sphere"}]}:(hte(e)||pte(e))&&(this._data={});this._generator=pte(e),e.name&&(this._name=e.name),t&&!m1(t)&&(this._data.format=t)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(e){this._name=e}set parent(e){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return{name:this._name,...this._data,transform:[]}}}var mie,gie=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n},yie=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)};function vie(e){return e instanceof pie||e instanceof die||e instanceof hie}t(fie,"isDataSourceNode",(function(){return vie}));class bie{constructor(){mie.set(this,void 0),gie(this,mie,!1)}setModified(){gie(this,mie,!0)}get modifiedFlag(){return yie(this,mie)}}t(fie,"Optimizer",(function(){return bie})),mie=new WeakMap;class xie extends bie{getNodeDepths(e,t,n){n.set(e,t);for(const r of e.children)this.getNodeDepths(r,t+1,n);return n}optimize(e){const t=[...this.getNodeDepths(e,0,new Map).entries()].sort(((e,t)=>t[1]-e[1]));for(const e of t)this.run(e[0]);return this.modifiedFlag}}t(fie,"BottomUpOptimizer",(function(){return xie}));class wie extends bie{optimize(e){this.run(e);for(const t of e.children)this.optimize(t);return this.modifiedFlag}}t(fie,"TopDownOptimizer",(function(){return wie}));class _ie extends fie.TopDownOptimizer{mergeNodes(e,t){const n=t.shift();for(const r of t)e.removeChild(r),r.parent=n,r.remove()}run(e){const t=e.children.map((e=>e.hash())),n={};for(let r=0;r<t.length;r++)void 0===n[t[r]]?n[t[r]]=[e.children[r]]:n[t[r]].push(e.children[r]);for(const t of g1(n))n[t].length>1&&(this.setModified(),this.mergeNodes(e,n[t]))}}class kie extends fie.TopDownOptimizer{constructor(e){super(),this.requiresSelectionId=e&&Pne(e)}run(e){e instanceof cie&&(this.requiresSelectionId&&(fie.isDataSourceNode(e.parent)||e.parent instanceof iie||e.parent instanceof lie)||(this.setModified(),e.remove()))}}class Eie extends fie.Optimizer{optimize(e){return this.run(e,new Set),this.modifiedFlag}run(e,t){let n=new Set;e instanceof Cte&&(n=e.producedFields(),d1(n,t)&&(this.setModified(),e.removeFormulas(t),0===e.producedFields.length&&e.remove()));for(const r of e.children)this.run(r,new Set([...t,...n]))}}class Sie extends fie.TopDownOptimizer{constructor(){super()}run(e){e instanceof Ate&&!e.isRequired()&&(this.setModified(),e.remove())}}class Aie extends fie.BottomUpOptimizer{run(e){if(!(fie.isDataSourceNode(e)||e.numChildren()>1))for(const t of e.children)if(t instanceof lie)if(e instanceof lie)this.setModified(),e.merge(t);else{if(p1(e.producedFields(),t.dependentFields()))continue;this.setModified(),t.swapWithParent()}}}class Cie extends fie.BottomUpOptimizer{run(e){const t=[...e.children],n=e.children.filter((e=>e instanceof lie));if(e.numChildren()>1&&n.length>=1){const r={},i=new Set;for(const e of n){const t=e.parse;for(const e of g1(t))e in r?r[e]!==t[e]&&i.add(e):r[e]=t[e]}for(const e of i)delete r[e];if(!m1(r)){this.setModified();const n=new lie(e,r);for(const i of t){if(i instanceof lie)for(const e of g1(r))delete i.parse[e];e.removeChild(i),i.parent=n,i instanceof lie&&0===g1(i.parse).length&&i.remove()}}}}}class Die extends fie.BottomUpOptimizer{run(e){e instanceof Ate||e.numChildren()>0||e instanceof oie||e instanceof pie||(this.setModified(),e.remove())}}class Mie extends fie.BottomUpOptimizer{run(e){const t=e.children.filter((e=>e instanceof Cte)),n=t.pop();for(const e of t)this.setModified(),n.merge(e)}}class Fie extends fie.BottomUpOptimizer{run(e){const t=e.children.filter((e=>e instanceof iie)),n={};for(const e of t){const t=n1(e.groupBy);t in n||(n[t]=[]),n[t].push(e)}for(const t of g1(n)){const r=n[t];if(r.length>1){const t=r.pop();for(const n of r)t.merge(n)&&(e.removeChild(n),n.parent=t,n.remove(),this.setModified())}}}}class Nie extends fie.BottomUpOptimizer{constructor(e){super(),this.model=e}run(e){const t=!(fie.isDataSourceNode(e)||e instanceof Une||e instanceof lie||e instanceof cie),n=[],r=[];for(const i of e.children)i instanceof nie&&(t&&!p1(e.producedFields(),i.dependentFields())?n.push(i):r.push(i));if(n.length>0){const t=n.pop();for(const e of n)t.merge(e,this.model.renameSignal.bind(this.model));this.setModified(),e instanceof nie?e.merge(t,this.model.renameSignal.bind(this.model)):t.swapWithParent()}if(r.length>1){const e=r.pop();for(const t of r)e.merge(t,this.model.renameSignal.bind(this.model));this.setModified()}}}class Oie extends fie.BottomUpOptimizer{run(e){const t=[...e.children];if(!o1(t,(e=>e instanceof Ate))||e.numChildren()<=1)return;const n=[];let r;for(const i of t)if(i instanceof Ate){let t=i;for(;1===t.numChildren();){const[e]=t.children;if(!(e instanceof Ate))break;t=e}n.push(...t.children),r?(e.removeChild(i),i.parent=r.parent,r.parent.removeChild(r),r.parent=t,this.setModified()):r=t}else n.push(i);if(n.length){this.setModified();for(const e of n)e.parent.removeChild(e),e.parent=r}}}class $ie extends Ste{constructor(e,t){super(e),this.transform=t}clone(){return new $ie(null,K0(this.transform))}addDimensions(e){this.transform.groupby=l1(this.transform.groupby.concat(e),(e=>e))}dependentFields(){const e=new Set;return this.transform.groupby&&this.transform.groupby.forEach(e.add,e),this.transform.joinaggregate.map((e=>e.field)).filter((e=>void 0!==e)).forEach(e.add,e),e}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(e){return e.as??y9(e)}hash(){return`JoinAggregateTransform ${n1(this.transform)}`}assemble(){const e=[],t=[],n=[];for(const r of this.transform.joinaggregate)t.push(r.op),n.push(this.getDefaultName(r)),e.push(void 0===r.field?null:r.field);const r=this.transform.groupby;return{type:"joinaggregate",as:n,ops:t,fields:e,...void 0!==r?{groupby:r}:{}}}}class Tie extends Ste{constructor(e,t){super(e),this._stack=t}clone(){return new Tie(null,K0(this._stack))}static makeFromTransform(e,t){const{stack:n,groupby:r,as:i,offset:o="zero"}=t,a=[],s=[];if(void 0!==t.sort)for(const e of t.sort)a.push(e.field),s.push(N1(e.order,"ascending"));const u={field:a,order:s};let l;return l=function(e){return $g(e)&&e.every((e=>My(e)))&&e.length>1}(i)?i:My(i)?[i,`${i}_end`]:[`${t.stack}_start`,`${t.stack}_end`],new Tie(e,{stackField:n,groupby:r,offset:o,sort:u,facetby:[],as:l})}static makeFromEncoding(e,t){const n=t.stack,{encoding:r}=t;if(!n)return null;const{groupbyChannel:i,fieldChannel:o,offset:a,impute:s}=n;let u;if(i){u=A9(r[i])}const l=function(e){return e.stack.stackBy.reduce(((e,t)=>{const n=y9(t.fieldDef);return n&&e.push(n),e}),[])}(t),c=t.encoding.order;let f;return f=$g(c)||i9(c)?f5(c):l.reduce(((e,t)=>(e.field.push(t),e.order.push("y"===o?"descending":"ascending"),e)),{field:[],order:[]}),new Tie(e,{dimensionFieldDef:u,stackField:t.vgField(o),facetby:[],stackby:l,sort:f,offset:a,impute:s,as:[t.vgField(o,{suffix:"start",forAs:!0}),t.vgField(o,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(e){this._stack.facetby.push(...e)}dependentFields(){const e=new Set;return e.add(this._stack.stackField),this.getGroupbyFields().forEach(e.add,e),this._stack.facetby.forEach(e.add,e),this._stack.sort.field.forEach(e.add,e),e}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${n1(this._stack)}`}getGroupbyFields(){const{dimensionFieldDef:e,impute:t,groupby:n}=this._stack;return e?e.bin?t?[y9(e,{binSuffix:"mid"})]:[y9(e,{}),y9(e,{binSuffix:"end"})]:[y9(e)]:n??[]}assemble(){const e=[],{facetby:t,dimensionFieldDef:n,stackField:r,stackby:i,sort:o,offset:a,impute:s,as:u}=this._stack;if(s&&n){const{bandPosition:o=.5,bin:a}=n;a&&e.push({type:"formula",expr:`${o}*`+y9(n,{expr:"datum"})+`+${1-o}*`+y9(n,{expr:"datum",binSuffix:"end"}),as:y9(n,{binSuffix:"mid",forAs:!0})}),e.push({type:"impute",field:r,groupby:[...i,...t],key:y9(n,{binSuffix:"mid"}),method:"value",value:0})}return e.push({type:"stack",groupby:[...this.getGroupbyFields(),...t],field:r,sort:o,as:u,offset:a}),e}}class zie extends Ste{constructor(e,t){super(e),this.transform=t}clone(){return new zie(null,K0(this.transform))}addDimensions(e){this.transform.groupby=l1(this.transform.groupby.concat(e),(e=>e))}dependentFields(){const e=new Set;return(this.transform.groupby??[]).forEach(e.add,e),(this.transform.sort??[]).forEach((t=>e.add(t.field))),this.transform.window.map((e=>e.field)).filter((e=>void 0!==e)).forEach(e.add,e),e}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(e){return e.as??y9(e)}hash(){return`WindowTransform ${n1(this.transform)}`}assemble(){const e=[],t=[],n=[],r=[];for(const i of this.transform.window)t.push(i.op),n.push(this.getDefaultName(i)),r.push(void 0===i.param?null:i.param),e.push(void 0===i.field?null:i.field);const i=this.transform.frame,o=this.transform.groupby;if(i&&null===i[0]&&null===i[1]&&t.every((e=>O3(e))))return{type:"joinaggregate",as:n,ops:t,fields:e,...void 0!==o?{groupby:o}:{}};const a=[],s=[];if(void 0!==this.transform.sort)for(const e of this.transform.sort)a.push(e.field),s.push(e.order??"ascending");const u={field:a,order:s},l=this.transform.ignorePeers;return{type:"window",params:r,as:n,ops:t,fields:e,sort:u,...void 0!==l?{ignorePeers:l}:{},...void 0!==o?{groupby:o}:{},...void 0!==i?{frame:i}:{}}}}function Rie(e){if(e instanceof oie)if(1!==e.numChildren()||e.children[0]instanceof Ate){const n=e.model.component.data.main;Pie(n);const r=(t=e,function e(n){if(!(n instanceof oie)){const r=n.clone();if(r instanceof Ate){const e=Lie+r.getSource();r.setSource(e),t.model.component.data.outputNodes[e]=r}else(r instanceof iie||r instanceof Tie||r instanceof zie||r instanceof $ie)&&r.addDimensions(t.fields);for(const t of n.children.flatMap(e))t.parent=r;return[r]}return n.children.flatMap(e)}),i=e.children.map(r).flat();for(const e of i)e.parent=n}else{const t=e.children[0];(t instanceof iie||t instanceof Tie||t instanceof zie||t instanceof $ie)&&t.addDimensions(e.fields),t.swapWithParent(),Rie(e)}else e.children.map(Rie);var t}function Pie(e){if(e instanceof Ate&&e.type===vte.Main&&1===e.numChildren()){const t=e.children[0];t instanceof oie||(t.swapWithParent(),Pie(e))}}const Lie="scale_";function Bie(e){for(const t of e){for(const e of t.children)if(e.parent!==t)return!1;if(!Bie(t.children))return!1}return!0}function Iie(e,t){let n=!1;for(const r of t)n=e.optimize(r)||n;return n}function jie(e,t,n){let r=e.sources,i=!1;return i=Iie(new Sie,r)||i,i=Iie(new kie(t),r)||i,r=r.filter((e=>e.numChildren()>0)),i=Iie(new Die,r)||i,r=r.filter((e=>e.numChildren()>0)),n||(i=Iie(new Aie,r)||i,i=Iie(new Nie(t),r)||i,i=Iie(new Eie,r)||i,i=Iie(new Cie,r)||i,i=Iie(new Fie,r)||i,i=Iie(new Mie,r)||i,i=Iie(new _ie,r)||i,i=Iie(new Oie,r)||i),e.sources=r,i}class Uie{constructor(e){Object.defineProperty(this,"signal",{enumerable:!0,get:e})}static fromName(e,t){return new Uie((()=>e(t)))}}function qie(e){voe(e)?function(e){const t=e.component.scales;for(const n of g1(t)){const r=Wie(e,n);if(t[n].setWithExplicit("domains",r),Yie(e,n),e.component.data.isFaceted){let t=e;for(;!boe(t)&&t.parent;)t=t.parent;if("shared"===t.component.resolve.scale[n])for(const e of r.value)X3(e)&&(e.data=Lie+e.data.replace(Lie,""))}}}(e):function(e){for(const t of e.children)qie(t);const t=e.component.scales;for(const n of g1(t)){let r,i=null;for(const t of e.children){const e=t.component.scales[n];if(e){r=void 0===r?e.getWithExplicit("domains"):lte(r,e.getWithExplicit("domains"),"domains","scale",Qie);const t=e.get("selectionExtent");i&&t&&i.param!==t.param&&m5.warn(g5.NEEDS_SAME_SELECTION),i=t}}t[n].setWithExplicit("domains",r),i&&t[n].set("selectionExtent",i,!0)}}(e)}function Wie(e,t){const n=e.getScaleComponent(t).get("type"),{encoding:r}=e,i=function(e,t,n,r){if("unaggregated"===e){const{valid:e,reason:r}=Xie(t,n);if(!e)return void m5.warn(r)}else if(void 0===e&&r.useUnaggregatedDomain){const{valid:e}=Xie(t,n);if(e)return"unaggregated"}return e}(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return i!==e.scaleDomain(t)&&(e.specifiedScales[t]={...e.specifiedScales[t],domain:i}),"x"===t&&C9(r.x2)?C9(r.x)?lte(Vie(n,i,e,"x"),Vie(n,i,e,"x2"),"domain","scale",Qie):Vie(n,i,e,"x2"):"y"===t&&C9(r.y2)?C9(r.y)?lte(Vie(n,i,e,"y"),Vie(n,i,e,"y2"),"domain","scale",Qie):Vie(n,i,e,"y2"):Vie(n,i,e,t)}function Hie(e,t,n){const r=G6(n)?.unit;return"temporal"===t||r?function(e,t,n){return e.map((e=>({signal:`{data: ${T9(e,{timeUnit:n,type:t})}}`})))}(e,t,r):[e]}function Vie(e,t,n,r){const{encoding:i}=n,o=C9(i[r]),{type:a}=o,s=o.timeUnit;if(function(e){return e&&e.unionWith}(t)){const i=Vie(e,void 0,n,r),o=Hie(t.unionWith,a,s);return ote([...i.value,...o])}if(G3(t))return ote([t]);if(t&&"unaggregated"!==t&&!L4(t))return ote(Hie(t,a,s));const u=n.stack;if(u&&r===u.fieldChannel){if("normalize"===u.offset)return ate([[0,1]]);const e=n.requestDataName(vte.Main);return ate([{data:e,field:n.vgField(r,{suffix:"start"})},{data:e,field:n.vgField(r,{suffix:"end"})}])}const l=_3(r)&&i9(o)?function(e,t,n){if(!T4(n))return;const r=e.fieldDef(t),i=r.sort;if(V8(i))return{op:"min",field:ore(r,t),order:"ascending"};const{stack:o}=e,a=o?[...o.groupbyField?[o.groupbyField]:[],...o.stackBy.map((e=>e.fieldDef.field))]:void 0;if(H8(i)){return Gie(i,o&&!i1(a,i.field))}if(W8(i)){const{encoding:t,order:n}=i,r=e.fieldDef(t),{aggregate:s,field:u}=r,l=o&&!i1(a,u);if(F3(s)||N3(s))return Gie({field:y9(r),order:n},l);if(O3(s)||!s)return Gie({op:s,field:u,order:n},l)}else{if("descending"===i)return{op:"min",field:e.vgField(t),order:"descending"};if(i1(["ascending",void 0],i))return!0}return}(n,r,e):void 0;if(a9(o)){return ate(Hie([o.datum],a,s))}const c=o;if("unaggregated"===t){const e=n.requestDataName(vte.Main),{field:t}=o;return ate([{data:e,field:y9({field:t,aggregate:"min"})},{data:e,field:y9({field:t,aggregate:"max"})}])}if(L3(c.bin)){if(T4(e))return ate("bin-ordinal"===e?[]:[{data:b1(l)?n.requestDataName(vte.Main):n.requestDataName(vte.Raw),field:n.vgField(r,R9(c,r)?{binSuffix:"range"}:{}),sort:!0!==l&&Tg(l)?l:{field:n.vgField(r,{}),op:"min"}}]);{const{bin:e}=c;if(L3(e)){const t=eie(n,c.field,e);return ate([new Uie((()=>{const e=n.getSignalName(t);return`[${e}.start, ${e}.stop]`}))])}return ate([{data:n.requestDataName(vte.Main),field:n.vgField(r,{})}])}}if(c.timeUnit&&i1(["time","utc"],e)&&e9(c,voe(n)?n.encoding[U2(r)]:void 0,n.markDef,n.config)){const e=n.requestDataName(vte.Main);return ate([{data:e,field:n.vgField(r)},{data:e,field:n.vgField(r,{suffix:"end"})}])}return ate(l?[{data:b1(l)?n.requestDataName(vte.Main):n.requestDataName(vte.Raw),field:n.vgField(r),sort:l}]:[{data:n.requestDataName(vte.Main),field:n.vgField(r)}])}function Gie(e,t){const{op:n,field:r,order:i}=e;return{op:n??(t?"sum":j8),...r?{field:C1(r)}:{},...i?{order:i}:{}}}function Yie(e,t){const n=e.component.scales[t],r=e.specifiedScales[t].domain,i=e.fieldDef(t)?.bin,o=L4(r)&&r,a=I3(i)&&j3(i.extent)&&i.extent;(o||a)&&n.set("selectionExtent",o??a,!0)}function Xie(e,t){const{aggregate:n,type:r}=e;return n?My(n)&&!R3[n]?{valid:!1,reason:g5.unaggregateDomainWithNonSharedDomainOp(n)}:"quantitative"===r&&"log"===t?{valid:!1,reason:g5.unaggregatedDomainWithLogScale(e)}:{valid:!0}:{valid:!1,reason:g5.unaggregateDomainHasNoEffectForRawField(e)}}function Qie(e,t,n,r){return e.explicit&&t.explicit&&m5.warn(g5.mergeConflictingDomainProperty(n,r,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function Jie(e){if(X3(e)&&My(e.field))return e.field;if(function(e){return!$g(e)&&"fields"in e&&!("data"in e)}(e)){let t;for(const n of e.fields)if(X3(n)&&My(n.field))if(t){if(t!==n.field)return m5.warn(g5.FACETED_INDEPENDENT_DIFFERENT_SOURCES),t}else t=n.field;return m5.warn(g5.FACETED_INDEPENDENT_SAME_FIELDS_DIFFERENT_SOURCES),t}if(function(e){return!$g(e)&&"fields"in e&&"data"in e}(e)){m5.warn(g5.FACETED_INDEPENDENT_SAME_SOURCE);const t=e.fields[0];return My(t)?t:void 0}}function Kie(e,t){return function(e){const t=l1(e.map((e=>{if(X3(e)){const{sort:t,...n}=e;return n}return e})),n1),n=l1(e.map((e=>{if(X3(e)){const t=e.sort;return void 0===t||b1(t)||("op"in t&&"count"===t.op&&delete t.field,"ascending"===t.order&&delete t.order),t}})).filter((e=>void 0!==e)),n1);if(0===t.length)return;if(1===t.length){const t=e[0];if(X3(t)&&n.length>0){let e=n[0];if(n.length>1)m5.warn(g5.MORE_THAN_ONE_SORT),e=!0;else if(Tg(e)&&"field"in e){const n=e.field;t.field===n&&(e=!e.order||{order:e.order})}return{...t,sort:e}}return t}const r=l1(n.map((e=>b1(e)||!("op"in e)||My(e.op)&&e.op in M3?e:(m5.warn(g5.domainSortDropped(e)),!0))),n1);let i;1===r.length?i=r[0]:r.length>1&&(m5.warn(g5.MORE_THAN_ONE_SORT),i=!0);const o=l1(e.map((e=>X3(e)?e.data:null)),(e=>e));if(1===o.length&&null!==o[0])return{data:o[0],fields:t.map((e=>e.field)),...i?{sort:i}:{}};return{fields:t,...i?{sort:i}:{}}}(e.component.scales[t].get("domains").map((t=>(X3(t)&&(t.data=e.lookupDataSource(t.data)),t))))}function Zie(e){return woe(e)||xoe(e)?e.children.reduce(((e,t)=>e.concat(Zie(t))),eoe(e)):eoe(e)}function eoe(e){return g1(e.component.scales).reduce(((t,n)=>{const r=e.component.scales[n];if(r.merged)return t;const i=r.combine(),{name:o,type:a,selectionExtent:s,domains:u,range:l,reverse:c,...f}=i,d=function(e,t,n,r){if(a3(n)){if(Y3(e))return{step:{signal:`${t}_step`}}}else if(Tg(e)&&X3(e))return{...e,data:r.lookupDataSource(e.data)};return e}(i.range,o,n,e),h=Kie(e,n),p=s?function(e,t,n,r){const i=Wne(e,t.param,t);return{signal:z4(n.get("type"))&&$g(r)&&r[0]>r[1]?`isValid(${i}) && reverse(${i})`:i}}(e,s,r,h):null;return t.push({name:o,type:a,...h?{domain:h}:{},...p?{domainRaw:p}:{},range:d,...void 0!==c?{reverse:c}:{},...f}),t}),[])}class toe extends ite{constructor(e,t){super({},{name:e}),this.merged=!1,this.setWithExplicit("type",t)}domainDefinitelyIncludesZero(){return!1!==this.get("zero")||o1(this.get("domains"),(e=>$g(e)&&2===e.length&&e[0]<=0&&e[1]>=0))}}const noe=["range","scheme"];function roe(e){return"x"===e?"width":"y"===e?"height":void 0}function ioe(e,t){const n=e.fieldDef(t);if(n?.bin){const{bin:r,field:i}=n,o=roe(t),a=e.getName(o);if(Tg(r)&&r.binned&&void 0!==r.step)return new Uie((()=>{const n=e.scaleName(t),i=`(domain("${n}")[1] - domain("${n}")[0]) / ${r.step}`;return`${e.getSignalName(a)} / (${i})`}));if(L3(r)){const t=eie(e,i,r);return new Uie((()=>{const n=e.getSignalName(t),r=`(${n}.stop - ${n}.start) / ${n}.step`;return`${e.getSignalName(a)} / (${r})`}))}}}function ooe(e,t){const n=t.specifiedScales[e],{size:r}=t,i=t.getScaleComponent(e).get("type");for(const r of noe)if(void 0!==n[r]){const o=Y4(i,r),a=X4(e,r);if(o)if(a)m5.warn(a);else switch(r){case"range":{const r=n.range;if($g(r)){if(a3(e))return ote(r.map((e=>{if("width"===e||"height"===e){const n=t.getName(e),r=t.getSignalName.bind(t);return Uie.fromName(r,n)}return e})))}else if(Tg(r))return ote({data:t.requestDataName(vte.Main),field:r.field,sort:{op:"min",field:t.vgField(e)}});return ote(r)}case"scheme":return ote(aoe(n[r]))}else m5.warn(g5.scalePropertyNotWorkWithScaleType(i,r,e))}if(e===U1||e===q1){const t=e===U1?"width":"height",n=r[t];if(I7(n)){if(T4(i))return ote({step:n.step});m5.warn(g5.stepDropped(t))}}const{rangeMin:o,rangeMax:a}=n,s=function(e,t){const{size:n,config:r,mark:i,encoding:o}=t,a=t.getSignalName.bind(t),{type:s}=C9(o[e]),u=t.getScaleComponent(e).get("type"),{domain:l,domainMid:c}=t.specifiedScales[e];switch(e){case U1:case q1:{if(i1(["point","band"],u))if(e!==U1||n.width){if(e===q1&&!n.height){const e=H7(r.view,"height");if(I7(e))return e}}else{const e=H7(r.view,"width");if(I7(e))return e}const i=roe(e),o=t.getName(i);return e===q1&&z4(u)?[Uie.fromName(a,o),0]:[0,Uie.fromName(a,o)]}case i2:{const o=soe(i,t.component.scales[e].get("zero"),r),a=function(e,t,n,r){const i={x:ioe(n,"x"),y:ioe(n,"y")};switch(e){case"bar":case"tick":{if(void 0!==r.scale.maxBandSize)return r.scale.maxBandSize;const e=loe(t,i,r.view);return Cy(e)?e-1:new Uie((()=>`${e.signal} - 1`))}case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":{if(r.scale.maxSize)return r.scale.maxSize;const e=loe(t,i,r.view);return Cy(e)?Math.pow(uoe*e,2):new Uie((()=>`pow(0.95 * ${e.signal}, 2)`))}}throw new Error(g5.incompatibleChannel("size",e))}(i,n,t,r);return P4(u)?function(e,t,n){const r=()=>{const r=i5(t),i=i5(e),o=`(${r} - ${i}) / (${n} - 1)`;return`sequence(${i}, ${r} + ${o}, ${o})`};return G3(t)?new Uie(r):{signal:r()}}(o,a,function(e,t,n,r){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return void 0!==n&&$g(n)?n.length+1:(m5.warn(g5.domainRequiredForThresholdScale(r)),3)}}(u,r,l,e)):[o,a]}case Y1:return[0,2*Math.PI];case o2:return[0,360];case V1:return[0,new Uie((()=>`min(${t.getSignalName("width")},${t.getSignalName("height")})/2`))];case l2:return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case c2:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case r2:return"symbol";case e2:case t2:case n2:return"ordinal"===u?"nominal"===s?"category":"ordinal":void 0!==c?"diverging":"rect"===i||"geoshape"===i?"heatmap":"ramp";case a2:case s2:case u2:return[r.scale.minOpacity,r.scale.maxOpacity]}throw new Error(`Scale range undefined for channel ${e}`)}(e,t);return(void 0!==o||void 0!==a)&&Y4(i,"rangeMin")&&$g(s)&&2===s.length?ote([o??s[0],a??s[1]]):ate(s)}function aoe(e){return function(e){return!My(e)&&!!e.name}(e)?{scheme:e.name,...e1(e,["name"])}:{scheme:e}}function soe(e,t,n){if(t)return G3(t)?{signal:`${t.signal} ? 0 : ${soe(e,!1,n)}`}:0;switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(g5.incompatibleChannel("size",e))}const uoe=.95;function loe(e,t,n){const r=I7(e.width)?e.width.step:W7(n,"width"),i=I7(e.height)?e.height.step:W7(n,"height");return t.x||t.y?new Uie((()=>`min(${[t.x?t.x.signal:r,t.y?t.y.signal:i].join(", ")})`)):Math.min(r,i)}function coe(e,t){voe(e)?function(e,t){const n=e.component.scales,{config:r,encoding:i,markDef:o,specifiedScales:a}=e;for(const s of g1(n)){const u=a[s],l=n[s],c=e.getScaleComponent(s),f=C9(i[s]),d=u[t],h=c.get("type"),p=c.get("padding"),m=c.get("paddingInner"),g=Y4(h,t),y=X4(s,t);if(void 0!==d&&(g?y&&m5.warn(y):m5.warn(g5.scalePropertyNotWorkWithScaleType(h,t,s))),g&&void 0===y)if(void 0!==d){const e=f.timeUnit,n=f.type;switch(t){case"domainMax":case"domainMin":O6(u[t])||"temporal"===n||e?l.set(t,{signal:T9(u[t],{type:n,timeUnit:e})},!0):l.set(t,u[t],!0);break;default:l.copyKeyFromObject(t,u)}}else{const n=t in foe?foe[t]({model:e,channel:s,fieldOrDatumDef:f,scaleType:h,scalePadding:p,scalePaddingInner:m,domain:u.domain,markDef:o,config:r}):r.scale[t];void 0!==n&&l.set(t,n,!1)}}}(e,t):hoe(e,t)}const foe={bins:({model:e,fieldOrDatumDef:t})=>i9(t)?function(e,t){const n=t.bin;if(L3(n)){const r=eie(e,t.field,n);return new Uie((()=>e.getSignalName(r)))}if(B3(n)&&I3(n)&&void 0!==n.step)return{step:n.step};return}(e,t):void 0,interpolate:({channel:e,fieldOrDatumDef:t})=>function(e,t){if(i1([e2,t2,n2],e)&&"nominal"!==t)return"hcl";return}(e,t.type),nice:({scaleType:e,channel:t,domain:n,fieldOrDatumDef:r})=>function(e,t,n,r){if(A9(r)?.bin||$g(n)||i1([y4,v4],e))return;return t in i3||void 0}(e,t,n,r),padding:({channel:e,scaleType:t,fieldOrDatumDef:n,markDef:r,config:i})=>function(e,t,n,r,i,o){if(e in i3){if(R4(t)){if(void 0!==n.continuousPadding)return n.continuousPadding;const{type:t,orient:a}=i;if("bar"===t&&(!i9(r)||!r.bin&&!r.timeUnit)&&("vertical"===a&&"x"===e||"horizontal"===a&&"y"===e))return o.continuousBandSize}if(t===_4)return n.pointPadding}return}(e,t,i.scale,n,r,i.bar),paddingInner:({scalePadding:e,channel:t,markDef:n,config:r})=>function(e,t,n,r){if(void 0!==e)return;if(t in i3){const{bandPaddingInner:e,barBandPaddingInner:t,rectBandPaddingInner:i}=r;return N1(e,"bar"===n?t:i)}return}(e,t,n.type,r.scale),paddingOuter:({scalePadding:e,channel:t,scaleType:n,markDef:r,scalePaddingInner:i,config:o})=>function(e,t,n,r,i,o){if(void 0!==e)return;if(t in i3&&n===k4){const{bandPaddingOuter:e}=o;return N1(e,G3(i)?{signal:`${i.signal}/2`}:i/2)}return}(e,t,n,r.type,i,o.scale),reverse:({fieldOrDatumDef:e,scaleType:t,channel:n,config:r})=>function(e,t,n,r){if("x"===n&&void 0!==r.xReverse)return z4(e)&&"descending"===t?G3(r.xReverse)?{signal:`!${r.xReverse.signal}`}:!r.xReverse:r.xReverse;if(z4(e)&&"descending"===t)return!0;return}(t,i9(e)?e.sort:void 0,n,r.scale),zero:({channel:e,fieldOrDatumDef:t,domain:n,markDef:r,scaleType:i})=>function(e,t,n,r,i){if(n&&"unaggregated"!==n&&z4(i)){if($g(n)){const e=n[0],t=n[n.length-1];if(e<=0&&t>=0)return!0}return!1}if("size"===e&&"quantitative"===t.type&&!P4(i))return!0;if((!i9(t)||!t.bin)&&i1([...o3,...u3],e)){const{orient:t,type:n}=r;return!i1(["bar","area","line","trail"],n)||!("horizontal"===t&&"y"===e||"vertical"===t&&"x"===e)}return!1}(e,t,n,r,i)};function doe(e){voe(e)?function(e){const t=e.component.scales;for(const n of w3){const r=t[n];if(!r)continue;const i=ooe(n,e);r.setWithExplicit("range",i)}}(e):hoe(e,"range")}function hoe(e,t){const n=e.component.scales;for(const n of e.children)"range"===t?doe(n):coe(n,t);for(const r of g1(n)){let i;for(const n of e.children){const e=n.component.scales[r];if(e){i=lte(i,e.getWithExplicit(t),t,"scale",ste(((e,n)=>{switch(t){case"range":return e.step&&n.step?e.step-n.step:0}return 0})))}}n[r].setWithExplicit(t,i)}}function poe(e,t,n,r){const i=function(e,t,n){switch(t.type){case"nominal":case"ordinal":if(E2(e)||"discrete"===C3(e))return"shape"===e&&"ordinal"===t.type&&m5.warn(g5.discreteChannelCannotEncode(e,"ordinal")),"ordinal";if(e in i3){if(i1(["rect","bar","image","rule"],n.type))return"band"}else if("arc"===n.type&&e in s3)return"band";return v8(n[q2(e)])||h9(t)&&t.axis?.tickBand?"band":"point";case"temporal":return E2(e)?"time":"discrete"===C3(e)?(m5.warn(g5.discreteChannelCannotEncode(e,"temporal")),"ordinal"):i9(t)&&t.timeUnit&&G6(t.timeUnit).utc?"utc":"time";case"quantitative":return E2(e)?i9(t)&&L3(t.bin)?"bin-ordinal":"linear":"discrete"===C3(e)?(m5.warn(g5.discreteChannelCannotEncode(e,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(g5.invalidFieldType(t.type))}(t,n,r),{type:o}=e;return _3(t)?void 0!==o?function(e,t){if(!_3(e))return!1;switch(e){case U1:case q1:case Y1:case V1:return R4(t)||i1(["band","point"],t);case i2:case l2:case a2:case s2:case u2:case o2:return R4(t)||P4(t)||i1(["band","point","ordinal"],t);case e2:case t2:case n2:return"band"!==t;case c2:case r2:return"ordinal"===t||P4(t)}}(t,o)?i9(n)&&(a=o,s=n.type,!(i1([u4,c4],s)?void 0===a||T4(a):s===l4?i1([y4,v4,void 0],a):s!==s4||i1([h4,p4,m4,g4,b4,x4,w4,d4,void 0],a)))?(m5.warn(g5.scaleTypeNotWorkWithFieldDef(o,i)),i):o:(m5.warn(g5.scaleTypeNotWorkWithChannel(t,o,i)),i):i:null;var a,s}function moe(e){voe(e)?e.component.scales=function(e){const{encoding:t,mark:n,markDef:r}=e;return w3.reduce(((i,o)=>{const a=C9(t[o]);if(a&&n===c8&&o===r2&&a.type===f4)return i;let s=a&&a.scale;if(a&&null!==s&&!1!==s){s??(s={});const t=poe(s,o,a,r);i[o]=new toe(e.scaleName(`${o}`,!0),{value:t,explicit:s.type===t})}return i}),{})}(e):e.component.scales=function(e){var t;const n=e.component.scales={},r={},i=e.component.resolve;for(const n of e.children){moe(n);for(const o of g1(n.component.scales))if((t=i.scale)[o]??(t[o]=Cre(o,e)),"shared"===i.scale[o]){const e=r[o],t=n.component.scales[o].getWithExplicit("type");e?S4(e.value,t.value)?r[o]=lte(e,t,"type","scale",goe):(i.scale[o]="independent",delete r[o]):r[o]=t}}for(const t of g1(r)){const i=e.scaleName(t,!0),o=r[t];n[t]=new toe(i,o);for(const n of e.children){const e=n.component.scales[t];e&&(n.renameScale(e.get("name"),i),e.merged=!0)}}return n}(e)}const goe=ste(((e,t)=>C4(e)-C4(t)));class yoe{constructor(){this.nameMap={}}rename(e,t){this.nameMap[e]=t}has(e){return void 0!==this.nameMap[e]}get(e){for(;this.nameMap[e]&&e!==this.nameMap[e];)e=this.nameMap[e];return e}}function voe(e){return"unit"===e?.type}function boe(e){return"facet"===e?.type}function xoe(e){return"concat"===e?.type}function woe(e){return"layer"===e?.type}class _oe{constructor(e,t,n,r,i,o,a){this.type=t,this.parent=n,this.config=i,this.correctDataNames=e=>(e.from&&e.from.data&&(e.from.data=this.lookupDataSource(e.from.data)),e.from&&e.from.facet&&e.from.facet.data&&(e.from.facet.data=this.lookupDataSource(e.from.facet.data)),e),this.parent=n,this.config=i,this.view=W3(a),this.name=e.name??r,this.title=V3(e.title)?{text:e.title}:e.title?W3(e.title):void 0,this.scaleNameMap=n?n.scaleNameMap:new yoe,this.projectionNameMap=n?n.projectionNameMap:new yoe,this.signalNameMap=n?n.signalNameMap:new yoe,this.data=e.data,this.description=e.description,this.transforms=(e.transform??[]).map((e=>Cee(e)?{filter:Q0(e.filter,o4)}:e)),this.layout="layer"===t||"unit"===t?{}:function(e,t,n){const r=n[t],i={},{spacing:o,columns:a}=r;void 0!==o&&(i.spacing=o),void 0!==a&&(X8(e)&&!G8(e.facet)||P7(e))&&(i.columns=a),L7(e)&&(i.columns=1);for(const t of U7)if(void 0!==e[t])if("spacing"===t){const n=e[t];i[t]=Cy(n)?n:{row:n.row??o,column:n.column??o}}else i[t]=e[t];return i}(e,t,i),this.component={data:{sources:n?n.component.data.sources:[],outputNodes:n?n.component.data.outputNodes:{},outputNodeRefCounts:n?n.component.data.outputNodeRefCounts:{},isFaceted:X8(e)||n&&n.component.data.isFaceted&&void 0===e.data},layoutSize:new ite,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:{scale:{},axis:{},legend:{},...o?K0(o):{}},selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){!function(e,{ignoreRange:t}={}){moe(e),qie(e);for(const t of G4)coe(e,t);t||doe(e)}(this)}parseProjection(){Jre(this)}renameTopLevelLayoutSizeSignal(){"width"!==this.getName("width")&&this.renameSignal(this.getName("width"),"width"),"height"!==this.getName("height")&&this.renameSignal(this.getName("height"),"height")}parseLegends(){jre(this)}assembleGroupStyle(){if("unit"===this.type||"layer"===this.type)return this.view?.style??"cell"}assembleEncodeFromView(e){const{style:t,...n}=e,r={};for(const e of g1(n)){const t=n[e];void 0!==t&&(r[e]=n5(t))}return r}assembleGroupEncodeEntry(e){let t={};return this.view&&(t=this.assembleEncodeFromView(this.view)),e||(this.description&&(t.description=n5(this.description)),"unit"!==this.type&&"layer"!==this.type)?m1(t)?void 0:t:{width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height"),...t??{}}}assembleLayout(){if(!this.layout)return;const{spacing:e,...t}=this.layout,{component:n,config:r}=this,i=function(e,t){const n={};for(const r of A2){const i=e[r];if(i?.facetFieldDef){const{titleAnchor:e,titleOrient:o}=ure(["titleAnchor","titleOrient"],i.facetFieldDef.header,t,r),a=are(r,o),s=bre(e,a);void 0!==s&&(n[a]=s)}}return m1(n)?void 0:n}(n.layoutHeaders,r);return{padding:e,...this.assembleDefaultLayout(),...t,...i?{titleBand:i}:{}}}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:e}=this.component;let t=[];for(const n of A2)e[n].title&&t.push(fre(this,n));for(const e of lre)t=t.concat(pre(this,e));return t}assembleAxes(){return function(e,t){const{x:n=[],y:r=[]}=e;return[...n.map((e=>Gne(e,"grid",t))),...r.map((e=>Gne(e,"grid",t))),...n.map((e=>Gne(e,"main",t))),...r.map((e=>Gne(e,"main",t)))].filter((e=>e))}(this.component.axes,this.config)}assembleLegends(){return Vre(this)}assembleProjections(){return Gre(this)}assembleTitle(){const{encoding:e,...t}=this.title??{},n={...H3(this.config.title).nonMark,...t,...e?{encode:{update:e}}:{}};if(n.text)return i1(["unit","layer"],this.type)?i1(["middle",void 0],n.anchor)&&(n.frame??(n.frame="group")):n.anchor??(n.anchor="start"),m1(n)?void 0:n}assembleGroup(e=[]){const t={};(e=e.concat(this.assembleSignals())).length>0&&(t.signals=e);const n=this.assembleLayout();n&&(t.layout=n),t.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const r=!this.parent||boe(this.parent)?Zie(this):[];r.length>0&&(t.scales=r);const i=this.assembleAxes();i.length>0&&(t.axes=i);const o=this.assembleLegends();return o.length>0&&(t.legends=o),t}getName(e){return x1((this.name?`${this.name}_`:"")+e)}getDataName(e){return this.getName(vte[e].toLowerCase())}requestDataName(e){const t=this.getDataName(e),n=this.component.data.outputNodeRefCounts;return n[t]=(n[t]||0)+1,t}getSizeSignalRef(e){if(boe(this.parent)){const t=l3(Sre(e)),n=this.component.scales[t];if(n&&!n.merged){const e=n.get("type"),r=n.get("range");if(T4(e)&&Y3(r)){const e=n.get("name"),r=Jie(Kie(this,t));if(r){return{signal:Ere(e,n,y9({aggregate:"distinct",field:r},{expr:"datum"}))}}return m5.warn(g5.unknownField(t)),null}}}return{signal:this.signalNameMap.get(this.getName(e))}}lookupDataSource(e){const t=this.component.data.outputNodes[e];return t?t.getSource():e}getSignalName(e){return this.signalNameMap.get(e)}renameSignal(e,t){this.signalNameMap.rename(e,t)}renameScale(e,t){this.scaleNameMap.rename(e,t)}renameProjection(e,t){this.projectionNameMap.rename(e,t)}scaleName(e,t){return t?this.getName(e):P2(e)&&_3(e)&&this.component.scales[e]||this.scaleNameMap.has(this.getName(e))?this.scaleNameMap.get(this.getName(e)):void 0}projectionName(e){return e?this.getName("projection"):this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection"))?this.projectionNameMap.get(this.getName("projection")):void 0}getScaleComponent(e){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const t=this.component.scales[e];return t&&!t.merged?t:this.parent?this.parent.getScaleComponent(e):void 0}getSelectionComponent(e,t){let n=this.component.selection[e];if(!n&&this.parent&&(n=this.parent.getSelectionComponent(e,t)),!n)throw new Error(g5.selectionNotFound(t));return n}hasAxisOrientSignalRef(){return this.component.axes.x?.some?.((e=>e.hasOrientSignalRef()))||this.component.axes.y?.some?.((e=>e.hasOrientSignalRef()))}}class koe extends _oe{vgField(e,t={}){const n=this.fieldDef(e);if(n)return y9(n,t)}reduceFieldDef(e,t){return function(e,t,n,r){return e?g1(e).reduce(((n,i)=>{const o=e[i];return $g(o)?o.reduce(((e,n)=>t.call(r,e,n,i)),n):t.call(r,n,o,i)}),n):n}(this.getMapping(),((t,n,r)=>{const i=A9(n);return i?e(t,i,r):t}),t)}forEachFieldDef(e,t){K9(this.getMapping(),((t,n)=>{const r=A9(t);r&&e(r,n)}),t)}}class Eoe extends Ste{constructor(e,t){super(e),this.transform=t,this.transform=K0(t);const n=this.transform.as??[void 0,void 0];this.transform.as=[n[0]??"value",n[1]??"density"]}clone(){return new Eoe(null,K0(this.transform))}dependentFields(){return new Set([this.transform.density,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${n1(this.transform)}`}assemble(){const{density:e,...t}=this.transform;return{type:"kde",field:e,...t}}}class Soe extends Ste{constructor(e,t){super(e),this.filter=t}clone(){return new Soe(null,{...this.filter})}static make(e,t){const{config:n,mark:r,markDef:i}=t;if("filter"!==s5("invalid",i,n))return null;const o=t.reduceFieldDef(((e,n,i)=>{const o=_3(i)&&t.getScaleComponent(i);if(o){z4(o.get("type"))&&"count"!==n.aggregate&&!f8(r)&&(e[n.field]=n)}return e}),{});return g1(o).length?new Soe(e,o):null}dependentFields(){return new Set(g1(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${n1(this.filter)}`}assemble(){const e=g1(this.filter).reduce(((e,t)=>{const n=this.filter[t],r=y9(n,{expr:"datum"});return null!==n&&("temporal"===n.type?e.push(`(isDate(${r}) || (isValid(${r}) && isFinite(+${r})))`):"quantitative"===n.type&&(e.push(`isValid(${r})`),e.push(`isFinite(+${r})`))),e}),[]);return e.length>0?{type:"filter",expr:e.join(" && ")}:null}}class Aoe extends Ste{constructor(e,t){super(e),this.transform=t,this.transform=K0(t);const{flatten:n,as:r=[]}=this.transform;this.transform.as=n.map(((e,t)=>r[t]??e))}clone(){return new Aoe(this.parent,K0(this.transform))}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${n1(this.transform)}`}assemble(){const{flatten:e,as:t}=this.transform;return{type:"flatten",fields:e,as:t}}}class Coe extends Ste{constructor(e,t){super(e),this.transform=t,this.transform=K0(t);const n=this.transform.as??[void 0,void 0];this.transform.as=[n[0]??"key",n[1]??"value"]}clone(){return new Coe(null,K0(this.transform))}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${n1(this.transform)}`}assemble(){const{fold:e,as:t}=this.transform;return{type:"fold",fields:e,as:t}}}class Doe extends Ste{constructor(e,t,n,r){super(e),this.fields=t,this.geojson=n,this.signal=r}clone(){return new Doe(null,K0(this.fields),this.geojson,this.signal)}static parseAll(e,t){if(t.component.projection&&!t.component.projection.isFit)return e;let n=0;for(const r of[[J1,Q1],[Z1,K1]]){const i=r.map((e=>{const n=C9(t.encoding[e]);return i9(n)?n.field:a9(n)?{expr:`${n.datum}`}:f9(n)?{expr:`${n.value}`}:void 0}));(i[0]||i[1])&&(e=new Doe(e,i,null,t.getName("geojson_"+n++)))}if(t.channelHasField(r2)){const r=t.typedFieldDef(r2);r.type===f4&&(e=new Doe(e,null,r.field,t.getName("geojson_"+n++)))}return e}dependentFields(){const e=(this.fields??[]).filter(My);return new Set([...this.geojson?[this.geojson]:[],...e])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${n1(this.fields)}`}assemble(){return[...this.geojson?[{type:"filter",expr:`isValid(datum["${this.geojson}"])`}]:[],{type:"geojson",...this.fields?{fields:this.fields}:{},...this.geojson?{geojson:this.geojson}:{},signal:this.signal}]}}class Moe extends Ste{constructor(e,t,n,r){super(e),this.projection=t,this.fields=n,this.as=r}clone(){return new Moe(null,this.projection,K0(this.fields),K0(this.as))}static parseAll(e,t){if(!t.projectionName())return e;for(const n of[[J1,Q1],[Z1,K1]]){const r=n.map((e=>{const n=C9(t.encoding[e]);return i9(n)?n.field:a9(n)?{expr:`${n.datum}`}:f9(n)?{expr:`${n.value}`}:void 0})),i=n[0]===Z1?"2":"";(r[0]||r[1])&&(e=new Moe(e,t.projectionName(),r,[t.getName(`x${i}`),t.getName(`y${i}`)]))}return e}dependentFields(){return new Set(this.fields.filter(My))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${n1(this.fields)} ${n1(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class Foe extends Ste{constructor(e,t){super(e),this.transform=t}clone(){return new Foe(null,K0(this.transform))}dependentFields(){return new Set([this.transform.impute,this.transform.key,...this.transform.groupby??[]])}producedFields(){return new Set([this.transform.impute])}processSequence(e){const{start:t=0,stop:n,step:r}=e;return{signal:`sequence(${[t,n,...r?[r]:[]].join(",")})`}}static makeFromTransform(e,t){return new Foe(e,t)}static makeFromEncoding(e,t){const n=t.encoding,r=n.x,i=n.y;if(i9(r)&&i9(i)){const o=r.impute?r:i.impute?i:void 0;if(void 0===o)return;const a=r.impute?i:i.impute?r:void 0,{method:s,value:u,frame:l,keyvals:c}=o.impute,f=Z9(t.mark,n);return new Foe(e,{impute:o.field,key:a.field,...s?{method:s}:{},...void 0!==u?{value:u}:{},...l?{frame:l}:{},...void 0!==c?{keyvals:c}:{},...f.length?{groupby:f}:{}})}return null}hash(){return`Impute ${n1(this.transform)}`}assemble(){const{impute:e,key:t,keyvals:n,method:r,groupby:i,value:o,frame:a=[null,null]}=this.transform,s={type:"impute",field:e,key:t,...n?{keyvals:(u=n,void 0!==u?.stop?this.processSequence(n):n)}:{},method:"value",...i?{groupby:i}:{},value:r&&"value"!==r?null:o};var u;if(r&&"value"!==r){return[s,{type:"window",as:[`imputed_${e}_value`],ops:[r],fields:[e],frame:a,ignorePeers:!1,...i?{groupby:i}:{}},{type:"formula",expr:`datum.${e} === null ? datum.imputed_${e}_value : datum.${e}`,as:e}]}return[s]}}class Noe extends Ste{constructor(e,t){super(e),this.transform=t,this.transform=K0(t);const n=this.transform.as??[void 0,void 0];this.transform.as=[n[0]??t.on,n[1]??t.loess]}clone(){return new Noe(null,K0(this.transform))}dependentFields(){return new Set([this.transform.loess,this.transform.on,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${n1(this.transform)}`}assemble(){const{loess:e,on:t,...n}=this.transform;return{type:"loess",x:t,y:e,...n}}}class Ooe extends Ste{constructor(e,t,n){super(e),this.transform=t,this.secondary=n}clone(){return new Ooe(null,K0(this.transform),this.secondary)}static make(e,t,n,r){const i=t.component.data.sources,{from:o}=n;let a=null;if(function(e){return"data"in e}(o)){let e=Voe(o.data,i);e||(e=new pie(o.data),i.push(e));const n=t.getName(`lookup_${r}`);a=new Ate(e,n,vte.Lookup,t.component.data.outputNodeRefCounts),t.component.data.outputNodes[n]=a}else if(function(e){return"param"in e}(o)){const e=o.param;let r;n={as:e,...n};try{r=t.getSelectionComponent(x1(e),e)}catch(t){throw new Error(g5.cannotLookupVariableParameter(e))}if(a=r.materialized,!a)throw new Error(g5.noSameUnitLookup(e))}return new Ooe(e,n,a.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?iy(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${n1({transform:this.transform,secondary:this.secondary})}`}assemble(){let e;if(this.transform.from.fields)e={values:this.transform.from.fields,...this.transform.as?{as:iy(this.transform.as)}:{}};else{let t=this.transform.as;My(t)||(m5.warn(g5.NO_FIELDS_NEEDS_AS),t="_lookup"),e={as:[t]}}return{type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup],...e,...this.transform.default?{default:this.transform.default}:{}}}}class $oe extends Ste{constructor(e,t){super(e),this.transform=t,this.transform=K0(t);const n=this.transform.as??[void 0,void 0];this.transform.as=[n[0]??"prob",n[1]??"value"]}clone(){return new $oe(null,K0(this.transform))}dependentFields(){return new Set([this.transform.quantile,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${n1(this.transform)}`}assemble(){const{quantile:e,...t}=this.transform;return{type:"quantile",field:e,...t}}}class Toe extends Ste{constructor(e,t){super(e),this.transform=t,this.transform=K0(t);const n=this.transform.as??[void 0,void 0];this.transform.as=[n[0]??t.on,n[1]??t.regression]}clone(){return new Toe(null,K0(this.transform))}dependentFields(){return new Set([this.transform.regression,this.transform.on,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${n1(this.transform)}`}assemble(){const{regression:e,on:t,...n}=this.transform;return{type:"regression",x:t,y:e,...n}}}class zoe extends Ste{constructor(e,t){super(e),this.transform=t}clone(){return new zoe(null,K0(this.transform))}addDimensions(e){this.transform.groupby=l1((this.transform.groupby??[]).concat(e),(e=>e))}producedFields(){}dependentFields(){return new Set([this.transform.pivot,this.transform.value,...this.transform.groupby??[]])}hash(){return`PivotTransform ${n1(this.transform)}`}assemble(){const{pivot:e,value:t,groupby:n,limit:r,op:i}=this.transform;return{type:"pivot",field:e,value:t,...void 0!==r?{limit:r}:{},...void 0!==i?{op:i}:{},...void 0!==n?{groupby:n}:{}}}}class Roe extends Ste{constructor(e,t){super(e),this.transform=t}clone(){return new Roe(null,K0(this.transform))}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${n1(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function Poe(e){let t=0;return function n(r,i){if(r instanceof pie&&!r.isGenerator&&!fte(r.data)){e.push(i);i={name:null,source:i.name,transform:[]}}if(r instanceof lie&&(r.parent instanceof pie&&!i.source?(i.format={...i.format??{},parse:r.assembleFormatParse()},i.transform.push(...r.assembleTransforms(!0))):i.transform.push(...r.assembleTransforms())),r instanceof oie)return i.name||(i.name="data_"+t++),!i.source||i.transform.length>0?(e.push(i),r.data=i.name):r.data=i.source,void e.push(...r.assemble());if((r instanceof die||r instanceof hie||r instanceof Soe||r instanceof Une||r instanceof ire||r instanceof Moe||r instanceof iie||r instanceof Ooe||r instanceof zie||r instanceof $ie||r instanceof Coe||r instanceof Aoe||r instanceof Eoe||r instanceof Noe||r instanceof $oe||r instanceof Toe||r instanceof cie||r instanceof Roe||r instanceof zoe)&&i.transform.push(r.assemble()),(r instanceof nie||r instanceof Cte||r instanceof Foe||r instanceof Tie||r instanceof Doe)&&i.transform.push(...r.assemble()),r instanceof Ate)if(i.source&&0===i.transform.length)r.setSource(i.source);else if(r.parent instanceof Ate)r.setSource(i.name);else if(i.name||(i.name="data_"+t++),r.setSource(i.name),1===r.numChildren()){e.push(i);i={name:null,source:i.name,transform:[]}}switch(r.numChildren()){case 0:r instanceof Ate&&(!i.source||i.transform.length>0)&&e.push(i);break;case 1:n(r.children[0],i);break;default:{i.name||(i.name="data_"+t++);let o=i.name;!i.source||i.transform.length>0?e.push(i):o=i.source;for(const e of r.children){n(e,{name:null,source:o,transform:[]})}break}}}}function Loe(e,t){const{facet:n,config:r,child:i,component:o}=e;if(e.channelHasField(t)){const a=n[t],s=sre("title",null,r,t);let u=_9(a,r,{allowDisabling:!0,includeDefault:void 0===s||!!s});i.component.layoutHeaders[t].title&&(u=$g(u)?u.join(", "):u,u+=` / ${i.component.layoutHeaders[t].title}`,i.component.layoutHeaders[t].title=null);const l=sre("labelOrient",a.header,r,t),c=null!==a.header&&N1(a.header?.labels,r.header.labels,!0),f=i1(["bottom","right"],l)?"footer":"header";o.layoutHeaders[t]={title:null!==a.header?u:null,facetFieldDef:a,[f]:"facet"===t?[]:[Boe(e,t,c)]}}}function Boe(e,t,n){const r="row"===t?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(r)?e.child.getSizeSignalRef(r):void 0,axes:[]}}function Ioe(e,t){const{child:n}=e;if(n.component.axes[t]){const{layoutHeaders:i,resolve:o}=e.component;if(o.axis[t]=Dre(o,t),"shared"===o.axis[t]){const o="x"===t?"column":"row",a=i[o];for(const i of n.component.axes[t]){const t="top"===(r=i.get("orient"))||"left"===r||G3(r)?"header":"footer";a[t]??(a[t]=[Boe(e,o,!1)]);const n=Gne(i,"main",e.config,{header:!0});n&&a[t][0].axes.push(n),i.mainExtracted=!0}}}var r}function joe(e){for(const t of e.children)t.parseLayoutSize()}function Uoe(e,t){const n=Sre(t),r=l3(n),i=e.component.resolve,o=e.component.layoutSize;let a;for(const t of e.children){const o=t.component.layoutSize.getWithExplicit(n),s=i.scale[r]??Cre(r,e);if("independent"===s&&"step"===o.value){a=void 0;break}if(a){if("independent"===s&&a.value!==o.value){a=void 0;break}a=lte(a,o,n,"")}else a=o}if(a){for(const r of e.children)e.renameSignal(r.getName(n),e.getName(t)),r.component.layoutSize.set(n,"merged",!1);o.setWithExplicit(t,a)}else o.setWithExplicit(t,{explicit:!1,value:void 0})}function qoe(e,t){const n="width"===t?"x":"y",r=e.config,i=e.getScaleComponent(n);if(i){const e=i.get("type"),n=i.get("range");if(T4(e)){const e=H7(r.view,t);return Y3(n)||I7(e)?"step":e}return q7(r.view,t)}if(e.hasProjection||"arc"===e.mark)return q7(r.view,t);{const e=H7(r.view,t);return I7(e)?e.step:e}}function Woe(e,t,n){return y9(t,{suffix:`by_${y9(e)}`,...n??{}})}class Hoe extends koe{constructor(e,t,n,r){super(e,"facet",t,n,r,e.resolve),this.child=yae(e.spec,this,this.getName("child"),void 0,r),this.children=[this.child],this.facet=this.initFacet(e.facet)}initFacet(e){if(!G8(e))return{facet:this.initFacetFieldDef(e,"facet")};const t=g1(e),n={};for(const r of t){if(![B1,I1].includes(r)){m5.warn(g5.incompatibleChannel(r,"facet"));break}const t=e[r];if(void 0===t.field){m5.warn(g5.emptyFieldDef(t,r));break}n[r]=this.initFacetFieldDef(t,r)}return n}initFacetFieldDef(e,t){const n=F9(e,t);return n.header?n.header=W3(n.header):null===n.header&&(n.header=null),n}channelHasField(e){return!!this.facet[e]}fieldDef(e){return this.facet[e]}parseData(){this.component.data=Goe(this),this.child.parseData()}parseLayoutSize(){joe(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),function(e){for(const t of A2)Loe(e,t);Ioe(e,"x"),Ioe(e,"y")}(this)}assembleSelectionTopLevelSignals(e){return this.child.assembleSelectionTopLevelSignals(e)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(e){return this.child.assembleSelectionData(e)}getHeaderLayoutMixins(){const e={};for(const t of A2)for(const n of cre){const r=this.component.layoutHeaders[t],i=r[n],{facetFieldDef:o}=r;if(o){const n=sre("titleOrient",o.header,this.config,t);if(["right","bottom"].includes(n)){const r=are(t,n);e.titleAnchor??(e.titleAnchor={}),e.titleAnchor[r]="end"}}if(i?.[0]){const i="row"===t?"height":"width",o="header"===n?"headerBand":"footerBand";"facet"===t||this.child.component.layoutSize.get(i)||(e[o]??(e[o]={}),e[o][t]=.5),r.title&&(e.offset??(e.offset={}),e.offset["row"===t?"rowTitle":"columnTitle"]=10)}}return e}assembleDefaultLayout(){const{column:e,row:t}=this.facet,n=e?this.columnDistinctSignal():t?1:void 0;let r="all";return(t||"independent"!==this.component.resolve.scale.x)&&(e||"independent"!==this.component.resolve.scale.y)||(r="none"),{...this.getHeaderLayoutMixins(),...n?{columns:n}:{},bounds:"full",align:r}}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof Hoe)){return{signal:`length(data('${this.getName("column_domain")}'))`}}}assembleGroup(e){return this.parent&&this.parent instanceof Hoe?{...this.channelHasField("column")?{encode:{update:{columns:{field:y9(this.facet.column,{prefix:"distinct"})}}}}:{},...super.assembleGroup(e)}:super.assembleGroup(e)}getCardinalityAggregateForChild(){const e=[],t=[],n=[];if(this.child instanceof Hoe){if(this.child.channelHasField("column")){const r=y9(this.child.facet.column);e.push(r),t.push("distinct"),n.push(`distinct_${r}`)}}else for(const r of o3){const i=this.child.component.scales[r];if(i&&!i.merged){const o=i.get("type"),a=i.get("range");if(T4(o)&&Y3(a)){const i=Jie(Kie(this.child,r));i?(e.push(i),t.push("distinct"),n.push(`distinct_${i}`)):m5.warn(g5.unknownField(r))}}}return{fields:e,ops:t,as:n}}assembleFacet(){const{name:e,data:t}=this.component.data.facetRoot,{row:n,column:r}=this.facet,{fields:i,ops:o,as:a}=this.getCardinalityAggregateForChild(),s=[];for(const e of A2){const t=this.facet[e];if(t){s.push(y9(t));const{bin:u,sort:l}=t;if(L3(u)&&s.push(y9(t,{binSuffix:"end"})),H8(l)){const{field:e,op:s=j8}=l,u=Woe(t,l);n&&r?(i.push(u),o.push("max"),a.push(u)):(i.push(e),o.push(s),a.push(u))}else if($g(l)){const n=ore(t,e);i.push(n),o.push("max"),a.push(n)}}}const u=!!n&&!!r;return{name:e,data:t,groupby:s,...u||i.length>0?{aggregate:{...u?{cross:u}:{},...i.length?{fields:i,ops:o,as:a}:{}}}:{}}}facetSortFields(e){const{facet:t}=this,n=t[e];return n?H8(n.sort)?[Woe(n,n.sort,{expr:"datum"})]:$g(n.sort)?[ore(n,e,{expr:"datum"})]:[y9(n,{expr:"datum"})]:[]}facetSortOrder(e){const{facet:t}=this,n=t[e];if(n){const{sort:e}=n;return[(H8(e)?e.order:!$g(e)&&e)||"ascending"]}return[]}assembleLabelTitle(){const{facet:e,config:t}=this;if(e.facet)return gre(e.facet,"facet",t);const n={row:["top","bottom"],column:["left","right"]};for(const r of lre)if(e[r]){const i=sre("labelOrient",e[r]?.header,t,r);if(n[r].includes(i))return gre(e[r],r,t)}}assembleMarks(){const{child:e}=this,t=function(e){const t=[],n=Poe(t);for(const t of e.children)n(t,{source:e.name,name:null,transform:[]});return t}(this.component.data.facetRoot),n=e.assembleGroupEncodeEntry(!1),r=this.assembleLabelTitle()||e.assembleTitle(),i=e.assembleGroupStyle();return[{name:this.getName("cell"),type:"group",...r?{title:r}:{},...i?{style:i}:{},from:{facet:this.assembleFacet()},sort:{field:A2.map((e=>this.facetSortFields(e))).flat(),order:A2.map((e=>this.facetSortOrder(e))).flat()},...t.length>0?{data:t}:{},...n?{encode:{update:n}}:{},...e.assembleGroup(_te(this,[]))}]}getMapping(){return this.facet}}function Voe(e,t){for(const n of t){const t=n.data;if(e.name&&n.hasName()&&e.name!==n.dataName)continue;const r=e.format?.mesh,i=t.format?.feature;if(r&&i)continue;const o=e.format?.feature;if((o||i)&&o!==i)continue;const a=t.format?.mesh;if(!r&&!a||r===a)if(dte(e)&&dte(t)){if(J0(e.values,t.values))return n}else if(fte(e)&&fte(t)){if(e.url===t.url)return n}else if(hte(e)&&e.name===n.dataName)return n}return null}function Goe(e){let t=function(e,t){if(e.data||!e.parent){if(null===e.data){const e=new pie({values:[]});return t.push(e),e}const n=Voe(e.data,t);if(n)return pte(e.data)||(n.data.format=s1({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{const n=new pie(e.data);return t.push(n),n}}return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}(e,e.component.data.sources);const{outputNodes:n,outputNodeRefCounts:r}=e.component.data,i=e.parent?e.parent.component.data.ancestorParse.clone():new cte,o=e.data;pte(o)?(mte(o)?t=new hie(t,o.sequence):yte(o)&&(t=new die(t,o.graticule)),i.parseNothing=!0):null===o?.format?.parse&&(i.parseNothing=!0),t=lie.makeExplicit(t,e,i)??t,t=new cie(t);const a=e.parent&&woe(e.parent);(voe(e)||boe(e))&&a&&(t=nie.makeFromEncoding(t,e)??t),e.transforms.length>0&&(t=function(e,t,n){let r=0;for(const i of t.transforms){let o,a;if(Lee(i))a=e=new ire(e,i),o="derived";else if(Cee(i)){const r=sie(i);a=e=lie.makeWithAncestors(e,{},r,n)??e,e=new Une(e,t,i.filter)}else if(Bee(i))a=e=nie.makeFromTransform(e,i,t),o="number";else if(jee(i))o="date",void 0===n.getWithExplicit(i.field).value&&(e=new lie(e,{[i.field]:o}),n.set(i.field,o,!1)),a=e=Cte.makeFromTransform(e,i);else if(Uee(i))a=e=iie.makeFromTransform(e,i),o="number",Pne(t)&&(e=new cie(e));else if(Dee(i))a=e=Ooe.make(e,t,i,r++),o="derived";else if(zee(i))a=e=new zie(e,i),o="number";else if(Ree(i))a=e=new $ie(e,i),o="number";else if(qee(i))a=e=Tie.makeFromTransform(e,i),o="derived";else if(Wee(i))a=e=new Coe(e,i),o="derived";else if(Pee(i))a=e=new Aoe(e,i),o="derived";else if(Mee(i))a=e=new zoe(e,i),o="derived";else if(Tee(i))e=new Roe(e,i);else if(Iee(i))a=e=Foe.makeFromTransform(e,i),o="derived";else if(Fee(i))a=e=new Eoe(e,i),o="derived";else if(Nee(i))a=e=new $oe(e,i),o="derived";else if(Oee(i))a=e=new Toe(e,i),o="derived";else{if(!$ee(i)){m5.warn(g5.invalidTransformIgnored(i));continue}a=e=new Noe(e,i),o="derived"}if(a&&void 0!==o)for(const e of a.producedFields()??[])n.set(e,o,!1)}return e}(t,e,i));const s=function(e){const t={};if(voe(e)&&e.component.selection)for(const n of g1(e.component.selection)){const r=e.component.selection[n];for(const e of r.project.items)!e.channel&&F1(e.field)>1&&(t[e.field]="flatten")}return t}(e),u=uie(e);t=lie.makeWithAncestors(t,{},{...s,...u},i)??t,voe(e)&&(t=Doe.parseAll(t,e),t=Moe.parseAll(t,e)),(voe(e)||boe(e))&&(a||(t=nie.makeFromEncoding(t,e)??t),t=Cte.makeFromEncoding(t,e)??t,t=ire.parseAllForSortIndex(t,e));const l=e.getDataName(vte.Raw),c=new Ate(t,l,vte.Raw,r);if(n[l]=c,t=c,voe(e)){const n=iie.makeFromEncoding(t,e);n&&(t=n,Pne(e)&&(t=new cie(t))),t=Foe.makeFromEncoding(t,e)??t,t=Tie.makeFromEncoding(t,e)??t}voe(e)&&(t=Soe.make(t,e)??t);const f=e.getDataName(vte.Main),d=new Ate(t,f,vte.Main,r);n[f]=d,t=d,voe(e)&&function(e,t){for(const[n,r]of v1(e.component.selection??{})){const i=e.getName(`lookup_${n}`);e.component.data.outputNodes[i]=r.materialized=new Ate(new Une(t,e,{param:n}),i,vte.Lookup,e.component.data.outputNodeRefCounts)}}(e,d);let h=null;if(boe(e)){const r=e.getName("facet");t=function(e,t){const{row:n,column:r}=t;if(n&&r){let t=null;for(const i of[n,r])if(H8(i.sort)){const{field:n,op:r=j8}=i.sort;e=t=new $ie(e,{joinaggregate:[{op:r,field:n,as:Woe(i,i.sort,{forAs:!0})}],groupby:[y9(i)]})}return t}return null}(t,e.facet)??t,h=new oie(t,e,r,d.getSource()),n[r]=h}return{...e.component.data,outputNodes:n,outputNodeRefCounts:r,raw:c,main:d,facetRoot:h,ancestorParse:i}}class Yoe extends _oe{constructor(e,t,n,r){super(e,"concat",t,n,r,e.resolve),"shared"!==e.resolve?.axis?.x&&"shared"!==e.resolve?.axis?.y||m5.warn(g5.CONCAT_CANNOT_SHARE_AXIS),this.children=this.getChildren(e).map(((e,t)=>yae(e,this,this.getName(`concat_${t}`),void 0,r)))}parseData(){this.component.data=Goe(this);for(const e of this.children)e.parseData()}parseSelections(){this.component.selection={};for(const e of this.children){e.parseSelections();for(const t of g1(e.component.selection))this.component.selection[t]=e.component.selection[t]}}parseMarkGroup(){for(const e of this.children)e.parseMarkGroup()}parseAxesAndHeaders(){for(const e of this.children)e.parseAxesAndHeaders()}getChildren(e){return L7(e)?e.vconcat:B7(e)?e.hconcat:e.concat}parseLayoutSize(){!function(e){joe(e);const t=1===e.layout.columns?"width":"childWidth",n=void 0===e.layout.columns?"height":"childHeight";Uoe(e,t),Uoe(e,n)}(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(e){return this.children.reduce(((e,t)=>t.assembleSelectionTopLevelSignals(e)),e)}assembleSignals(){return this.children.forEach((e=>e.assembleSignals())),[]}assembleLayoutSignals(){const e=wre(this);for(const t of this.children)e.push(...t.assembleLayoutSignals());return e}assembleSelectionData(e){return this.children.reduce(((e,t)=>t.assembleSelectionData(e)),e)}assembleMarks(){return this.children.map((e=>{const t=e.assembleTitle(),n=e.assembleGroupStyle(),r=e.assembleGroupEncodeEntry(!1);return{type:"group",name:e.getName("group"),...t?{title:t}:{},...n?{style:n}:{},...r?{encode:{update:r}}:{},...e.assembleGroup()}}))}assembleDefaultLayout(){const e=this.layout.columns;return{...null!=e?{columns:e}:{},bounds:"full",align:"each"}}}const Xoe={disable:1,gridScale:1,scale:1,...j9,labelExpr:1,encode:1},Qoe=g1(Xoe);class Joe extends ite{constructor(e={},t={},n=!1){super(),this.explicit=e,this.implicit=t,this.mainExtracted=n}clone(){return new Joe(K0(this.explicit),K0(this.implicit),this.mainExtracted)}hasAxisPart(e){return"axis"===e||("grid"===e||"title"===e?!!this.get(e):!(!1===(t=this.get(e))||null===t));var t}hasOrientSignalRef(){return G3(this.explicit.orient)}}const Koe={bottom:"top",top:"bottom",left:"right",right:"left"};function Zoe(e,t){if(!e)return t.map((e=>e.clone()));{if(e.length!==t.length)return;const n=e.length;for(let r=0;r<n;r++){const n=e[r],i=t[r];if(!!n!=!!i)return;if(n&&i){const t=n.getWithExplicit("orient"),o=i.getWithExplicit("orient");if(t.explicit&&o.explicit&&t.value!==o.value)return;e[r]=eae(n,i)}}}return e}function eae(e,t){for(const n of Qoe){const r=lte(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",((e,t)=>{switch(n){case"title":return p5(e,t);case"gridScale":return{explicit:e.explicit,value:N1(e.value,t.value)}}return ute(e,t,n,"axis")}));e.setWithExplicit(n,r)}return e}function tae(e,t,n,r,i){if("disable"===t)return void 0!==n;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(G3(n.labelAngle)?n.labelAngle:P1(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===rre(r,i))return!0}return e===n[t]}const nae=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function rae(e,t){let n=t.axis(e);const r=new Joe,i=C9(t.encoding[e]),{mark:o,config:a}=t,s=n?.orient||a["x"===e?"axisX":"axisY"]?.orient||a.axis?.orient||function(e){return"x"===e?"bottom":"left"}(e),u=t.getScaleComponent(e).get("type"),l=Qne(e,u,s,t.config),c=void 0!==n?!n:Kne("disable",a.style,n?.style,l).configValue;if(r.set("disable",c,void 0!==n),c)return r;n=n||{};const f=function(e,t,n,r,i){const o=t?.labelAngle;if(void 0!==o)return G3(o)?o:P1(o);{const{configValue:o}=Kne("labelAngle",r,t?.style,i);return void 0!==o?P1(o):n!==U1||!i1([c4,u4],e.type)||i9(e)&&e.timeUnit?void 0:270}}(i,n,e,a.style,l),d={fieldOrDatumDef:i,axis:n,channel:e,model:t,scaleType:u,orient:s,labelAngle:f,mark:o,config:a};for(const i of Qoe){const o=i in Zne?Zne[i](d):q9(i)?n[i]:void 0,s=void 0!==o,u=tae(o,i,n,t,e);if(s&&u)r.set(i,o,u);else{const{configValue:e,configFrom:t}=q9(i)&&"values"!==i?Kne(i,a.style,n.style,l):{},c=void 0!==e;s&&!c?r.set(i,o,u):("vgAxisConfig"!==t||nae.has(i)&&c||L9(e)||G3(e))&&r.set(i,e,!1)}}const h=n.encoding??{},p=B9.reduce(((n,i)=>{if(!r.hasAxisPart(i))return n;const o=Are(h[i]??{},t),a="labels"===i?function(e,t,n){const{encoding:r,config:i}=e,o=C9(r[t])??C9(r[U2(t)]),a=e.axis(t)||{},{format:s,formatType:u}=a;return F8(u)?{text:T8({fieldOrDatumDef:o,field:"datum.value",format:s,formatType:u,config:i}),...n}:n}(t,e,o):o;return void 0===a||m1(a)||(n[i]={update:a}),n}),{});return m1(p)||r.set("encode",p,!!n.encoding||void 0!==n.labelAngle),r}function iae(e,t,n){const r=W3(e),i=s5("orient",r,n);if(r.orient=function(e,t,n){switch(e){case n8:case u8:case l8:case o8:case r8:case e8:return}const{x:r,y:i,x2:o,y2:a}=t;switch(e){case Z4:if(i9(r)&&(B3(r.bin)||i9(i)&&i.aggregate&&!r.aggregate))return"vertical";if(i9(i)&&(B3(i.bin)||i9(r)&&r.aggregate&&!i.aggregate))return"horizontal";if(a||o){if(n)return n;if(!o&&(i9(r)&&r.type===s4&&!L3(r.bin)||u9(r)))return"horizontal";if(!a&&(i9(i)&&i.type===s4&&!L3(i.bin)||u9(i)))return"vertical"}case i8:if(o&&(!i9(r)||!B3(r.bin))&&a&&(!i9(i)||!B3(i.bin)))return;case K4:if(a)return i9(i)&&B3(i.bin)?"horizontal":"vertical";if(o)return i9(r)&&B3(r.bin)?"vertical":"horizontal";if(e===i8){if(r&&!i)return"vertical";if(i&&!r)return"horizontal"}case t8:case a8:{const t=s9(r),o=s9(i);if(n)return n;if(t&&!o)return"tick"!==e?"horizontal":"vertical";if(!t&&o)return"tick"!==e?"vertical":"horizontal";if(t&&o){const t=r,n=i,o=t.type===l4,a=n.type===l4;return o&&!a?"tick"!==e?"vertical":"horizontal":!o&&a?"tick"!==e?"horizontal":"vertical":!t.aggregate&&n.aggregate?"tick"!==e?"vertical":"horizontal":t.aggregate&&!n.aggregate&&"tick"!==e?"horizontal":"vertical"}return}}return"vertical"}(r.type,t,i),void 0!==i&&i!==r.orient&&m5.warn(g5.orientOverridden(r.orient,i)),"bar"===r.type&&r.orient){const e=s5("cornerRadiusEnd",r,n);if(void 0!==e){const n="horizontal"===r.orient&&t.x2||"vertical"===r.orient&&t.y2?["cornerRadius"]:b8[r.orient];for(const t of n)r[t]=e;void 0!==r.cornerRadiusEnd&&delete r.cornerRadiusEnd}}void 0===s5("opacity",r,n)&&(r.opacity=function(e,t){if(i1([n8,a8,u8,l8],e)&&!Y9(t))return.7;return}(r.type,t));return void 0===s5("cursor",r,n)&&(r.cursor=function(e,t,n){if(t.href||e.href||s5("href",e,n))return"pointer";return e.cursor}(r,t,n)),r}function oae(e,t){const{config:n}=e;return{...fne(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...Kte("x",e,{defaultPos:"mid"}),...Kte("y",e,{defaultPos:"mid"}),...Yte("size",e),...Yte("angle",e),...aae(e,n,t)}}function aae(e,t,n){return n?{shape:{value:n}}:Yte("shape",e)}function sae(e,t,n){if(void 0===s5("align",e,n))return"center"}function uae(e,t,n){if(void 0===s5("baseline",e,n))return"middle"}function lae(e){const{config:t,markDef:n}=e,{orient:r}=n,i="horizontal"===r?"width":"height",o=e.getScaleComponent("horizontal"===r?"x":"y"),a=s5("size",n,t,{vgChannel:i})??t.tick.bandSize;if(void 0!==a)return a;{const e=o?o.get("range"):void 0;if(e&&Y3(e)&&Cy(e.step))return 3*e.step/4;return 3*W7(t.view,i)/4}}const cae={arc:{vgMark:"arc",encodeEntry:e=>({...fne(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...Kte("x",e,{defaultPos:"mid"}),...Kte("y",e,{defaultPos:"mid"}),...ane(e,"radius","arc"),...ane(e,"theta","arc")})},area:{vgMark:"area",encodeEntry:e=>({...fne(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"}),...rne("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"horizontal"===e.markDef.orient}),...rne("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"vertical"===e.markDef.orient}),...pne(e)})},bar:{vgMark:"rect",encodeEntry:e=>({...fne(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...ane(e,"x","bar"),...ane(e,"y","bar")})},circle:{vgMark:"symbol",encodeEntry:e=>oae(e,"circle")},geoshape:{vgMark:"shape",encodeEntry:e=>({...fne(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})}),postEncodingTransform:e=>{const{encoding:t}=e,n=t.shape;return[{type:"geoshape",projection:e.projectionName(),...n&&i9(n)&&n.type===f4?{field:y9(n,{expr:"datum"})}:{}}]}},image:{vgMark:"image",encodeEntry:e=>({...fne(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"}),...ane(e,"x","image"),...ane(e,"y","image"),...Ite(e,"url")})},line:{vgMark:"line",encodeEntry:e=>({...fne(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...Kte("x",e,{defaultPos:"mid"}),...Kte("y",e,{defaultPos:"mid"}),...Yte("size",e,{vgChannel:"strokeWidth"}),...pne(e)})},point:{vgMark:"symbol",encodeEntry:e=>oae(e)},rect:{vgMark:"rect",encodeEntry:e=>({...fne(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...ane(e,"x","rect"),...ane(e,"y","rect")})},rule:{vgMark:"rule",encodeEntry:e=>{const{markDef:t}=e,n=t.orient;return e.encoding.x||e.encoding.y||e.encoding.latitude||e.encoding.longitude?{...fne(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...rne("x",e,{defaultPos:"horizontal"===n?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"vertical"!==n}),...rne("y",e,{defaultPos:"vertical"===n?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"horizontal"!==n}),...Yte("size",e,{vgChannel:"strokeWidth"})}:{}}},square:{vgMark:"symbol",encodeEntry:e=>oae(e,"square")},text:{vgMark:"text",encodeEntry:e=>{const{config:t,encoding:n}=e;return{...fne(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"}),...Kte("x",e,{defaultPos:"mid"}),...Kte("y",e,{defaultPos:"mid"}),...Ite(e),...Yte("size",e,{vgChannel:"fontSize"}),...Yte("angle",e),...mne("align",sae(e.markDef,n,t)),...mne("baseline",uae(e.markDef,n,t)),...Kte("radius",e,{defaultPos:null}),...Kte("theta",e,{defaultPos:null})}}},tick:{vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:n}=e,r=n.orient,i="horizontal"===r?"width":"height",o="horizontal"===r?"height":"width";return{...fne(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...Kte("x",e,{defaultPos:"mid",vgChannel:"xc"}),...Kte("y",e,{defaultPos:"mid",vgChannel:"yc"}),...Yte("size",e,{defaultValue:lae(e),vgChannel:i}),[o]:n5(s5("thickness",n,t))}}},trail:{vgMark:"trail",encodeEntry:e=>({...fne(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...Kte("x",e,{defaultPos:"mid"}),...Kte("y",e,{defaultPos:"mid"}),...Yte("size",e),...pne(e)})}};function fae(e){if(i1([t8,K4,s8],e.mark)){const t=Z9(e.mark,e.encoding);if(t.length>0)return function(e,t){return[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:dae+e.requestDataName(vte.Main),data:e.requestDataName(vte.Main),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:pae(e,{fromPrefix:dae})}]}(e,t)}else if(e.mark===Z4){const t=K3.some((t=>s5(t,e.markDef,e.config)));if(e.stack&&!e.fieldDef("size")&&t)return function(e){const[t]=pae(e,{fromPrefix:hae}),n=e.scaleName(e.stack.fieldChannel),r=(t={})=>e.vgField(e.stack.fieldChannel,t),i=(e,t)=>`${e}(${[r({prefix:"min",suffix:"start",expr:t}),r({prefix:"max",suffix:"start",expr:t}),r({prefix:"min",suffix:"end",expr:t}),r({prefix:"max",suffix:"end",expr:t})].map((e=>`scale('${n}',${e})`)).join(",")})`;let o,a;"x"===e.stack.fieldChannel?(o={...Z0(t.encode.update,["y","yc","y2","height",...K3]),x:{signal:i("min","datum")},x2:{signal:i("max","datum")},clip:{value:!0}},a={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},t.encode.update={...e1(t.encode.update,["y","yc","y2"]),height:{field:{group:"height"}}}):(o={...Z0(t.encode.update,["x","xc","x2","width"]),y:{signal:i("min","datum")},y2:{signal:i("max","datum")},clip:{value:!0}},a={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},t.encode.update={...e1(t.encode.update,["x","xc","x2"]),width:{field:{group:"width"}}});for(const n of K3){const r=u5(n,e.markDef,e.config);t.encode.update[n]?(o[n]=t.encode.update[n],delete t.encode.update[n]):r&&(o[n]=n5(r)),r&&(t.encode.update[n]={value:0})}const s=[];if(e.stack.groupbyChannel){const t=e.fieldDef(e.stack.groupbyChannel),n=y9(t);n&&s.push(n),(t?.bin||t?.timeUnit)&&s.push(y9(t,{binSuffix:"end"}))}o=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce(((n,r)=>{if(t.encode.update[r])return{...n,[r]:t.encode.update[r]};{const t=u5(r,e.markDef,e.config);return void 0!==t?{...n,[r]:n5(t)}:n}}),o),o.stroke&&(o.strokeForeground={value:!0},o.strokeOffset={value:0});return[{type:"group",from:{facet:{data:e.requestDataName(vte.Main),name:hae+e.requestDataName(vte.Main),groupby:s,aggregate:{fields:[r({suffix:"start"}),r({suffix:"start"}),r({suffix:"end"}),r({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:o},marks:[{type:"group",encode:{update:a},marks:[t]}]}]}(e)}return pae(e)}const dae="faceted_path_";const hae="stack_group_";function pae(e,t={fromPrefix:""}){const{mark:n,markDef:r,encoding:i,config:o}=e,a=N1(r.clip,function(e){const t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return!!(t&&t.get("selectionExtent")||n&&n.get("selectionExtent"))||void 0}(e),function(e){const t=e.component.projection;return!(!t||t.isFit)||void 0}(e)),s=a5(r),u=i.key,l=function(e){const{encoding:t,stack:n,mark:r,markDef:i,config:o}=e,a=t.order;if(!(!$g(a)&&f9(a)&&r1(a.value)||!a&&r1(s5("order",i,o)))){if(($g(a)||i9(a))&&!n)return f5(a,{expr:"datum"});if(f8(r)){const n="horizontal"===i.orient?"y":"x",r=t[n];if(i9(r)){const t=r.sort;return $g(t)?{field:y9(r,{prefix:n,suffix:"sort_index",expr:"datum"})}:H8(t)?{field:y9({aggregate:Y9(e.encoding)?t.op:void 0,field:t.field},{expr:"datum"})}:W8(t)?{field:y9(e.fieldDef(t.encoding),{expr:"datum"}),order:t.order}:null===t?void 0:{field:y9(r,{binSuffix:e.stack&&e.stack.impute?"mid":void 0,expr:"datum"})}}}}}(e),c=function(e){if(!e.component.selection)return null;const t=g1(e.component.selection).length;let n=t,r=e.parent;for(;r&&0===n;)n=g1(r.component.selection).length,r=r.parent;return n?{interactive:t>0||!!e.encoding.tooltip}:null}(e),f=s5("aria",r,o),d=cae[n].postEncodingTransform?cae[n].postEncodingTransform(e):null;return[{name:e.getName("marks"),type:cae[n].vgMark,...a?{clip:!0}:{},...s?{style:s}:{},...u?{key:u.field}:{},...l?{sort:l}:{},...c||{},...!1===f?{aria:f}:{},from:{data:t.fromPrefix+e.requestDataName(vte.Main)},encode:{update:cae[n].encodeEntry(e)},...d?{transform:d}:{}}]}class mae extends koe{constructor(e,t,n,r={},i){super(e,"unit",t,n,i,void 0,j7(e)?e.view:void 0),this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection=[],this.children=[];const o=p8(e.mark)?{...e.mark}:{type:e.mark},a=o.type;void 0===o.filled&&(o.filled=function(e,t,{graticule:n}){if(n)return!1;const r=u5("filled",e,t),i=e.type;return N1(r,i!==n8&&i!==t8&&i!==i8)}(o,i,{graticule:e.data&&yte(e.data)}));const s=this.encoding=Q9(e.encoding||{},a,o.filled,i);this.markDef=iae(o,s,i),this.size=function({encoding:e,size:t}){for(const n of o3){const r=q2(n);I7(t[r])&&s9(e[n])&&(delete t[r],m5.warn(g5.stepDropped(r)))}return t}({encoding:s,size:j7(e)?{...r,...e.width?{width:e.width}:{},...e.height?{height:e.height}:{}}:r}),this.stack=fee(a,s),this.specifiedScales=this.initScales(a,s),this.specifiedAxes=this.initAxes(s),this.specifiedLegends=this.initLegends(s),this.specifiedProjection=e.projection,this.selection=(e.params??[]).filter((e=>z7(e)))}get hasProjection(){const{encoding:e}=this,t=this.mark===c8,n=e&&_2.some((t=>l9(e[t])));return t||n}scaleDomain(e){const t=this.specifiedScales[e];return t?t.domain:void 0}axis(e){return this.specifiedAxes[e]}legend(e){return this.specifiedLegends[e]}initScales(e,t){return w3.reduce(((e,n)=>{const r=C9(t[n]);return r&&(e[n]=this.initScale(r.scale??{})),e}),{})}initScale(e){const{domain:t,range:n}=e,r=W3(e);return $g(t)&&(r.domain=t.map(e5)),$g(n)&&(r.range=n.map(e5)),r}initAxes(e){return o3.reduce(((t,n)=>{const r=e[n];if(l9(r)||n===U1&&l9(e.x2)||n===q1&&l9(e.y2)){const e=l9(r)?r.axis:void 0;t[n]=e?this.initAxis({...e}):e}return t}),{})}initAxis(e){const t=g1(e),n={};for(const r of t){const t=e[r];n[r]=L9(t)?Z3(t):e5(t)}return n}initLegends(e){return b3.reduce(((t,n)=>{const r=C9(e[n]);if(r&&function(e){switch(e){case e2:case t2:case n2:case i2:case r2:case a2:case l2:case c2:return!0;case s2:case u2:case o2:return!1}}(n)){const e=r.legend;t[n]=e?W3(e):e}return t}),{})}parseData(){this.component.data=Goe(this)}parseLayoutSize(){!function(e){const{size:t,component:n}=e;for(const r of o3){const i=q2(r);if(t[i]){const e=t[i];n.layoutSize.set(i,I7(e)?"step":e,!0)}else{const t=qoe(e,i);n.layoutSize.set(i,t,!1)}}}(this)}parseSelections(){this.component.selection=function(e,t){const n={},r=e.config.selection;if(!t||!t.length)return n;for(const i of t){const t=x1(i.name),o=i.select,a=My(o)?o:o.type,s=Tg(o)?K0(o):{type:a},{fields:u,encodings:l,...c}=r[a];for(const e in c)"mark"===e&&(s[e]={...c[e],...s[e]}),void 0!==s[e]&&!0!==s[e]||(s[e]=c[e]??s[e]);const f=n[t]={...s,name:t,type:a,init:i.value,bind:i.bind,events:My(s.on)?BQ(s.on,"scope"):iy(K0(s.on))};for(const t of zne)t.defined(f)&&t.parse&&t.parse(e,f,i)}return n}(this,this.selection)}parseMarkGroup(){this.component.mark=fae(this)}parseAxesAndHeaders(){var e;this.component.axes=(e=this,o3.reduce(((t,n)=>(e.component.scales[n]&&(t[n]=[rae(n,e)]),t)),{}))}assembleSelectionTopLevelSignals(e){return function(e,t){let n=!1;for(const r of y1(e.component.selection??{})){const i=r.name,o=Py(i+Nne);if(0===t.filter((e=>e.name===i)).length){const e="global"===r.resolve?"union":r.resolve,n="point"===r.type?", true, true)":")";t.push({name:r.name,update:`${Tne}(${o}, ${Py(e)}${n}`})}n=!0;for(const n of zne)n.defined(r)&&n.topLevelSignals&&(t=n.topLevelSignals(e,r,t))}n&&0===t.filter((e=>"unit"===e.name)).length&&t.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]});return Ete(t)}(this,e)}assembleSignals(){return[...Yne(this),...wte(this,[])]}assembleSelectionData(e){return function(e,t){const n=[...t];for(const t of y1(e.component.selection??{})){const r={name:t.name+Nne};if(t.init){const n=t.project.items.map((e=>{const{signals:t,...n}=e;return n}));r.values=t.init.map((t=>({unit:Rne(e,{escape:!1}),fields:n,values:xte(t,!1)})))}n.filter((e=>e.name===t.name+Nne)).length||n.push(r)}return n}(this,e)}assembleLayout(){return null}assembleLayoutSignals(){return wre(this)}assembleMarks(){let e=this.component.mark??[];return this.parent&&woe(this.parent)||(e=kte(this,e)),e.map(this.correctDataNames)}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(e){return G9(this.encoding,e)}fieldDef(e){return A9(this.encoding[e])}typedFieldDef(e){const t=this.fieldDef(e);return c9(t)?t:null}}class gae extends _oe{constructor(e,t,n,r,i){super(e,"layer",t,n,i,e.resolve,e.view);const o={...r,...e.width?{width:e.width}:{},...e.height?{height:e.height}:{}};this.children=e.layer.map(((e,t)=>{if(oee(e))return new gae(e,this,this.getName(`layer_${t}`),o,i);if(H9(e))return new mae(e,this,this.getName(`layer_${t}`),o,i);throw new Error(g5.invalidSpec(e))}))}parseData(){this.component.data=Goe(this);for(const e of this.children)e.parseData()}parseLayoutSize(){var e;joe(e=this),Uoe(e,"width"),Uoe(e,"height")}parseSelections(){this.component.selection={};for(const e of this.children){e.parseSelections();for(const t of g1(e.component.selection))this.component.selection[t]=e.component.selection[t]}}parseMarkGroup(){for(const e of this.children)e.parseMarkGroup()}parseAxesAndHeaders(){!function(e){const{axes:t,resolve:n}=e.component,r={top:0,bottom:0,right:0,left:0};for(const r of e.children){r.parseAxesAndHeaders();for(const i of g1(r.component.axes))n.axis[i]=Dre(e.component.resolve,i),"shared"===n.axis[i]&&(t[i]=Zoe(t[i],r.component.axes[i]),t[i]||(n.axis[i]="independent",delete t[i]))}for(const i of o3){for(const o of e.children)if(o.component.axes[i]){if("independent"===n.axis[i]){t[i]=(t[i]??[]).concat(o.component.axes[i]);for(const e of o.component.axes[i]){const{value:t,explicit:n}=e.getWithExplicit("orient");if(!G3(t)){if(r[t]>0&&!n){const n=Koe[t];r[t]>r[n]&&e.set("orient",n,!1)}r[t]++}}}delete o.component.axes[i]}if("independent"===n.axis[i]&&t[i]&&t[i].length>1)for(const e of t[i])e.get("grid")&&!e.explicit.grid&&(e.implicit.grid=!1)}}(this)}assembleSelectionTopLevelSignals(e){return this.children.reduce(((e,t)=>t.assembleSelectionTopLevelSignals(e)),e)}assembleSignals(){return this.children.reduce(((e,t)=>e.concat(t.assembleSignals())),Yne(this))}assembleLayoutSignals(){return this.children.reduce(((e,t)=>e.concat(t.assembleLayoutSignals())),wre(this))}assembleSelectionData(e){return this.children.reduce(((e,t)=>t.assembleSelectionData(e)),e)}assembleTitle(){let e=super.assembleTitle();if(e)return e;for(const t of this.children)if(e=t.assembleTitle(),e)return e}assembleLayout(){return null}assembleMarks(){return function(e,t){for(const n of e.children)voe(n)&&(t=kte(n,t));return t}(this,this.children.flatMap((e=>e.assembleMarks())))}assembleLegends(){return this.children.reduce(((e,t)=>e.concat(t.assembleLegends())),Vre(this))}}function yae(e,t,n,r,i){if(X8(e))return new Hoe(e,t,n,i);if(oee(e))return new gae(e,t,n,r,i);if(H9(e))return new mae(e,t,n,r,i);if(function(e){return L7(e)||B7(e)||P7(e)}(e))return new Yoe(e,t,n,i);throw new Error(g5.invalidSpec(e))}function vae(e,t={}){t.logger&&m5.set(t.logger),t.fieldTitle&&w9(t.fieldTitle);try{const n=Z7(Rg(t.config,e.config)),r=Jee(e,n),i=yae(r,null,"",void 0,n);i.parse(),function(e,t){Bie(e.sources);let n=0,r=0;for(let r=0;r<5&&jie(e,t,!0);r++)n++;e.sources.map(Rie);for(let n=0;n<5&&jie(e,t,!1);n++)r++;Bie(e.sources),5===Math.max(n,r)&&m5.warn("Maximum optimization runs(5) reached.")}(i.component.data,i);return{spec:function(e,t,n={},r){const i=e.config?ree(e.config):void 0,o=[].concat(e.assembleSelectionData([]),function(e,t){const n=[],r=Poe(n);let i=0;for(const t of e.sources){t.hasName()||(t.dataName="source_"+i++);const e=t.assemble();r(t,e)}for(const e of n)0===e.transform.length&&delete e.transform;let o=0;for(const[e,t]of n.entries())0!==(t.transform??[]).length||t.source||n.splice(o++,0,n.splice(e,1)[0]);for(const t of n)for(const n of t.transform??[])"lookup"===n.type&&(n.from=e.outputNodes[n.from].getSource());for(const e of n)e.name in t&&(e.values=t[e.name]);return n}(e.component.data,n)),a=e.assembleProjections(),s=e.assembleTitle(),u=e.assembleGroupStyle(),l=e.assembleGroupEncodeEntry(!0);let c=e.assembleLayoutSignals();c=c.filter((e=>"width"!==e.name&&"height"!==e.name||void 0===e.value||(t[e.name]=+e.value,!1)));const{params:f,...d}=t;return{$schema:"https://vega.github.io/schema/vega/v5.json",...e.description?{description:e.description}:{},...d,...s?{title:s}:{},...u?{style:u}:{},...l?{encode:{update:l}}:{},data:o,...a.length>0?{projections:a}:{},...e.assembleGroup([...c,...e.assembleSelectionTopLevelSignals([]),...R7(f)]),...i?{config:i}:{},...r?{usermeta:r}:{}}}(i,function(e,t,n,r){const i=r.component.layoutSize.get("width"),o=r.component.layoutSize.get("height");void 0===t?(t={type:"pad"},r.hasAxisOrientSignalRef()&&(t.resize=!0)):My(t)&&(t={type:t});if(i&&o&&(a=t.type,"fit"===a||"fit-x"===a||"fit-y"===a))if("step"===i&&"step"===o)m5.warn(g5.droppingFit()),t.type="pad";else if("step"===i||"step"===o){const e="step"===i?"width":"height";m5.warn(g5.droppingFit(l3(e)));const n="width"===e?"height":"width";t.type=function(e){return e?`fit-${l3(e)}`:"fit"}(n)}var a;return{...1===g1(t).length&&t.type?"pad"===t.type?{}:{autosize:t.type}:{autosize:t},...rte(n,!1),...rte(e,!0)}}(e,r.autosize,n,i),e.datasets,e.usermeta),normalized:r}}finally{t.logger&&m5.reset(),t.fieldTitle&&w9(b9)}}n(P0,B0);const bae=L0.version;t(P0,"version",(function(){return bae})),t(P0,"compile",(function(){return vae})),t(P0,"normalize",(function(){return Jee}));var xae=function(e){const[t,n]=/\/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:t,version:n}},wae={};const _ae="#fff",kae={background:"#333",title:{color:_ae,subtitleColor:_ae},style:{"guide-label":{fill:_ae},"guide-title":{fill:_ae}},axis:{domainColor:_ae,gridColor:"#888",tickColor:_ae}},Eae="#4572a7",Sae={background:"#fff",arc:{fill:Eae},area:{fill:Eae},line:{stroke:Eae,strokeWidth:2},path:{stroke:Eae},rect:{fill:Eae},shape:{stroke:Eae},symbol:{fill:Eae,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},Aae="#30a2da",Cae="#cbcbcb",Dae="#f0f0f0",Mae="#333",Fae={arc:{fill:Aae},area:{fill:Aae},axis:{domainColor:Cae,grid:!0,gridColor:Cae,gridWidth:1,labelColor:"#999",labelFontSize:10,titleColor:"#333",tickColor:Cae,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:Dae,group:{fill:Dae},legend:{labelColor:Mae,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:Mae,titleFontSize:14,titlePadding:10},line:{stroke:Aae,strokeWidth:2},path:{stroke:Aae,strokeWidth:.5},rect:{fill:Aae},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:Aae},bar:{binSpacing:2,fill:Aae,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},Nae="#000",Oae={group:{fill:"#e5e5e5"},arc:{fill:Nae},area:{fill:Nae},line:{stroke:Nae},path:{stroke:Nae},rect:{fill:Nae},shape:{stroke:Nae},symbol:{fill:Nae,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},$ae="Benton Gothic, sans-serif",Tae="#82c6df",zae="Benton Gothic Bold, sans-serif",Rae="normal",Pae={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},Lae={background:"#ffffff",title:{anchor:"start",color:"#000000",font:zae,fontSize:22,fontWeight:"normal"},arc:{fill:Tae},area:{fill:Tae},line:{stroke:Tae,strokeWidth:2},path:{stroke:Tae},rect:{fill:Tae},shape:{stroke:Tae},symbol:{fill:Tae,size:30},axis:{labelFont:$ae,labelFontSize:11.5,labelFontWeight:"normal",titleFont:zae,titleFontSize:13,titleFontWeight:Rae},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:$ae,labelFontSize:11.5,symbolType:"square",titleFont:zae,titleFontSize:13,titleFontWeight:Rae},range:{category:Pae["category-6"],diverging:Pae["fireandice-6"],heatmap:Pae["fire-7"],ordinal:Pae["fire-7"],ramp:Pae["fire-7"]}},Bae="#ab5787",Iae="#979797",jae={background:"#f9f9f9",arc:{fill:Bae},area:{fill:Bae},line:{stroke:Bae},path:{stroke:Bae},rect:{fill:Bae},shape:{stroke:Bae},symbol:{fill:Bae,size:30},axis:{domainColor:Iae,domainWidth:.5,gridWidth:.2,labelColor:Iae,tickColor:Iae,tickWidth:.2,titleColor:Iae},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},Uae="#3e5c69",qae={background:"#fff",arc:{fill:Uae},area:{fill:Uae},line:{stroke:Uae},path:{stroke:Uae},rect:{fill:Uae},shape:{stroke:Uae},symbol:{fill:Uae},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},Wae="#1696d2",Hae="#000000",Vae="Lato",Gae="Lato",Yae={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},Xae={background:"#FFFFFF",title:{anchor:"start",fontSize:18,font:Vae},axisX:{domain:!0,domainColor:Hae,domainWidth:1,grid:!1,labelFontSize:12,labelFont:Gae,labelAngle:0,tickColor:Hae,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:Vae},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:"#DEDDDD",gridWidth:1,labelFontSize:12,labelFont:Gae,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:Vae,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:Gae,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:Vae,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:Yae["six-groups-cat-1"],diverging:Yae["diverging-colors"],heatmap:Yae["diverging-colors"],ordinal:Yae["six-groups-seq"],ramp:Yae["shades-blue"]},area:{fill:Wae},rect:{fill:Wae},line:{color:Wae,stroke:Wae,strokeWidth:5},trail:{color:Wae,stroke:Wae,strokeWidth:0,size:1},path:{stroke:Wae,strokeWidth:.5},point:{filled:!0},text:{font:"Lato",color:Wae,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:Wae,stroke:null}},arc:{fill:Wae},shape:{stroke:Wae},symbol:{fill:Wae,size:30}},Qae="#3366CC",Jae="#ccc",Kae="Arial, sans-serif",Zae={arc:{fill:Qae},area:{fill:Qae},path:{stroke:Qae},rect:{fill:Qae},shape:{stroke:Qae},symbol:{stroke:Qae},circle:{fill:Qae},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:Kae,fontSize:12},"guide-title":{font:Kae,fontSize:12},"group-title":{font:Kae,fontSize:12}},title:{font:Kae,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:Jae,tickColor:Jae,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},ese="2.10.0";t(wae,"vox",(function(){return qae})),t(wae,"version",(function(){return ese})),t(wae,"urbaninstitute",(function(){return Xae})),t(wae,"quartz",(function(){return jae})),t(wae,"latimes",(function(){return Lae})),t(wae,"googlecharts",(function(){return Zae})),t(wae,"ggplot2",(function(){return Oae})),t(wae,"fivethirtyeight",(function(){return Fae})),t(wae,"excel",(function(){return Sae})),t(wae,"dark",(function(){return kae}));var tse="#vg-tooltip-element {\n  visibility: hidden;\n  padding: 8px;\n  position: fixed;\n  z-index: 1000;\n  font-family: sans-serif;\n  font-size: 11px;\n  border-radius: 3px;\n  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);\n  /* The default theme is the light theme. */\n  background-color: rgba(255, 255, 255, 0.95);\n  border: 1px solid #d9d9d9;\n  color: black; }\n  #vg-tooltip-element.visible {\n    visibility: visible; }\n  #vg-tooltip-element h2 {\n    margin-top: 0;\n    margin-bottom: 10px;\n    font-size: 13px; }\n  #vg-tooltip-element img {\n    max-width: 200px;\n    max-height: 200px; }\n  #vg-tooltip-element table {\n    border-spacing: 0; }\n    #vg-tooltip-element table tr {\n      border: none; }\n      #vg-tooltip-element table tr td {\n        overflow: hidden;\n        text-overflow: ellipsis;\n        padding-top: 2px;\n        padding-bottom: 2px; }\n        #vg-tooltip-element table tr td.key {\n          color: #808080;\n          max-width: 150px;\n          text-align: right;\n          padding-right: 4px; }\n        #vg-tooltip-element table tr td.value {\n          display: block;\n          max-width: 300px;\n          max-height: 7em;\n          text-align: left; }\n  #vg-tooltip-element.dark-theme {\n    background-color: rgba(32, 32, 32, 0.9);\n    border: 1px solid #f5f5f5;\n    color: white; }\n    #vg-tooltip-element.dark-theme td.key {\n      color: #bfbfbf; }\n";const nse="vg-tooltip-element",rse={offsetX:10,offsetY:10,id:nse,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")},maxDepth:2};function ise(e,t,n){if($g(e))return`[${e.map((e=>t(My(e)?e:ose(e,n)))).join(", ")}]`;if(Tg(e)){let r="";const i=e,{title:o,image:a}=i,s=
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.
  
  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.
  
  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ******************************************************************************/
function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(i,["title","image"]);o&&(r+=`<h2>${t(o)}</h2>`),a&&(r+=`<img src="${t(a)}">`);const u=Object.keys(s);if(u.length>0){r+="<table>";for(const e of u){let i=s[e];void 0!==i&&(Tg(i)&&(i=ose(i,n)),r+=`<tr><td class="key">${t(e)}:</td><td class="value">${t(i)}</td></tr>`)}r+="</table>"}return r||"{}"}return t(e)}function ose(e,t){return JSON.stringify(e,function(e){const t=[];return function(n,r){if("object"!=typeof r||null===r)return r;const i=t.indexOf(this)+1;return t.length=i,t.length>e?"[Object]":t.indexOf(r)>=0?"[Circular]":(t.push(r),r)}}(t))}class ase{constructor(e){this.options=Object.assign(Object.assign({},rse),e);const t=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const e=document.createElement("style");e.setAttribute("id",this.options.styleId),e.innerHTML=function(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return tse.toString().replace(nse,e)}(t);const n=document.head;n.childNodes.length>0?n.insertBefore(e,n.childNodes[0]):n.appendChild(e)}}tooltipHandler(e,t,n,r){this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),document.body.appendChild(this.el));if((null!=document.fullscreenElement?document.fullscreenElement:document.body).appendChild(this.el),null==r||""===r)return void this.el.classList.remove("visible",`${this.options.theme}-theme`);this.el.innerHTML=ise(r,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x:i,y:o}=function(e,t,n,r){let i=e.clientX+n;i+t.width>window.innerWidth&&(i=+e.clientX-n-t.width);let o=e.clientY+r;return o+t.height>window.innerHeight&&(o=+e.clientY-r-t.height),{x:i,y:o}}(t,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.setAttribute("style",`top: ${o}px; left: ${i}px`)}}
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.
  
  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.
  
  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ******************************************************************************/
function sse(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))}var use,lse='.vega-embed {\n  position: relative;\n  display: inline-block;\n  box-sizing: border-box; }\n  .vega-embed.has-actions {\n    padding-right: 38px; }\n  .vega-embed details:not([open]) > :not(summary) {\n    display: none !important; }\n  .vega-embed summary {\n    list-style: none;\n    position: absolute;\n    top: 0;\n    right: 0;\n    padding: 6px;\n    z-index: 1000;\n    background: white;\n    box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);\n    color: #1b1e23;\n    border: 1px solid #aaa;\n    border-radius: 999px;\n    opacity: 0.2;\n    transition: opacity 0.4s ease-in;\n    outline: none;\n    cursor: pointer;\n    line-height: 0px; }\n    .vega-embed summary::-webkit-details-marker {\n      display: none; }\n    .vega-embed summary:active {\n      box-shadow: #aaa 0px 0px 0px 1px inset; }\n    .vega-embed summary svg {\n      width: 14px;\n      height: 14px; }\n  .vega-embed details[open] summary {\n    opacity: 0.7; }\n  .vega-embed:hover summary,\n  .vega-embed:focus summary {\n    opacity: 1 !important;\n    transition: opacity 0.2s ease; }\n  .vega-embed .vega-actions {\n    position: absolute;\n    z-index: 1001;\n    top: 35px;\n    right: -9px;\n    display: flex;\n    flex-direction: column;\n    padding-bottom: 8px;\n    padding-top: 8px;\n    border-radius: 4px;\n    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);\n    border: 1px solid #d9d9d9;\n    background: white;\n    animation-duration: 0.15s;\n    animation-name: scale-in;\n    animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);\n    text-align: left; }\n    .vega-embed .vega-actions a {\n      padding: 8px 16px;\n      font-family: sans-serif;\n      font-size: 14px;\n      font-weight: 600;\n      white-space: nowrap;\n      color: #434a56;\n      text-decoration: none; }\n      .vega-embed .vega-actions a:hover {\n        background-color: #f7f7f9;\n        color: black; }\n    .vega-embed .vega-actions::before, .vega-embed .vega-actions::after {\n      content: "";\n      display: inline-block;\n      position: absolute; }\n    .vega-embed .vega-actions::before {\n      left: auto;\n      right: 14px;\n      top: -16px;\n      border: 8px solid #0000;\n      border-bottom-color: #d9d9d9; }\n    .vega-embed .vega-actions::after {\n      left: auto;\n      right: 15px;\n      top: -14px;\n      border: 7px solid #0000;\n      border-bottom-color: #fff; }\n  .vega-embed .chart-wrapper {\n    width: 100%;\n    height: 100%; }\n\n.vega-embed-wrapper {\n  max-width: 100%;\n  overflow: auto;\n  padding-right: 14px; }\n\n@keyframes scale-in {\n  from {\n    opacity: 0;\n    transform: scale(0.6); }\n  to {\n    opacity: 1;\n    transform: scale(1); } }\n';function cse(e,...t){for(const n of t)fse(e,n);return e}function fse(e,t){for(const n of Object.keys(t))Pg(e,n,t[n],!0)}String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e});const dse=pg;let hse=P0;const pse="undefined"!=typeof window?window:void 0;void 0===hse&&(null===(use=null==pse?void 0:pse.vl)||void 0===use?void 0:use.compile)&&(hse=pse.vl);const mse={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},gse={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},yse={vega:"Vega","vega-lite":"Vega-Lite"},vse={vega:dse.version,"vega-lite":hse?hse.version:"not available"},bse={vega:e=>e,"vega-lite":(e,t)=>hse.compile(e,{config:t}).spec},xse='\n<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">\n  <circle r="2" cy="8" cx="2"></circle>\n  <circle r="2" cy="8" cx="8"></circle>\n  <circle r="2" cy="8" cx="14"></circle>\n</svg>',wse="chart-wrapper";function _se(e,t,n,r){const i=`<html><head>${t}</head><body><pre><code class="json">`,o=`</code></pre>${n}</body></html>`,a=window.open("");a.document.write(i+e+o),a.document.title=`${yse[r]} JSON Source`}function kse(e){return(t=e)&&"load"in t?e:dse.loader(e);var t}function Ese(e){var t;return null!==(t=e.usermeta&&e.usermeta.embedOptions)&&void 0!==t?t:{}}function Sse(e,t,n={}){var r,i,o;return sse(this,void 0,void 0,(function*(){let a,s;My(t)?(s=kse(n.loader),a=JSON.parse(yield s.load(t))):a=t;const u=Ese(a).loader;s&&!u||(s=kse(null!==(r=n.loader)&&void 0!==r?r:u));const l=yield Ase(Ese(a),s),c=yield Ase(n,s),f=Object.assign(Object.assign({},cse(c,l)),{config:Rg(null!==(i=c.config)&&void 0!==i?i:{},null!==(o=l.config)&&void 0!==o?o:{})});return yield function(e,t,n={},r){var i,o,a,s,u,l;return sse(this,void 0,void 0,(function*(){const c=n.theme?Rg(wae[n.theme],null!==(i=n.config)&&void 0!==i?i:{}):n.config,f=Ey(n.actions)?n.actions:cse({},mse,null!==(o=n.actions)&&void 0!==o?o:{}),d=Object.assign(Object.assign({},gse),n.i18n),h=null!==(a=n.renderer)&&void 0!==a?a:"canvas",p=null!==(s=n.logLevel)&&void 0!==s?s:dse.Warn,m=null!==(u=n.downloadFileName)&&void 0!==u?u:"visualization",g="string"==typeof e?document.querySelector(e):e;if(!g)throw new Error(`${e} does not exist`);if(!1!==n.defaultStyle){const e="vega-embed-style",{root:t,rootContainer:r}=function(e){var t;const n=e.getRootNode?e.getRootNode():document;return n instanceof ShadowRoot?{root:n,rootContainer:n}:{root:document,rootContainer:null!==(t=document.head)&&void 0!==t?t:document.body}}(g);if(!t.getElementById(e)){const t=document.createElement("style");t.id=e,t.innerText=void 0===n.defaultStyle||!0===n.defaultStyle?lse.toString():n.defaultStyle,r.appendChild(t)}}const y=function(e,t){var n;if(e.$schema){const r=xae(e.$schema);t&&t!==r.library&&console.warn(`The given visualization spec is written in ${yse[r.library]}, but mode argument sets ${null!==(n=yse[t])&&void 0!==n?n:t}.`);const i=r.library;return qd.satisfies(vse[i],`^${r.version.slice(1)}`)||console.warn(`The input spec uses ${yse[i]} ${r.version}, but the current version of ${yse[i]} is v${vse[i]}.`),i}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":null!=t?t:"vega"}(t,n.mode);let v=bse[y](t,c);if("vega-lite"===y&&v.$schema){const e=xae(v.$schema);qd.satisfies(vse.vega,`^${e.version.slice(1)}`)||console.warn(`The compiled spec uses Vega ${e.version}, but current version is v${vse.vega}.`)}g.classList.add("vega-embed"),f&&g.classList.add("has-actions"),g.innerHTML="";let b=g;if(f){const e=document.createElement("div");e.classList.add(wse),g.appendChild(e),b=e}const x=n.patch;x&&(v=x instanceof Function?x(v):Td(v,x,!0,!1).newDocument),n.formatLocale&&dse.formatLocale(n.formatLocale),n.timeFormatLocale&&dse.timeFormatLocale(n.timeFormatLocale);const{ast:w}=n,_=dse.parse(v,"vega-lite"===y?{}:c,{ast:w}),k=new(n.viewClass||dse.View)(_,Object.assign({loader:r,logLevel:p,renderer:h},w?{expr:dse.expressionInterpreter}:{}));if(!1!==n.tooltip){let e;e="function"==typeof n.tooltip?n.tooltip:new ase(!0===n.tooltip?{}:n.tooltip).call,k.tooltip(e)}let E,{hover:S}=n;if(void 0===S&&(S="vega"===y),S){const{hoverSet:e,updateSet:t}="boolean"==typeof S?{}:S;k.hover(e,t)}if(n&&(null!=n.width&&k.width(n.width),null!=n.height&&k.height(n.height),null!=n.padding&&k.padding(n.padding)),yield k.initialize(b,n.bind).runAsync(),!1!==f){let e=g;if(!1!==n.defaultStyle){const t=document.createElement("details");t.title=d.CLICK_TO_VIEW_ACTIONS,g.append(t),e=t;const n=document.createElement("summary");n.innerHTML=xse,t.append(n),E=e=>{t.contains(e.target)||t.removeAttribute("open")},document.addEventListener("click",E)}const r=document.createElement("div");if(e.append(r),r.classList.add("vega-actions"),!0===f||!1!==f.export)for(const e of["svg","png"])if(!0===f||!0===f.export||f.export[e]){const t=d[`${e.toUpperCase()}_ACTION`],i=document.createElement("a");i.text=t,i.href="#",i.target="_blank",i.download=`${m}.${e}`,i.addEventListener("mousedown",(function(t){return sse(this,void 0,void 0,(function*(){t.preventDefault();const r=yield k.toImageURL(e,n.scaleFactor);this.href=r}))})),r.append(i)}if(!0===f||!1!==f.source){const e=document.createElement("a");e.text=d.SOURCE_ACTION,e.href="#",e.addEventListener("click",(function(e){var r,i;_se(Ud(t),null!==(r=n.sourceHeader)&&void 0!==r?r:"",null!==(i=n.sourceFooter)&&void 0!==i?i:"",y),e.preventDefault()})),r.append(e)}if("vega-lite"===y&&(!0===f||!1!==f.compiled)){const e=document.createElement("a");e.text=d.COMPILED_ACTION,e.href="#",e.addEventListener("click",(function(e){var t,r;_se(Ud(v),null!==(t=n.sourceHeader)&&void 0!==t?t:"",null!==(r=n.sourceFooter)&&void 0!==r?r:"","vega"),e.preventDefault()})),r.append(e)}if(!0===f||!1!==f.editor){const e=null!==(l=n.editorUrl)&&void 0!==l?l:"https://vega.github.io/editor/",i=document.createElement("a");i.text=d.EDITOR_ACTION,i.href="#",i.addEventListener("click",(function(n){!function(e,t,n){const r=e.open(t),{origin:i}=new URL(t);let o=40;e.addEventListener("message",(function t(n){n.source===r&&(o=0,e.removeEventListener("message",t,!1))}),!1),setTimeout((function e(){o<=0||(r.postMessage(n,i),setTimeout(e,250),o-=1)}),250)}(window,e,{config:c,mode:y,renderer:h,spec:Ud(t)}),n.preventDefault()})),r.append(i)}}function A(){E&&document.removeEventListener("click",E),k.finalize()}return{view:k,spec:t,vgSpec:v,finalize:A}}))}(e,a,f,s)}))}function Ase(e,t){var n;return sse(this,void 0,void 0,(function*(){const r=My(e.config)?JSON.parse(yield t.load(e.config)):null!==(n=e.config)&&void 0!==n?n:{},i=My(e.patch)?JSON.parse(yield t.load(e.patch)):e.patch;return Object.assign(Object.assign(Object.assign({},e),i?{patch:i}:{}),r?{config:r}:{})}))}function Cse(){const[e,t]=md("https://raw.githubusercontent.com/Cnovotn/Info474Assignment2/main/data/franchiseBasedData.csv");return Sse("#team-wins",{$schema:"https://vega.github.io/schema/vega-lite/v5.json",description:"A simple bar chart looking at all of the MLB franchises wins for 2001.",title:"2001 Wins For Each Franchise",width:screen.width/1.5,height:"400",data:{values:e},signals:[{name:"tooltip",value:{},on:[{events:"rect:mouseover",update:"datum"},{events:"rect:mouseout",update:"{}"}]}],mark:{type:"bar",cornerRadiusEnd:1},layer:[{mark:"bar"},{mark:{type:"text",align:"center",baseline:"line-bottom"},encoding:{text:{field:"Wins",type:"quantitative"}}}],encoding:{x:{field:"Franchise",type:"nominal",axis:{labelAngle:-90}},y:{field:"Wins",type:"quantitative"}}}),ve.createElement("div",{className:"centered"},ve.createElement("div",{id:"team-wins"},ve.createElement("p",null,t&&"Loading the data!!!"),ve.createElement("svg",{width:"600",height:"500"})),ve.createElement("p",{className:"vis-description"},"The entire reason that I chose this season as the season to investigate out of all of them was because the Seattle Mariners were able to win the most regular season games in MLB history! It was also a great season for the Oakland Athletics which is traditionally another team that struggles to get wins."),ve.createElement("p",{className:"vis-description"},"What I found most interesting was the fact that the Arizona Diamondbacks were the ones that won the world series even though they were barely above the middle of the pack for wins the entire season."))}function Dse(){const[e,t]=md("https://raw.githubusercontent.com/Cnovotn/Info474Assignment2/main/data/franchiseBasedData.csv");return Sse("#big-graphic-2",{$schema:"https://vega.github.io/schema/vega-lite/v5.json",description:"A scatterplot showing the salary and wins for each of the franchises in the MLB.",data:{values:e},mark:"circle",width:screen.width/1.5,height:"400",padding:5,layer:[{mark:"circle"},{mark:{type:"text",align:"center",baseline:"line-bottom",tooltip:{content:"data"}},encoding:{text:{field:"Franchise",type:"nominal"}}}],encoding:{x:{field:"Salary",type:"quantitative",scale:{domain:[25e6,13e7]}},y:{field:"Wins",type:"quantitative",scale:{domain:[50,130]}}}}),ve.createElement("div",{className:"centered",style:{margin:30}},ve.createElement("div",{id:"big-graphic-2"},ve.createElement("h1",null,"Main Graphic With All Data"),ve.createElement("p",null,t&&"Loading the data!!!"),ve.createElement("svg",null)),ve.createElement("p",{className:"vis-description"},"This Visualization was extremely helpful for simply looking at all of the data points that are associated with each team. Since I am most curious about how the salary of each team affects their performance throughout the season, I have included the salary as the x-axis label and included the hits/wins as the y-axis which can be seen as the biggest measure of success for a season."),ve.createElement("p",null,"I am especially excited to see within this graphic that the Seattle Mariners and Oakland Athletics were at the top of the wins spectrum even though they were middle and below the average salary for the season."))}function Mse(){const[e,t]=md("https://raw.githubusercontent.com/Info474Sp21/Info474Assignment3/main/data/data_by_year_o.csv");return console.log(e),ve.createElement("div",null,ve.createElement("h1",{className:"centered"},"Testing D3 Implementation"))}xe(),xe(),xe();class Fse extends xe().Component{render(){return ve.createElement("div",null,ve.createElement("h2",null,"Info 474"),ve.createElement("h3",null,"May 1th, 2021"),ve.createElement("h3",null,"Clayton Novotney, Kelson Flint, Olivia Victorino, Zhan Wu"),ve.createElement("h1",{className:"centered"},"Interactive Data Visualization, Assignment 3"),ve.createElement("br",null),ve.createElement("h2",null,"Step 1: Data Selection"),ve.createElement("h4",null,"Data Selected: Spotify Music Data from ",ve.createElement("a",{href:"https://www.kaggle.com/yamaerenay/spotify-dataset-19212020-160k-tracks"},"Kaggle.com")),ve.createElement("p",null,"From this particular website, there were 7 different CSV files that we were able to choice from with different information being stored in each one."),ve.createElement("ul",null,ve.createElement("li",null,"artists.csv"),ve.createElement("li",null,"data_by_artist_o.csv"),ve.createElement("li",null,"data_by_genres_0.csv"),ve.createElement("li",null,"data_by_year_o.csv"),ve.createElement("li",null,ve.createElement("b",null,"data_o.csv")),ve.createElement("li",null,"dict_artists.json"),ve.createElement("li",null,ve.createElement("b",null,"tracks.csv"))),ve.createElement("p",null,"Looking at all of the different csv files, we found that we were most interested in the data_o.csv and tracks.csv files since they had the most unique information that we believe we could work with"),ve.createElement("br",null),ve.createElement("p",null,"The columns we are most interested in for the data_o.csv (28.44 MB) file are:"),ve.createElement("p",null,"valence (positivity), year (Year), acousticness (How Acoustic the song is), artists (array of artists contributed), danceability (how suitable the song is for dancing), duration (time duration of song in ms), energy (how energetic the song is), instrumentalness (ratio of instrumental sounds)"),ve.createElement("br",null),ve.createElement("p",null,"The columns we are most interested in for the tracks.csv (106.21 MB) file are:"),ve.createElement("p",null,"id (id of track), name (name of track), popularity (popularity of track), duration_ms (time duration of track in ms), explicit (whether it contains explicit (1) content or not (0)), artists (artists contributed to the track), id_artists (id of artists contributed to the track), release_date (the release date of the album containing this track), dancibility (how suitable the track is for dancing, 0(not danceable)->1(very danceable)), energy (how energetic the track is, 0(less energetic)->1(very energetic))"),ve.createElement("br",null),ve.createElement("h4",null,"Questions: "),ve.createElement(Mse,null),ve.createElement("br",null),ve.createElement(Dse,null),ve.createElement("h2",null,"Step 2: Interactive Data Visualization"),ve.createElement("p",null,"We got my data from a website called ",ve.createElement("a",{href:"https://www.kaggle.com/yamaerenay/spotify-dataset-19212020-160k-tracks"},"Kaggle.com")," and were able to execute certain SQL queries on the data set that was given."))}}xe();class Nse extends xe().Component{render(){return ve.createElement("div",{style:{marginTop:30}},ve.createElement("h1",null,"Conclusion"),ve.createElement("br",null),ve.createElement("p",null,"In summary to my experience with this assignment. I found myself completing very redundant processing for loading transforming and displaying the data within the data sets that I found. I tried multiple times to reduce redundancies within my code but began running into issues with the DOM, Hooks, and other tedious problems that required me to basically brute force this assignment and create multiple redudanct components that I would then load into the Vega visualiser."),ve.createElement("br",null),ve.createElement("p",null,"Using Tableau for the initial data loading and transformation was very obnoxious because working with the graphical user interface on their application was SOOOOO much easier than physically coding in the visualisations that I was interested in displaying using VEGA. While I chose to use VEGA for this assignment, I started out working with D3 as well and could see the appeal to that library program as well. I also think that I went about the assignment completely wrong, but by the time I figured this out I was way too deep into it. I simply altered the CSV files themselves for the queries rather than performing the queries with in the JS application itself. While this may have been wrong, it could have helped the runtime of the application significantly. This is also a huge learning experience for me since I am aware of the tools and features that will help me complete the transformations and queries within the VegaLite or D3 library itself."),ve.createElement("br",null),ve.createElement("p",null,"I also figured out at the end of the assignment, that the data sets that I was using was also very redundant. I could have easily created one main data set with all of the columns that I loaded into multiple different csv files."),ve.createElement("br",null),ve.createElement("p",null,"All in all, this was a very interesting assignment to work on and helped me get acquanted with the coding programs that are used for visualizing data in the web interfaces we are using every day."))}}const Ose=()=>ve.createElement("div",{id:"main",className:"container"},ve.createElement(Fse,null),ve.createElement("div",{className:"flexed data-center"},ve.createElement(Cse,null)),ve.createElement(Nse,null));Zf.render(ve.createElement(Ose,null),document.querySelector("#root"))}();
//# sourceMappingURL=index.3de142c6.js.map
